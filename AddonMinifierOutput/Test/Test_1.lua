local function a(...)local b,c="LibStub",2;local LibStub=_G[b]if not LibStub or LibStub.minor<c then LibStub=LibStub or{libs={},minors={}}_G[b]=LibStub;LibStub.minor=c;function LibStub:NewLibrary(d,e)assert(type(d)=="string","Bad argument #2 to `NewLibrary' (string expected)")e=assert(tonumber(string.match(e,"%d+")),"Minor version must either be a number or contain a number.")local f=self.minors[d]if f and f>=e then return nil end;self.minors[d],self.libs[d]=e,self.libs[d]or{}return self.libs[d],f end;function LibStub:GetLibrary(d,g)if not self.libs[d]and not g then error(("Cannot find a library instance of %q."):format(tostring(d)),2)end;return self.libs[d],self.minors[d]end;function LibStub:IterateLibraries()return pairs(self.libs)end;setmetatable(LibStub,{__call=LibStub.GetLibrary})end end;local function h(...)local i,k="CallbackHandler-1.0",8;local l=LibStub:NewLibrary(i,k)if not l then return end;local m={__index=function(n,o)n[o]={}return n[o]end}local securecallfunction,error=securecallfunction,error;local setmetatable,rawget=setmetatable,rawget;local next,select,pairs,type,tostring=next,select,pairs,type,tostring;local function p(q,...)local r,s=next(q)if not s then return end;repeat securecallfunction(s,...)r,s=next(q,r)until not s end;function l.New(t,u,v,w,A)v=v or"RegisterCallback"w=w or"UnregisterCallback"if A==nil then A="UnregisterAllCallbacks"end;local B=setmetatable({},m)local C={recurse=0,events=B}function C:Fire(D,...)if not rawget(B,D)or not next(B[D])then return end;local E=C.recurse;C.recurse=E+1;p(B[D],D,...)C.recurse=E;if C.insertQueue and E==0 then for F,G in pairs(C.insertQueue)do local H=not rawget(B,F)or not next(B[F])for I,J in pairs(G)do B[F][I]=J;if H and C.OnUsed then C.OnUsed(C,u,F)H=nil end end end;C.insertQueue=nil end end;u[v]=function(self,D,s,...)if type(D)~="string"then error("Usage: "..v.."(eventname, method[, arg]): 'eventname' - string expected.",2)end;s=s or D;local H=not rawget(B,D)or not next(B[D])if type(s)~="string"and type(s)~="function"then error("Usage: "..v.."(\"eventname\", \"methodname\"): 'methodname' - string or function expected.",2)end;local K;if type(s)=="string"then if type(self)~="table"then error("Usage: "..v.."(\"eventname\", \"methodname\"): self was not a table?",2)elseif self==u then error("Usage: "..v.."(\"eventname\", \"methodname\"): do not use Library:"..v.."(), use your own 'self'",2)elseif type(self[s])~="function"then error("Usage: "..v.."(\"eventname\", \"methodname\"): 'methodname' - method '"..tostring(s).."' not found on self.",2)end;if select("#",...)>=1 then local L=select(1,...)K=function(...)self[s](self,L,...)end else K=function(...)self[s](self,...)end end else if type(self)~="table"and type(self)~="string"and type(self)~="thread"then error("Usage: "..v.."(self or \"addonId\", eventname, method): 'self or addonId': table or string or thread expected.",2)end;if select("#",...)>=1 then local L=select(1,...)K=function(...)s(L,...)end else K=s end end;if B[D][self]or C.recurse<1 then B[D][self]=K;if C.OnUsed and H then C.OnUsed(C,u,D)end else C.insertQueue=C.insertQueue or setmetatable({},m)C.insertQueue[D][self]=K end end;u[w]=function(self,D)if not self or self==u then error("Usage: "..w.."(eventname): bad 'self'",2)end;if type(D)~="string"then error("Usage: "..w.."(eventname): 'eventname' - string expected.",2)end;if rawget(B,D)and B[D][self]then B[D][self]=nil;if C.OnUnused and not next(B[D])then C.OnUnused(C,u,D)end end;if C.insertQueue and rawget(C.insertQueue,D)and C.insertQueue[D][self]then C.insertQueue[D][self]=nil end end;if A then u[A]=function(...)if select("#",...)<1 then error("Usage: "..A.."([whatFor]): missing 'self' or \"addonId\" to unregister events for.",2)end;if select("#",...)==1 and...==u then error("Usage: "..A.."([whatFor]): supply a meaningful 'self' or \"addonId\"",2)end;for M=1,select("#",...)do local self=select(M,...)if C.insertQueue then for D,G in pairs(C.insertQueue)do if G[self]then G[self]=nil end end end;for D,G in pairs(B)do if G[self]then G[self]=nil;if C.OnUnused and not next(G)then C.OnUnused(C,u,D)end end end end end end;return C end end;local function N(...)local i,k="AceAddon-3.0",13;local O,f=LibStub:NewLibrary(i,k)if not O then return end;O.frame=O.frame or CreateFrame("Frame","AceAddon30Frame")O.addons=O.addons or{}O.statuses=O.statuses or{}O.initializequeue=O.initializequeue or{}O.enablequeue=O.enablequeue or{}O.embeds=O.embeds or setmetatable({},{__index=function(n,o)n[o]={}return n[o]end})local tinsert,P,Q=table.insert,table.concat,table.remove;local R,tostring=string.format,tostring;local select,pairs,next,type,unpack=select,pairs,next,type,unpack;local loadstring,assert,error=loadstring,assert,error;local setmetatable,getmetatable,rawset,rawget=setmetatable,getmetatable,rawset,rawget;local xpcall=xpcall;local function S(T)return geterrorhandler()(T)end;local function U(J,...)if type(J)=="function"then return xpcall(J,S,...)end end;local V,W,X,Y,Z,_,a0,a1,a2,a3,a4,a5;local function a6(self)return self.name end;local function a7(a8)for M=1,#O.initializequeue do if O.initializequeue[M]==a8 then return true end end;return false end;function O:NewAddon(a9,...)local I,aa;local M=1;if type(a9)=="table"then I=a9;aa=...M=2 else aa=a9 end;if type(aa)~="string"then error(("Usage: NewAddon([object,] name, [lib, lib, lib, ...]): 'name' - string expected got '%s'."):format(type(aa)),2)end;if self.addons[aa]then error(("Usage: NewAddon([object,] name, [lib, lib, lib, ...]): 'name' - Addon '%s' already exists."):format(aa),2)end;I=I or{}I.name=aa;local ab={}local ac=getmetatable(I)if ac then for ad,ae in pairs(ac)do ab[ad]=ae end end;ab.__tostring=a6;setmetatable(I,ab)self.addons[aa]=I;I.modules={}I.orderedModules={}I.defaultModuleLibraries={}Z(I)self:EmbedLibraries(I,select(M,...))tinsert(self.initializequeue,I)return I end;function O:GetAddon(aa,g)if not g and not self.addons[aa]then error(("Usage: GetAddon(name): 'name' - Cannot find an AceAddon '%s'."):format(tostring(aa)),2)end;return self.addons[aa]end;function O:EmbedLibraries(a8,...)for M=1,select("#",...)do local af=select(M,...)self:EmbedLibrary(a8,af,false,4)end end;function O:EmbedLibrary(a8,af,g,ag)local ah=LibStub:GetLibrary(af,true)if not ah and not g then error(("Usage: EmbedLibrary(addon, libname, silent, offset): 'libname' - Cannot find a library instance of %q."):format(tostring(af)),ag or 2)elseif ah and type(ah.Embed)=="function"then ah:Embed(a8)tinsert(self.embeds[a8],af)return true elseif ah then error(("Usage: EmbedLibrary(addon, libname, silent, offset): 'libname' - Library '%s' is not Embed capable"):format(af),ag or 2)end end;function a0(self,aa,g)if not self.modules[aa]and not g then error(("Usage: GetModule(name, silent): 'name' - Cannot find module '%s'."):format(tostring(aa)),2)end;return self.modules[aa]end;local function ai(self)return true end;function _(self,aa,aj,...)if type(aa)~="string"then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'name' - string expected got '%s'."):format(type(aa)),2)end;if type(aj)~="string"and type(aj)~="table"and type(aj)~="nil"then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'prototype' - table (prototype), string (lib) or nil expected got '%s'."):format(type(aj)),2)end;if self.modules[aa]then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'name' - Module '%s' already exists."):format(aa),2)end;local ak=O:NewAddon(R("%s_%s",self.name or tostring(self),aa))ak.IsModule=ai;ak:SetEnabledState(self.defaultModuleState)ak.moduleName=aa;if type(aj)=="string"then O:EmbedLibraries(ak,aj,...)else O:EmbedLibraries(ak,...)end;O:EmbedLibraries(ak,unpack(self.defaultModuleLibraries))if not aj or type(aj)=="string"then aj=self.defaultModulePrototype or nil end;if type(aj)=="table"then local al=getmetatable(ak)al.__index=aj;setmetatable(ak,al)end;U(self.OnModuleCreated,self,ak)self.modules[aa]=ak;tinsert(self.orderedModules,ak)return ak end;function a1(self)return self.moduleName or self.name end;function V(self)self:SetEnabledState(true)if not a7(self)then return O:EnableAddon(self)end end;function W(self)self:SetEnabledState(false)return O:DisableAddon(self)end;function X(self,aa)local ak=self:GetModule(aa)return ak:Enable()end;function Y(self,aa)local ak=self:GetModule(aa)return ak:Disable()end;function a3(self,...)if next(self.modules)then error("Usage: SetDefaultModuleLibraries(...): cannot change the module defaults after a module has been registered.",2)end;self.defaultModuleLibraries={...}end;function a2(self,am)if next(self.modules)then error("Usage: SetDefaultModuleState(state): cannot change the module defaults after a module has been registered.",2)end;self.defaultModuleState=am end;function a5(self,aj)if next(self.modules)then error("Usage: SetDefaultModulePrototype(prototype): cannot change the module defaults after a module has been registered.",2)end;if type(aj)~="table"then error(("Usage: SetDefaultModulePrototype(prototype): 'prototype' - table expected got '%s'."):format(type(aj)),2)end;self.defaultModulePrototype=aj end;function a4(self,am)self.enabledState=am end;local function an(self)return pairs(self.modules)end;local function ao(self)return pairs(O.embeds[self])end;local function ap(self)return self.enabledState end;local aq={NewModule=_,GetModule=a0,Enable=V,Disable=W,EnableModule=X,DisableModule=Y,IsEnabled=ap,SetDefaultModuleLibraries=a3,SetDefaultModuleState=a2,SetDefaultModulePrototype=a5,SetEnabledState=a4,IterateModules=an,IterateEmbeds=ao,GetName=a1}local function ar(self)return false end;local as={defaultModuleState=true,enabledState=true,IsModule=ar}function Z(u,at)for ad,ae in pairs(aq)do u[ad]=ae end;if not at then for ad,ae in pairs(as)do u[ad]=u[ad]or ae end end end;function O:InitializeAddon(a8)U(a8.OnInitialize,a8)local au=self.embeds[a8]for M=1,#au do local ah=LibStub:GetLibrary(au[M],true)if ah then U(ah.OnEmbedInitialize,ah,a8)end end end;function O:EnableAddon(a8)if type(a8)=="string"then a8=O:GetAddon(a8)end;if self.statuses[a8.name]or not a8.enabledState then return false end;self.statuses[a8.name]=true;U(a8.OnEnable,a8)if self.statuses[a8.name]then local au=self.embeds[a8]for M=1,#au do local ah=LibStub:GetLibrary(au[M],true)if ah then U(ah.OnEmbedEnable,ah,a8)end end;local av=a8.orderedModules;for M=1,#av do self:EnableAddon(av[M])end end;return self.statuses[a8.name]end;function O:DisableAddon(a8)if type(a8)=="string"then a8=O:GetAddon(a8)end;if not self.statuses[a8.name]then return false end;self.statuses[a8.name]=false;U(a8.OnDisable,a8)if not self.statuses[a8.name]then local au=self.embeds[a8]for M=1,#au do local ah=LibStub:GetLibrary(au[M],true)if ah then U(ah.OnEmbedDisable,ah,a8)end end;local av=a8.orderedModules;for M=1,#av do self:DisableAddon(av[M])end end;return not self.statuses[a8.name]end;function O:IterateAddons()return pairs(self.addons)end;function O:IterateAddonStatus()return pairs(self.statuses)end;function O:IterateEmbedsOnAddon(a8)return pairs(self.embeds[a8])end;function O:IterateModulesOfAddon(a8)return pairs(a8.modules)end;local aw={Blizzard_DebugTools=true,Blizzard_TimeManager=true,Blizzard_BattlefieldMap=true,Blizzard_MapCanvas=true,Blizzard_SharedMapDataProviders=true,Blizzard_CombatLog=true}local function ax(ay,F,az)if F=="ADDON_LOADED"and(az==nil or not aw[az])or F=="PLAYER_LOGIN"then while#O.initializequeue>0 do local a8=Q(O.initializequeue,1)if F=="ADDON_LOADED"then a8.baseName=az end;O:InitializeAddon(a8)tinsert(O.enablequeue,a8)end;if IsLoggedIn()then while#O.enablequeue>0 do local a8=Q(O.enablequeue,1)O:EnableAddon(a8)end end end end;O.frame:RegisterEvent("ADDON_LOADED")O.frame:RegisterEvent("PLAYER_LOGIN")O.frame:SetScript("OnEvent",ax)for aa,a8 in pairs(O.addons)do Z(a8,true)end;if f and f<10 then for aa,a8 in pairs(O.addons)do a8.orderedModules={}for aA,ak in pairs(a8.modules)do tinsert(a8.orderedModules,ak)end end end end;local function aB(...)local l=LibStub("CallbackHandler-1.0")local i,k="AceEvent-3.0",4;local aC=LibStub:NewLibrary(i,k)if not aC then return end;local pairs=pairs;aC.frame=aC.frame or CreateFrame("Frame","AceEvent30Frame")aC.embeds=aC.embeds or{}if not aC.events then aC.events=l:New(aC,"RegisterEvent","UnregisterEvent","UnregisterAllEvents")end;function aC.events:OnUsed(u,D)aC.frame:RegisterEvent(D)end;function aC.events:OnUnused(u,D)aC.frame:UnregisterEvent(D)end;if not aC.messages then aC.messages=l:New(aC,"RegisterMessage","UnregisterMessage","UnregisterAllMessages")aC.SendMessage=aC.messages.Fire end;local aq={"RegisterEvent","UnregisterEvent","RegisterMessage","UnregisterMessage","SendMessage","UnregisterAllEvents","UnregisterAllMessages"}function aC:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;function aC:OnEmbedDisable(u)u:UnregisterAllEvents()u:UnregisterAllMessages()end;local B=aC.events;aC.frame:SetScript("OnEvent",function(ay,F,...)B:Fire(F,...)end)for u,ae in pairs(aC.embeds)do aC:Embed(u)end end;local function aD(...)local i,k="AceTimer-3.0",17;local aE,f=LibStub:NewLibrary(i,k)if not aE then return end;aE.activeTimers=aE.activeTimers or{}local aF=aE.activeTimers;local type,unpack,next,error,select=type,unpack,next,error,select;local GetTime,aG=GetTime,C_Timer.After;local function aH(self,aI,J,aJ,...)if aJ<0.01 then aJ=0.01 end;local aK={object=self,func=J,looping=aI,argsCount=select("#",...),delay=aJ,ends=GetTime()+aJ,...}aF[aK]=aK;aK.callback=function()if not aK.cancelled then if type(aK.func)=="string"then aK.object[aK.func](aK.object,unpack(aK,1,aK.argsCount))else aK.func(unpack(aK,1,aK.argsCount))end;if aK.looping and not aK.cancelled then local aL=GetTime()local aM=aK.delay-(aL-aK.ends)if aM<0.01 then aM=0.01 end;aG(aM,aK.callback)aK.ends=aL+aM else aF[aK.handle or aK]=nil end end end;aG(aJ,aK.callback)return aK end;function aE:ScheduleTimer(J,aJ,...)if not J or not aJ then error(i..": ScheduleTimer(callback, delay, args...): 'callback' and 'delay' must have set values.",2)end;if type(J)=="string"then if type(self)~="table"then error(i..": ScheduleTimer(callback, delay, args...): 'self' - must be a table.",2)elseif not self[J]then error(i..": ScheduleTimer(callback, delay, args...): Tried to register '"..J.."' as the callback, but it doesn't exist in the module.",2)end end;return aH(self,nil,J,aJ,...)end;function aE:ScheduleRepeatingTimer(J,aJ,...)if not J or not aJ then error(i..": ScheduleRepeatingTimer(callback, delay, args...): 'callback' and 'delay' must have set values.",2)end;if type(J)=="string"then if type(self)~="table"then error(i..": ScheduleRepeatingTimer(callback, delay, args...): 'self' - must be a table.",2)elseif not self[J]then error(i..": ScheduleRepeatingTimer(callback, delay, args...): Tried to register '"..J.."' as the callback, but it doesn't exist in the module.",2)end end;return aH(self,true,J,aJ,...)end;function aE:CancelTimer(aN)local aK=aF[aN]if not aK then return false else aK.cancelled=true;aF[aN]=nil;return true end end;function aE:CancelAllTimers()for ad,ae in next,aF do if ae.object==self then aE.CancelTimer(self,ad)end end end;function aE:TimeLeft(aN)local aK=aF[aN]if not aK then return 0 else return aK.ends-GetTime()end end;if f and f<10 then aE.frame:SetScript("OnUpdate",nil)aE.frame:SetScript("OnEvent",nil)aE.frame:UnregisterAllEvents()for I,aO in next,aE.selfs do for aP,aK in next,aO do if type(aK)=="table"and aK.callback then local aQ;if aK.delay then aQ=aE.ScheduleRepeatingTimer(aK.object,aK.callback,aK.delay,aK.arg)else aQ=aE.ScheduleTimer(aK.object,aK.callback,aK.when-GetTime(),aK.arg)end;aF[aQ]=nil;aF[aP]=aQ;aQ.handle=aP end end end;aE.selfs=nil;aE.hash=nil;aE.debug=nil elseif f and f<17 then aE.inactiveTimers=nil;aE.frame=nil;local aR=aE.activeTimers;aE.activeTimers={}aF=aE.activeTimers;for aP,aK in next,aR do local aQ;local aS,aT=aK:GetDuration(),aK:GetElapsed()aK:GetParent():Stop()if aK.looping then aQ=aE.ScheduleRepeatingTimer(aK.object,aK.func,aS,unpack(aK.args,1,aK.argsCount))else aQ=aE.ScheduleTimer(aK.object,aK.func,aS-aT,unpack(aK.args,1,aK.argsCount))end;aF[aQ]=nil;aF[aP]=aQ;aQ.handle=aP end;if f<13 and aE.hashCompatTable then for aP,aN in next,aE.hashCompatTable do local aU=aF[aN]if aU then aF[aN]=nil;aF[aP]=aU;aU.handle=aP end end;aE.hashCompatTable=nil end end;aE.embeds=aE.embeds or{}local aq={"ScheduleTimer","ScheduleRepeatingTimer","CancelTimer","CancelAllTimers","TimeLeft"}function aE:Embed(u)aE.embeds[u]=true;for aV,ae in next,aq do u[ae]=aE[ae]end;return u end;function aE:OnEmbedDisable(u)u:CancelAllTimers()end;for a8 in next,aE.embeds do aE:Embed(a8)end end;local function aW(...)local i,k="AceBucket-3.0",4;local aX,f=LibStub:NewLibrary(i,k)if not aX then return end;aX.buckets=aX.buckets or{}aX.embeds=aX.embeds or{}local aC,aE;local P=table.concat;local type,next,pairs,select=type,next,pairs,select;local tonumber,tostring,rawset=tonumber,tostring,rawset;local assert,loadstring,error=assert,loadstring,error;local aY=setmetatable({},{__mode='k'})local xpcall=xpcall;local function S(T)return geterrorhandler()(T)end;local function U(J,...)if J then return xpcall(J,S,...)end end;local function aZ(a_)local b0=a_.received;if next(b0)~=nil then local b1=a_.callback;if type(b1)=="string"then U(a_.object[b1],a_.object,b0)else U(b1,b0)end;for ad in pairs(b0)do b0[ad]=nil end;a_.timer=aE.ScheduleTimer(a_,aZ,a_.interval,a_)else a_.timer=nil end end;local function b2(self,F,az)if az==nil then az="nil"end;self.received[az]=(self.received[az]or 0)+1;if not self.timer then self.timer=aE.ScheduleTimer(self,aZ,self.interval,self)end end;local function b3(self,F,b4,b1,b5)if not aC or not aE then aC=LibStub:GetLibrary("AceEvent-3.0",true)aE=LibStub:GetLibrary("AceTimer-3.0",true)if not aC or not aE then error(i.." requires AceEvent-3.0 and AceTimer-3.0",3)end end;if type(F)~="string"and type(F)~="table"then error("Usage: RegisterBucket(event, interval, callback): 'event' - string or table expected.",3)end;if not b1 then if type(F)=="string"then b1=F else error("Usage: RegisterBucket(event, interval, callback): cannot omit callback when event is not a string.",3)end end;if not tonumber(b4)then error("Usage: RegisterBucket(event, interval, callback): 'interval' - number expected.",3)end;if type(b1)~="string"and type(b1)~="function"then error("Usage: RegisterBucket(event, interval, callback): 'callback' - string or function or nil expected.",3)end;if type(b1)=="string"and type(self[b1])~="function"then error("Usage: RegisterBucket(event, interval, callback): 'callback' - method not found on target object.",3)end;local a_=next(aY)if a_ then aY[a_]=nil else a_={handler=b2,received={}}end;a_.object,a_.callback,a_.interval=self,b1,tonumber(b4)local b6=b5 and aC.RegisterMessage or aC.RegisterEvent;if type(F)=="table"then for aV,b7 in pairs(F)do b6(a_,b7,"handler")end else b6(a_,F,"handler")end;local aP=tostring(a_)aX.buckets[aP]=a_;return aP end;function aX:RegisterBucketEvent(F,b4,b1)return b3(self,F,b4,b1,false)end;function aX:RegisterBucketMessage(b8,b4,b1)return b3(self,b8,b4,b1,true)end;function aX:UnregisterBucket(aP)local a_=aX.buckets[aP]if a_ then aC.UnregisterAllEvents(a_)aC.UnregisterAllMessages(a_)for ad in pairs(a_.received)do a_.received[ad]=nil end;if a_.timer then aE.CancelTimer(a_,a_.timer)a_.timer=nil end;aX.buckets[aP]=nil;aY[a_]=true end end;function aX:UnregisterAllBuckets()for aP,a_ in pairs(aX.buckets)do if a_.object==self then aX.UnregisterBucket(self,aP)end end end;local aq={"RegisterBucketEvent","RegisterBucketMessage","UnregisterBucket","UnregisterAllBuckets"}function aX:Embed(u)for aV,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;function aX:OnEmbedDisable(u)u:UnregisterAllBuckets()end;for a8 in pairs(aX.embeds)do aX:Embed(a8)end end;local function b9(...)local ba,bb="AceHook-3.0",9;local bc,f=LibStub:NewLibrary(ba,bb)if not bc then return end;bc.embeded=bc.embeded or{}bc.registry=bc.registry or setmetatable({},{__index=function(n,o)n[o]={}return n[o]end})bc.handlers=bc.handlers or{}bc.actives=bc.actives or{}bc.scripts=bc.scripts or{}bc.onceSecure=bc.onceSecure or{}bc.hooks=bc.hooks or{}local C=bc.registry;local q=bc.handlers;local bd=bc.actives;local be=bc.scripts;local bf=bc.onceSecure;local pairs,next,type=pairs,next,type;local bg=string.format;local assert,error=assert,error;local issecurevariable,hooksecurefunc=issecurevariable,hooksecurefunc;local _G=_G;local bh,bi,bj;local bk={OnClick=true}local aq={"Hook","SecureHook","HookScript","SecureHookScript","Unhook","UnhookAll","IsHooked","RawHook","RawHookScript"}function bc:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeded[u]=true;u.hooks=u.hooks or{}return u end;function bc:OnEmbedDisable(u)u:UnhookAll()end;function bi(self,bl,bm,bn,bo)local bp;local s=type(bl)=="string"if bo and not bn then bp=function(...)if bd[bp]then if s then self[bl](self,...)else bl(...)end end;return bm(...)end else bp=function(...)if bd[bp]then if s then return self[bl](self,...)else return bl(...)end elseif not bn then return bm(...)end end end;return bp end;function bh()end;function bj(self,bq,s,bl,br,bn,bs,bt,bu)if not bl then bl=s end;assert(not br or type(br)=="boolean")assert(not bn or type(bn)=="boolean")assert(not bs or type(bs)=="boolean")assert(not bt or type(bt)=="boolean")assert(bu)if bq and type(bq)~="table"then error(bg("%s: 'object' - nil or table expected got %s",bu,type(bq)),3)end;if type(s)~="string"then error(bg("%s: 'method' - string expected got %s",bu,type(s)),3)end;if type(bl)~="string"and type(bl)~="function"then error(bg("%s: 'handler' - nil, string, or function expected got %s",bu,type(bl)),3)end;if type(bl)=="string"and type(self[bl])~="function"then error(bg("%s: 'handler' - Handler specified does not exist at self[handler]",bu),3)end;if br then if not bq or not bq.GetScript or not bq:HasScript(s)then error(bg("%s: You can only hook a script on a frame object",bu),3)end;if not bn and bq.IsProtected and bq:IsProtected()and bk[s]then error(bg("Cannot hook secure script %q; Use SecureHookScript(obj, method, [handler]) instead.",s),3)end else local bv;if bq then bv=bf[bq]and bf[bq][s]or issecurevariable(bq,s)else bv=bf[s]or issecurevariable(s)end;if bv then if bt then if bq then bf[bq]=bf[bq]or{}bf[bq][s]=true else bf[s]=true end elseif not bn then error(bg("%s: Attempt to hook secure function %s. Use `SecureHook' or add `true' to the argument list to override.",bu,s),3)end end end;local bp;if bq then bp=C[self][bq]and C[self][bq][s]else bp=C[self][s]end;if bp then if bd[bp]then error(bg("Attempting to rehook already active hook %s.",s))end;if q[bp]==bl then bd[bp]=true;return elseif bq then if self.hooks and self.hooks[bq]then self.hooks[bq][s]=nil end;C[self][bq][s]=nil else if self.hooks then self.hooks[s]=nil end;C[self][s]=nil end;q[bp],bd[bp],be[bp]=nil,nil,nil end;local bm;if br then bm=bq:GetScript(s)or bh elseif bq then bm=bq[s]else bm=_G[s]end;if not bm then error(bg("%s: Attempting to hook a non existing target",bu),3)end;bp=bi(self,bl,bm,bn,not(bs or bn))if bq then self.hooks[bq]=self.hooks[bq]or{}C[self][bq]=C[self][bq]or{}C[self][bq][s]=bp;if not bn then self.hooks[bq][s]=bm end;if br then if not bn then bq:SetScript(s,bp)else bq:HookScript(s,bp)end else if not bn then bq[s]=bp else hooksecurefunc(bq,s,bp)end end else C[self][s]=bp;if not bn then _G[s]=bp;self.hooks[s]=bm else hooksecurefunc(s,bp)end end;bd[bp],q[bp],be[bp]=true,bl,br and true or nil end;function bc:Hook(I,s,bl,bw)if type(I)=="string"then s,bl,bw,I=I,s,bl,nil end;if bl==true then bl,bw=nil,true end;bj(self,I,s,bl,false,false,false,bw or false,"Usage: Hook([object], method, [handler], [hookSecure])")end;function bc:RawHook(I,s,bl,bw)if type(I)=="string"then s,bl,bw,I=I,s,bl,nil end;if bl==true then bl,bw=nil,true end;bj(self,I,s,bl,false,false,true,bw or false,"Usage: RawHook([object], method, [handler], [hookSecure])")end;function bc:SecureHook(I,s,bl)if type(I)=="string"then s,bl,I=I,s,nil end;bj(self,I,s,bl,false,true,false,false,"Usage: SecureHook([object], method, [handler])")end;function bc:HookScript(bx,br,bl)bj(self,bx,br,bl,true,false,false,false,"Usage: HookScript(object, method, [handler])")end;function bc:RawHookScript(bx,br,bl)bj(self,bx,br,bl,true,false,true,false,"Usage: RawHookScript(object, method, [handler])")end;function bc:SecureHookScript(bx,br,bl)bj(self,bx,br,bl,true,true,false,false,"Usage: SecureHookScript(object, method, [handler])")end;function bc:Unhook(bq,s)local bu="Usage: Unhook([obj], method)"if type(bq)=="string"then s,bq=bq,nil end;if bq and type(bq)~="table"then error(bg("%s: 'obj' - expecting nil or table got %s",bu,type(bq)),2)end;if type(s)~="string"then error(bg("%s: 'method' - expeting string got %s",bu,type(s)),2)end;local bp;if bq then bp=C[self][bq]and C[self][bq][s]else bp=C[self][s]end;if not bp or not bd[bp]then return false end;bd[bp],q[bp]=nil,nil;if bq then C[self][bq][s]=nil;C[self][bq]=next(C[self][bq])and C[self][bq]or nil;if not self.hooks[bq]or not self.hooks[bq][s]then return true end;if be[bp]and bq:GetScript(s)==bp then bq:SetScript(s,self.hooks[bq][s]~=bh and self.hooks[bq][s]or nil)be[bp]=nil elseif bq and self.hooks[bq]and self.hooks[bq][s]and bq[s]==bp then bq[s]=self.hooks[bq][s]end;self.hooks[bq][s]=nil;self.hooks[bq]=next(self.hooks[bq])and self.hooks[bq]or nil else C[self][s]=nil;if not self.hooks[s]then return true end;if self.hooks[s]and _G[s]==bp then _G[s]=self.hooks[s]end;self.hooks[s]=nil end;return true end;function bc:UnhookAll()for o,by in pairs(C[self])do if type(o)=="table"then for s in pairs(by)do bc.Unhook(self,o,s)end else bc.Unhook(self,o)end end end;function bc:IsHooked(bq,s)if type(bq)=="string"then if C[self][bq]and bd[C[self][bq]]then return true,q[C[self][bq]]end else if C[self][bq]and C[self][bq][s]and bd[C[self][bq][s]]then return true,q[C[self][bq][s]]end end;return false,nil end;for u,ae in pairs(bc.embeded)do bc:Embed(u)end end;local function bz(...)local bA,bB="AceDB-3.0",28;local bC=LibStub:NewLibrary(bA,bB)if not bC then return end;local type,pairs,next,error=type,pairs,next,error;local setmetatable,rawset,rawget=setmetatable,rawset,rawget;local _G=_G;bC.db_registry=bC.db_registry or{}bC.frame=bC.frame or CreateFrame("Frame")local l;local bD={Fire=function()end}local bE={}local function bF(bG,bH)if type(bH)~="table"then bH={}end;if type(bG)=="table"then for ad,ae in pairs(bG)do if type(ae)=="table"then ae=bF(ae,bH[ad])end;bH[ad]=ae end end;return bH end;local function bI(bH,bG)for ad,ae in pairs(bG)do if ad=="*"or ad=="**"then if type(ae)=="table"then local al={__index=function(aU,bJ)if bJ==nil then return nil end;local n={}bI(n,ae)rawset(aU,bJ,n)return n end}setmetatable(bH,al)for bK,bL in pairs(bH)do if not rawget(bG,bK)and type(bL)=="table"then bI(bL,ae)end end else local al={__index=function(aU,bJ)return bJ~=nil and ae or nil end}setmetatable(bH,al)end elseif type(ae)=="table"then if not rawget(bH,ad)then rawset(bH,ad,{})end;if type(bH[ad])=="table"then bI(bH[ad],ae)if bG['**']then bI(bH[ad],bG['**'])end end else if rawget(bH,ad)==nil then rawset(bH,ad,ae)end end end end;local function bM(bN,bO,bP)setmetatable(bN,nil)for ad,ae in pairs(bO)do if ad=="*"or ad=="**"then if type(ae)=="table"then for o,by in pairs(bN)do if type(by)=="table"then if bO[o]==nil and(not bP or bP[o]==nil)then bM(by,ae)if next(by)==nil then bN[o]=nil end elseif ad=="**"then bM(by,ae,bO[o])end end end elseif ad=="*"then for o,by in pairs(bN)do if bO[o]==nil and ae==by then bN[o]=nil end end end elseif type(ae)=="table"and type(bN[ad])=="table"then bM(bN[ad],ae,bP and bP[ad])if next(bN[ad])==nil then bN[ad]=nil end else if bN[ad]==bO[ad]and(not bP or bP[ad]==nil)then bN[ad]=nil end end end end;local function bQ(bN,bR,bS,o,bO)local bT=rawget(bN,"sv")local bU;if not bT[bS]then bT[bS]={}end;if not bT[bS][o]then bT[bS][o]={}bU=true end;local n=bT[bS][o]if bO then bI(n,bO)end;rawset(bN,bR,n)return bU,n end;local bV={__index=function(aU,bR)local bW=rawget(aU,"keys")local o=bW[bR]if o then local bX=rawget(aU,"defaults")local bO=bX and bX[bR]if bR=="profile"then local aH=bQ(aU,bR,"profiles",o,bO)if aH then aU.callbacks:Fire("OnNewProfile",aU,o)end elseif bR=="profiles"then local bT=rawget(aU,"sv")if not bT.profiles then bT.profiles={}end;rawset(aU,"profiles",bT.profiles)elseif bR=="global"then local bT=rawget(aU,"sv")if not bT.global then bT.global={}end;if bO then bI(bT.global,bO)end;rawset(aU,bR,bT.global)else bQ(aU,bR,bR,o,bO)end end;return rawget(aU,bR)end}local function bY(bO,bZ,ag)if not bO then return end;ag=ag or 0;for ad in pairs(bO)do if not bZ[ad]or ad=="profiles"then error(("Usage: AceDBObject:RegisterDefaults(defaults): '%s' is not a valid datatype."):format(ad),3+ag)end end end;local b_={["callbacks"]=true,["RegisterCallback"]=true,["UnregisterCallback"]=true,["UnregisterAllCallbacks"]=true,["children"]=true}local c0=GetRealmName()local c1=UnitName("player").." - "..c0;local aV,c2=UnitClass("player")local aV,c3=UnitRace("player")local c4=UnitFactionGroup("player")local c5=c4 .." - "..c0;local c6=GetLocale():lower()local c7={"US","KR","EU","TW","CN"}local c8=c7[GetCurrentRegion()]or GetCurrentRegionName()or"TR"local c9=c5 .." - "..c8;local function ca(bT,bO,cb,cc,cd)if cb==true then cb="Default"end;local ce;if not cd then if not bT.profileKeys then bT.profileKeys={}end;ce=bT.profileKeys[c1]or cb or c1;bT.profileKeys[c1]=ce else ce=cd.keys.profile or cb or c1;bT.profileKeys=nil end;local bZ={["char"]=c1,["realm"]=c0,["class"]=c2,["race"]=c3,["faction"]=c4,["factionrealm"]=c5,["factionrealmregion"]=c9,["profile"]=ce,["locale"]=c6,["global"]=true,["profiles"]=true}bY(bO,bZ,1)if cc then for ad,ae in pairs(cc)do if not b_[ad]then cc[ad]=nil end end end;local bN=setmetatable(cc or{},bV)if not rawget(bN,"callbacks")then if not l then l=LibStub:GetLibrary("CallbackHandler-1.0",true)end;bN.callbacks=l and l:New(bN)or bD end;if not cd then for aa,J in pairs(bE)do bN[aa]=J end else bN.RegisterDefaults=bE.RegisterDefaults;bN.ResetProfile=bE.ResetProfile end;bN.profiles=bT.profiles;bN.keys=bZ;bN.sv=bT;bN.defaults=bO;bN.parent=cd;bC.db_registry[bN]=true;return bN end;local function cf(bx,F)if F=="PLAYER_LOGOUT"then for bN in pairs(bC.db_registry)do bN.callbacks:Fire("OnDatabaseShutdown",bN)bN:RegisterDefaults(nil)local bT=rawget(bN,"sv")for bR in pairs(bN.keys)do if rawget(bT,bR)then if bR~="global"and(bR~="profiles"or rawget(bN,"parent"))then for o in pairs(bT[bR])do if not next(bT[bR][o])then bT[bR][o]=nil end end end;if not next(bT[bR])then bT[bR]=nil end end end end end end;bC.frame:RegisterEvent("PLAYER_LOGOUT")bC.frame:SetScript("OnEvent",cf)function bE:RegisterDefaults(bO)if bO and type(bO)~="table"then error(("Usage: AceDBObject:RegisterDefaults(defaults): 'defaults' - table or nil expected, got %q."):format(type(bO)),2)end;bY(bO,self.keys)if self.defaults then for bR,o in pairs(self.keys)do if self.defaults[bR]and rawget(self,bR)then bM(self[bR],self.defaults[bR])end end end;self.defaults=bO;if bO then for bR,o in pairs(self.keys)do if bO[bR]and rawget(self,bR)then bI(self[bR],bO[bR])end end end end;function bE:SetProfile(aa)if type(aa)~="string"then error(("Usage: AceDBObject:SetProfile(name): 'name' - string expected, got %q."):format(type(aa)),2)end;if aa==self.keys.profile then return end;local cg=self.profile;local bO=self.defaults and self.defaults.profile;self.callbacks:Fire("OnProfileShutdown",self)if cg and bO then bM(cg,bO)end;self.profile=nil;self.keys["profile"]=aa;if self.sv.profileKeys then self.sv.profileKeys[c1]=aa end;if self.children then for aV,bN in pairs(self.children)do bE.SetProfile(bN,aa)end end;self.callbacks:Fire("OnProfileChanged",self,aa)end;function bE:GetProfiles(n)if n and type(n)~="table"then error(("Usage: AceDBObject:GetProfiles(tbl): 'tbl' - table or nil expected, got %q."):format(type(n)),2)end;if n then for ad,ae in pairs(n)do n[ad]=nil end else n={}end;local ch=self.keys.profile;local M=0;for ce in pairs(self.profiles)do M=M+1;n[M]=ce;if ch and ce==ch then ch=nil end end;if ch then M=M+1;n[M]=ch end;return n,M end;function bE:GetCurrentProfile()return self.keys.profile end;function bE:DeleteProfile(aa,g)if type(aa)~="string"then error(("Usage: AceDBObject:DeleteProfile(name): 'name' - string expected, got %q."):format(type(aa)),2)end;if self.keys.profile==aa then error(("Cannot delete the active profile (%q) in an AceDBObject."):format(aa),2)end;if not rawget(self.profiles,aa)and not g then error(("Cannot delete profile %q as it does not exist."):format(aa),2)end;self.profiles[aa]=nil;if self.children then for aV,bN in pairs(self.children)do bE.DeleteProfile(bN,aa,true)end end;if self.sv.profileKeys then for o,ci in pairs(self.sv.profileKeys)do if ci==aa then self.sv.profileKeys[o]=nil end end end;self.callbacks:Fire("OnProfileDeleted",self,aa)end;function bE:CopyProfile(aa,g)if type(aa)~="string"then error(("Usage: AceDBObject:CopyProfile(name): 'name' - string expected, got %q."):format(type(aa)),2)end;if aa==self.keys.profile then error(("Cannot have the same source and destination profiles (%q)."):format(aa),2)end;if not rawget(self.profiles,aa)and not g then error(("Cannot copy profile %q as it does not exist."):format(aa),2)end;bE.ResetProfile(self,nil,true)local ci=self.profile;local cj=self.profiles[aa]bF(cj,ci)if self.children then for aV,bN in pairs(self.children)do bE.CopyProfile(bN,aa,true)end end;self.callbacks:Fire("OnProfileCopied",self,aa)end;function bE:ResetProfile(ck,cl)local ci=self.profile;for ad,ae in pairs(ci)do ci[ad]=nil end;local bO=self.defaults and self.defaults.profile;if bO then bI(ci,bO)end;if self.children and not ck then for aV,bN in pairs(self.children)do bE.ResetProfile(bN,nil,cl)end end;if not cl then self.callbacks:Fire("OnProfileReset",self)end end;function bE:ResetDB(cb)if cb and type(cb)~="string"then error(("Usage: AceDBObject:ResetDB(defaultProfile): 'defaultProfile' - string or nil expected, got %q."):format(type(cb)),2)end;local bT=self.sv;for ad,ae in pairs(bT)do bT[ad]=nil end;ca(bT,self.defaults,cb,self)if self.children then if not bT.namespaces then bT.namespaces={}end;for aa,bN in pairs(self.children)do if not bT.namespaces[aa]then bT.namespaces[aa]={}end;ca(bT.namespaces[aa],bN.defaults,self.keys.profile,bN,self)end end;self.callbacks:Fire("OnDatabaseReset",self)self.callbacks:Fire("OnProfileChanged",self,self.keys["profile"])return self end;function bE:RegisterNamespace(aa,bO)if type(aa)~="string"then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'name' - string expected, got %q."):format(type(aa)),2)end;if bO and type(bO)~="table"then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'defaults' - table or nil expected, got %q."):format(type(bO)),2)end;if self.children and self.children[aa]then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'name' - a namespace called %q already exists."):format(aa),2)end;local bT=self.sv;if not bT.namespaces then bT.namespaces={}end;if not bT.namespaces[aa]then bT.namespaces[aa]={}end;local cm=ca(bT.namespaces[aa],bO,self.keys.profile,nil,self)if not self.children then self.children={}end;self.children[aa]=cm;return cm end;function bE:GetNamespace(aa,g)if type(aa)~="string"then error(("Usage: AceDBObject:GetNamespace(name): 'name' - string expected, got %q."):format(type(aa)),2)end;if not g and not(self.children and self.children[aa])then error(("Usage: AceDBObject:GetNamespace(name): 'name' - namespace %q does not exist."):format(aa),2)end;if not self.children then self.children={}end;return self.children[aa]end;function bC:New(n,bO,cb)if type(n)=="string"then local aa=n;n=_G[aa]if not n then n={}_G[aa]=n end end;if type(n)~="table"then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'tbl' - table expected, got %q."):format(type(n)),2)end;if bO and type(bO)~="table"then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'defaults' - table expected, got %q."):format(type(bO)),2)end;if cb and type(cb)~="string"and cb~=true then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'defaultProfile' - string or true expected, got %q."):format(type(cb)),2)end;return ca(n,bO,cb)end;for bN in pairs(bC.db_registry)do if not bN.parent then for aa,J in pairs(bE)do bN[aa]=J end else bN.RegisterDefaults=bE.RegisterDefaults;bN.ResetProfile=bE.ResetProfile end end end;local function cn(...)local co,cp="AceDBOptions-3.0",15;local cq=LibStub:NewLibrary(co,cp)if not cq then return end;local pairs,next=pairs,next;local UnitClass=UnitClass;cq.optionTables=cq.optionTables or{}cq.handlers=cq.handlers or{}local cr={choose="Existing Profiles",choose_desc="You can either create a new profile by entering a name in the editbox, or choose one of the already existing profiles.",choose_sub="Select one of your currently available profiles.",copy="Copy From",copy_desc="Copy the settings from one existing profile into the currently active profile.",current="Current Profile:",default="Default",delete="Delete a Profile",delete_confirm="Are you sure you want to delete the selected profile?",delete_desc="Delete existing and unused profiles from the database to save space, and cleanup the SavedVariables file.",delete_sub="Deletes a profile from the database.",intro="You can change the active database profile, so you can have different settings for every character.",new="New",new_sub="Create a new empty profile.",profiles="Profiles",profiles_sub="Manage Profiles",reset="Reset Profile",reset_desc="Reset the current profile back to its default values, in case your configuration is broken, or you simply want to start over.",reset_sub="Reset the current profile to the default"}local cs=GetLocale()if cs=="deDE"then cr["choose"]="Vorhandene Profile"cr["choose_desc"]="Du kannst ein neues Profil erstellen, indem du einen neuen Namen in der Eingabebox 'Neu' eingibst, oder wähle eines der vorhandenen Profile aus."cr["choose_sub"]="Wählt ein bereits vorhandenes Profil aus."cr["copy"]="Kopieren von..."cr["copy_desc"]="Kopiere die Einstellungen von einem vorhandenen Profil in das aktive Profil."cr["current"]="Aktuelles Profil:"cr["default"]="Standard"cr["delete"]="Profil löschen"cr["delete_confirm"]="Willst du das ausgewählte Profil wirklich löschen?"cr["delete_desc"]="Lösche vorhandene oder unbenutzte Profile aus der Datenbank, um Platz zu sparen und die SavedVariables-Datei 'sauber' zu halten."cr["delete_sub"]="Löscht ein Profil aus der Datenbank."cr["intro"]="Hier kannst du das aktive Datenbankprofil ändern, damit du verschiedene Einstellungen für jeden Charakter erstellen kannst, wodurch eine sehr flexible Konfiguration möglich wird."cr["new"]="Neu"cr["new_sub"]="Ein neues Profil erstellen."cr["profiles"]="Profile"cr["profiles_sub"]="Profile verwalten"cr["reset"]="Profil zurücksetzen"cr["reset_desc"]="Setzt das momentane Profil auf Standardwerte zurück, für den Fall, dass mit der Konfiguration etwas schief lief oder weil du einfach neu starten willst."cr["reset_sub"]="Das aktuelle Profil auf Standard zurücksetzen."elseif cs=="frFR"then cr["choose"]="Profils existants"cr["choose_desc"]="Vous pouvez créer un nouveau profil en entrant un nouveau nom dans la boîte de saisie, ou en choississant un des profils déjà existants."cr["choose_sub"]="Permet de choisir un des profils déjà disponibles."cr["copy"]="Copier à partir de"cr["copy_desc"]="Copie les paramètres d'un profil déjà existant dans le profil actuellement actif."cr["current"]="Profil actuel :"cr["default"]="Défaut"cr["delete"]="Supprimer un profil"cr["delete_confirm"]="Etes-vous sûr de vouloir supprimer le profil sélectionné ?"cr["delete_desc"]="Supprime les profils existants inutilisés de la base de données afin de gagner de la place et de nettoyer le fichier SavedVariables."cr["delete_sub"]="Supprime un profil de la base de données."cr["intro"]="Vous pouvez changer le profil actuel afin d'avoir des paramètres différents pour chaque personnage, permettant ainsi d'avoir une configuration très flexible."cr["new"]="Nouveau"cr["new_sub"]="Créée un nouveau profil vierge."cr["profiles"]="Profils"cr["profiles_sub"]="Gestion des profils"cr["reset"]="Réinitialiser le profil"cr["reset_desc"]="Réinitialise le profil actuel au cas où votre configuration est corrompue ou si vous voulez tout simplement faire table rase."cr["reset_sub"]="Réinitialise le profil actuel avec les paramètres par défaut."elseif cs=="koKR"then cr["choose"]="기존 프로필"cr["choose_desc"]="편집 상자에 이름을 입력하여 새로운 프로필을 만들거나 이미 존재하는 프로필 중 하나를 선택할 수 있습니다."cr["choose_sub"]="현재 이용할 수 있는 프로필 중 하나를 선택합니다."cr["copy"]="복사해 올 프로필"cr["copy_desc"]="기존 프로필의 설정을 현재 활성화된 프로필로 복사합니다."cr["current"]="현재 프로필:"cr["default"]="기본값"cr["delete"]="프로필 삭제"cr["delete_confirm"]="선택한 프로필을 삭제하시겠습니까?"cr["delete_desc"]="데이터베이스에서 기존 프로필과 사용하지 않는 프로필을 삭제하여 공간을 절약하고 SavedVariables 파일을 정리합니다."cr["delete_sub"]="데이터베이스에서 프로필을 삭제합니다."cr["intro"]="활성 데이터베이스 프로필을 변경할 수 있으며, 모든 캐릭터마다 서로 다른 설정을 지정할 수 있습니다."cr["new"]="새로운 프로필"cr["new_sub"]="비어 있는 프로필을 새로 만듭니다."cr["profiles"]="프로필"cr["profiles_sub"]="프로필 관리"cr["reset"]="프로필 재설정"cr["reset_desc"]="구성이 손상되었거나 처음부터 다시 시작하고 싶은 경우 현재 프로필을 기본값으로 재설정하세요."cr["reset_sub"]="현재 프로필을 기본값으로 재설정합니다"elseif cs=="esES"or cs=="esMX"then cr["choose"]="Perfiles existentes"cr["choose_desc"]="Puedes crear un nuevo perfil introduciendo un nombre en el recuadro o puedes seleccionar un perfil de los ya existentes."cr["choose_sub"]="Selecciona uno de los perfiles disponibles."cr["copy"]="Copiar de"cr["copy_desc"]="Copia los ajustes de un perfil existente al perfil actual."cr["current"]="Perfil actual:"cr["default"]="Por defecto"cr["delete"]="Borrar un Perfil"cr["delete_confirm"]="¿Estas seguro que quieres borrar el perfil seleccionado?"cr["delete_desc"]="Borra los perfiles existentes y sin uso de la base de datos para ganar espacio y limpiar el archivo SavedVariables."cr["delete_sub"]="Borra un perfil de la base de datos."cr["intro"]="Puedes cambiar el perfil activo de tal manera que cada personaje tenga diferentes configuraciones."cr["new"]="Nuevo"cr["new_sub"]="Crear un nuevo perfil vacio."cr["profiles"]="Perfiles"cr["profiles_sub"]="Manejar Perfiles"cr["reset"]="Reiniciar Perfil"cr["reset_desc"]="Reinicia el perfil actual a los valores por defectos, en caso de que se haya estropeado la configuración o quieras volver a empezar de nuevo."cr["reset_sub"]="Reinicar el perfil actual al de por defecto"elseif cs=="zhTW"then cr["choose"]="現有的設定檔"cr["choose_desc"]="您可以在文字方塊內輸入名字以建立新的設定檔，或是選擇一個現有的設定檔使用。"cr["choose_sub"]="從當前可用的設定檔裡面選擇一個。"cr["copy"]="複製自"cr["copy_desc"]="從一個現有的設定檔，將設定複製到現在使用中的設定檔。"cr["current"]="目前設定檔："cr["default"]="預設"cr["delete"]="刪除一個設定檔"cr["delete_confirm"]="確定要刪除所選擇的設定檔嗎？"cr["delete_desc"]="從資料庫裡刪除不再使用的設定檔，以節省空間，並且清理 SavedVariables 檔案。"cr["delete_sub"]="從資料庫裡刪除一個設定檔。"cr["intro"]="您可以從資料庫中選擇一個設定檔來使用，如此就可以讓每個角色使用不同的設定。"cr["new"]="新建"cr["new_sub"]="新建一個空的設定檔。"cr["profiles"]="設定檔"cr["profiles_sub"]="管理設定檔"cr["reset"]="重置設定檔"cr["reset_desc"]="將現用的設定檔重置為預設值；用於設定檔損壞，或者單純想要重來的情況。"cr["reset_sub"]="將目前的設定檔重置為預設值"elseif cs=="zhCN"then cr["choose"]="现有的配置文件"cr["choose_desc"]="你可以通过在文本框内输入一个名字创立一个新的配置文件，也可以选择一个已经存在的配置文件。"cr["choose_sub"]="从当前可用的配置文件里面选择一个。"cr["copy"]="复制自"cr["copy_desc"]="从当前某个已保存的配置文件复制到当前正使用的配置文件。"cr["current"]="当前配置文件："cr["default"]="默认"cr["delete"]="删除一个配置文件"cr["delete_confirm"]="你确定要删除所选择的配置文件么？"cr["delete_desc"]="从数据库里删除不再使用的配置文件，以节省空间，并且清理SavedVariables文件。"cr["delete_sub"]="从数据库里删除一个配置文件。"cr["intro"]="你可以选择一个活动的数据配置文件，这样你的每个角色就可以拥有不同的设置值，可以给你的插件配置带来极大的灵活性。"cr["new"]="新建"cr["new_sub"]="新建一个空的配置文件。"cr["profiles"]="配置文件"cr["profiles_sub"]="管理配置文件"cr["reset"]="重置配置文件"cr["reset_desc"]="将当前的配置文件恢复到它的默认值，用于你的配置文件损坏，或者你只是想重来的情况。"cr["reset_sub"]="将当前的配置文件恢复为默认值"elseif cs=="ruRU"then cr["choose"]="Существующие профили"cr["choose_desc"]="Вы можете создать новый профиль, введя название в поле ввода, или выбрать один из уже существующих профилей."cr["choose_sub"]="Выбор одного из уже доступных профилей."cr["copy"]="Скопировать из"cr["copy_desc"]="Копирование настроек из выбранного профиля в активный."cr["current"]="Текущий профиль:"cr["default"]="По умолчанию"cr["delete"]="Удалить профиль"cr["delete_confirm"]="Вы уверены, что хотите удалить выбранный профиль?"cr["delete_desc"]="Удаление существующего и неиспользуемого профиля из базы данных для сохранения места, и очистка файла SavedVariables."cr["delete_sub"]="Удаление профиля из базы данных."cr["intro"]="Изменяя активный профиль, Вы можете задать разные настройки для каждого персонажа."cr["new"]="Новый"cr["new_sub"]="Создание нового чистого профиля."cr["profiles"]="Профили"cr["profiles_sub"]="Управление профилями"cr["reset"]="Сбросить профиль"cr["reset_desc"]="Сброс текущего профиля к стандартным настройкам, если Ваша конфигурация испорчена или Вы хотите настроить все заново."cr["reset_sub"]="Сброс текущего профиля на стандартный"elseif cs=="itIT"then cr["choose"]="Profili Esistenti"cr["choose_desc"]="Puoi creare un nuovo profilo digitando il nome della casella di testo, oppure scegliendone uno tra i profili già esistenti."cr["choose_sub"]="Seleziona uno dei profili attualmente disponibili."cr["copy"]="Copia Da"cr["copy_desc"]="Copia le impostazioni da un profilo esistente nel profilo attivo in questo momento."cr["current"]="Profilo Attivo:"cr["default"]="Predefinito"cr["delete"]="Cancella un Profilo"cr["delete_confirm"]="Sei sicuro di voler cancellare il profilo selezionato?"cr["delete_desc"]="Cancella i profili non utilizzati dal database per risparmiare spazio e mantenere puliti i file di configurazione SavedVariables."cr["delete_sub"]="Cancella un profilo dal Database."cr["intro"]="Puoi cambiare il profilo attivo, in modo da usare impostazioni diverse per ogni personaggio."cr["new"]="Nuovo"cr["new_sub"]="Crea un nuovo profilo vuoto."cr["profiles"]="Profili"cr["profiles_sub"]="Gestisci Profili"cr["reset"]="Reimposta Profilo"cr["reset_desc"]="Riporta il tuo profilo attivo alle sue impostazioni predefinite, nel caso in cui la tua configurazione si sia corrotta, o semplicemente tu voglia re-inizializzarla."cr["reset_sub"]="Reimposta il profilo ai suoi valori predefiniti."elseif cs=="ptBR"then cr["choose"]="Perfis Existentes"cr["choose_desc"]="Você pode tanto criar um perfil novo tanto digitando um nome na caixa de texto, quanto escolher um dos perfis já existentes."cr["choose_sub"]="Selecione um de seus perfis atualmente disponíveis."cr["copy"]="Copiar De"cr["copy_desc"]="Copia as definições de um perfil existente no perfil atualmente ativo."cr["current"]="Perfil Autal:"cr["default"]="Padrão"cr["delete"]="Remover um Perfil"cr["delete_confirm"]="Tem certeza que deseja remover o perfil selecionado?"cr["delete_desc"]="Remove perfis existentes e inutilizados do banco de dados para economizar espaço, e limpar o arquivo SavedVariables."cr["delete_sub"]="Remove um perfil do banco de dados."cr["intro"]="Você pode alterar o perfil do banco de dados ativo, para que possa ter definições diferentes para cada personagem."cr["new"]="Novo"cr["new_sub"]="Cria um novo perfil vazio."cr["profiles"]="Perfis"cr["profiles_sub"]="Gerenciar Perfis"cr["reset"]="Resetar Perfil"cr["reset_desc"]="Reseta o perfil atual para os valores padrões, no caso de sua configuração estar quebrada, ou simplesmente se deseja começar novamente."cr["reset_sub"]="Resetar o perfil atual ao padrão"end;local ct;local cu={}local function cv(bN,cw,cx)local cy={}local cz=bN:GetCurrentProfile()for M,ae in pairs(bN:GetProfiles(cu))do if not(cx and ae==cz)then cy[ae]=ae end end;for ad,ae in pairs(ct)do if(cw or cy[ad])and not(cx and ad==cz)then cy[ad]=ae end end;return cy end;local cA={}function cA:Reset()self.db:ResetProfile()end;function cA:SetProfile(cB,by)self.db:SetProfile(by)end;function cA:GetCurrentProfile()return self.db:GetCurrentProfile()end;function cA:ListProfiles(cB)local L=cB.arg;local cy;if L=="common"and not self.noDefaultProfiles then cy=cv(self.db,true,nil)elseif L=="nocurrent"then cy=cv(self.db,nil,true)elseif L=="both"then cy=cv(self.db,not self.noDefaultProfiles and true,true)else cy=cv(self.db)end;return cy end;function cA:HasNoProfiles(cB)local cy=self:ListProfiles(cB)return not next(cy)and true or false end;function cA:CopyProfile(cB,by)self.db:CopyProfile(by)end;function cA:DeleteProfile(cB,by)self.db:DeleteProfile(by)end;local function cC(bN)ct={["Default"]=cr["default"],[bN.keys.char]=bN.keys.char,[bN.keys.realm]=bN.keys.realm,[bN.keys.class]=UnitClass("player")}end;local function cD(bN,cE)if not ct then cC(bN)end;local bl=cq.handlers[bN]or{db=bN,noDefaultProfiles=cE}for ad,ae in pairs(cA)do bl[ad]=ae end;cq.handlers[bN]=bl;return bl end;local cF={desc={order=1,type="description",name=cr["intro"].."\n"},descreset={order=9,type="description",name=cr["reset_desc"]},reset={order=10,type="execute",name=cr["reset"],desc=cr["reset_sub"],func="Reset"},current={order=11,type="description",name=function(cB)return cr["current"].." "..NORMAL_FONT_COLOR_CODE..cB.handler:GetCurrentProfile()..FONT_COLOR_CODE_CLOSE end,width="default"},choosedesc={order=20,type="description",name="\n"..cr["choose_desc"]},new={name=cr["new"],desc=cr["new_sub"],type="input",order=30,get=false,set="SetProfile"},choose={name=cr["choose"],desc=cr["choose_sub"],type="select",order=40,get="GetCurrentProfile",set="SetProfile",values="ListProfiles",arg="common"},copydesc={order=50,type="description",name="\n"..cr["copy_desc"]},copyfrom={order=60,type="select",name=cr["copy"],desc=cr["copy_desc"],get=false,set="CopyProfile",values="ListProfiles",disabled="HasNoProfiles",arg="nocurrent"},deldesc={order=70,type="description",name="\n"..cr["delete_desc"]},delete={order=80,type="select",name=cr["delete"],desc=cr["delete_sub"],get=false,set="DeleteProfile",values="ListProfiles",disabled="HasNoProfiles",arg="nocurrent",confirm=true,confirmText=cr["delete_confirm"]}}function cq:GetOptionsTable(bN,cE)local n=cq.optionTables[bN]or{type="group",name=cr["profiles"],desc=cr["profiles_sub"]}n.handler=cD(bN,cE)n.args=cF;cq.optionTables[bN]=n;return n end;for bN,n in pairs(cq.optionTables)do n.handler=cD(bN)n.args=cF end end;local function cG(...)local i,k="AceLocale-3.0",6;local cH,f=LibStub:NewLibrary(i,k)if not cH then return end;local assert,tostring,error=assert,tostring,error;local getmetatable,setmetatable,rawset,rawget=getmetatable,setmetatable,rawset,rawget;local cI=GetLocale()if cI=="enGB"then cI="enUS"end;cH.apps=cH.apps or{}cH.appnames=cH.appnames or{}local cJ={__index=function(self,o)rawset(self,o,o)geterrorhandler()(i..": "..tostring(cH.appnames[self])..": Missing entry for '"..tostring(o).."'")return o end}local cK={__index=function(self,o)rawset(self,o,o)return o end}local cL;local cM=function()assert(false)end;local cN=setmetatable({},{__newindex=function(self,o,by)rawset(cL,o,by==true and o or by)end,__index=cM})local cO=setmetatable({},{__newindex=function(self,o,by)if not rawget(cL,o)then rawset(cL,o,by==true and o or by)end end,__index=cM})function cH:NewLocale(cP,cQ,cR,g)local cS=GAME_LOCALE or cI;local cT=cH.apps[cP]if g and cT and getmetatable(cT)~=cK then geterrorhandler()("Usage: NewLocale(application, locale[, isDefault[, silent]]): 'silent' must be specified for the first locale registered")end;if not cT then if g=="raw"then cT={}else cT=setmetatable({},g and cK or cJ)end;cH.apps[cP]=cT;cH.appnames[cT]=cP end;if cQ~=cS and not cR then return end;cL=cT;if cR then return cO end;return cN end;function cH:GetLocale(cP,g)if not g and not cH.apps[cP]then error("Usage: GetLocale(application[, silent]): 'application' - No locales registered for '"..tostring(cP).."'",2)end;return cH.apps[cP]end end;local function cU(...)local i,k="AceConsole-3.0",7;local cV,f=LibStub:NewLibrary(i,k)if not cV then return end;cV.embeds=cV.embeds or{}cV.commands=cV.commands or{}cV.weakcommands=cV.weakcommands or{}local P,tostring,select=table.concat,tostring,select;local type,pairs,error=type,pairs,error;local bg,cW,cX=string.format,string.find,string.sub;local cY=math.max;local _G=_G;local cZ={}local function c_(self,bx,...)local d0=0;if self~=cV then d0=d0+1;cZ[d0]="|cff33ff99"..tostring(self).."|r:"end;for M=1,select("#",...)do d0=d0+1;cZ[d0]=tostring(select(M,...))end;bx:AddMessage(P(cZ," ",1,d0))end;function cV:Print(...)local bx=...if type(bx)=="table"and bx.AddMessage then return c_(self,bx,select(2,...))else return c_(self,DEFAULT_CHAT_FRAME,...)end end;function cV:Printf(...)local bx=...if type(bx)=="table"and bx.AddMessage then return c_(self,bx,bg(select(2,...)))else return c_(self,DEFAULT_CHAT_FRAME,bg(...))end end;function cV:RegisterChatCommand(d1,J,d2)if type(d1)~="string"then error([[Usage: AceConsole:RegisterChatCommand( "command", func[, persist ]): 'command' - expected a string]],2)end;if d2==nil then d2=true end;local aa="ACECONSOLE_"..d1:upper()if type(J)=="string"then SlashCmdList[aa]=function(d3,d4)self[J](self,d3,d4)end else SlashCmdList[aa]=J end;_G["SLASH_"..aa.."1"]="/"..d1:lower()cV.commands[d1]=aa;if not d2 then if not cV.weakcommands[self]then cV.weakcommands[self]={}end;cV.weakcommands[self][d1]=J end;return true end;function cV:UnregisterChatCommand(d1)local aa=cV.commands[d1]if aa then SlashCmdList[aa]=nil;_G["SLASH_"..aa.."1"]=nil;hash_SlashCmdList["/"..d1:upper()]=nil;cV.commands[d1]=nil end end;function cV:IterateChatCommands()return pairs(cV.commands)end;local function d5(d0,...)if d0>1 then return nil,d5(d0-1,...)elseif d0==1 then return nil,...else return...end end;function cV:GetArgs(d6,d7,d8)d7=d7 or 1;d8=cY(d8 or 1,1)local d9=d8;d9=cW(d6,"[^ ]",d9)if not d9 then return d5(d7,1e9)end;if d7<1 then return d9 end;local da;local db=cX(d6,d9,d9)if db=='"'then d9=d9+1;da='([|"])'elseif db=="'"then d9=d9+1;da="([|'])"else da="([| ])"end;d8=d9;while true do local aV;d9,aV,db=cW(d6,da,d9)if not d9 then break end;if db=="|"then if cX(d6,d9,d9+1)=="|H"then d9=cW(d6,"|h",d9+2)if not d9 then break end;d9=cW(d6,"|h",d9+2)if not d9 then break end elseif cX(d6,d9,d9+1)=="|T"then d9=cW(d6,"|t",d9+2)if not d9 then break end end;d9=d9+2 else return cX(d6,d8,d9-1),cV:GetArgs(d6,d7-1,d9+1)end end;return cX(d6,d8),d5(d7-1,1e9)end;local aq={"Print","Printf","RegisterChatCommand","UnregisterChatCommand","GetArgs"}function cV:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;function cV:OnEmbedEnable(u)if cV.weakcommands[u]then for d1,J in pairs(cV.weakcommands[u])do u:RegisterChatCommand(d1,J,false,true)end end end;function cV:OnEmbedDisable(u)if cV.weakcommands[u]then for d1,J in pairs(cV.weakcommands[u])do u:UnregisterChatCommand(d1)end end end;for a8 in pairs(cV.embeds)do cV:Embed(a8)end end;local function dc(...)local dd,de="AceGUI-3.0",41;local df,f=LibStub:NewLibrary(dd,de)if not df then return end;local tinsert,dg=table.insert,table.wipe;local select,pairs,next,type=select,pairs,next,type;local error,assert=error,assert;local setmetatable,rawget=setmetatable,rawget;local dh,di,dj=math.max,math.min,math.ceil;local UIParent=UIParent;df.WidgetRegistry=df.WidgetRegistry or{}df.LayoutRegistry=df.LayoutRegistry or{}df.WidgetBase=df.WidgetBase or{}df.WidgetContainerBase=df.WidgetContainerBase or{}df.WidgetVersions=df.WidgetVersions or{}df.tooltip=df.tooltip or CreateFrame("GameTooltip","AceGUITooltip",UIParent,"GameTooltipTemplate")local dk=df.WidgetRegistry;local dl=df.LayoutRegistry;local dm=df.WidgetVersions;local xpcall=xpcall;local function S(T)return geterrorhandler()(T)end;local function U(J,...)if J then return xpcall(J,S,...)end end;local dn,dp;do if f and f<29 and df.objPools then df.objPools=nil end;df.objPools=df.objPools or{}local dq=df.objPools;function dn(dr)if not dk[dr]then error("Attempt to instantiate unknown widget type",2)end;if not dq[dr]then dq[dr]={}end;local ds=next(dq[dr])if not ds then ds=dk[dr]()ds.AceGUIWidgetVersion=dm[dr]else dq[dr][ds]=nil;if not ds.AceGUIWidgetVersion or ds.AceGUIWidgetVersion<dm[dr]then return dn(dr)end end;return ds end;function dp(bq,dr)if not dq[dr]then dq[dr]={}end;if dq[dr][bq]then error("Attempt to Release Widget that is already released",2)end;dq[dr][bq]=true end end;function df:Create(dr)if dk[dr]then local dt=dn(dr)if rawget(dt,"Acquire")then dt.OnAcquire=dt.Acquire;dt.Acquire=nil elseif rawget(dt,"Aquire")then dt.OnAcquire=dt.Aquire;dt.Aquire=nil end;if rawget(dt,"Release")then dt.OnRelease=rawget(dt,"Release")dt.Release=nil end;if dt.OnAcquire then dt:OnAcquire()else error(("Widget type %s doesn't supply an OnAcquire Function"):format(dr))end;U(dt.SetLayout,dt,"List")U(dt.ResumeLayout,dt)return dt end end;function df:Release(dt)if dt.isQueuedForRelease then return end;dt.isQueuedForRelease=true;U(dt.PauseLayout,dt)dt.frame:Hide()dt:Fire("OnRelease")U(dt.ReleaseChildren,dt)if dt.OnRelease then dt:OnRelease()end;for ad in pairs(dt.userdata)do dt.userdata[ad]=nil end;for ad in pairs(dt.events)do dt.events[ad]=nil end;dt.width=nil;dt.relWidth=nil;dt.height=nil;dt.relHeight=nil;dt.noAutoHeight=nil;dt.frame:ClearAllPoints()dt.frame:Hide()dt.frame:SetParent(UIParent)dt.frame.width=nil;dt.frame.height=nil;if dt.content then dt.content.width=nil;dt.content.height=nil end;dt.isQueuedForRelease=nil;dp(dt,dt.type)end;function df:IsReleasing(dt)if dt.isQueuedForRelease then return true end;if dt.parent and dt.parent.AceGUIWidgetVersion then return df:IsReleasing(dt.parent)end;return false end;function df:SetFocus(dt)if self.FocusedWidget and self.FocusedWidget~=dt then U(self.FocusedWidget.ClearFocus,self.FocusedWidget)end;self.FocusedWidget=dt end;function df:ClearFocus()if self.FocusedWidget then U(self.FocusedWidget.ClearFocus,self.FocusedWidget)self.FocusedWidget=nil end end;do local du=df.WidgetBase;du.SetParent=function(self,cd)local bx=self.frame;bx:SetParent(nil)bx:SetParent(cd.content)self.parent=cd end;du.SetCallback=function(self,aa,J)if type(J)=="function"then self.events[aa]=J end end;du.Fire=function(self,aa,...)if self.events[aa]then local dv,dw=U(self.events[aa],self,aa,...)if dv then return dw end end end;du.SetWidth=function(self,dx)self.frame:SetWidth(dx)self.frame.width=dx;if self.OnWidthSet then self:OnWidthSet(dx)end end;du.SetRelativeWidth=function(self,dx)if dx<=0 or dx>1 then error(":SetRelativeWidth(width): Invalid relative width.",2)end;self.relWidth=dx;self.width="relative"end;du.SetHeight=function(self,dy)self.frame:SetHeight(dy)self.frame.height=dy;if self.OnHeightSet then self:OnHeightSet(dy)end end;du.IsVisible=function(self)return self.frame:IsVisible()end;du.IsShown=function(self)return self.frame:IsShown()end;du.Release=function(self)df:Release(self)end;du.IsReleasing=function(self)return df:IsReleasing(self)end;du.SetPoint=function(self,...)return self.frame:SetPoint(...)end;du.ClearAllPoints=function(self)return self.frame:ClearAllPoints()end;du.GetNumPoints=function(self)return self.frame:GetNumPoints()end;du.GetPoint=function(self,...)return self.frame:GetPoint(...)end;du.GetUserDataTable=function(self)return self.userdata end;du.SetUserData=function(self,o,by)self.userdata[o]=by end;du.GetUserData=function(self,o)return self.userdata[o]end;du.IsFullHeight=function(self)return self.height=="fill"end;du.SetFullHeight=function(self,dz)if dz then self.height="fill"else self.height=nil end end;du.IsFullWidth=function(self)return self.width=="fill"end;du.SetFullWidth=function(self,dz)if dz then self.width="fill"else self.width=nil end end;local dA=df.WidgetContainerBase;dA.PauseLayout=function(self)self.LayoutPaused=true end;dA.ResumeLayout=function(self)self.LayoutPaused=nil end;dA.PerformLayout=function(self)if self.LayoutPaused then return end;U(self.LayoutFunc,self.content,self.children)end;dA.DoLayout=function(self)self:PerformLayout()end;dA.AddChild=function(self,dB,dC)if dC then local dD=1;for aV,dt in pairs(self.children)do if dt==dC then break end;dD=dD+1 end;tinsert(self.children,dD,dB)else tinsert(self.children,dB)end;dB:SetParent(self)dB.frame:Show()self:DoLayout()end;dA.AddChildren=function(self,...)for M=1,select("#",...)do local dB=select(M,...)tinsert(self.children,dB)dB:SetParent(self)dB.frame:Show()end;self:DoLayout()end;dA.ReleaseChildren=function(self)local dE=self.children;for M=1,#dE do df:Release(dE[M])dE[M]=nil end end;dA.SetLayout=function(self,dF)self.LayoutFunc=df:GetLayout(dF)end;dA.SetAutoAdjustHeight=function(self,dG)if dG then self.noAutoHeight=nil else self.noAutoHeight=true end end;local function dH(ay)local self=ay.obj;if ay:GetWidth()and ay:GetHeight()then if self.OnWidthSet then self:OnWidthSet(ay:GetWidth())end;if self.OnHeightSet then self:OnHeightSet(ay:GetHeight())end end end;local function dI(ay)if ay:GetWidth()and ay:GetHeight()then ay.width=ay:GetWidth()ay.height=ay:GetHeight()ay.obj:DoLayout()end end;setmetatable(dA,{__index=du})function df:RegisterAsContainer(dt)dt.children={}dt.userdata={}dt.events={}dt.base=dA;dt.content.obj=dt;dt.frame.obj=dt;dt.content:SetScript("OnSizeChanged",dI)dt.frame:SetScript("OnSizeChanged",dH)setmetatable(dt,{__index=dA})dt:SetLayout("List")return dt end;function df:RegisterAsWidget(dt)dt.userdata={}dt.events={}dt.base=du;dt.frame.obj=dt;dt.frame:SetScript("OnSizeChanged",dH)setmetatable(dt,{__index=du})return dt end end;function df:RegisterWidgetType(dJ,dK,dL)assert(type(dK)=="function")assert(type(dL)=="number")local dM=dm[dJ]if dM and dM>=dL then return end;dm[dJ]=dL;dk[dJ]=dK end;function df:RegisterLayout(dJ,dN)assert(type(dN)=="function")if type(dJ)=="string"then dJ=dJ:upper()end;dl[dJ]=dN end;function df:GetLayout(dJ)if type(dJ)=="string"then dJ=dJ:upper()end;return dl[dJ]end;df.counts=df.counts or{}function df:GetNextWidgetNum(dr)if not self.counts[dr]then self.counts[dr]=0 end;self.counts[dr]=self.counts[dr]+1;return self.counts[dr]end;function df:GetWidgetCount(dr)return self.counts[dr]or 0 end;function df:GetWidgetVersion(dr)return dm[dr]end;df:RegisterLayout("List",function(dO,dE)local dy=0;local dx=dO.width or dO:GetWidth()or 0;for M=1,#dE do local dB=dE[M]local bx=dB.frame;bx:ClearAllPoints()bx:Show()if M==1 then bx:SetPoint("TOPLEFT",dO)else bx:SetPoint("TOPLEFT",dE[M-1].frame,"BOTTOMLEFT")end;if dB.width=="fill"then dB:SetWidth(dx)bx:SetPoint("RIGHT",dO)if dB.DoLayout then dB:DoLayout()end elseif dB.width=="relative"then dB:SetWidth(dx*dB.relWidth)if dB.DoLayout then dB:DoLayout()end end;dy=dy+(bx.height or bx:GetHeight()or 0)end;U(dO.obj.LayoutFinished,dO.obj,nil,dy)end)df:RegisterLayout("Fill",function(dO,dE)if dE[1]then dE[1]:SetWidth(dO:GetWidth()or 0)dE[1]:SetHeight(dO:GetHeight()or 0)dE[1].frame:ClearAllPoints()dE[1].frame:SetAllPoints(dO)dE[1].frame:Show()U(dO.obj.LayoutFinished,dO.obj,nil,dE[1].frame:GetHeight())end end)local dP=nil;local function dQ(I,J,...)dP=true;I[J](I,...)dP=nil end;df:RegisterLayout("Flow",function(dO,dE)if dP then return end;local dy=0;local dR=0;local dS=0;local dT=0;local dx=dO.width or dO:GetWidth()or 0;local dU;local dV;local dW;local dX;local dY;local dZ;for M=1,#dE do local dB=dE[M]dZ=nil;local bx=dB.frame;local d_=bx.height or bx:GetHeight()or 0;local e0=bx.width or bx:GetWidth()or 0;dY=dX;dX=dB.alignoffset or d_/2;if dB.width=="relative"then e0=dx*dB.relWidth end;bx:Show()bx:ClearAllPoints()if M==1 then bx:SetPoint("TOPLEFT",dO)dS=d_;dT=dX;dU=bx;dV=dX;dR=e0;if dR>dx then dZ=true end else if dR==0 or e0+dR>dx or dB.width=="fill"then if dW then break end;dU:SetPoint("TOPLEFT",dO,"TOPLEFT",0,-(dy+dT-dV+3))dy=dy+dS+3;dU=bx;dV=dX;dS=d_;dT=dX;dR=e0;if dR>dx then dZ=true end else dT=dh(dT,dX)dS=dh(dS,dT+d_/2)bx:SetPoint("TOPLEFT",dE[M-1].frame,"TOPRIGHT",0,dX-dY)dR=e0+dR end end;if dB.width=="fill"then dQ(dB,"SetWidth",dx)bx:SetPoint("RIGHT",dO)dR=0;dU=bx;if dB.DoLayout then dB:DoLayout()end;dS=bx.height or bx:GetHeight()or 0;dT=dB.alignoffset or dS/2;dV=dT elseif dB.width=="relative"then dQ(dB,"SetWidth",dx*dB.relWidth)if dB.DoLayout then dB:DoLayout()end elseif dZ then if dx>1 then bx:SetPoint("RIGHT",dO)end end;if dB.height=="fill"then bx:SetPoint("BOTTOM",dO)dW=true end end;if dW then dU:SetPoint("TOPLEFT",dO,"TOPLEFT",0,-dy)elseif dU then dU:SetPoint("TOPLEFT",dO,"TOPLEFT",0,-(dy+dT-dV+3))end;dy=dy+dS+3;U(dO.obj.LayoutFinished,dO.obj,nil,dy)end)local e1=function(e2,e3,e4,e5,e6,dB)local e7=e5 and(e5["align"..e2]or e5.align)or e4 and(e4["align"..e2]or e4.align)or e3["align"..e2]or e3.align or"CENTERLEFT"local e8;dB,e6=dB or 0,e6 or 0;if type(e7)=="string"then e7=e7:lower()e7=e2=="V"and(e7:sub(1,3)=="top"and"start"or e7:sub(1,6)=="bottom"and"end"or e7:sub(1,6)=="center"and"middle")or e2=="H"and(e7:sub(-4)=="left"and"start"or e7:sub(-5)=="right"and"end"or e7:sub(-6)=="center"and"middle")or e7;e8=(e7=="start"or e7=="fill")and 0 or e7=="end"and e6-dB or(e6-dB)/2 elseif type(e7)=="function"then e8=e7(dB or 0,e6,e2)else e8=e7 end;return e7,dh(0,di(e8,e6))end;local e9=function(e2,ea,eb,ec,ed)local ee=0;for e6=eb,ec do ee=ee+(ea[e6]or 0)end;return ee+dh(0,ec-eb)*(ed or 0)end;df:RegisterLayout("Table",function(dO,dE)local bq=dO.obj;bq:PauseLayout()local e3=bq:GetUserData("table")local ef=e3.columns;local eg=e3.spaceH or e3.space or 0;local eh=e3.spaceV or e3.space or 0;local ei=(dO:GetWidth()or dO.width or 0)-eg*(#ef-1)local ej=bq:GetUserData("layoutCache")if not ej then ej={{},{},{},{},{},{}}bq:SetUserData("layoutCache",ej)end;local aU,ek,el,em,en,eo=unpack(ej)local d0,ep=0;for M,dB in ipairs(dE)do if dB:IsShown()then repeat d0=d0+1;local col=(d0-1)%#ef+1;local eq=dj(d0/#ef)local er=em[col]local e6=er and er.child or dB;local e5=e6:GetUserData("cell")ep=not er;if not er and e5 and e5.rowspan then er={child=dB,from=eq,to=eq+e5.rowspan-1}em[col]=er end;if er and M==#dE then er.to=eq end;local es=dh(0,di((e5 and e5.colspan or 1)-1,#ef-col))d0=d0+es;if not er or er.to==eq then aU[d0]=e6;en[e6]=er and er.from or eq;eo[e6]=col;if er then em[col]=nil end end until ep end end;local et=dj(d0/#ef)local eu,ev=ei,0;for col,e4 in ipairs(ef)do ek[col]=0;if type(e4)=="number"then e4={[e4>=1 and e4<10 and"weight"or"width"]=e4}ef[col]=e4 end;if e4.weight then ev=ev+(e4.weight or 1)else if not e4.width or e4.width<=0 then for eq=1,et do local dB=aU[(eq-1)*#ef+col]if dB then local ew=dB.frame;ew:ClearAllPoints()local ex=ew:GetWidth()or 0;ek[col]=dh(ek[col],ex-e9("H",ek,eo[dB],col-1,eg))end end;ek[col]=dh(e4.min or e4[1]or 0,di(ek[col],e4.max or e4[2]or ek[col]))else ek[col]=e4.width<1 and e4.width*ei or e4.width end;eu=dh(0,eu-ek[col])end end;local ey=ev>0 and eu/ev or 0;for col,e4 in pairs(ef)do if e4.weight then ek[col]=ey*e4.weight end end;for eq=1,et do local ez=0;for col=1,#ef do local dB=aU[(eq-1)*#ef+col]if dB then local e4=ef[eo[dB]]local e5=dB:GetUserData("cell")local eA=e9("H",ek,1,eo[dB]-1,eg)+(eo[dB]==1 and 0 or eg)local eB=e9("H",ek,eo[dB],col,eg)local ew=dB.frame;ew:ClearAllPoints()local ex=ew:GetWidth()or 0;local eC,eD=e1("H",e3,e4,e5,eB,ex)ew:SetPoint("LEFT",dO,eA+eD,0)if dB:IsFullWidth()or eC=="fill"or ex>eB then ew:SetPoint("RIGHT",dO,"LEFT",eA+eD+eB,0)end;if dB.DoLayout then dB:DoLayout()end;ez=dh(ez,(ew:GetHeight()or 0)-e9("V",el,en[dB],eq-1,eh))end end;el[eq]=ez;for col=1,#ef do local dB=aU[(eq-1)*#ef+col]if dB then local e4=ef[eo[dB]]local e5=dB:GetUserData("cell")local eE=e9("V",el,1,en[dB]-1,eh)+(en[dB]==1 and 0 or eh)local eF=e9("V",el,en[dB],eq,eh)local ew=dB.frame;local eG=ew:GetHeight()or 0;local eC,eD=e1("V",e3,e4,e5,eF,eG)if dB:IsFullHeight()or eC=="fill"then ew:SetHeight(eF)end;ew:SetPoint("TOP",dO,0,-(eE+eD))end end end;local eH=e9("V",el,1,#el,eh)for aV,ae in pairs(ej)do dg(ae)end;U(bq.LayoutFinished,bq,nil,eH)bq:ResumeLayout()end)end;local function eI(...)local eJ,dL="BlizOptionsGroup",26;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs=pairs;local CreateFrame=CreateFrame;local function eK(bx)bx.obj:Fire("OnShow")end;local function eL(bx)bx.obj:Fire("OnHide")end;local function eM(bx)bx.obj:Fire("okay")end;local function eN(bx)bx.obj:Fire("cancel")end;local function eO(bx)bx.obj:Fire("default")end;local function eP(bx)bx.obj:Fire("refresh")end;local eQ={["OnAcquire"]=function(self)self:SetName()self:SetTitle()end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eR=dx-63;if eR<0 then eR=0 end;dO:SetWidth(eR)dO.width=eR end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eS=dy-26;if eS<0 then eS=0 end;dO:SetHeight(eS)dO.height=eS end,["SetName"]=function(self,aa,cd)self.frame.name=aa;self.frame.parent=cd end,["SetTitle"]=function(self,eT)local dO=self.content;dO:ClearAllPoints()if not eT or eT==""then dO:SetPoint("TOPLEFT",10,-10)self.label:SetText("")else dO:SetPoint("TOPLEFT",10,-40)self.label:SetText(eT)end;dO:SetPoint("BOTTOMRIGHT",-10,10)end}local function dK()local bx=CreateFrame("Frame",nil,InterfaceOptionsFramePanelContainer)bx:Hide()bx.okay=eM;bx.cancel=eN;bx.default=eO;bx.refresh=eP;bx.OnCommit=eM;bx.OnDefault=eO;bx.OnRefresh=eP;bx:SetScript("OnHide",eL)bx:SetScript("OnShow",eK)local eU=bx:CreateFontString(nil,"OVERLAY","GameFontNormalLarge")eU:SetPoint("TOPLEFT",10,-15)eU:SetPoint("BOTTOMRIGHT",bx,"TOPRIGHT",10,-45)eU:SetJustifyH("LEFT")eU:SetJustifyV("TOP")local dO=CreateFrame("Frame",nil,bx)dO:SetPoint("TOPLEFT",10,-10)dO:SetPoint("BOTTOMRIGHT",-10,10)local dt={label=eU,frame=bx,content=dO,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function eV(...)local eJ,dL="DropdownGroup",22;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local assert,pairs,type=assert,pairs,type;local CreateFrame=CreateFrame;local function eW(self,F,by)local eX=self.parentgroup;local eY=eX.status or eX.localstatus;eY.selected=by;self.parentgroup:Fire("OnGroupSelected",by)end;local eQ={["OnAcquire"]=function(self)self.dropdown:SetText("")self:SetDropdownWidth(200)self:SetTitle("")end,["OnRelease"]=function(self)self.dropdown.list=nil;self.status=nil;for ad in pairs(self.localstatus)do self.localstatus[ad]=nil end end,["SetTitle"]=function(self,eT)self.titletext:SetText(eT)self.dropdown.frame:ClearAllPoints()if eT and eT~=""then self.dropdown.frame:SetPoint("TOPRIGHT",-2,0)else self.dropdown.frame:SetPoint("TOPLEFT",-1,0)end end,["SetGroupList"]=function(self,eZ,e_)self.dropdown:SetList(eZ,e_)end,["SetStatusTable"]=function(self,eY)assert(type(eY)=="table")self.status=eY end,["SetGroup"]=function(self,eX)self.dropdown:SetValue(eX)local eY=self.status or self.localstatus;eY.selected=eX;self:Fire("OnGroupSelected",eX)end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eR=dx-26;if eR<0 then eR=0 end;dO:SetWidth(eR)dO.width=eR end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eS=dy-63;if eS<0 then eS=0 end;dO:SetHeight(eS)dO.height=eS end,["LayoutFinished"]=function(self,dx,dy)self:SetHeight((dy or 0)+63)end,["SetDropdownWidth"]=function(self,dx)self.dropdown:SetWidth(dx)end}local f0={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dK()local bx=CreateFrame("Frame")bx:SetHeight(100)bx:SetWidth(100)bx:SetFrameStrata("FULLSCREEN_DIALOG")local f1=bx:CreateFontString(nil,"OVERLAY","GameFontNormal")f1:SetPoint("TOPLEFT",4,-5)f1:SetPoint("TOPRIGHT",-4,-5)f1:SetJustifyH("LEFT")f1:SetHeight(18)local f2=df:Create("Dropdown")f2.frame:SetParent(bx)f2.frame:SetFrameLevel(f2.frame:GetFrameLevel()+2)f2:SetCallback("OnValueChanged",eW)f2.frame:SetPoint("TOPLEFT",-1,0)f2.frame:Show()f2:SetLabel("")local f3=CreateFrame("Frame",nil,bx,"BackdropTemplate")f3:SetPoint("TOPLEFT",0,-26)f3:SetPoint("BOTTOMRIGHT",0,3)f3:SetBackdrop(f0)f3:SetBackdropColor(0.1,0.1,0.1,0.5)f3:SetBackdropBorderColor(0.4,0.4,0.4)local dO=CreateFrame("Frame",nil,f3)dO:SetPoint("TOPLEFT",10,-10)dO:SetPoint("BOTTOMRIGHT",-10,10)local dt={frame=bx,localstatus={},titletext=f1,dropdown=f2,border=f3,content=dO,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;f2.parentgroup=dt;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function f4(...)local eJ,dL="Frame",30;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs,assert,type=pairs,assert,type;local dg=table.wipe;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function f5(bx)PlaySound(799)bx.obj:Hide()end;local function f6(bx)bx.obj:Fire("OnShow")end;local function f7(bx)bx.obj:Fire("OnClose")end;local function f8(bx)df:ClearFocus()end;local function f9(bx)bx:GetParent():StartMoving()df:ClearFocus()end;local function fa(fb)local bx=fb:GetParent()bx:StopMovingOrSizing()local self=bx.obj;local eY=self.status or self.localstatus;eY.width=bx:GetWidth()eY.height=bx:GetHeight()eY.top=bx:GetTop()eY.left=bx:GetLeft()end;local function fc(bx)bx:GetParent():StartSizing("BOTTOMRIGHT")df:ClearFocus()end;local function fd(bx)bx:GetParent():StartSizing("BOTTOM")df:ClearFocus()end;local function fe(bx)bx:GetParent():StartSizing("RIGHT")df:ClearFocus()end;local function ff(bx)bx.obj:Fire("OnEnterStatusBar")end;local function fg(bx)bx.obj:Fire("OnLeaveStatusBar")end;local eQ={["OnAcquire"]=function(self)self.frame:SetParent(UIParent)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")self.frame:SetFrameLevel(100)self:SetTitle()self:SetStatusText()self:ApplyStatus()self:Show()self:EnableResize(true)end,["OnRelease"]=function(self)self.status=nil;dg(self.localstatus)end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eR=dx-34;if eR<0 then eR=0 end;dO:SetWidth(eR)dO.width=eR end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eS=dy-57;if eS<0 then eS=0 end;dO:SetHeight(eS)dO.height=eS end,["SetTitle"]=function(self,eT)self.titletext:SetText(eT)self.titlebg:SetWidth((self.titletext:GetWidth()or 0)+10)end,["SetStatusText"]=function(self,fh)self.statustext:SetText(fh)end,["Hide"]=function(self)self.frame:Hide()end,["Show"]=function(self)self.frame:Show()end,["EnableResize"]=function(self,am)local J=am and"Show"or"Hide"self.sizer_se[J](self.sizer_se)self.sizer_s[J](self.sizer_s)self.sizer_e[J](self.sizer_e)end,["SetStatusTable"]=function(self,eY)assert(type(eY)=="table")self.status=eY;self:ApplyStatus()end,["ApplyStatus"]=function(self)local eY=self.status or self.localstatus;local bx=self.frame;self:SetWidth(eY.width or 700)self:SetHeight(eY.height or 500)bx:ClearAllPoints()if eY.top and eY.left then bx:SetPoint("TOP",UIParent,"BOTTOM",0,eY.top)bx:SetPoint("LEFT",UIParent,"LEFT",eY.left,0)else bx:SetPoint("CENTER")end end}local fi={bgFile="Interface\\DialogFrame\\UI-DialogBox-Background",edgeFile="Interface\\DialogFrame\\UI-DialogBox-Border",tile=true,tileSize=32,edgeSize=32,insets={left=8,right=8,top=8,bottom=8}}local f0={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dK()local bx=CreateFrame("Frame",nil,UIParent,"BackdropTemplate")bx:Hide()bx:EnableMouse(true)bx:SetMovable(true)bx:SetResizable(true)bx:SetFrameStrata("FULLSCREEN_DIALOG")bx:SetFrameLevel(100)bx:SetBackdrop(fi)bx:SetBackdropColor(0,0,0,1)if bx.SetResizeBounds then bx:SetResizeBounds(400,200)else bx:SetMinResize(400,200)end;bx:SetToplevel(true)bx:SetScript("OnShow",f6)bx:SetScript("OnHide",f7)bx:SetScript("OnMouseDown",f8)local fj=CreateFrame("Button",nil,bx,"UIPanelButtonTemplate")fj:SetScript("OnClick",f5)fj:SetPoint("BOTTOMRIGHT",-27,17)fj:SetHeight(20)fj:SetWidth(100)fj:SetText(CLOSE)local fk=CreateFrame("Button",nil,bx,"BackdropTemplate")fk:SetPoint("BOTTOMLEFT",15,15)fk:SetPoint("BOTTOMRIGHT",-132,15)fk:SetHeight(24)fk:SetBackdrop(f0)fk:SetBackdropColor(0.1,0.1,0.1)fk:SetBackdropBorderColor(0.4,0.4,0.4)fk:SetScript("OnEnter",ff)fk:SetScript("OnLeave",fg)local fl=fk:CreateFontString(nil,"OVERLAY","GameFontNormal")fl:SetPoint("TOPLEFT",7,-2)fl:SetPoint("BOTTOMRIGHT",-7,2)fl:SetHeight(20)fl:SetJustifyH("LEFT")fl:SetText("")local fm=bx:CreateTexture(nil,"OVERLAY")fm:SetTexture(131080)fm:SetTexCoord(0.31,0.67,0,0.63)fm:SetPoint("TOP",0,12)fm:SetWidth(100)fm:SetHeight(40)local eT=CreateFrame("Frame",nil,bx)eT:EnableMouse(true)eT:SetScript("OnMouseDown",f9)eT:SetScript("OnMouseUp",fa)eT:SetAllPoints(fm)local f1=eT:CreateFontString(nil,"OVERLAY","GameFontNormal")f1:SetPoint("TOP",fm,"TOP",0,-14)local fn=bx:CreateTexture(nil,"OVERLAY")fn:SetTexture(131080)fn:SetTexCoord(0.21,0.31,0,0.63)fn:SetPoint("RIGHT",fm,"LEFT")fn:SetWidth(30)fn:SetHeight(40)local fo=bx:CreateTexture(nil,"OVERLAY")fo:SetTexture(131080)fo:SetTexCoord(0.67,0.77,0,0.63)fo:SetPoint("LEFT",fm,"RIGHT")fo:SetWidth(30)fo:SetHeight(40)local fp=CreateFrame("Frame",nil,bx)fp:SetPoint("BOTTOMRIGHT")fp:SetWidth(25)fp:SetHeight(25)fp:EnableMouse()fp:SetScript("OnMouseDown",fc)fp:SetScript("OnMouseUp",fa)local fq=fp:CreateTexture(nil,"BACKGROUND")fq:SetWidth(14)fq:SetHeight(14)fq:SetPoint("BOTTOMRIGHT",-8,8)fq:SetTexture(137057)local x=0.1*14/17;fq:SetTexCoord(0.05-x,0.5,0.05,0.5+x,0.05,0.5-x,0.5+x,0.5)local fr=fp:CreateTexture(nil,"BACKGROUND")fr:SetWidth(8)fr:SetHeight(8)fr:SetPoint("BOTTOMRIGHT",-8,8)fr:SetTexture(137057)x=0.1*8/17;fr:SetTexCoord(0.05-x,0.5,0.05,0.5+x,0.05,0.5-x,0.5+x,0.5)local fs=CreateFrame("Frame",nil,bx)fs:SetPoint("BOTTOMRIGHT",-25,0)fs:SetPoint("BOTTOMLEFT")fs:SetHeight(25)fs:EnableMouse(true)fs:SetScript("OnMouseDown",fd)fs:SetScript("OnMouseUp",fa)local ft=CreateFrame("Frame",nil,bx)ft:SetPoint("BOTTOMRIGHT",0,25)ft:SetPoint("TOPRIGHT")ft:SetWidth(25)ft:EnableMouse(true)ft:SetScript("OnMouseDown",fe)ft:SetScript("OnMouseUp",fa)local dO=CreateFrame("Frame",nil,bx)dO:SetPoint("TOPLEFT",17,-27)dO:SetPoint("BOTTOMRIGHT",-17,40)local dt={localstatus={},titletext=f1,statustext=fl,titlebg=fm,sizer_se=fp,sizer_s=fs,sizer_e=ft,content=dO,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;fj.obj,fk.obj=dt,dt;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function fu(...)local eJ,dL="InlineGroup",22;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eQ={["OnAcquire"]=function(self)self:SetWidth(300)self:SetHeight(100)self:SetTitle("")end,["SetTitle"]=function(self,eT)self.titletext:SetText(eT)end,["LayoutFinished"]=function(self,dx,dy)if self.noAutoHeight then return end;self:SetHeight((dy or 0)+40)end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eR=dx-20;if eR<0 then eR=0 end;dO:SetWidth(eR)dO.width=eR end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eS=dy-20;if eS<0 then eS=0 end;dO:SetHeight(eS)dO.height=eS end}local f0={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:SetFrameStrata("FULLSCREEN_DIALOG")local f1=bx:CreateFontString(nil,"OVERLAY","GameFontNormal")f1:SetPoint("TOPLEFT",14,0)f1:SetPoint("TOPRIGHT",-14,0)f1:SetJustifyH("LEFT")f1:SetHeight(18)local f3=CreateFrame("Frame",nil,bx,"BackdropTemplate")f3:SetPoint("TOPLEFT",0,-17)f3:SetPoint("BOTTOMRIGHT",-1,3)f3:SetBackdrop(f0)f3:SetBackdropColor(0.1,0.1,0.1,0.5)f3:SetBackdropBorderColor(0.4,0.4,0.4)local dO=CreateFrame("Frame",nil,f3)dO:SetPoint("TOPLEFT",10,-10)dO:SetPoint("BOTTOMRIGHT",-10,10)local dt={frame=bx,content=dO,titletext=f1,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function fv(...)local eJ,dL="ScrollFrame",26;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs,assert,type=pairs,assert,type;local fw,cY,fx=math.min,math.max,math.floor;local CreateFrame,UIParent=CreateFrame,UIParent;local function fy(bx)bx:SetScript("OnUpdate",nil)bx.obj:FixScroll()end;local function fz(bx,by)bx.obj:MoveScroll(by)end;local function fA(bx)bx:SetScript("OnUpdate",fy)end;local function fB(bx,by)bx.obj:SetScroll(by)end;local eQ={["OnAcquire"]=function(self)self:SetScroll(0)self.scrollframe:SetScript("OnUpdate",fy)end,["OnRelease"]=function(self)self.status=nil;for ad in pairs(self.localstatus)do self.localstatus[ad]=nil end;self.scrollframe:SetPoint("BOTTOMRIGHT")self.scrollbar:Hide()self.scrollBarShown=nil;self.content.height,self.content.width,self.content.original_width=nil,nil,nil end,["SetScroll"]=function(self,by)local eY=self.status or self.localstatus;local fC=self.scrollframe:GetHeight()local dy=self.content:GetHeight()local ag;if fC>dy then ag=0 else ag=fx((dy-fC)/1000.0*by)end;self.content:ClearAllPoints()self.content:SetPoint("TOPLEFT",0,ag)self.content:SetPoint("TOPRIGHT",0,ag)eY.offset=ag;eY.scrollvalue=by end,["MoveScroll"]=function(self,by)local eY=self.status or self.localstatus;local dy,fC=self.scrollframe:GetHeight(),self.content:GetHeight()if self.scrollBarShown then local fD=dy-fC;local fE=1;if by<0 then fE=-1 end;self.scrollbar:SetValue(fw(cY(eY.scrollvalue+fE*1000/(fD/45),0),1000))end end,["FixScroll"]=function(self)if self.updateLock then return end;self.updateLock=true;local eY=self.status or self.localstatus;local dy,fC=self.scrollframe:GetHeight(),self.content:GetHeight()local ag=eY.offset or 0;if fC<dy+2 then if self.scrollBarShown then self.scrollBarShown=nil;self.scrollbar:Hide()self.scrollbar:SetValue(0)self.scrollframe:SetPoint("BOTTOMRIGHT")if self.content.original_width then self.content.width=self.content.original_width end;self:DoLayout()end else if not self.scrollBarShown then self.scrollBarShown=true;self.scrollbar:Show()self.scrollframe:SetPoint("BOTTOMRIGHT",-20,0)if self.content.original_width then self.content.width=self.content.original_width-20 end;self:DoLayout()end;local by=ag/(fC-dy)*1000;if by>1000 then by=1000 end;self.scrollbar:SetValue(by)self:SetScroll(by)if by<1000 then self.content:ClearAllPoints()self.content:SetPoint("TOPLEFT",0,ag)self.content:SetPoint("TOPRIGHT",0,ag)eY.offset=ag end end;self.updateLock=nil end,["LayoutFinished"]=function(self,dx,dy)self.content:SetHeight(dy or 0+20)self:FixScroll()self.scrollframe:SetScript("OnUpdate",fy)end,["SetStatusTable"]=function(self,eY)assert(type(eY)=="table")self.status=eY;if not eY.scrollvalue then eY.scrollvalue=0 end end,["OnWidthSet"]=function(self,dx)local dO=self.content;dO.width=dx-(self.scrollBarShown and 20 or 0)dO.original_width=dx end,["OnHeightSet"]=function(self,dy)local dO=self.content;dO.height=dy end}local function dK()local bx=CreateFrame("Frame",nil,UIParent)local fF=df:GetNextWidgetNum(eJ)local fG=CreateFrame("ScrollFrame",nil,bx)fG:SetPoint("TOPLEFT")fG:SetPoint("BOTTOMRIGHT")fG:EnableMouseWheel(true)fG:SetScript("OnMouseWheel",fz)fG:SetScript("OnSizeChanged",fA)local fH=CreateFrame("Slider",("AceConfigDialogScrollFrame%dScrollBar"):format(fF),fG,"UIPanelScrollBarTemplate")fH:SetPoint("TOPLEFT",fG,"TOPRIGHT",4,-16)fH:SetPoint("BOTTOMLEFT",fG,"BOTTOMRIGHT",4,16)fH:SetMinMaxValues(0,1000)fH:SetValueStep(1)fH:SetValue(0)fH:SetWidth(16)fH:Hide()fH:SetScript("OnValueChanged",fB)local fI=fH:CreateTexture(nil,"BACKGROUND")fI:SetAllPoints(fH)fI:SetColorTexture(0,0,0,0.4)local dO=CreateFrame("Frame",nil,fG)dO:SetPoint("TOPLEFT")dO:SetPoint("TOPRIGHT")dO:SetHeight(400)fG:SetScrollChild(dO)local dt={localstatus={scrollvalue=0},scrollframe=fG,scrollbar=fH,content=dO,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;fG.obj,fH.obj=dt,dt;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function fJ(...)local eJ,dL="SimpleGroup",20;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eQ={["OnAcquire"]=function(self)self:SetWidth(300)self:SetHeight(100)end,["LayoutFinished"]=function(self,dx,dy)if self.noAutoHeight then return end;self:SetHeight(dy or 0)end,["OnWidthSet"]=function(self,dx)local dO=self.content;dO:SetWidth(dx)dO.width=dx end,["OnHeightSet"]=function(self,dy)local dO=self.content;dO:SetHeight(dy)dO.height=dy end}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:SetFrameStrata("FULLSCREEN_DIALOG")local dO=CreateFrame("Frame",nil,bx)dO:SetPoint("TOPLEFT")dO:SetPoint("BOTTOMRIGHT")local dt={frame=bx,content=dO,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function fK(...)local eJ,dL="TabGroup",38;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs,ipairs,assert,type,dg=pairs,ipairs,assert,type,table.wipe;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;local fL={}local fM={}local fN={}local function fO(fP,fQ,fR,fS,fT,fU)local fV=fP:GetName()local fW=fP.Middle or fP.middleTexture or _G[fV.."Middle"]local fX=fP.MiddleDisabled or fV and _G[fV.."MiddleDisabled"]local fY=fP.Left or fP.leftTexture or _G[fV.."Left"]local fZ=2*fY:GetWidth()local f_=fP.Text or _G[fP:GetName().."Text"]local g0=fP.HighlightTexture or fV and _G[fV.."HighlightTexture"]local dx,g1;local g2;if fU then g2=fU else f_:SetWidth(0)g2=f_:GetWidth()end;if fR then if fR<fZ then dx=1;g1=fZ else dx=fR-fZ;g1=fR end;f_:SetWidth(dx)else if fQ then dx=g2+fQ else dx=g2+24 end;if fT and dx>fT then if fQ then dx=fT+fQ else dx=fT+24 end;f_:SetWidth(dx)else f_:SetWidth(0)end;if fS and dx<fS then dx=fS end;g1=dx+fZ end;if fW then fW:SetWidth(dx)end;if fX then fX:SetWidth(dx)end;fP:SetWidth(g1)if g0 then g0:SetWidth(g1)end end;local function g3(fP)local aa=fP:GetName()local fY=fP.Left or _G[aa.."Left"]local g4=fP.Middle or _G[aa.."Middle"]local g5=fP.Right or _G[aa.."Right"]fY:Show()g4:Show()g5:Show()fP:Enable()local fh=fP.Text or _G[aa.."Text"]fh:SetPoint("CENTER",fP,"CENTER",fP.deselectedTextX or 0,fP.deselectedTextY or 2)local g6=fP.LeftDisabled or _G[aa.."LeftDisabled"]local g7=fP.MiddleDisabled or _G[aa.."MiddleDisabled"]local g8=fP.RightDisabled or _G[aa.."RightDisabled"]g6:Hide()g7:Hide()g8:Hide()end;local function g9(fP)local aa=fP:GetName()local fY=fP.Left or _G[aa.."Left"]local g4=fP.Middle or _G[aa.."Middle"]local g5=fP.Right or _G[aa.."Right"]fY:Hide()g4:Hide()g5:Hide()fP:Disable()fP:SetDisabledFontObject(GameFontHighlightSmall)local fh=fP.Text or _G[aa.."Text"]fh:SetPoint("CENTER",fP,"CENTER",fP.selectedTextX or 0,fP.selectedTextY or-3)local g6=fP.LeftDisabled or _G[aa.."LeftDisabled"]local g7=fP.MiddleDisabled or _G[aa.."MiddleDisabled"]local g8=fP.RightDisabled or _G[aa.."RightDisabled"]g6:Show()g7:Show()g8:Show()if GameTooltip:IsOwned(fP)then GameTooltip:Hide()end end;local function ga(fP)local aa=fP:GetName()local fY=fP.Left or _G[aa.."Left"]local g4=fP.Middle or _G[aa.."Middle"]local g5=fP.Right or _G[aa.."Right"]fY:Show()g4:Show()g5:Show()fP:Disable()fP.text=fP:GetText()fP:SetDisabledFontObject(GameFontDisableSmall)local g6=fP.LeftDisabled or _G[aa.."LeftDisabled"]local g7=fP.MiddleDisabled or _G[aa.."MiddleDisabled"]local g8=fP.RightDisabled or _G[aa.."RightDisabled"]g6:Hide()g7:Hide()g8:Hide()end;local function gb(bx)if bx.disabled then ga(bx)elseif bx.selected then g9(bx)else g3(bx)end end;local function gc(bx,fh)bx:_SetText(fh)local dx=bx.obj.frame.width or bx.obj.frame:GetWidth()or 0;fO(bx,0,nil,nil,dx,bx:GetFontString():GetStringWidth())end;local function gd(bx,ge)bx.selected=ge;gb(bx)end;local function gf(bx,gg)bx.disabled=gg;gb(bx)end;local function gh(bx)local self=bx.obj;self:BuildTabs()bx:SetScript("OnUpdate",nil)end;local function gi(bx)if not(bx.selected or bx.disabled)then PlaySound(841)bx.obj:SelectTab(bx.value)end end;local function gj(bx)local self=bx.obj;self:Fire("OnTabEnter",self.tabs[bx.id].value,bx)end;local function gk(bx)local self=bx.obj;self:Fire("OnTabLeave",self.tabs[bx.id].value,bx)end;local function gl(bx)_G[bx:GetName().."HighlightTexture"]:SetWidth(bx:GetTextWidth()+30)end;local eQ={["OnAcquire"]=function(self)self:SetTitle()end,["OnRelease"]=function(self)self.status=nil;for ad in pairs(self.localstatus)do self.localstatus[ad]=nil end;self.tablist=nil;for aV,fP in pairs(self.tabs)do fP:Hide()end end,["CreateTab"]=function(self,aN)local gm=("AceGUITabGroup%dTab%d"):format(self.num,aN)local fP=CreateFrame("Button",gm,self.border)fP:SetSize(115,24)fP.deselectedTextY=-3;fP.selectedTextY=-2;fP.LeftDisabled=fP:CreateTexture(gm.."LeftDisabled","BORDER")fP.LeftDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fP.LeftDisabled:SetSize(20,24)fP.LeftDisabled:SetPoint("BOTTOMLEFT",0,-3)fP.LeftDisabled:SetTexCoord(0,0.15625,0,1.0)fP.MiddleDisabled=fP:CreateTexture(gm.."MiddleDisabled","BORDER")fP.MiddleDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fP.MiddleDisabled:SetSize(88,24)fP.MiddleDisabled:SetPoint("LEFT",fP.LeftDisabled,"RIGHT")fP.MiddleDisabled:SetTexCoord(0.15625,0.84375,0,1.0)fP.RightDisabled=fP:CreateTexture(gm.."RightDisabled","BORDER")fP.RightDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fP.RightDisabled:SetSize(20,24)fP.RightDisabled:SetPoint("LEFT",fP.MiddleDisabled,"RIGHT")fP.RightDisabled:SetTexCoord(0.84375,1.0,0,1.0)fP.Left=fP:CreateTexture(gm.."Left","BORDER")fP.Left:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fP.Left:SetSize(20,24)fP.Left:SetPoint("TOPLEFT")fP.Left:SetTexCoord(0,0.15625,0,1.0)fP.Middle=fP:CreateTexture(gm.."Middle","BORDER")fP.Middle:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fP.Middle:SetSize(88,24)fP.Middle:SetPoint("LEFT",fP.Left,"RIGHT")fP.Middle:SetTexCoord(0.15625,0.84375,0,1.0)fP.Right=fP:CreateTexture(gm.."Right","BORDER")fP.Right:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fP.Right:SetSize(20,24)fP.Right:SetPoint("LEFT",fP.Middle,"RIGHT")fP.Right:SetTexCoord(0.84375,1.0,0,1.0)fP.Text=fP:CreateFontString(gm.."Text")fP:SetFontString(fP.Text)fP:SetNormalFontObject(GameFontNormalSmall)fP:SetHighlightFontObject(GameFontHighlightSmall)fP:SetDisabledFontObject(GameFontHighlightSmall)fP:SetHighlightTexture("Interface\\PaperDollInfoFrame\\UI-Character-Tab-Highlight","ADD")fP.HighlightTexture=fP:GetHighlightTexture()fP.HighlightTexture:ClearAllPoints()fP.HighlightTexture:SetPoint("LEFT",fP,"LEFT",10,-4)fP.HighlightTexture:SetPoint("RIGHT",fP,"RIGHT",-10,-4)_G[gm.."HighlightTexture"]=fP.HighlightTexture;fP.obj=self;fP.id=aN;fP.text=fP.Text;fP.text:ClearAllPoints()fP.text:SetPoint("LEFT",14,-3)fP.text:SetPoint("RIGHT",-12,-3)fP:SetScript("OnClick",gi)fP:SetScript("OnEnter",gj)fP:SetScript("OnLeave",gk)fP:SetScript("OnShow",gl)fP._SetText=fP.SetText;fP.SetText=gc;fP.SetSelected=gd;fP.SetDisabled=gf;return fP end,["SetTitle"]=function(self,fh)self.titletext:SetText(fh or"")if fh and fh~=""then self.alignoffset=25 else self.alignoffset=18 end;self:BuildTabs()end,["SetStatusTable"]=function(self,eY)assert(type(eY)=="table")self.status=eY end,["SelectTab"]=function(self,by)local eY=self.status or self.localstatus;local gn;for M,ae in ipairs(self.tabs)do if ae.value==by then ae:SetSelected(true)gn=true else ae:SetSelected(false)end end;eY.selected=by;if gn then self:Fire("OnGroupSelected",by)end end,["SetTabs"]=function(self,go)self.tablist=go;self:BuildTabs()end,["BuildTabs"]=function(self)local gp=self.titletext:GetText()and self.titletext:GetText()~=""local gq=self.tablist;local go=self.tabs;if not gq then return end;local dx=self.frame.width or self.frame:GetWidth()or 0;dg(fL)dg(fM)dg(fN)for M,ae in ipairs(gq)do local fP=go[M]if not fP then fP=self:CreateTab(M)go[M]=fP end;fP:Show()fP:SetText(ae.text)fP:SetDisabled(ae.disabled)fP.value=ae.value;fL[M]=fP:GetWidth()-6 end;for M=#gq+1,#go,1 do go[M]:Hide()end;local gr=#gq;local gs=1;local dR=0;for M=1,#gq do if dR~=0 and dx-dR-fL[M]<0 then fM[gs]=dR+10;fN[gs]=M-1;gs=gs+1;dR=0 end;dR=dR+fL[M]end;fM[gs]=dR+10;fN[gs]=#gq;if gs>1 then if fN[gs-1]==gr-1 then if gs==2 and fN[gs-1]>2 or fN[gs]-fN[gs-1]>2 then if fM[gs]+fL[gr-1]<=dx then fN[gs-1]=fN[gs-1]-1;fM[gs]=fM[gs]+fL[gr-1]fM[gs-1]=fM[gs-1]-fL[gr-1]end end end end;local gt=1;for eq,gu in ipairs(fN)do local H=true;for gv=gt,gu do local fP=go[gv]fP:ClearAllPoints()if H then fP:SetPoint("TOPLEFT",self.frame,"TOPLEFT",0,-(gp and 14 or 7)-(eq-1)*20)H=false else fP:SetPoint("LEFT",go[gv-1],"RIGHT",-10,0)end end;local fQ=0;if not(gs==1 and fM[1]<dx*0.75-18)then fQ=(dx-fM[eq])/(gu-gt+1)end;for M=gt,gu do fO(go[M],fQ+4,nil,nil,dx,go[M]:GetFontString():GetStringWidth())end;gt=gu+1 end;self.borderoffset=(gp and 17 or 10)+gs*20;self.border:SetPoint("TOPLEFT",1,-self.borderoffset)end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eR=dx-60;if eR<0 then eR=0 end;dO:SetWidth(eR)dO.width=eR;self:BuildTabs(self)self.frame:SetScript("OnUpdate",gh)end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eS=dy-(self.borderoffset+23)if eS<0 then eS=0 end;dO:SetHeight(eS)dO.height=eS end,["LayoutFinished"]=function(self,dx,dy)if self.noAutoHeight then return end;self:SetHeight((dy or 0)+self.borderoffset+23)end}local f0={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dK()local fF=df:GetNextWidgetNum(eJ)local bx=CreateFrame("Frame",nil,UIParent)bx:SetHeight(100)bx:SetWidth(100)bx:SetFrameStrata("FULLSCREEN_DIALOG")local f1=bx:CreateFontString(nil,"OVERLAY","GameFontNormal")f1:SetPoint("TOPLEFT",14,0)f1:SetPoint("TOPRIGHT",-14,0)f1:SetJustifyH("LEFT")f1:SetHeight(18)f1:SetText("")local f3=CreateFrame("Frame",nil,bx,"BackdropTemplate")f3:SetPoint("TOPLEFT",1,-27)f3:SetPoint("BOTTOMRIGHT",-1,3)f3:SetBackdrop(f0)f3:SetBackdropColor(0.1,0.1,0.1,0.5)f3:SetBackdropBorderColor(0.4,0.4,0.4)local dO=CreateFrame("Frame",nil,f3)dO:SetPoint("TOPLEFT",10,-7)dO:SetPoint("BOTTOMRIGHT",-10,7)local dt={num=fF,frame=bx,localstatus={},alignoffset=18,titletext=f1,border=f3,borderoffset=27,tabs={},content=dO,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function gw(...)local eJ,dL="TreeGroup",47;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local next,pairs,ipairs,assert,type=next,pairs,ipairs,assert,type;local di,dh,fx=math.min,math.max,math.floor;local select,Q,unpack,P=select,table.remove,unpack,table.concat;local CreateFrame,UIParent=CreateFrame,UIParent;local aH,gx;do local gy=setmetatable({},{__mode='k'})function aH()local aU=next(gy)if aU then gy[aU]=nil;return aU else return{}end end;function gx(aU)for ad in pairs(aU)do aU[ad]=nil end;gy[aU]=true end end;local gz=175;local gA=true;local function gB(gC)local cd=gC.parent;if cd and cd.value then return gB(cd).."\001"..gC.value else return gC.value end end;local function gD(gE,gF,ge,gG,gH)local self=gE.obj;local gI=gE.toggle;local fh=gF.text or""local gJ=gF.icon;local gK=gF.iconCoords;local gL=gF.level;local by=gF.value;local gM=gF.uniquevalue;local gg=gF.disabled;gE.treeline=gF;gE.value=by;gE.uniquevalue=gM;if ge then gE:LockHighlight()gE.selected=true else gE:UnlockHighlight()gE.selected=false end;gE.level=gL;if gL==1 then gE:SetNormalFontObject("GameFontNormal")gE:SetHighlightFontObject("GameFontHighlight")gE.text:SetPoint("LEFT",(gJ and 16 or 0)+8,2)else gE:SetNormalFontObject("GameFontHighlightSmall")gE:SetHighlightFontObject("GameFontHighlightSmall")gE.text:SetPoint("LEFT",(gJ and 16 or 0)+8*gL,2)end;if gg then gE:EnableMouse(false)gE.text:SetText("|cff808080"..fh..FONT_COLOR_CODE_CLOSE)else gE.text:SetText(fh)gE:EnableMouse(true)end;if gJ then gE.icon:SetTexture(gJ)gE.icon:SetPoint("LEFT",8*gL,gL==1 and 0 or 1)else gE.icon:SetTexture(nil)end;if gK then gE.icon:SetTexCoord(unpack(gK))else gE.icon:SetTexCoord(0,1,0,1)end;if gG then if not gH then gI:SetNormalTexture(130838)gI:SetPushedTexture(130836)else gI:SetNormalTexture(130821)gI:SetPushedTexture(130820)end;gI:Show()else gI:Hide()end end;local function gN(gO)local gP=false;for ad,ae in ipairs(gO)do if ae.children==nil and ae.visible~=false then gP=true elseif ae.children then gP=gP or gN(ae.children)end;if gP then return gP end end;return false end;local function gQ(self,ae,gO,gL,cd)local gC=aH()gC.value=ae.value;gC.text=ae.text;gC.icon=ae.icon;gC.iconCoords=ae.iconCoords;gC.disabled=ae.disabled;gC.tree=gO;gC.level=gL;gC.parent=cd;gC.visible=ae.visible;gC.uniquevalue=gB(gC)if ae.children then gC.hasChildren=true else gC.hasChildren=nil end;self.lines[#self.lines+1]=gC;return gC end;local function gR(bx)local self=bx.obj;bx:SetScript("OnUpdate",nil)self:RefreshTree(nil,true)end;local function gS(...)local d0=select('#',...)if d0==1 then return...else return....."\001"..gS(select(2,...))end end;local function gT(bx)local gE=bx.button;local self=gE.obj;local eY=(self.status or self.localstatus).groups;eY[gE.uniquevalue]=not eY[gE.uniquevalue]self:RefreshTree()end;local function f5(bx)local self=bx.obj;self:Fire("OnClick",bx.uniquevalue,bx.selected)if not bx.selected then self:SetSelected(bx.uniquevalue)bx.selected=true;bx:LockHighlight()self:RefreshTree()end;df:ClearFocus()end;local function gU(gE)local self=gE.obj;local eY=(self.status or self.localstatus).groups;eY[gE.uniquevalue]=not eY[gE.uniquevalue]self:RefreshTree()end;local function gV(bx)local self=bx.obj;self:Fire("OnButtonEnter",bx.uniquevalue,bx)if self.enabletooltips then local gW=df.tooltip;gW:SetOwner(bx,"ANCHOR_NONE")gW:ClearAllPoints()gW:SetPoint("LEFT",bx,"RIGHT")gW:SetText(bx.text:GetText()or"",1,.82,0,true)gW:Show()end end;local function gX(bx)local self=bx.obj;self:Fire("OnButtonLeave",bx.uniquevalue,bx)if self.enabletooltips then df.tooltip:Hide()end end;local function gY(bx,by)if bx.obj.noupdate then return end;local self=bx.obj;local eY=self.status or self.localstatus;eY.scrollvalue=fx(by+0.5)self:RefreshTree()df:ClearFocus()end;local function gZ(bx)bx.obj:RefreshTree()end;local function g_(bx,fE)local self=bx.obj;if self.showscroll then local fH=self.scrollbar;local fw,cY=fH:GetMinMaxValues()local by=fH:GetValue()local h0=di(cY,dh(fw,by-fE))if by~=h0 then fH:SetValue(h0)end end end;local function h1(bx)bx:SetBackdropColor(1,1,1,0)end;local function h2(bx)bx:SetBackdropColor(1,1,1,0.8)end;local function h3(bx)local h4=bx:GetParent()h4:StartSizing("RIGHT")end;local function h5(bx)local h4=bx:GetParent()local self=h4.obj;local h6=h4:GetParent()h4:StopMovingOrSizing()h4:SetUserPlaced(false)h4:SetHeight(0)h4:ClearAllPoints()h4:SetPoint("TOPLEFT",h6,"TOPLEFT",0,0)h4:SetPoint("BOTTOMLEFT",h6,"BOTTOMLEFT",0,0)local eY=self.status or self.localstatus;eY.treewidth=h4:GetWidth()h4.obj:Fire("OnTreeResize",h4:GetWidth())h4.obj:OnWidthSet(eY.fullwidth)h4.obj:DoLayout()end;local eQ={["OnAcquire"]=function(self)self:SetTreeWidth(gz,gA)self:EnableButtonTooltips(true)self.frame:SetScript("OnUpdate",gR)end,["OnRelease"]=function(self)self.status=nil;self.tree=nil;self.frame:SetScript("OnUpdate",nil)for ad,ae in pairs(self.localstatus)do if ad=="groups"then for bJ in pairs(ae)do ae[bJ]=nil end else self.localstatus[ad]=nil end end;self.localstatus.scrollvalue=0;self.localstatus.treewidth=gz;self.localstatus.treesizable=gA end,["EnableButtonTooltips"]=function(self,h7)self.enabletooltips=h7 end,["CreateButton"]=function(self)local fF=df:GetNextWidgetNum("TreeGroupButton")local gE=CreateFrame("Button",("AceGUI30TreeButton%d"):format(fF),self.treeframe,"OptionsListButtonTemplate")gE.obj=self;local gJ=gE:CreateTexture(nil,"OVERLAY")gJ:SetWidth(14)gJ:SetHeight(14)gE.icon=gJ;gE:SetScript("OnClick",f5)gE:SetScript("OnDoubleClick",gU)gE:SetScript("OnEnter",gV)gE:SetScript("OnLeave",gX)gE.toggle.button=gE;gE.toggle:SetScript("OnClick",gT)gE.text:SetHeight(14)return gE end,["SetStatusTable"]=function(self,eY)assert(type(eY)=="table")self.status=eY;if not eY.groups then eY.groups={}end;if not eY.scrollvalue then eY.scrollvalue=0 end;if not eY.treewidth then eY.treewidth=gz end;if eY.treesizable==nil then eY.treesizable=gA end;self:SetTreeWidth(eY.treewidth,eY.treesizable)self:RefreshTree()end,["SetTree"]=function(self,gO,h8)self.filter=h8;if gO then assert(type(gO)=="table")end;self.tree=gO;self:RefreshTree()end,["BuildLevel"]=function(self,gO,gL,cd)local h9=(self.status or self.localstatus).groups;for M,ae in ipairs(gO)do if ae.children then if not self.filter or gN(ae.children)then local gC=gQ(self,ae,gO,gL,cd)if h9[gC.uniquevalue]then self:BuildLevel(ae.children,gL+1,gC)end end elseif ae.visible~=false or not self.filter then gQ(self,ae,gO,gL,cd)end end end,["RefreshTree"]=function(self,ha,hb)local hc=self.buttons;local hd=self.lines;for M,ae in ipairs(hc)do ae:Hide()end;while hd[1]do local aU=Q(hd)for ad in pairs(aU)do aU[ad]=nil end;gx(aU)end;if not self.tree then return end;local eY=self.status or self.localstatus;local he=eY.groups;local gO=self.tree;local h4=self.treeframe;eY.scrollToSelection=eY.scrollToSelection or ha;self:BuildLevel(gO,1)local hf=#hd;local hg=fx(((self.treeframe:GetHeight()or 0)-20)/18)if hg<=0 then return end;if self.frame:GetParent()==UIParent and not hb then self.frame:SetScript("OnUpdate",gR)return end;local H,hh;ha=eY.scrollToSelection;eY.scrollToSelection=nil;if hf<=hg then eY.scrollvalue=0;self:ShowScroll(false)H,hh=1,hf else self:ShowScroll(true)self.noupdate=true;self.scrollbar:SetMinMaxValues(0,hf-hg)if hf-eY.scrollvalue<hg then eY.scrollvalue=hf-hg end;self.noupdate=nil;H,hh=eY.scrollvalue+1,eY.scrollvalue+hg;if ha and eY.selected then local hi;for M,gC in ipairs(hd)do if gC.uniquevalue==eY.selected then hi=M end end;if not hi then elseif hi>=H and hi<=hh then else if hi<H then eY.scrollvalue=hi-1 else eY.scrollvalue=hi-hg end;H,hh=eY.scrollvalue+1,eY.scrollvalue+hg end end;if self.scrollbar:GetValue()~=eY.scrollvalue then self.scrollbar:SetValue(eY.scrollvalue)end end;local hj=1;for M=H,hh do local gC=hd[M]local gE=hc[hj]if not gE then gE=self:CreateButton()hc[hj]=gE;gE:SetParent(h4)gE:SetFrameLevel(h4:GetFrameLevel()+1)gE:ClearAllPoints()if hj==1 then if self.showscroll then gE:SetPoint("TOPRIGHT",-22,-10)gE:SetPoint("TOPLEFT",0,-10)else gE:SetPoint("TOPRIGHT",0,-10)gE:SetPoint("TOPLEFT",0,-10)end else gE:SetPoint("TOPRIGHT",hc[hj-1],"BOTTOMRIGHT",0,0)gE:SetPoint("TOPLEFT",hc[hj-1],"BOTTOMLEFT",0,0)end end;gD(gE,gC,eY.selected==gC.uniquevalue,gC.hasChildren,he[gC.uniquevalue])gE:Show()hj=hj+1 end end,["SetSelected"]=function(self,by)local eY=self.status or self.localstatus;if eY.selected~=by then eY.selected=by;self:Fire("OnGroupSelected",by)end end,["Select"]=function(self,gM,...)self.filter=false;local eY=self.status or self.localstatus;local h9=eY.groups;local hk={...}for M=1,#hk do h9[P(hk,"\001",1,M)]=true end;eY.selected=gM;self:RefreshTree(true)self:Fire("OnGroupSelected",gM)end,["SelectByPath"]=function(self,...)self:Select(gS(...),...)end,["SelectByValue"]=function(self,gM)self:Select(gM,("\001"):split(gM))end,["ShowScroll"]=function(self,hi)self.showscroll=hi;if hi then self.scrollbar:Show()if self.buttons[1]then self.buttons[1]:SetPoint("TOPRIGHT",self.treeframe,"TOPRIGHT",-22,-10)end else self.scrollbar:Hide()if self.buttons[1]then self.buttons[1]:SetPoint("TOPRIGHT",self.treeframe,"TOPRIGHT",0,-10)end end end,["OnWidthSet"]=function(self,dx)local dO=self.content;local h4=self.treeframe;local eY=self.status or self.localstatus;eY.fullwidth=dx;local eR=dx-eY.treewidth-20;if eR<0 then eR=0 end;dO:SetWidth(eR)dO.width=eR;local hl=di(400,dx-50)if hl>100 and eY.treewidth>hl then self:SetTreeWidth(hl,eY.treesizable)end;if h4.SetResizeBounds then h4:SetResizeBounds(100,1,hl,1600)else h4:SetMaxResize(hl,1600)end end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eS=dy-20;if eS<0 then eS=0 end;dO:SetHeight(eS)dO.height=eS end,["SetTreeWidth"]=function(self,hm,hn)if not hn then if type(hm)=='number'then hn=false elseif type(hm)=='boolean'then hn=hm;hm=gz else hn=false;hm=gz end end;self.treeframe:SetWidth(hm)self.dragger:EnableMouse(hn)local eY=self.status or self.localstatus;eY.treewidth=hm;eY.treesizable=hn;if eY.fullwidth then self:OnWidthSet(eY.fullwidth)end end,["GetTreeWidth"]=function(self)local eY=self.status or self.localstatus;return eY.treewidth or gz end,["LayoutFinished"]=function(self,dx,dy)if self.noAutoHeight then return end;self:SetHeight((dy or 0)+20)end}local f0={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local ho={bgFile="Interface\\Tooltips\\UI-Tooltip-Background",edgeFile=nil,tile=true,tileSize=16,edgeSize=1,insets={left=3,right=3,top=7,bottom=7}}local function dK()local fF=df:GetNextWidgetNum(eJ)local bx=CreateFrame("Frame",nil,UIParent)local h4=CreateFrame("Frame",nil,bx,"BackdropTemplate")h4:SetPoint("TOPLEFT")h4:SetPoint("BOTTOMLEFT")h4:SetWidth(gz)h4:EnableMouseWheel(true)h4:SetBackdrop(f0)h4:SetBackdropColor(0.1,0.1,0.1,0.5)h4:SetBackdropBorderColor(0.4,0.4,0.4)h4:SetResizable(true)if h4.SetResizeBounds then h4:SetResizeBounds(100,1,400,1600)else h4:SetMinResize(100,1)h4:SetMaxResize(400,1600)end;h4:SetScript("OnUpdate",gR)h4:SetScript("OnSizeChanged",gZ)h4:SetScript("OnMouseWheel",g_)local hp=CreateFrame("Frame",nil,h4,"BackdropTemplate")hp:SetWidth(8)hp:SetPoint("TOP",h4,"TOPRIGHT")hp:SetPoint("BOTTOM",h4,"BOTTOMRIGHT")hp:SetBackdrop(ho)hp:SetBackdropColor(1,1,1,0)hp:SetScript("OnEnter",h2)hp:SetScript("OnLeave",h1)hp:SetScript("OnMouseDown",h3)hp:SetScript("OnMouseUp",h5)local fH=CreateFrame("Slider",("AceConfigDialogTreeGroup%dScrollBar"):format(fF),h4,"UIPanelScrollBarTemplate")fH:SetScript("OnValueChanged",nil)fH:SetPoint("TOPRIGHT",-10,-26)fH:SetPoint("BOTTOMRIGHT",-10,26)fH:SetMinMaxValues(0,0)fH:SetValueStep(1)fH:SetValue(0)fH:SetWidth(16)fH:SetScript("OnValueChanged",gY)local fI=fH:CreateTexture(nil,"BACKGROUND")fI:SetAllPoints(fH)fI:SetColorTexture(0,0,0,0.4)local f3=CreateFrame("Frame",nil,bx,"BackdropTemplate")f3:SetPoint("TOPLEFT",h4,"TOPRIGHT")f3:SetPoint("BOTTOMRIGHT")f3:SetBackdrop(f0)f3:SetBackdropColor(0.1,0.1,0.1,0.5)f3:SetBackdropBorderColor(0.4,0.4,0.4)local dO=CreateFrame("Frame",nil,f3)dO:SetPoint("TOPLEFT",10,-10)dO:SetPoint("BOTTOMRIGHT",-10,10)local dt={frame=bx,lines={},levels={},buttons={},hasChildren={},localstatus={groups={},scrollvalue=0},filter=false,treeframe=h4,dragger=hp,scrollbar=fH,border=f3,content=dO,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;h4.obj,hp.obj,fH.obj=dt,dt,dt;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function hq(...)local df=LibStub("AceGUI-3.0")local pairs,assert,type=pairs,assert,type;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;do local eJ="Window"local dL=8;local function hr(ay)ay.obj:Fire("OnShow")end;local function hs(ay)ay.obj:Fire("OnClose")end;local function ht(ay)PlaySound(799)ay.obj:Hide()end;local function hu(ay)df:ClearFocus()end;local function hv(ay)ay:GetParent():StartMoving()df:ClearFocus()end;local function hw(ay)local bx=ay:GetParent()bx:StopMovingOrSizing()local self=bx.obj;local eY=self.status or self.localstatus;eY.width=bx:GetWidth()eY.height=bx:GetHeight()eY.top=bx:GetTop()eY.left=bx:GetLeft()end;local function hx(ay)ay:GetParent():StartSizing("BOTTOMRIGHT")df:ClearFocus()end;local function hy(ay)ay:GetParent():StartSizing("BOTTOM")df:ClearFocus()end;local function hz(ay)ay:GetParent():StartSizing("RIGHT")df:ClearFocus()end;local function hA(ay)ay:GetParent():StopMovingOrSizing()end;local function hB(self,eT)self.titletext:SetText(eT)end;local function hC(self,fh)end;local function hD(self)self.frame:Hide()end;local function hE(self)self.frame:Show()end;local function hF(self)self.frame:SetParent(UIParent)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")self:ApplyStatus()self:EnableResize(true)self:Show()end;local function hG(self)self.status=nil;for ad in pairs(self.localstatus)do self.localstatus[ad]=nil end end;local function hH(self,eY)assert(type(eY)=="table")self.status=eY;self:ApplyStatus()end;local function hI(self)local eY=self.status or self.localstatus;local bx=self.frame;self:SetWidth(eY.width or 700)self:SetHeight(eY.height or 500)if eY.top and eY.left then bx:SetPoint("TOP",UIParent,"BOTTOM",0,eY.top)bx:SetPoint("LEFT",UIParent,"LEFT",eY.left,0)else bx:SetPoint("CENTER",UIParent,"CENTER")end end;local function hJ(self,dx)local dO=self.content;local eR=dx-34;if eR<0 then eR=0 end;dO:SetWidth(eR)dO.width=eR end;local function hK(self,dy)local dO=self.content;local eS=dy-57;if eS<0 then eS=0 end;dO:SetHeight(eS)dO.height=eS end;local function hL(self,am)local J=am and"Show"or"Hide"self.sizer_se[J](self.sizer_se)self.sizer_s[J](self.sizer_s)self.sizer_e[J](self.sizer_e)end;local function dK()local bx=CreateFrame("Frame",nil,UIParent)local self={}self.type="Window"self.Hide=hD;self.Show=hE;self.SetTitle=hB;self.OnRelease=hG;self.OnAcquire=hF;self.SetStatusText=hC;self.SetStatusTable=hH;self.ApplyStatus=hI;self.OnWidthSet=hJ;self.OnHeightSet=hK;self.EnableResize=hL;self.localstatus={}self.frame=bx;bx.obj=self;bx:SetWidth(700)bx:SetHeight(500)bx:SetPoint("CENTER",UIParent,"CENTER",0,0)bx:EnableMouse()bx:SetMovable(true)bx:SetResizable(true)bx:SetFrameStrata("FULLSCREEN_DIALOG")bx:SetScript("OnMouseDown",hu)bx:SetScript("OnShow",hr)bx:SetScript("OnHide",hs)if bx.SetResizeBounds then bx:SetResizeBounds(240,240)else bx:SetMinResize(240,240)end;bx:SetToplevel(true)local fm=bx:CreateTexture(nil,"BACKGROUND")fm:SetTexture(251966)fm:SetPoint("TOPLEFT",9,-6)fm:SetPoint("BOTTOMRIGHT",bx,"TOPRIGHT",-28,-24)local hM=bx:CreateTexture(nil,"BACKGROUND")hM:SetTexture(137056)hM:SetPoint("TOPLEFT",8,-24)hM:SetPoint("BOTTOMRIGHT",-6,8)hM:SetVertexColor(0,0,0,.75)local hN=bx:CreateTexture(nil,"BORDER")hN:SetTexture(251963)hN:SetWidth(64)hN:SetHeight(64)hN:SetPoint("TOPLEFT")hN:SetTexCoord(0.501953125,0.625,0,1)local hO=bx:CreateTexture(nil,"BORDER")hO:SetTexture(251963)hO:SetWidth(64)hO:SetHeight(64)hO:SetPoint("TOPRIGHT")hO:SetTexCoord(0.625,0.75,0,1)local hP=bx:CreateTexture(nil,"BORDER")hP:SetTexture(251963)hP:SetHeight(64)hP:SetPoint("TOPLEFT",hN,"TOPRIGHT")hP:SetPoint("TOPRIGHT",hO,"TOPLEFT")hP:SetTexCoord(0.25,0.369140625,0,1)local hQ=bx:CreateTexture(nil,"BORDER")hQ:SetTexture(251963)hQ:SetWidth(64)hQ:SetHeight(64)hQ:SetPoint("BOTTOMLEFT")hQ:SetTexCoord(0.751953125,0.875,0,1)local hR=bx:CreateTexture(nil,"BORDER")hR:SetTexture(251963)hR:SetWidth(64)hR:SetHeight(64)hR:SetPoint("BOTTOMRIGHT")hR:SetTexCoord(0.875,1,0,1)local hS=bx:CreateTexture(nil,"BORDER")hS:SetTexture(251963)hS:SetHeight(64)hS:SetPoint("BOTTOMLEFT",hQ,"BOTTOMRIGHT")hS:SetPoint("BOTTOMRIGHT",hR,"BOTTOMLEFT")hS:SetTexCoord(0.376953125,0.498046875,0,1)local fY=bx:CreateTexture(nil,"BORDER")fY:SetTexture(251963)fY:SetWidth(64)fY:SetPoint("TOPLEFT",hN,"BOTTOMLEFT")fY:SetPoint("BOTTOMLEFT",hQ,"TOPLEFT")fY:SetTexCoord(0.001953125,0.125,0,1)local g5=bx:CreateTexture(nil,"BORDER")g5:SetTexture(251963)g5:SetWidth(64)g5:SetPoint("TOPRIGHT",hO,"BOTTOMRIGHT")g5:SetPoint("BOTTOMRIGHT",hR,"TOPRIGHT")g5:SetTexCoord(0.1171875,0.2421875,0,1)local hT=CreateFrame("Button",nil,bx,"UIPanelCloseButton")hT:SetPoint("TOPRIGHT",2,1)hT:SetScript("OnClick",ht)self.closebutton=hT;hT.obj=self;local f1=bx:CreateFontString(nil,"ARTWORK")f1:SetFontObject(GameFontNormal)f1:SetPoint("TOPLEFT",12,-8)f1:SetPoint("TOPRIGHT",-32,-8)self.titletext=f1;local eT=CreateFrame("Button",nil,bx)eT:SetPoint("TOPLEFT",fm)eT:SetPoint("BOTTOMRIGHT",fm)eT:EnableMouse()eT:SetScript("OnMouseDown",hv)eT:SetScript("OnMouseUp",hw)self.title=eT;local fp=CreateFrame("Frame",nil,bx)fp:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",0,0)fp:SetWidth(25)fp:SetHeight(25)fp:EnableMouse()fp:SetScript("OnMouseDown",hx)fp:SetScript("OnMouseUp",hA)self.sizer_se=fp;local fq=fp:CreateTexture(nil,"BACKGROUND")self.line1=fq;fq:SetWidth(14)fq:SetHeight(14)fq:SetPoint("BOTTOMRIGHT",-8,8)fq:SetTexture(137057)local x=0.1*14/17;fq:SetTexCoord(0.05-x,0.5,0.05,0.5+x,0.05,0.5-x,0.5+x,0.5)local fr=fp:CreateTexture(nil,"BACKGROUND")self.line2=fr;fr:SetWidth(8)fr:SetHeight(8)fr:SetPoint("BOTTOMRIGHT",-8,8)fr:SetTexture(137057)x=0.1*8/17;fr:SetTexCoord(0.05-x,0.5,0.05,0.5+x,0.05,0.5-x,0.5+x,0.5)local fs=CreateFrame("Frame",nil,bx)fs:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",-25,0)fs:SetPoint("BOTTOMLEFT",bx,"BOTTOMLEFT",0,0)fs:SetHeight(25)fs:EnableMouse()fs:SetScript("OnMouseDown",hy)fs:SetScript("OnMouseUp",hA)self.sizer_s=fs;local ft=CreateFrame("Frame",nil,bx)ft:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",0,25)ft:SetPoint("TOPRIGHT",bx,"TOPRIGHT",0,0)ft:SetWidth(25)ft:EnableMouse()ft:SetScript("OnMouseDown",hz)ft:SetScript("OnMouseUp",hA)self.sizer_e=ft;local dO=CreateFrame("Frame",nil,bx)self.content=dO;dO.obj=self;dO:SetPoint("TOPLEFT",bx,"TOPLEFT",12,-32)dO:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",-12,13)df:RegisterAsContainer(self)return self end;df:RegisterWidgetType(eJ,dK,dL)end end;local function hU(...)local eJ,dL="Button",24;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs=pairs;local _G=_G;local PlaySound,CreateFrame,UIParent=PlaySound,CreateFrame,UIParent;local function f5(bx,...)df:ClearFocus()PlaySound(852)bx.obj:Fire("OnClick",...)end;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local eQ={["OnAcquire"]=function(self)self:SetHeight(24)self:SetWidth(200)self:SetDisabled(false)self:SetAutoWidth(false)self:SetText()end,["SetText"]=function(self,fh)self.text:SetText(fh)if self.autoWidth then self:SetWidth(self.text:GetStringWidth()+30)end end,["SetAutoWidth"]=function(self,hX)self.autoWidth=hX;if self.autoWidth then self:SetWidth(self.text:GetStringWidth()+30)end end,["SetDisabled"]=function(self,gg)self.disabled=gg;if gg then self.frame:Disable()else self.frame:Enable()end end}local function dK()local aa="AceGUI30Button"..df:GetNextWidgetNum(eJ)local bx=CreateFrame("Button",aa,UIParent,"UIPanelButtonTemplate")bx:Hide()bx:EnableMouse(true)bx:SetScript("OnClick",f5)bx:SetScript("OnEnter",hV)bx:SetScript("OnLeave",hW)local fh=bx:GetFontString()fh:ClearAllPoints()fh:SetPoint("TOPLEFT",15,-1)fh:SetPoint("BOTTOMRIGHT",-15,1)fh:SetJustifyV("MIDDLE")local dt={text=fh,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function hY(...)local eJ,dL="CheckBox",26;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local select,pairs=select,pairs;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function hZ(self)local h_=self.image:GetTexture()self.text:ClearAllPoints()if not h_ then self.text:SetPoint("LEFT",self.checkbg,"RIGHT")self.text:SetPoint("RIGHT")else self.text:SetPoint("LEFT",self.image,"RIGHT",1,0)self.text:SetPoint("RIGHT")end end;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local function i0(bx)local self=bx.obj;if not self.disabled then if self.image:GetTexture()then self.text:SetPoint("LEFT",self.image,"RIGHT",2,-1)else self.text:SetPoint("LEFT",self.checkbg,"RIGHT",1,-1)end end;df:ClearFocus()end;local function i1(bx)local self=bx.obj;if not self.disabled then self:ToggleChecked()if self.checked then PlaySound(856)else PlaySound(857)end;self:Fire("OnValueChanged",self.checked)hZ(self)end end;local eQ={["OnAcquire"]=function(self)self:SetType()self:SetValue(false)self:SetTriState(nil)self:SetWidth(200)self:SetImage()self:SetDisabled(nil)self:SetDescription(nil)end,["OnWidthSet"]=function(self,dx)if self.desc then self.desc:SetWidth(dx-30)if self.desc:GetText()and self.desc:GetText()~=""then self:SetHeight(28+self.desc:GetStringHeight())end end end,["SetDisabled"]=function(self,gg)self.disabled=gg;if gg then self.frame:Disable()self.text:SetTextColor(0.5,0.5,0.5)SetDesaturation(self.check,true)if self.desc then self.desc:SetTextColor(0.5,0.5,0.5)end else self.frame:Enable()self.text:SetTextColor(1,1,1)if self.tristate and self.checked==nil then SetDesaturation(self.check,true)else SetDesaturation(self.check,false)end;if self.desc then self.desc:SetTextColor(1,1,1)end end end,["SetValue"]=function(self,by)local i2=self.check;self.checked=by;if by then SetDesaturation(i2,false)i2:Show()else if self.tristate and by==nil then SetDesaturation(i2,true)i2:Show()else SetDesaturation(i2,false)i2:Hide()end end;self:SetDisabled(self.disabled)end,["GetValue"]=function(self)return self.checked end,["SetTriState"]=function(self,i3)self.tristate=i3;self:SetValue(self:GetValue())end,["SetType"]=function(self,type)local i4=self.checkbg;local i2=self.check;local i5=self.highlight;local i6;if type=="radio"then i6=16;i4:SetTexture(130843)i4:SetTexCoord(0,0.25,0,1)i2:SetTexture(130843)i2:SetTexCoord(0.25,0.5,0,1)i2:SetBlendMode("ADD")i5:SetTexture(130843)i5:SetTexCoord(0.5,0.75,0,1)else i6=24;i4:SetTexture(130755)i4:SetTexCoord(0,1,0,1)i2:SetTexture(130751)i2:SetTexCoord(0,1,0,1)i2:SetBlendMode("BLEND")i5:SetTexture(130753)i5:SetTexCoord(0,1,0,1)end;i4:SetHeight(i6)i4:SetWidth(i6)end,["ToggleChecked"]=function(self)local by=self:GetValue()if self.tristate then if by then self:SetValue(nil)elseif by==nil then self:SetValue(false)else self:SetValue(true)end else self:SetValue(not self:GetValue())end end,["SetLabel"]=function(self,eU)self.text:SetText(eU)end,["SetDescription"]=function(self,i7)if i7 then if not self.desc then local ew=self.frame:CreateFontString(nil,"OVERLAY","GameFontHighlightSmall")ew:ClearAllPoints()ew:SetPoint("TOPLEFT",self.checkbg,"TOPRIGHT",5,-21)ew:SetWidth(self.frame.width-30)ew:SetPoint("RIGHT",self.frame,"RIGHT",-30,0)ew:SetJustifyH("LEFT")ew:SetJustifyV("TOP")self.desc=ew end;self.desc:Show()self.desc:SetText(i7)self:SetHeight(28+self.desc:GetStringHeight())else if self.desc then self.desc:SetText("")self.desc:Hide()end;self:SetHeight(24)end end,["SetImage"]=function(self,hk,...)local i8=self.image;i8:SetTexture(hk)if i8:GetTexture()then local d0=select("#",...)if d0==4 or d0==8 then i8:SetTexCoord(...)else i8:SetTexCoord(0,1,0,1)end end;hZ(self)end}local function dK()local bx=CreateFrame("Button",nil,UIParent)bx:Hide()bx:EnableMouse(true)bx:SetScript("OnEnter",hV)bx:SetScript("OnLeave",hW)bx:SetScript("OnMouseDown",i0)bx:SetScript("OnMouseUp",i1)local i4=bx:CreateTexture(nil,"ARTWORK")i4:SetWidth(24)i4:SetHeight(24)i4:SetPoint("TOPLEFT")i4:SetTexture(130755)local i2=bx:CreateTexture(nil,"OVERLAY")i2:SetAllPoints(i4)i2:SetTexture(130751)local fh=bx:CreateFontString(nil,"OVERLAY","GameFontHighlight")fh:SetJustifyH("LEFT")fh:SetHeight(18)fh:SetPoint("LEFT",i4,"RIGHT")fh:SetPoint("RIGHT")local i5=bx:CreateTexture(nil,"HIGHLIGHT")i5:SetTexture(130753)i5:SetBlendMode("ADD")i5:SetAllPoints(i4)local i8=bx:CreateTexture(nil,"OVERLAY")i8:SetHeight(16)i8:SetWidth(16)i8:SetPoint("LEFT",i4,"RIGHT",1,0)local dt={checkbg=i4,check=i2,text=fh,highlight=i5,image=i8,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function i9(...)local eJ,dL="ColorPicker",25;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local function ia(self,ib,ic,id,ie,ig)if not self.HasAlpha then ie=1 end;self:SetColor(ib,ic,id,ie)if ColorPickerFrame:IsVisible()then self:Fire("OnValueChanged",ib,ic,id,ie)else if ig then self:Fire("OnValueConfirmed",ib,ic,id,ie)end end end;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local function ih(bx)ColorPickerFrame:Hide()local self=bx.obj;if not self.disabled then ColorPickerFrame:SetFrameStrata("FULLSCREEN_DIALOG")ColorPickerFrame:SetFrameLevel(bx:GetFrameLevel()+10)ColorPickerFrame:SetClampedToScreen(true)ColorPickerFrame.func=function()local ib,ic,id=ColorPickerFrame:GetColorRGB()local ie=1-OpacitySliderFrame:GetValue()ia(self,ib,ic,id,ie)end;ColorPickerFrame.hasOpacity=self.HasAlpha;ColorPickerFrame.opacityFunc=function()local ib,ic,id=ColorPickerFrame:GetColorRGB()local ie=1-OpacitySliderFrame:GetValue()ia(self,ib,ic,id,ie,true)end;local ib,ic,id,ie=self.r,self.g,self.b,self.a;if self.HasAlpha then ColorPickerFrame.opacity=1-(ie or 0)end;ColorPickerFrame:SetColorRGB(ib,ic,id)ColorPickerFrame.cancelFunc=function()ia(self,ib,ic,id,ie,true)end;ColorPickerFrame:Show()end;df:ClearFocus()end;local eQ={["OnAcquire"]=function(self)self:SetHeight(24)self:SetWidth(200)self:SetHasAlpha(false)self:SetColor(0,0,0,1)self:SetDisabled(nil)self:SetLabel(nil)end,["SetLabel"]=function(self,fh)self.text:SetText(fh)end,["SetColor"]=function(self,ib,ic,id,ie)self.r=ib;self.g=ic;self.b=id;self.a=ie or 1;self.colorSwatch:SetVertexColor(ib,ic,id,ie)end,["SetHasAlpha"]=function(self,ii)self.HasAlpha=ii end,["SetDisabled"]=function(self,gg)self.disabled=gg;if self.disabled then self.frame:Disable()self.text:SetTextColor(0.5,0.5,0.5)else self.frame:Enable()self.text:SetTextColor(1,1,1)end end}local function dK()local bx=CreateFrame("Button",nil,UIParent)bx:Hide()bx:EnableMouse(true)bx:SetScript("OnEnter",hV)bx:SetScript("OnLeave",hW)bx:SetScript("OnClick",ih)local ij=bx:CreateTexture(nil,"OVERLAY")ij:SetWidth(19)ij:SetHeight(19)ij:SetTexture(130939)ij:SetPoint("LEFT")local ik=bx:CreateTexture(nil,"BACKGROUND")ij.background=ik;ik:SetWidth(16)ik:SetHeight(16)ik:SetColorTexture(1,1,1)ik:SetPoint("CENTER",ij)ik:Show()local il=bx:CreateTexture(nil,"BACKGROUND")ij.checkers=il;il:SetWidth(14)il:SetHeight(14)il:SetTexture(188523)il:SetTexCoord(.25,0,0.5,.25)il:SetDesaturated(true)il:SetVertexColor(1,1,1,0.75)il:SetPoint("CENTER",ij)il:Show()local fh=bx:CreateFontString(nil,"OVERLAY","GameFontHighlight")fh:SetHeight(24)fh:SetJustifyH("LEFT")fh:SetTextColor(1,1,1)fh:SetPoint("LEFT",ij,"RIGHT",2,0)fh:SetPoint("RIGHT")local dt={colorSwatch=ij,text=fh,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function im(...)local df=LibStub("AceGUI-3.0")local fw,cY,fx=math.min,math.max,math.floor;local select,pairs,ipairs,type,tostring=select,pairs,ipairs,type,tostring;local io=table.sort;local PlaySound=PlaySound;local UIParent,CreateFrame=UIParent,CreateFrame;local _G=_G;local function ip(cd,...)local M=1;local dB=select(M,...)while dB do dB:SetFrameLevel(cd:GetFrameLevel()+1)ip(dB,dB:GetChildren())M=M+1;dB=select(M,...)end end;local function iq(ir,cd,...)local M=1;local dB=select(M,...)cd:SetFrameStrata(ir)while dB do iq(ir,dB,dB:GetChildren())M=M+1;dB=select(M,...)end end;do local dr="Dropdown-Pullout"local is=5;local it={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\DialogFrame\\UI-DialogBox-Border",edgeSize=32,tileSize=32,tile=true,insets={left=11,right=12,top=12,bottom=11}}local iu={bgFile="Interface\\Buttons\\UI-SliderBar-Background",edgeFile="Interface\\Buttons\\UI-SliderBar-Border",tile=true,tileSize=8,edgeSize=8,insets={left=3,right=3,top=3,bottom=3}}local iv=200;local iw=600;local function ix(iy)local self=iy.pullout;for ad,ae in ipairs(self.items)do if ae.CloseMenu and ae~=iy then ae:CloseMenu()end end end;local function iz(ay,by)ay.obj:MoveScroll(by)end;local function gY(ay,by)ay.obj:SetScroll(by)end;local function iA(ay)ay.obj:FixScroll()end;local function iB(self,by)local eY=self.scrollStatus;local bx,dB=self.scrollFrame,self.itemFrame;local dy,fC=bx:GetHeight(),dB:GetHeight()local ag;if dy>fC then ag=0 else ag=fx((fC-dy)/1000*by)end;dB:ClearAllPoints()dB:SetPoint("TOPLEFT",bx,"TOPLEFT",0,ag)dB:SetPoint("TOPRIGHT",bx,"TOPRIGHT",self.slider:IsShown()and-12 or 0,ag)eY.offset=ag;eY.scrollvalue=by end;local function iC(self,by)local eY=self.scrollStatus;local bx,dB=self.scrollFrame,self.itemFrame;local dy,fC=bx:GetHeight(),dB:GetHeight()if dy>fC then self.slider:Hide()else self.slider:Show()local fD=dy-fC;local fE=1;if by<0 then fE=-1 end;self.slider:SetValue(fw(cY(eY.scrollvalue+fE*1000/(fD/45),0),1000))end end;local function iD(self)local eY=self.scrollStatus;local bx,dB=self.scrollFrame,self.itemFrame;local dy,fC=bx:GetHeight(),dB:GetHeight()local ag=eY.offset or 0;if fC<dy then self.slider:Hide()dB:SetPoint("TOPRIGHT",bx,"TOPRIGHT",0,ag)self.slider:SetValue(0)else self.slider:Show()local by=ag/(fC-dy)*1000;if by>1000 then by=1000 end;self.slider:SetValue(by)self:SetScroll(by)if by<1000 then dB:ClearAllPoints()dB:SetPoint("TOPLEFT",bx,"TOPLEFT",0,ag)dB:SetPoint("TOPRIGHT",bx,"TOPRIGHT",-12,ag)eY.offset=ag end end end;local function hF(self)self.frame:SetParent(UIParent)end;local function hG(self)self:Clear()self.frame:ClearAllPoints()self.frame:Hide()end;local function iE(self,iy)self.items[#self.items+1]=iy;local iF=#self.items*16;self.itemFrame:SetHeight(iF)self.frame:SetHeight(fw(iF+34,self.maxHeight))iy.frame:SetPoint("LEFT",self.itemFrame,"LEFT")iy.frame:SetPoint("RIGHT",self.itemFrame,"RIGHT")iy:SetPullout(self)iy:SetOnEnter(ix)end;local function iG(self,point,iH,iI,x,y)local iJ=self.items;local bx=self.frame;local iK=self.itemFrame;bx:SetPoint(point,iH,iI,x,y)local dy=8;for M,iy in pairs(iJ)do iy:SetPoint("TOP",iK,"TOP",0,-2+(M-1)*-16)iy:Show()dy=dy+16 end;iK:SetHeight(dy)iq("TOOLTIP",bx,bx:GetChildren())bx:Show()self:Fire("OnOpen")end;local function iL(self)self.frame:Hide()self:Fire("OnClose")end;local function iM(self)local iJ=self.items;for M,iy in pairs(iJ)do df:Release(iy)iJ[M]=nil end end;local function iN(self)return ipairs(self.items)end;local function iO(self,e8)self.hideOnLeave=e8 end;local function iP(self,dy)self.maxHeight=dy or iw;if self.frame:GetHeight()>dy then self.frame:SetHeight(dy)elseif self.itemFrame:GetHeight()+34<dy then self.frame:SetHeight(self.itemFrame:GetHeight()+34)end end;local function iQ(self)return 6+(self.slider:IsShown()and 12 or 0)end;local function iR(self)return 6 end;local function dK()local iS=df:GetNextWidgetNum(dr)local bx=CreateFrame("Frame","AceGUI30Pullout"..iS,UIParent,"BackdropTemplate")local self={}self.count=iS;self.type=dr;self.frame=bx;bx.obj=self;self.OnAcquire=hF;self.OnRelease=hG;self.AddItem=iE;self.Open=iG;self.Close=iL;self.Clear=iM;self.IterateItems=iN;self.SetHideOnLeave=iO;self.SetScroll=iB;self.MoveScroll=iC;self.FixScroll=iD;self.SetMaxHeight=iP;self.GetRightBorderWidth=iQ;self.GetLeftBorderWidth=iR;self.items={}self.scrollStatus={scrollvalue=0}self.maxHeight=iw;bx:SetBackdrop(it)bx:SetBackdropColor(0,0,0)bx:SetFrameStrata("FULLSCREEN_DIALOG")bx:SetClampedToScreen(true)bx:SetWidth(iv)bx:SetHeight(self.maxHeight)local iT=CreateFrame("ScrollFrame",nil,bx)local iK=CreateFrame("Frame",nil,iT)self.scrollFrame=iT;self.itemFrame=iK;iT.obj=self;iK.obj=self;local iU=CreateFrame("Slider","AceGUI30PulloutScrollbar"..iS,iT,"BackdropTemplate")iU:SetOrientation("VERTICAL")iU:SetHitRectInsets(0,0,-10,0)iU:SetBackdrop(iu)iU:SetWidth(8)iU:SetThumbTexture("Interface\\Buttons\\UI-SliderBar-Button-Vertical")iU:SetFrameStrata("FULLSCREEN_DIALOG")self.slider=iU;iU.obj=self;iT:SetScrollChild(iK)iT:SetPoint("TOPLEFT",bx,"TOPLEFT",6,-12)iT:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",-6,12)iT:EnableMouseWheel(true)iT:SetScript("OnMouseWheel",iz)iT:SetScript("OnSizeChanged",iA)iT:SetToplevel(true)iT:SetFrameStrata("FULLSCREEN_DIALOG")iK:SetPoint("TOPLEFT",iT,"TOPLEFT",0,0)iK:SetPoint("TOPRIGHT",iT,"TOPRIGHT",-12,0)iK:SetHeight(400)iK:SetToplevel(true)iK:SetFrameStrata("FULLSCREEN_DIALOG")iU:SetPoint("TOPLEFT",iT,"TOPRIGHT",-16,0)iU:SetPoint("BOTTOMLEFT",iT,"BOTTOMRIGHT",-16,0)iU:SetScript("OnValueChanged",gY)iU:SetMinMaxValues(0,1000)iU:SetValueStep(1)iU:SetValue(0)iT:Show()iK:Show()iU:Hide()self:FixScroll()df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,is)end;do local dr="Dropdown"local is=36;local function hV(ay)ay.obj.button:LockHighlight()ay.obj:Fire("OnEnter")end;local function hW(ay)ay.obj.button:UnlockHighlight()ay.obj:Fire("OnLeave")end;local function iV(ay)local self=ay.obj;if self.open then self.pullout:Close()end end;local function iW(ay)local self=ay.obj;if self.open then self.open=nil;self.pullout:Close()df:ClearFocus()else self.open=true;self.pullout:SetWidth(self.pulloutWidth or self.frame:GetWidth())self.pullout:Open("TOPLEFT",self.frame,"BOTTOMLEFT",0,self.label:IsShown()and-2 or 0)df:SetFocus(self)end end;local function iX(ay)local self=ay.userdata.obj;local by=self.value;if not self.multiselect then for M,iy in ay:IterateItems()do iy:SetValue(iy.userdata.value==by)end end;self.open=true;self:Fire("OnOpened")end;local function iY(ay)local self=ay.userdata.obj;self.open=nil;self:Fire("OnClosed")end;local function iZ(self)local fh;for M,dt in self.pullout:IterateItems()do if dt.type=="Dropdown-Item-Toggle"then if dt:GetValue()then if fh then fh=fh..", "..dt:GetText()else fh=dt:GetText()end end end end;self:SetText(fh)end;local function i_(ay,F,j0)local self=ay.userdata.obj;if self.multiselect then self:Fire("OnValueChanged",ay.userdata.value,j0)iZ(self)else if j0 then self:SetValue(ay.userdata.value)self:Fire("OnValueChanged",ay.userdata.value)else ay:SetValue(true)end;if self.open then self.pullout:Close()end end end;local function hF(self)local j1=df:Create("Dropdown-Pullout")self.pullout=j1;j1.userdata.obj=self;j1:SetCallback("OnClose",iY)j1:SetCallback("OnOpen",iX)self.pullout.frame:SetFrameLevel(self.frame:GetFrameLevel()+1)ip(self.pullout.frame,self.pullout.frame:GetChildren())self:SetHeight(44)self:SetWidth(200)self:SetLabel()self:SetPulloutWidth(nil)self.list={}end;local function hG(self)if self.open then self.pullout:Close()end;df:Release(self.pullout)self.pullout=nil;self:SetText("")self:SetDisabled(false)self:SetMultiselect(false)self.value=nil;self.list=nil;self.open=nil;self.hasClose=nil;self.frame:ClearAllPoints()self.frame:Hide()end;local function j2(self,gg)self.disabled=gg;if gg then self.text:SetTextColor(0.5,0.5,0.5)self.button:Disable()self.button_cover:Disable()self.label:SetTextColor(0.5,0.5,0.5)else self.button:Enable()self.button_cover:Enable()self.label:SetTextColor(1,.82,0)self.text:SetTextColor(1,1,1)end end;local function j3(self)if self.open then self.pullout:Close()end end;local function j4(self,fh)self.text:SetText(fh or"")end;local function j5(self,fh)if fh and fh~=""then self.label:SetText(fh)self.label:Show()self.dropdown:SetPoint("TOPLEFT",self.frame,"TOPLEFT",-15,-14)self:SetHeight(40)self.alignoffset=26 else self.label:SetText("")self.label:Hide()self.dropdown:SetPoint("TOPLEFT",self.frame,"TOPLEFT",-15,0)self:SetHeight(26)self.alignoffset=12 end end;local function j6(self,by)self:SetText(self.list[by]or"")self.value=by end;local function j7(self)return self.value end;local function j8(self,iy,by)if not self.multiselect then return end;for M,dt in self.pullout:IterateItems()do if dt.userdata.value==iy then if dt.SetValue then dt:SetValue(by)end end end;iZ(self)end;local function j9(self,iy,gg)for M,dt in self.pullout:IterateItems()do if dt.userdata.value==iy then dt:SetDisabled(gg)end end end;local function ja(self,by,fh,jb)if not jb then jb="Dropdown-Item-Toggle"end;local jc=df:GetWidgetVersion(jb)if not jc then error(("The given item type, %q, does not exist within AceGUI-3.0"):format(tostring(jb)),2)end;local iy=df:Create(jb)iy:SetText(fh)iy.userdata.obj=self;iy.userdata.value=by;iy:SetCallback("OnValueChanged",i_)self.pullout:AddItem(iy)end;local function jd(self)if not self.hasClose then local hT=df:Create("Dropdown-Item-Execute")hT:SetText(CLOSE)self.pullout:AddItem(hT)self.hasClose=true end end;local je={}local function jf(x,y)local jg,jh=tonumber(x),tonumber(y)if jg and jh then return jg<jh else return tostring(x)<tostring(y)end end;local function ji(self,eZ,e_,jb)self.list=eZ or{}self.pullout:Clear()self.hasClose=nil;if not eZ then return end;if type(e_)~="table"then for ae in pairs(eZ)do je[#je+1]=ae end;io(je,jf)for M,o in ipairs(je)do ja(self,o,eZ[o],jb)je[M]=nil end else for M,o in ipairs(e_)do ja(self,o,eZ[o],jb)end end;if self.multiselect then iZ(self)jd(self)end end;local function iE(self,by,fh,jb)self.list[by]=fh;ja(self,by,fh,jb)end;local function jj(self,jk)self.multiselect=jk;if jk then iZ(self)jd(self)end end;local function jl(self)return self.multiselect end;local function jm(self,dx)self.pulloutWidth=dx end;local function dK()local iS=df:GetNextWidgetNum(dr)local bx=CreateFrame("Frame",nil,UIParent)local f2=CreateFrame("Frame","AceGUI30DropDown"..iS,bx,"UIDropDownMenuTemplate")local self={}self.type=dr;self.frame=bx;self.dropdown=f2;self.count=iS;bx.obj=self;f2.obj=self;self.OnRelease=hG;self.OnAcquire=hF;self.ClearFocus=j3;self.SetText=j4;self.SetValue=j6;self.GetValue=j7;self.SetList=ji;self.SetLabel=j5;self.SetDisabled=j2;self.AddItem=iE;self.SetMultiselect=jj;self.GetMultiselect=jl;self.SetItemValue=j8;self.SetItemDisabled=j9;self.SetPulloutWidth=jm;self.alignoffset=26;bx:SetScript("OnHide",iV)f2:ClearAllPoints()f2:SetPoint("TOPLEFT",bx,"TOPLEFT",-15,0)f2:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",17,0)f2:SetScript("OnHide",nil)local fY=_G[f2:GetName().."Left"]local g4=_G[f2:GetName().."Middle"]local g5=_G[f2:GetName().."Right"]g4:ClearAllPoints()g5:ClearAllPoints()g4:SetPoint("LEFT",fY,"RIGHT",0,0)g4:SetPoint("RIGHT",g5,"LEFT",0,0)g5:SetPoint("TOPRIGHT",f2,"TOPRIGHT",0,17)local gE=_G[f2:GetName().."Button"]self.button=gE;gE.obj=self;gE:SetScript("OnEnter",hV)gE:SetScript("OnLeave",hW)gE:SetScript("OnClick",iW)local jn=CreateFrame("BUTTON",nil,self.frame)self.button_cover=jn;jn.obj=self;jn:SetPoint("TOPLEFT",self.frame,"BOTTOMLEFT",0,25)jn:SetPoint("BOTTOMRIGHT",self.frame,"BOTTOMRIGHT")jn:SetScript("OnEnter",hV)jn:SetScript("OnLeave",hW)jn:SetScript("OnClick",iW)local fh=_G[f2:GetName().."Text"]self.text=fh;fh.obj=self;fh:ClearAllPoints()fh:SetPoint("RIGHT",g5,"RIGHT",-43,2)fh:SetPoint("LEFT",fY,"LEFT",25,2)local eU=bx:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eU:SetPoint("TOPLEFT",bx,"TOPLEFT",0,0)eU:SetPoint("TOPRIGHT",bx,"TOPRIGHT",0,0)eU:SetJustifyH("LEFT")eU:SetHeight(18)eU:Hide()self.label=eU;df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,is)end end;local function jo(...)local df=LibStub("AceGUI-3.0")local select,assert=select,assert;local PlaySound=PlaySound;local CreateFrame=CreateFrame;local function ip(cd,...)local M=1;local dB=select(M,...)while dB do dB:SetFrameLevel(cd:GetFrameLevel()+1)ip(dB,dB:GetChildren())M=M+1;dB=select(M,...)end end;local function iq(ir,cd,...)local M=1;local dB=select(M,...)cd:SetFrameStrata(ir)while dB do iq(ir,dB,dB:GetChildren())M=M+1;dB=select(M,...)end end;local jp={version=2000,counter=0}function jp.Frame_OnEnter(ay)local self=ay.obj;if self.useHighlight then self.highlight:Show()end;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end end;function jp.Frame_OnLeave(ay)local self=ay.obj;self.highlight:Hide()self:Fire("OnLeave")if self.specialOnLeave then self.specialOnLeave(self)end end;function jp.OnAcquire(self)self.frame:SetToplevel(true)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")end;function jp.OnRelease(self)self:SetDisabled(false)self.pullout=nil;self.frame:SetParent(nil)self.frame:ClearAllPoints()self.frame:Hide()end;function jp.SetPullout(self,j1)self.pullout=j1;self.frame:SetParent(nil)self.frame:SetParent(j1.itemFrame)self.parent=j1.itemFrame;ip(j1.itemFrame,j1.itemFrame:GetChildren())end;function jp.SetText(self,fh)self.text:SetText(fh or"")end;function jp.GetText(self)return self.text:GetText()end;function jp.SetPoint(self,...)self.frame:SetPoint(...)end;function jp.Show(self)self.frame:Show()end;function jp.Hide(self)self.frame:Hide()end;function jp.SetDisabled(self,gg)self.disabled=gg;if gg then self.useHighlight=false;self.text:SetTextColor(.5,.5,.5)else self.useHighlight=true;self.text:SetTextColor(1,1,1)end end;function jp.SetOnLeave(self,J)self.specialOnLeave=J end;function jp.SetOnEnter(self,J)self.specialOnEnter=J end;function jp.Create(type)local iS=df:GetNextWidgetNum(type)local bx=CreateFrame("Button","AceGUI30DropDownItem"..iS)local self={}self.frame=bx;bx.obj=self;self.type=type;self.useHighlight=true;bx:SetHeight(17)bx:SetFrameStrata("FULLSCREEN_DIALOG")local fh=bx:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")fh:SetTextColor(1,1,1)fh:SetJustifyH("LEFT")fh:SetPoint("TOPLEFT",bx,"TOPLEFT",18,0)fh:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",-8,0)self.text=fh;local i5=bx:CreateTexture(nil,"OVERLAY")i5:SetTexture(136810)i5:SetBlendMode("ADD")i5:SetHeight(14)i5:ClearAllPoints()i5:SetPoint("RIGHT",bx,"RIGHT",-3,0)i5:SetPoint("LEFT",bx,"LEFT",5,0)i5:Hide()self.highlight=i5;local i2=bx:CreateTexture(nil,"OVERLAY")i2:SetWidth(16)i2:SetHeight(16)i2:SetPoint("LEFT",bx,"LEFT",3,-1)i2:SetTexture(130751)i2:Hide()self.check=i2;local jq=bx:CreateTexture(nil,"OVERLAY")jq:SetWidth(16)jq:SetHeight(16)jq:SetPoint("RIGHT",bx,"RIGHT",-3,-1)jq:SetTexture(130940)jq:Hide()self.sub=jq;bx:SetScript("OnEnter",jp.Frame_OnEnter)bx:SetScript("OnLeave",jp.Frame_OnLeave)self.OnAcquire=jp.OnAcquire;self.OnRelease=jp.OnRelease;self.SetPullout=jp.SetPullout;self.GetText=jp.GetText;self.SetText=jp.SetText;self.SetDisabled=jp.SetDisabled;self.SetPoint=jp.SetPoint;self.Show=jp.Show;self.Hide=jp.Hide;self.SetOnLeave=jp.SetOnLeave;self.SetOnEnter=jp.SetOnEnter;return self end;local jr=LibStub:NewLibrary("AceGUI-3.0-DropDown-ItemBase",jp.version)if jr then jr.GetItemBase=function()return jp end end;do local dr="Dropdown-Item-Header"local is=1;local function ix(ay)local self=ay.obj;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end end;local function js(ay)local self=ay.obj;self:Fire("OnLeave")if self.specialOnLeave then self.specialOnLeave(self)end end;local function j2(self,gg)jp.SetDisabled(self,gg)if not gg then self.text:SetTextColor(1,1,0)end end;local function dK()local self=jp.Create(dr)self.SetDisabled=j2;self.frame:SetScript("OnEnter",ix)self.frame:SetScript("OnLeave",js)self.text:SetTextColor(1,1,0)df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,is+jp.version)end;do local dr="Dropdown-Item-Execute"local is=1;local function jt(ay,gE)local self=ay.obj;if self.disabled then return end;self:Fire("OnClick")if self.pullout then self.pullout:Close()end end;local function dK()local self=jp.Create(dr)self.frame:SetScript("OnClick",jt)df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,is+jp.version)end;do local dr="Dropdown-Item-Toggle"local is=4;local function ju(self)if self.value then self.check:Show()else self.check:Hide()end end;local function hG(self)jp.OnRelease(self)self:SetValue(nil)end;local function jt(ay,gE)local self=ay.obj;if self.disabled then return end;self.value=not self.value;if self.value then PlaySound(856)else PlaySound(857)end;ju(self)self:Fire("OnValueChanged",self.value)end;local function j6(self,by)self.value=by;ju(self)end;local function j7(self)return self.value end;local function dK()local self=jp.Create(dr)self.frame:SetScript("OnClick",jt)self.SetValue=j6;self.GetValue=j7;self.OnRelease=hG;df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,is+jp.version)end;do local dr="Dropdown-Item-Menu"local is=2;local function ix(ay)local self=ay.obj;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end;self.highlight:Show()if not self.disabled and self.submenu then self.submenu:Open("TOPLEFT",self.frame,"TOPRIGHT",self.pullout:GetRightBorderWidth(),0,self.frame:GetFrameLevel()+100)end end;local function eL(ay)local self=ay.obj;if self.submenu then self.submenu:Close()end end;local function jv(self,jw)assert(jw.type=="Dropdown-Pullout")self.submenu=jw end;local function jx(self)self.submenu:Close()end;local function dK()local self=jp.Create(dr)self.sub:Show()self.frame:SetScript("OnEnter",ix)self.frame:SetScript("OnHide",eL)self.SetMenu=jv;self.CloseMenu=jx;df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,is+jp.version)end;do local dr="Dropdown-Item-Separator"local is=2;local function j2(self,gg)jp.SetDisabled(self,gg)self.useHighlight=false end;local function dK()local self=jp.Create(dr)self.SetDisabled=j2;local gC=self.frame:CreateTexture(nil,"OVERLAY")gC:SetHeight(1)gC:SetColorTexture(.5,.5,.5)gC:SetPoint("LEFT",self.frame,"LEFT",10,0)gC:SetPoint("RIGHT",self.frame,"RIGHT",-10,0)self.text:Hide()self.useHighlight=false;df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,is+jp.version)end end;local function jy(...)local eJ,dL="EditBox",28;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local tostring,pairs=tostring,pairs;local PlaySound=PlaySound;local GetCursorInfo,ClearCursor,GetSpellInfo=GetCursorInfo,ClearCursor,GetSpellInfo;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIEditBoxInsertLink(...)end)end;function _G.AceGUIEditBoxInsertLink(fh)for M=1,df:GetWidgetCount(eJ)do local jz=_G["AceGUI-3.0EditBox"..M]if jz and jz:IsVisible()and jz:HasFocus()then jz:Insert(fh)return true end end end;local function jA(self)if not self.disablebutton then self.button:Show()self.editbox:SetTextInsets(0,20,3,3)end end;local function jB(self)self.button:Hide()self.editbox:SetTextInsets(0,0,3,3)end;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local function jC(bx)bx.obj.editbox:SetFocus()bx:SetScript("OnShow",nil)end;local function jD(bx)df:ClearFocus()end;local function jE(bx)local self=bx.obj;local by=bx:GetText()local eN=self:Fire("OnEnterPressed",by)if not eN then PlaySound(856)jB(self)end end;local function jF(bx)local self=bx.obj;local type,aN,cB=GetCursorInfo()local aa;if type=="item"then aa=cB elseif type=="spell"then aa=GetSpellInfo(aN,cB)elseif type=="macro"then aa=GetMacroInfo(aN)end;if aa then self:SetText(aa)self:Fire("OnEnterPressed",aa)ClearCursor()jB(self)df:ClearFocus()end end;local function jG(bx)local self=bx.obj;local by=bx:GetText()if tostring(by)~=tostring(self.lasttext)then self:Fire("OnTextChanged",by)self.lasttext=by;jA(self)end end;local function jH(bx)df:SetFocus(bx.obj)end;local function f5(bx)local jz=bx.obj.editbox;jz:ClearFocus()jE(jz)end;local eQ={["OnAcquire"]=function(self)self:SetWidth(200)self:SetDisabled(false)self:SetLabel()self:SetText()self:DisableButton(false)self:SetMaxLetters(0)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gg)self.disabled=gg;if gg then self.editbox:EnableMouse(false)self.editbox:ClearFocus()self.editbox:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)else self.editbox:EnableMouse(true)self.editbox:SetTextColor(1,1,1)self.label:SetTextColor(1,.82,0)end end,["SetText"]=function(self,fh)self.lasttext=fh or""self.editbox:SetText(fh or"")self.editbox:SetCursorPosition(0)jB(self)end,["GetText"]=function(self,fh)return self.editbox:GetText()end,["SetLabel"]=function(self,fh)if fh and fh~=""then self.label:SetText(fh)self.label:Show()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,-18)self:SetHeight(44)self.alignoffset=30 else self.label:SetText("")self.label:Hide()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,0)self:SetHeight(26)self.alignoffset=12 end end,["DisableButton"]=function(self,gg)self.disablebutton=gg;if gg then jB(self)end end,["SetMaxLetters"]=function(self,fF)self.editbox:SetMaxLetters(fF or 0)end,["ClearFocus"]=function(self)self.editbox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editbox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",jC)end end,["HighlightText"]=function(self,eb,ec)self.editbox:HighlightText(eb,ec)end}local function dK()local fF=df:GetNextWidgetNum(eJ)local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local jz=CreateFrame("EditBox","AceGUI-3.0EditBox"..fF,bx,"InputBoxTemplate")jz:SetAutoFocus(false)jz:SetFontObject(ChatFontNormal)jz:SetScript("OnEnter",hV)jz:SetScript("OnLeave",hW)jz:SetScript("OnEscapePressed",jD)jz:SetScript("OnEnterPressed",jE)jz:SetScript("OnTextChanged",jG)jz:SetScript("OnReceiveDrag",jF)jz:SetScript("OnMouseDown",jF)jz:SetScript("OnEditFocusGained",jH)jz:SetTextInsets(0,0,3,3)jz:SetMaxLetters(256)jz:SetPoint("BOTTOMLEFT",6,0)jz:SetPoint("BOTTOMRIGHT")jz:SetHeight(19)local eU=bx:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eU:SetPoint("TOPLEFT",0,-2)eU:SetPoint("TOPRIGHT",0,-2)eU:SetJustifyH("LEFT")eU:SetHeight(18)local gE=CreateFrame("Button",nil,jz,"UIPanelButtonTemplate")gE:SetWidth(40)gE:SetHeight(20)gE:SetPoint("RIGHT",-2,0)gE:SetText(OKAY)gE:SetScript("OnClick",f5)gE:Hide()local dt={alignoffset=30,editbox=jz,label=eU,button=gE,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;jz.obj,gE.obj=dt,dt;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function jI(...)local eJ,dL="Heading",20;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eQ={["OnAcquire"]=function(self)self:SetText()self:SetFullWidth()self:SetHeight(18)end,["SetText"]=function(self,fh)self.label:SetText(fh or"")if fh and fh~=""then self.left:SetPoint("RIGHT",self.label,"LEFT",-5,0)self.right:Show()else self.left:SetPoint("RIGHT",-3,0)self.right:Hide()end end}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local eU=bx:CreateFontString(nil,"BACKGROUND","GameFontNormal")eU:SetPoint("TOP")eU:SetPoint("BOTTOM")eU:SetJustifyH("CENTER")local fY=bx:CreateTexture(nil,"BACKGROUND")fY:SetHeight(8)fY:SetPoint("LEFT",3,0)fY:SetPoint("RIGHT",eU,"LEFT",-5,0)fY:SetTexture(137057)fY:SetTexCoord(0.81,0.94,0.5,1)local g5=bx:CreateTexture(nil,"BACKGROUND")g5:SetHeight(8)g5:SetPoint("RIGHT",-3,0)g5:SetPoint("LEFT",eU,"RIGHT",5,0)g5:SetTexture(137057)g5:SetTexCoord(0.81,0.94,0.5,1)local dt={label=eU,left=fY,right=g5,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function jJ(...)local eJ,dL="Icon",21;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local select,pairs,print=select,pairs,print;local CreateFrame,UIParent=CreateFrame,UIParent;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local function f5(bx,gE)bx.obj:Fire("OnClick",gE)df:ClearFocus()end;local eQ={["OnAcquire"]=function(self)self:SetHeight(110)self:SetWidth(110)self:SetLabel()self:SetImage(nil)self:SetImageSize(64,64)self:SetDisabled(false)end,["SetLabel"]=function(self,fh)if fh and fh~=""then self.label:Show()self.label:SetText(fh)self:SetHeight(self.image:GetHeight()+25)else self.label:Hide()self:SetHeight(self.image:GetHeight()+10)end end,["SetImage"]=function(self,hk,...)local i8=self.image;i8:SetTexture(hk)if i8:GetTexture()then local d0=select("#",...)if d0==4 or d0==8 then i8:SetTexCoord(...)else i8:SetTexCoord(0,1,0,1)end end end,["SetImageSize"]=function(self,dx,dy)self.image:SetWidth(dx)self.image:SetHeight(dy)if self.label:IsShown()then self:SetHeight(dy+25)else self:SetHeight(dy+10)end end,["SetDisabled"]=function(self,gg)self.disabled=gg;if gg then self.frame:Disable()self.label:SetTextColor(0.5,0.5,0.5)self.image:SetVertexColor(0.5,0.5,0.5,0.5)else self.frame:Enable()self.label:SetTextColor(1,1,1)self.image:SetVertexColor(1,1,1,1)end end}local function dK()local bx=CreateFrame("Button",nil,UIParent)bx:Hide()bx:EnableMouse(true)bx:SetScript("OnEnter",hV)bx:SetScript("OnLeave",hW)bx:SetScript("OnClick",f5)local eU=bx:CreateFontString(nil,"BACKGROUND","GameFontHighlight")eU:SetPoint("BOTTOMLEFT")eU:SetPoint("BOTTOMRIGHT")eU:SetJustifyH("CENTER")eU:SetJustifyV("TOP")eU:SetHeight(18)local i8=bx:CreateTexture(nil,"BACKGROUND")i8:SetWidth(64)i8:SetHeight(64)i8:SetPoint("TOP",0,-5)local i5=bx:CreateTexture(nil,"HIGHLIGHT")i5:SetAllPoints(i8)i5:SetTexture(136580)i5:SetTexCoord(0,1,0.23,0.77)i5:SetBlendMode("ADD")local dt={label=eU,image=i8,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;dt.SetText=function(self,...)print("AceGUI-3.0-Icon: SetText is deprecated! Use SetLabel instead!")self:SetLabel(...)end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function jK(...)local eJ,dL="InteractiveLabel",21;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local select,pairs=select,pairs;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local function jL(bx,gE)bx.obj:Fire("OnClick",gE)df:ClearFocus()end;local eQ={["OnAcquire"]=function(self)self:LabelOnAcquire()self:SetHighlight()self:SetHighlightTexCoord()self:SetDisabled(false)end,["SetHighlight"]=function(self,...)self.highlight:SetTexture(...)end,["SetHighlightTexCoord"]=function(self,...)local jM=select("#",...)if jM==4 or jM==8 then self.highlight:SetTexCoord(...)else self.highlight:SetTexCoord(0,1,0,1)end end,["SetDisabled"]=function(self,gg)self.disabled=gg;if gg then self.frame:EnableMouse(false)self.label:SetTextColor(0.5,0.5,0.5)else self.frame:EnableMouse(true)self.label:SetTextColor(1,1,1)end end}local function dK()local eU=df:Create("Label")local bx=eU.frame;bx:EnableMouse(true)bx:SetScript("OnEnter",hV)bx:SetScript("OnLeave",hW)bx:SetScript("OnMouseDown",jL)local i5=bx:CreateTexture(nil,"HIGHLIGHT")i5:SetTexture(nil)i5:SetAllPoints()i5:SetBlendMode("ADD")eU.highlight=i5;eU.type=eJ;eU.LabelOnAcquire=eU.OnAcquire;for s,J in pairs(eQ)do eU[s]=J end;return eU end;df:RegisterWidgetType(eJ,dK,dL)end;local function jN(...)local eJ,dL="Keybinding",26;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs=pairs;local IsShiftKeyDown,IsControlKeyDown,IsAltKeyDown=IsShiftKeyDown,IsControlKeyDown,IsAltKeyDown;local CreateFrame,UIParent=CreateFrame,UIParent;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local function jO(bx,gE)if gE=="LeftButton"or gE=="RightButton"then local self=bx.obj;if self.waitingForKey then bx:EnableKeyboard(false)bx:EnableMouseWheel(false)self.msgframe:Hide()bx:UnlockHighlight()self.waitingForKey=nil else bx:EnableKeyboard(true)bx:EnableMouseWheel(true)self.msgframe:Show()bx:LockHighlight()self.waitingForKey=true end end;df:ClearFocus()end;local jP={["BUTTON1"]=true,["BUTTON2"]=true,["UNKNOWN"]=true,["LSHIFT"]=true,["LCTRL"]=true,["LALT"]=true,["RSHIFT"]=true,["RCTRL"]=true,["RALT"]=true}local function jQ(bx,o)local self=bx.obj;if self.waitingForKey then local jR=o;if jR=="ESCAPE"then jR=""else if jP[jR]then return end;if IsShiftKeyDown()then jR="SHIFT-"..jR end;if IsControlKeyDown()then jR="CTRL-"..jR end;if IsAltKeyDown()then jR="ALT-"..jR end end;bx:EnableKeyboard(false)bx:EnableMouseWheel(false)self.msgframe:Hide()bx:UnlockHighlight()self.waitingForKey=nil;if not self.disabled then self:SetKey(jR)self:Fire("OnKeyChanged",jR)end end end;local function jS(bx,gE)if gE=="LeftButton"or gE=="RightButton"then return elseif gE=="MiddleButton"then gE="BUTTON3"elseif gE=="Button4"then gE="BUTTON4"elseif gE=="Button5"then gE="BUTTON5"end;jQ(bx,gE)end;local function jT(bx,jU)local gE;if jU>=0 then gE="MOUSEWHEELUP"else gE="MOUSEWHEELDOWN"end;jQ(bx,gE)end;local eQ={["OnAcquire"]=function(self)self:SetWidth(200)self:SetLabel("")self:SetKey("")self.waitingForKey=nil;self.msgframe:Hide()self:SetDisabled(false)self.button:EnableKeyboard(false)self.button:EnableMouseWheel(false)end,["SetDisabled"]=function(self,gg)self.disabled=gg;if gg then self.button:Disable()self.label:SetTextColor(0.5,0.5,0.5)else self.button:Enable()self.label:SetTextColor(1,1,1)end end,["SetKey"]=function(self,o)if(o or"")==""then self.button:SetText(NOT_BOUND)self.button:SetNormalFontObject("GameFontNormal")else self.button:SetText(o)self.button:SetNormalFontObject("GameFontHighlight")end end,["GetKey"]=function(self)local o=self.button:GetText()if o==NOT_BOUND then o=nil end;return o end,["SetLabel"]=function(self,eU)self.label:SetText(eU or"")if(eU or"")==""then self.alignoffset=nil;self:SetHeight(24)else self.alignoffset=30;self:SetHeight(44)end end}local jV={bgFile="Interface\\Tooltips\\UI-Tooltip-Background",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=3,bottom=3}}local function jW(bx)bx:SetWidth(bx.msg:GetWidth()+10)bx:SetScript("OnUpdate",nil)end;local function dK()local aa="AceGUI30KeybindingButton"..df:GetNextWidgetNum(eJ)local bx=CreateFrame("Frame",nil,UIParent)local gE=CreateFrame("Button",aa,bx,"UIPanelButtonTemplate")gE:EnableMouse(true)gE:EnableMouseWheel(false)gE:RegisterForClicks("AnyDown")gE:SetScript("OnEnter",hV)gE:SetScript("OnLeave",hW)gE:SetScript("OnClick",jO)gE:SetScript("OnKeyDown",jQ)gE:SetScript("OnMouseDown",jS)gE:SetScript("OnMouseWheel",jT)gE:SetPoint("BOTTOMLEFT")gE:SetPoint("BOTTOMRIGHT")gE:SetHeight(24)gE:EnableKeyboard(false)local fh=gE:GetFontString()fh:SetPoint("LEFT",7,0)fh:SetPoint("RIGHT",-7,0)local eU=bx:CreateFontString(nil,"OVERLAY","GameFontHighlight")eU:SetPoint("TOPLEFT")eU:SetPoint("TOPRIGHT")eU:SetJustifyH("CENTER")eU:SetHeight(18)local jX=CreateFrame("Frame",nil,UIParent,"BackdropTemplate")jX:SetHeight(30)jX:SetBackdrop(jV)jX:SetBackdropColor(0,0,0)jX:SetFrameStrata("FULLSCREEN_DIALOG")jX:SetFrameLevel(1000)jX:SetToplevel(true)local jY=jX:CreateFontString(nil,"OVERLAY","GameFontNormal")jY:SetText("Press a key to bind, ESC to clear the binding or click the button again to cancel.")jX.msg=jY;jY:SetPoint("TOPLEFT",5,-5)jX:SetScript("OnUpdate",jW)jX:SetPoint("BOTTOM",gE,"TOP")jX:Hide()local dt={button=gE,label=eU,msgframe=jX,frame=bx,alignoffset=30,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;gE.obj=dt;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function jZ(...)local eJ,dL="Label",28;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local cY,select,pairs=math.max,select,pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local function j_(self)if self.resizing then return end;local bx=self.frame;local dx=bx.width or bx:GetWidth()or 0;local i8=self.image;local eU=self.label;local dy;eU:ClearAllPoints()i8:ClearAllPoints()if self.imageshown then local k0=i8:GetWidth()if dx-k0<200 or(eU:GetText()or"")==""then i8:SetPoint("TOP")eU:SetPoint("TOP",i8,"BOTTOM")eU:SetPoint("LEFT")eU:SetWidth(dx)dy=i8:GetHeight()+eU:GetStringHeight()else i8:SetPoint("TOPLEFT")if i8:GetHeight()>eU:GetStringHeight()then eU:SetPoint("LEFT",i8,"RIGHT",4,0)else eU:SetPoint("TOPLEFT",i8,"TOPRIGHT",4,0)end;eU:SetWidth(dx-k0-4)dy=cY(i8:GetHeight(),eU:GetStringHeight())end else eU:SetPoint("TOPLEFT")eU:SetWidth(dx)dy=eU:GetStringHeight()end;if not dy or dy==0 then dy=1 end;self.resizing=true;bx:SetHeight(dy)bx.height=dy;self.resizing=nil end;local eQ={["OnAcquire"]=function(self)self.resizing=true;self:SetWidth(200)self:SetText()self:SetImage(nil)self:SetImageSize(16,16)self:SetColor()self:SetFontObject()self:SetJustifyH("LEFT")self:SetJustifyV("TOP")self.resizing=nil;j_(self)end,["OnWidthSet"]=function(self,dx)j_(self)end,["SetText"]=function(self,fh)self.label:SetText(fh)j_(self)end,["SetColor"]=function(self,ib,ic,id)if not(ib and ic and id)then ib,ic,id=1,1,1 end;self.label:SetVertexColor(ib,ic,id)end,["SetImage"]=function(self,hk,...)local i8=self.image;i8:SetTexture(hk)if i8:GetTexture()then self.imageshown=true;local d0=select("#",...)if d0==4 or d0==8 then i8:SetTexCoord(...)else i8:SetTexCoord(0,1,0,1)end else self.imageshown=nil end;j_(self)end,["SetFont"]=function(self,k1,dy,k2)if not self.fontObject then self.fontObject=CreateFont("AceGUI30LabelFont"..df:GetNextWidgetNum(eJ))end;self.fontObject:SetFont(k1,dy,k2)self:SetFontObject(self.fontObject)end,["SetFontObject"]=function(self,k1)self.label:SetFontObject(k1 or GameFontHighlightSmall)j_(self)end,["SetImageSize"]=function(self,dx,dy)self.image:SetWidth(dx)self.image:SetHeight(dy)j_(self)end,["SetJustifyH"]=function(self,k3)self.label:SetJustifyH(k3)end,["SetJustifyV"]=function(self,k4)self.label:SetJustifyV(k4)end}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local eU=bx:CreateFontString(nil,"BACKGROUND","GameFontHighlightSmall")local i8=bx:CreateTexture(nil,"BACKGROUND")local dt={label=eU,image=i8,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function k5(...)local eJ,dL="MultiLineEditBox",32;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local pairs=pairs;local GetCursorInfo,GetSpellInfo,ClearCursor=GetCursorInfo,GetSpellInfo,ClearCursor;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIMultiLineEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIMultiLineEditBoxInsertLink(...)end)end;function _G.AceGUIMultiLineEditBoxInsertLink(fh)for M=1,df:GetWidgetCount(eJ)do local jz=_G[("MultiLineEditBox%uEdit"):format(M)]if jz and jz:IsVisible()and jz:HasFocus()then jz:Insert(fh)return true end end end;local function dF(self)self:SetHeight(self.numlines*14+(self.disablebutton and 19 or 41)+self.labelHeight)if self.labelHeight==0 then self.scrollBar:SetPoint("TOP",self.frame,"TOP",0,-23)else self.scrollBar:SetPoint("TOP",self.label,"BOTTOM",0,-19)end;if self.disablebutton then self.scrollBar:SetPoint("BOTTOM",self.frame,"BOTTOM",0,21)self.scrollBG:SetPoint("BOTTOMLEFT",0,4)else self.scrollBar:SetPoint("BOTTOM",self.button,"TOP",0,18)self.scrollBG:SetPoint("BOTTOMLEFT",self.button,"TOPLEFT")end end;local function k6(self)self=self.obj;self.editBox:ClearFocus()if not self:Fire("OnEnterPressed",self.editBox:GetText())then self.button:Disable()end end;local function k7(self,aV,y,aV,k8)self,y=self.obj.scrollFrame,-y;local ag=self:GetVerticalScroll()if y<ag then self:SetVerticalScroll(y)else y=y+k8-self:GetHeight()if y>ag then self:SetVerticalScroll(y)end end end;local function k9(self)self:HighlightText(0,0)self.obj:Fire("OnEditFocusLost")end;local function ix(self)self=self.obj;if not self.entered then self.entered=true;self:Fire("OnEnter")end end;local function js(self)self=self.obj;if self.entered then self.entered=nil;self:Fire("OnLeave")end end;local function ka(self)self=self.obj.editBox;self:SetFocus()self:SetCursorPosition(self:GetNumLetters())end;local function kb(self)local type,aN,cB=GetCursorInfo()if type=="spell"then cB=GetSpellInfo(aN,cB)elseif type~="item"then return end;ClearCursor()self=self.obj;local d4=self.editBox;if not d4:HasFocus()then d4:SetFocus()d4:SetCursorPosition(d4:GetNumLetters())end;d4:Insert(cB)self.button:Enable()end;local function iA(self,dx,dy)self.obj.editBox:SetWidth(dx)end;local function kc(self,kd)if kd then self=self.obj;self:Fire("OnTextChanged",self.editBox:GetText())self.button:Enable()end end;local function ke(self)self:HighlightText(0,0)self:SetCursorPosition(self:GetNumLetters())self:SetCursorPosition(0)self.obj.button:Disable()end;local function kf(self,ag)local d4=self.obj.editBox;d4:SetHitRectInsets(0,0,ag,d4:GetHeight()-ag-self:GetHeight())end;local function kg(self,kh,ki)if ki==0 then self.obj.editBox:SetHitRectInsets(0,0,0,0)else kf(self,self:GetVerticalScroll())end end;local function kj(bx)bx.obj.editBox:SetFocus()bx:SetScript("OnShow",nil)end;local function kk(bx)df:SetFocus(bx.obj)bx.obj:Fire("OnEditFocusGained")end;local eQ={["OnAcquire"]=function(self)self.editBox:SetText("")self:SetDisabled(false)self:SetWidth(200)self:DisableButton(false)self:SetNumLines()self.entered=nil;self:SetMaxLetters(0)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gg)local d4=self.editBox;if gg then d4:ClearFocus()d4:EnableMouse(false)d4:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)self.scrollFrame:EnableMouse(false)self.button:Disable()else d4:EnableMouse(true)d4:SetTextColor(1,1,1)self.label:SetTextColor(1,0.82,0)self.scrollFrame:EnableMouse(true)end end,["SetLabel"]=function(self,fh)if fh and fh~=""then self.label:SetText(fh)if self.labelHeight~=10 then self.labelHeight=10;self.label:Show()end elseif self.labelHeight~=0 then self.labelHeight=0;self.label:Hide()end;dF(self)end,["SetNumLines"]=function(self,by)if not by or by<4 then by=4 end;self.numlines=by;dF(self)end,["SetText"]=function(self,fh)self.editBox:SetText(fh)end,["GetText"]=function(self)return self.editBox:GetText()end,["SetMaxLetters"]=function(self,fF)self.editBox:SetMaxLetters(fF or 0)end,["DisableButton"]=function(self,gg)self.disablebutton=gg;if gg then self.button:Hide()else self.button:Show()end;dF(self)end,["ClearFocus"]=function(self)self.editBox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editBox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",kj)end end,["HighlightText"]=function(self,eb,ec)self.editBox:HighlightText(eb,ec)end,["GetCursorPosition"]=function(self)return self.editBox:GetCursorPosition()end,["SetCursorPosition"]=function(self,...)return self.editBox:SetCursorPosition(...)end}local it={bgFile=[[Interface\Tooltips\UI-Tooltip-Background]],edgeFile=[[Interface\Tooltips\UI-Tooltip-Border]],edgeSize=16,insets={left=4,right=3,top=4,bottom=3}}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local kl=df:GetNextWidgetNum(eJ)local eU=bx:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eU:SetPoint("TOPLEFT",bx,"TOPLEFT",0,-4)eU:SetPoint("TOPRIGHT",bx,"TOPRIGHT",0,-4)eU:SetJustifyH("LEFT")eU:SetText(ACCEPT)eU:SetHeight(10)local gE=CreateFrame("Button",("%s%dButton"):format(eJ,kl),bx,"UIPanelButtonTemplate")gE:SetPoint("BOTTOMLEFT",0,4)gE:SetHeight(22)gE:SetWidth(eU:GetStringWidth()+24)gE:SetText(ACCEPT)gE:SetScript("OnClick",k6)gE:Disable()local fh=gE:GetFontString()fh:ClearAllPoints()fh:SetPoint("TOPLEFT",gE,"TOPLEFT",5,-5)fh:SetPoint("BOTTOMRIGHT",gE,"BOTTOMRIGHT",-5,1)fh:SetJustifyV("MIDDLE")local km=CreateFrame("Frame",nil,bx,"BackdropTemplate")km:SetBackdrop(it)km:SetBackdropColor(0,0,0)km:SetBackdropBorderColor(0.4,0.4,0.4)local iT=CreateFrame("ScrollFrame",("%s%dScrollFrame"):format(eJ,kl),bx,"UIPanelScrollFrameTemplate")local kn=_G[iT:GetName().."ScrollBar"]kn:ClearAllPoints()kn:SetPoint("TOP",eU,"BOTTOM",0,-19)kn:SetPoint("BOTTOM",gE,"TOP",0,18)kn:SetPoint("RIGHT",bx,"RIGHT")km:SetPoint("TOPRIGHT",kn,"TOPLEFT",0,19)km:SetPoint("BOTTOMLEFT",gE,"TOPLEFT")iT:SetPoint("TOPLEFT",km,"TOPLEFT",5,-6)iT:SetPoint("BOTTOMRIGHT",km,"BOTTOMRIGHT",-4,4)iT:SetScript("OnEnter",ix)iT:SetScript("OnLeave",js)iT:SetScript("OnMouseUp",ka)iT:SetScript("OnReceiveDrag",kb)iT:SetScript("OnSizeChanged",iA)iT:HookScript("OnVerticalScroll",kf)iT:HookScript("OnScrollRangeChanged",kg)local d4=CreateFrame("EditBox",("%s%dEdit"):format(eJ,kl),iT)d4:SetAllPoints()d4:SetFontObject(ChatFontNormal)d4:SetMultiLine(true)d4:EnableMouse(true)d4:SetAutoFocus(false)d4:SetCountInvisibleLetters(false)d4:SetScript("OnCursorChanged",k7)d4:SetScript("OnEditFocusLost",k9)d4:SetScript("OnEnter",ix)d4:SetScript("OnEscapePressed",d4.ClearFocus)d4:SetScript("OnLeave",js)d4:SetScript("OnMouseDown",kb)d4:SetScript("OnReceiveDrag",kb)d4:SetScript("OnTextChanged",kc)d4:SetScript("OnTextSet",ke)d4:SetScript("OnEditFocusGained",kk)iT:SetScrollChild(d4)local dt={button=gE,editBox=d4,frame=bx,label=eU,labelHeight=10,numlines=4,scrollBar=kn,scrollBG=km,scrollFrame=iT,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;gE.obj,d4.obj,iT.obj=dt,dt,dt;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function ko(...)local eJ,dL="Slider",23;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local fw,cY,fx=math.min,math.max,math.floor;local tonumber,pairs=tonumber,pairs;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function kp(self)local by=self.value or 0;if self.ispercent then self.editbox:SetText(("%s%%"):format(fx(by*1000+0.5)/10))else self.editbox:SetText(fx(by*100+0.5)/100)end end;local function kq(self)local kr,ks=self.min or 0,self.max or 100;if self.ispercent then self.lowtext:SetFormattedText("%s%%",kr*100)self.hightext:SetFormattedText("%s%%",ks*100)else self.lowtext:SetText(kr)self.hightext:SetText(ks)end end;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local function f8(bx)bx.obj.slider:EnableMouseWheel(true)df:ClearFocus()end;local function kt(bx,h0)local self=bx.obj;if not bx.setup then if self.step and self.step>0 then local kr=self.min or 0;h0=fx((h0-kr)/self.step+0.5)*self.step+kr end;if h0~=self.value and not self.disabled then self.value=h0;self:Fire("OnValueChanged",h0)end;if self.value then kp(self)end end end;local function ku(bx)local self=bx.obj;self:Fire("OnMouseUp",self.value)end;local function kv(bx,ae)local self=bx.obj;if not self.disabled then local by=self.value;if ae>0 then by=fw(by+(self.step or 1),self.max)else by=cY(by-(self.step or 1),self.min)end;self.slider:SetValue(by)end end;local function jD(bx)bx:ClearFocus()end;local function jE(bx)local self=bx.obj;local by=bx:GetText()if self.ispercent then by=by:gsub('%%','')by=tonumber(by)/100 else by=tonumber(by)end;if by then PlaySound(856)self.slider:SetValue(by)self:Fire("OnMouseUp",by)end end;local function kw(bx)bx:SetBackdropBorderColor(0.5,0.5,0.5,1)end;local function kx(bx)bx:SetBackdropBorderColor(0.3,0.3,0.3,0.8)end;local eQ={["OnAcquire"]=function(self)self:SetWidth(200)self:SetHeight(44)self:SetDisabled(false)self:SetIsPercent(nil)self:SetSliderValues(0,100,1)self:SetValue(0)self.slider:EnableMouseWheel(false)end,["SetDisabled"]=function(self,gg)self.disabled=gg;if gg then self.slider:EnableMouse(false)self.label:SetTextColor(.5,.5,.5)self.hightext:SetTextColor(.5,.5,.5)self.lowtext:SetTextColor(.5,.5,.5)self.editbox:SetTextColor(.5,.5,.5)self.editbox:EnableMouse(false)self.editbox:ClearFocus()else self.slider:EnableMouse(true)self.label:SetTextColor(1,.82,0)self.hightext:SetTextColor(1,1,1)self.lowtext:SetTextColor(1,1,1)self.editbox:SetTextColor(1,1,1)self.editbox:EnableMouse(true)end end,["SetValue"]=function(self,by)self.slider.setup=true;self.slider:SetValue(by)self.value=by;kp(self)self.slider.setup=nil end,["GetValue"]=function(self)return self.value end,["SetLabel"]=function(self,fh)self.label:SetText(fh)end,["SetSliderValues"]=function(self,kr,ks,ky)local bx=self.slider;bx.setup=true;self.min=kr;self.max=ks;self.step=ky;bx:SetMinMaxValues(kr or 0,ks or 100)kq(self)bx:SetValueStep(ky or 1)if self.value then bx:SetValue(self.value)end;bx.setup=nil end,["SetIsPercent"]=function(self,by)self.ispercent=by;kq(self)kp(self)end}local kz={bgFile="Interface\\Buttons\\UI-SliderBar-Background",edgeFile="Interface\\Buttons\\UI-SliderBar-Border",tile=true,tileSize=8,edgeSize=8,insets={left=3,right=3,top=6,bottom=6}}local kA={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\ChatFrame\\ChatFrameBackground",tile=true,edgeSize=1,tileSize=5}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:EnableMouse(true)bx:SetScript("OnMouseDown",f8)local eU=bx:CreateFontString(nil,"OVERLAY","GameFontNormal")eU:SetPoint("TOPLEFT")eU:SetPoint("TOPRIGHT")eU:SetJustifyH("CENTER")eU:SetHeight(15)local iU=CreateFrame("Slider",nil,bx,"BackdropTemplate")iU:SetOrientation("HORIZONTAL")iU:SetHeight(15)iU:SetHitRectInsets(0,0,-10,0)iU:SetBackdrop(kz)iU:SetThumbTexture("Interface\\Buttons\\UI-SliderBar-Button-Horizontal")iU:SetPoint("TOP",eU,"BOTTOM")iU:SetPoint("LEFT",3,0)iU:SetPoint("RIGHT",-3,0)iU:SetValue(0)iU:SetScript("OnValueChanged",kt)iU:SetScript("OnEnter",hV)iU:SetScript("OnLeave",hW)iU:SetScript("OnMouseUp",ku)iU:SetScript("OnMouseWheel",kv)local kB=iU:CreateFontString(nil,"ARTWORK","GameFontHighlightSmall")kB:SetPoint("TOPLEFT",iU,"BOTTOMLEFT",2,3)local kC=iU:CreateFontString(nil,"ARTWORK","GameFontHighlightSmall")kC:SetPoint("TOPRIGHT",iU,"BOTTOMRIGHT",-2,3)local jz=CreateFrame("EditBox",nil,bx,"BackdropTemplate")jz:SetAutoFocus(false)jz:SetFontObject(GameFontHighlightSmall)jz:SetPoint("TOP",iU,"BOTTOM")jz:SetHeight(14)jz:SetWidth(70)jz:SetJustifyH("CENTER")jz:EnableMouse(true)jz:SetBackdrop(kA)jz:SetBackdropColor(0,0,0,0.5)jz:SetBackdropBorderColor(0.3,0.3,0.30,0.80)jz:SetScript("OnEnter",kw)jz:SetScript("OnLeave",kx)jz:SetScript("OnEnterPressed",jE)jz:SetScript("OnEscapePressed",jD)local dt={label=eU,slider=iU,lowtext=kB,hightext=kC,editbox=jz,alignoffset=25,frame=bx,type=eJ}for s,J in pairs(eQ)do dt[s]=J end;iU.obj,jz.obj=dt,dt;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function kD(...)local l=LibStub("CallbackHandler-1.0")local i,k="AceConfigRegistry-3.0",21;local kE=LibStub:NewLibrary(i,k)if not kE then return end;kE.tables=kE.tables or{}if not kE.callbacks then kE.callbacks=l:New(kE)end;local tinsert,P=table.insert,table.concat;local cW,kF=string.find,string.match;local type,tostring,select,pairs=type,tostring,select,pairs;local error,assert=error,assert;kE.validated={cmd={},dropdown={},dialog={}}local function T(jY,kG,...)local aU={}for M=select("#",...),1,-1 do tinsert(aU,(select(M,...)))end;error(i..":ValidateOptionsTable(): "..P(aU,".")..jY,kG+2)end;local kH={["string"]=true,_="string"}local kI={["string"]=true,["function"]=true,_="string or funcref"}local kJ={["table"]=true,_="table"}local kK={["table"]=true,["string"]=true,["function"]=true,_="methodname, funcref or table"}local kL={["nil"]=true,["string"]=true,_="string"}local kM={["nil"]=true,["string"]=true,["function"]=true,_="string or funcref"}local kN={["nil"]=true,["string"]=true,["number"]=true,["function"]=true,_="string, number or funcref"}local kO={["nil"]=true,["number"]=true,_="number"}local kP={["nil"]=true,["string"]=true,["function"]=true,["boolean"]={[false]=true},_="methodname, funcref or false"}local kQ={["nil"]=true,["string"]=true,["function"]=true,["number"]=true,_="methodname, funcref or number"}local kR={["nil"]=true,["string"]=true,["function"]=true,["table"]=true,_="methodname, funcref or table"}local kS={["nil"]=true,["string"]=true,["function"]=true,["boolean"]=true,_="methodname, funcref or boolean"}local kT={["nil"]=true,["table"]=true,_="table"}local kU={["nil"]=true,["boolean"]=true,_="boolean"}local kV={["nil"]=true,["boolean"]=true,["number"]=true,_="boolean or number"}local kW={["nil"]=true,["string"]=true,["number"]=true,_="string or number"}local kX={type=kH,name=kI,desc=kM,descStyle=kL,order=kQ,validate=kP,confirm=kS,confirmText=kL,disabled=kS,hidden=kS,guiHidden=kS,dialogHidden=kS,dropdownHidden=kS,cmdHidden=kS,tooltipHyperlink=kM,icon=kN,iconCoords=kR,handler=kT,get=kP,set=kP,func=kP,arg={["*"]=true},width=kW}local kY={header={control=kL,dialogControl=kL,dropdownControl=kL},description={image=kN,imageCoords=kR,imageHeight=kO,imageWidth=kO,fontSize=kM,control=kL,dialogControl=kL,dropdownControl=kL},group={args=kJ,plugins=kT,inline=kU,cmdInline=kU,guiInline=kU,dropdownInline=kU,dialogInline=kU,childGroups=kL},execute={image=kN,imageCoords=kR,imageHeight=kO,imageWidth=kO,control=kL,dialogControl=kL,dropdownControl=kL},input={pattern=kL,usage=kL,control=kL,dialogControl=kL,dropdownControl=kL,multiline=kV},toggle={tristate=kU,image=kN,imageCoords=kR,control=kL,dialogControl=kL,dropdownControl=kL},tristate={},range={min=kO,softMin=kO,max=kO,softMax=kO,step=kO,bigStep=kO,isPercent=kU,control=kL,dialogControl=kL,dropdownControl=kL},select={values=kK,sorting=kR,style={["nil"]=true,["string"]={dropdown=true,radio=true},_="string: 'dropdown' or 'radio'"},control=kL,dialogControl=kL,dropdownControl=kL,itemControl=kL},multiselect={values=kK,style=kL,tristate=kU,control=kL,dialogControl=kL,dropdownControl=kL},color={hasAlpha=kS,control=kL,dialogControl=kL,dropdownControl=kL},keybinding={control=kL,dialogControl=kL,dropdownControl=kL}}local function kZ(ad,kG,...)kG=(kG or 0)+1;if type(ad)~="string"then T("["..tostring(ad).."] - key is not a string",kG,...)end;if cW(ad,"[%c\127]")then T("["..tostring(ad).."] - key name contained control characters",kG,...)end end;local function k_(ae,l0,kG,...)kG=(kG or 0)+1;local l1=l0[type(ae)]or l0["*"]if not l1 then T(": expected a "..l0._..", got '"..tostring(ae).."'",kG,...)end;if type(l1)=="table"then if not l1[ae]then T(": did not expect "..type(ae).." value '"..tostring(ae).."'",kG,...)end end end;local function l2(l3,kG,...)kG=(kG or 0)+1;if type(l3)~="table"then T(": expected a table, got a "..type(l3),kG,...)end;if type(l3.type)~="string"then T(".type: expected a string, got a "..type(l3.type),kG,...)end;local l4=kY[l3.type]if not l4 then T(".type: unknown type '"..l3.type.."'",kG,...)end;for ad,ae in pairs(l3)do if not(l4[ad]or kX[ad])then T(": unknown parameter",kG,tostring(ad),...)end end;for ad,l0 in pairs(kX)do k_(l3[ad],l0,kG,ad,...)end;for ad,l0 in pairs(l4)do k_(l3[ad],l0,kG,ad,...)end;if l3.type=="group"then for ad,ae in pairs(l3.args)do kZ(ad,kG,"args",...)l2(ae,kG,ad,"args",...)end;if l3.plugins then for l5,l6 in pairs(l3.plugins)do if type(l6)~="table"then T(": expected a table, got '"..tostring(l6).."'",kG,tostring(l5),"plugins",...)end;for ad,ae in pairs(l6)do kZ(ad,kG,tostring(l5),"plugins",...)l2(ae,kG,ad,tostring(l5),"plugins",...)end end end end end;function kE:ValidateOptionsTable(l3,aa,kG)kG=(kG or 0)+1;aa=aa or"Optionstable"if not l3.name then l3.name=aa end;l2(l3,kG,aa)end;function kE:NotifyChange(l7)if not kE.tables[l7]then return end;kE.callbacks:Fire("ConfigTableChange",l7)end;local function l8(l9,la,kG)kG=(kG or 0)+2;if l9~="cmd"and l9~="dropdown"and l9~="dialog"then error(i..": Requesting options table: 'uiType' - invalid configuration UI type, expected 'cmd', 'dropdown' or 'dialog'",kG)end;if not kF(la,"[A-Za-z]%-[0-9]")then error(i..": Requesting options table: 'uiName' - badly formatted or missing version number. Expected e.g. 'MyLib-1.2'",kG)end end;function kE:RegisterOptionsTable(l7,l3,lb)if type(l3)=="table"then if l3.type~="group"then error(i..": RegisterOptionsTable(appName, options): 'options' - missing type='group' member in root group",2)end;kE.tables[l7]=function(l9,la,kG)kG=(kG or 0)+1;l8(l9,la,kG)if not kE.validated[l9][l7]and not lb then kE:ValidateOptionsTable(l3,l7,kG)kE.validated[l9][l7]=true end;return l3 end elseif type(l3)=="function"then kE.tables[l7]=function(l9,la,kG)kG=(kG or 0)+1;l8(l9,la,kG)local fP=assert(l3(l9,la,l7))if not kE.validated[l9][l7]and not lb then kE:ValidateOptionsTable(fP,l7,kG)kE.validated[l9][l7]=true end;return fP end else error(i..": RegisterOptionsTable(appName, options): 'options' - expected table or function reference",2)end end;function kE:IterateOptionsTables()return pairs(kE.tables)end;function kE:GetOptionsTable(l7,l9,la)local ew=kE.tables[l7]if not ew then return nil end;if l9 then return ew(l9,la,1)else return ew end end end;local function lc(...)local ld=LibStub("AceConfigRegistry-3.0")local i,k="AceConfigCmd-3.0",14;local le=LibStub:NewLibrary(i,k)if not le then return end;le.commands=le.commands or{}local lf=le.commands;local cV;local lg="AceConsole-3.0"local cX,lh,li,kF,lj=string.sub,string.split,string.lower,string.match,string.trim;local bg,tonumber,tostring=string.format,tonumber,tostring;local io,tinsert=table.sort,table.insert;local select,pairs,next,type=select,pairs,next,type;local error,assert=error,assert;local _G=_G;local cr=setmetatable({},{__index=function(self,ad)return ad end})local function print(jY)(SELECTED_CHAT_FRAME or DEFAULT_CHAT_FRAME):AddMessage(jY)end;local lk={["table"]=true}local ll="expected a table"local lm={["function"]=true,["string"]=true}local ln="expected function or member name"local function lo(...)for M=1,select("#",...)do if select(M,...)~=nil then return select(M,...)end end end;local function T(cB,lp,jY)local lq=" "..cX(cB.input,1,lp-1)error(i..": /"..cB[0]..lq..": "..(jY or"malformed options table"),2)end;local function lr(cB,lp,jY)local lq=cX(cB.input,1,lp-1)print("/"..cB[0].." "..lq..": "..(jY or"malformed options table"))end;local function ls(cB,lp,fP,lt,...)local s=cB[lt]if not s then T(cB,lp,"'"..lt.."': not set")end;cB.arg=fP.arg;cB.option=fP;cB.type=fP.type;if type(s)=="function"then return s(cB,...)elseif type(s)=="string"then if type(cB.handler[s])~="function"then T(cB,lp,"'"..lt.."': '"..s.."' is not a member function of "..tostring(cB.handler))end;return cB.handler[s](cB.handler,cB,...)else assert(false)end end;local function lu(cB,fP,lt,...)local s=fP[lt]cB.arg=fP.arg;cB.option=fP;cB.type=fP.type;if type(s)=="function"then return s(cB,...)else assert(false)end end;local function lv(cB,lp,fP,lt,...)if cB.validate then local lw=ls(cB,lp,fP,"validate",...)if type(lw)=="string"then lr(cB,lp,"'"..cX(cB.input,lp).."' - "..lw)return end end;ls(cB,lp,fP,lt,...)end;local function lx(cB,lp,fP,ly,lz,lA,lB)local lC,lD=cB[lz],cB[lz.."_at"]local e8=fP[lz]if e8~=nil then if e8==false then e8=nil elseif not lA[type(e8)]then T(cB,lp,"'"..lz.."' - "..lB)end;cB[lz]=e8;cB[lz.."_at"]=ly end;return lC,lD end;local lE={}local function lF(fP)if not fP.plugins then return pairs(fP.args)end;local lG,lH=next(fP.plugins)local ae;return function(aV,ad)while lH do ad,ae=next(lH,ad)if ad then return ad,ae end;if lH==fP.args then lH=nil else lG,lH=next(fP.plugins,lG)if not lG then lH=fP.args end end end end end;local function lI(cB,lp,fP)if fP.cmdHidden~=nil then return fP.cmdHidden end;local lJ=fP.hidden;if type(lJ)=="function"or type(lJ)=="string"then cB.hidden=lJ;lJ=ls(cB,lp,fP,'hidden')cB.hidden=nil end;return lJ end;local function lK(cB,lp,fP,ly,lL)if not lL then print("|cff33ff99"..cB.appName.."|r: Arguments to |cffffff78/"..cB[0].."|r "..cX(cB.input,1,lp-1)..":")end;local jf={}local lM={}for ad,ae in lF(fP)do if not lM[ad]then tinsert(jf,ad)lM[ad]=ae end end;io(jf,function(lN,lO)local lP=lM[lN].order or 100;local lQ=lM[lO].order or 100;if type(lP)=="function"or type(lP)=="string"then cB.order=lP;cB[#cB+1]=lN;lP=ls(cB,lp,lM[lN],"order")cB[#cB]=nil;cB.order=nil end;if type(lQ)=="function"or type(lP)=="string"then cB.order=lQ;cB[#cB+1]=lO;lQ=ls(cB,lp,lM[lO],"order")cB[#cB]=nil;cB.order=nil end;if lP<0 and lQ<0 then return lP<lQ end;if lQ<0 then return true end;if lP<0 then return false end;if lP==lQ then return tostring(lN)<tostring(lO)end;return lP<lQ end)for M=1,#jf do local ad=jf[M]local ae=lM[ad]if not lI(cB,lp,ae)then if ae.type~="description"and ae.type~="header"then local aa,i7=ae.name,ae.desc;if type(aa)=="function"then aa=lu(cB,ae,'name')end;if type(i7)=="function"then i7=lu(cB,ae,'desc')end;if ae.type=="group"and lo(ae.cmdInline,ae.inline,false)then print("  "..(i7 or aa)..":")local lR,lS=lx(cB,lp,ae,ly,"handler",lk,ll)lK(cB,lp,ae,ly,true)cB.handler,cB.handler_at=lR,lS else local o=ad:gsub(" ","_")print("  |cffffff78"..o.."|r - "..(i7 or aa or""))end end end end end;local function lT(fh)if fh==nil or fh=="NONE"then return nil end;fh=fh:upper()local lU,lV,lW;local lX;while true do if fh=="-"then break end;lX,fh=lh('-',fh,2)if fh then if lX~="SHIFT"and lX~="CTRL"and lX~="ALT"then return false end;if lX=="SHIFT"then if lU then return false end;lU=true end;if lX=="CTRL"then if lV then return false end;lV=true end;if lX=="ALT"then if lW then return false end;lW=true end else fh=lX;break end end;if fh==""then return false end;if not fh:find("^F%d+$")and fh~="CAPSLOCK"and fh:len()~=1 and(fh:byte()<128 or fh:len()>4)and not _G["KEY_"..fh]then return false end;local lY=fh;if lU then lY="SHIFT-"..lY end;if lV then lY="CTRL-"..lY end;if lW then lY="ALT-"..lY end;return lY end;local function aP(cB,lp,fP,ly,lZ)if not(type(fP)=="table"and type(fP.type)=="string")then T(cB,lp)end;local lR,lS=lx(cB,lp,fP,ly,"handler",lk,ll)local l_,m0=lx(cB,lp,fP,ly,"set",lm,ln)local m1,m2=lx(cB,lp,fP,ly,"get",lm,ln)local m3,m4=lx(cB,lp,fP,ly,"func",lm,ln)local m5,m6=lx(cB,lp,fP,ly,"validate",lm,ln)if fP.type=="group"then if type(fP.args)~="table"then T(cB,lp)end;if fP.plugins and type(fP.plugins)~="table"then T(cB,lp)end;local aV,m7,L=cB.input:find(" *([^ ]+) *",lp)if not L then lK(cB,lp,fP,ly)return end;m7=m7+1;for ad,ae in lF(fP)do if not(type(ad)=="string"and type(ae)=="table"and type(ae.type)=="string")then T(cB,lp,"options table child '"..tostring(ad).."' is malformed")end;if ae.type=="group"and lo(ae.cmdInline,ae.inline,false)then cB[ly+1]=ad;if aP(cB,lp,ae,ly+1,true)==false then cB[ly+1]=nil else return end elseif li(L)==li(ad:gsub(" ","_"))then cB[ly+1]=ad;return aP(cB,m7,ae,ly+1)end end;if lZ then cB.handler,cB.handler_at=lR,lS;cB.set,cB.set_at=l_,m0;cB.get,cB.get_at=m1,m2;cB.func,cB.func_at=m3,m4;cB.validate,cB.validate_at=m5,m6;return false end;lr(cB,lp,"'"..L.."' - "..cr["unknown argument"])return end;local m8=cX(cB.input,lp)if fP.type=="execute"then lv(cB,lp,fP,"func")elseif fP.type=="input"then local lw=true;if fP.pattern then if type(fP.pattern)~="string"then T(cB,lp,"'pattern' - expected a string")end;if not kF(m8,fP.pattern)then lr(cB,lp,"'"..m8 .."' - "..cr["invalid input"])return end end;lv(cB,lp,fP,"set",m8)elseif fP.type=="toggle"then local id;local d6=lj(li(m8))if d6==""then id=ls(cB,lp,fP,"get")if fP.tristate then if id then id=nil elseif id==nil then id=false else id=true end else id=not id end elseif d6==cr["on"]then id=true elseif d6==cr["off"]then id=false elseif fP.tristate and d6==cr["default"]then id=nil else if fP.tristate then lr(cB,lp,bg(cr["'%s' - expected 'on', 'off' or 'default', or no argument to toggle."],d6))else lr(cB,lp,bg(cr["'%s' - expected 'on' or 'off', or no argument to toggle."],d6))end;return end;lv(cB,lp,fP,"set",id)elseif fP.type=="range"then local e8=tonumber(m8)if not e8 then lr(cB,lp,"'"..m8 .."' - "..cr["expected number"])return end;if type(cB.step)=="number"then e8=e8-e8%cB.step end;if type(cB.min)=="number"and e8<cB.min then lr(cB,lp,e8 .." - "..bg(cr["must be equal to or higher than %s"],tostring(cB.min)))return end;if type(cB.max)=="number"and e8>cB.max then lr(cB,lp,e8 .." - "..bg(cr["must be equal to or lower than %s"],tostring(cB.max)))return end;lv(cB,lp,fP,"set",e8)elseif fP.type=="select"then local d6=lj(li(m8))local m9=fP.values;if type(m9)=="function"or type(m9)=="string"then cB.values=m9;m9=ls(cB,lp,fP,"values")cB.values=nil end;if d6==""then local id=ls(cB,lp,fP,"get")local R="|cffffff78- [%s]|r %s"local ma="|cffffff78- [%s]|r %s |cffff0000*|r"print(cr["Options for |cffffff78"..cB[#cB].."|r:"])for ad,ae in pairs(m9)do if id==ad then print(ma:format(ad,ae))else print(R:format(ad,ae))end end;return end;local mb;for ad,ae in pairs(m9)do if li(ad)==d6 then d6=ad;mb=true;break end end;if not mb then lr(cB,lp,"'"..d6 .."' - "..cr["unknown selection"])return end;lv(cB,lp,fP,"set",d6)elseif fP.type=="multiselect"then local d6=lj(li(m8))local m9=fP.values;if type(m9)=="function"or type(m9)=="string"then cB.values=m9;m9=ls(cB,lp,fP,"values")cB.values=nil end;if d6==""then local R="|cffffff78- [%s]|r %s"local ma="|cffffff78- [%s]|r %s |cffff0000*|r"print(cr["Options for |cffffff78"..cB[#cB].."|r (multiple possible):"])for ad,ae in pairs(m9)do if ls(cB,lp,fP,"get",ad)then print(ma:format(ad,ae))else print(R:format(ad,ae))end end;return end;local mc={}for ae in d6:gmatch("[^ ]+")do local md,e8=ae:match('(.+)=(.+)')if not md then md=ae end;local mb;for ad in pairs(m9)do if li(ad)==md then md=ad;mb=true;break end end;if not mb then lr(cB,lp,"'"..md.."' - "..cr["unknown selection"])return end;if e8 then if e8==cr["on"]or e8==cr["off"]or fP.tristate and e8==cr["default"]then mc[md]=e8 else if fP.tristate then lr(cB,lp,bg(cr["'%s' '%s' - expected 'on', 'off' or 'default', or no argument to toggle."],ae,e8))else lr(cB,lp,bg(cr["'%s' '%s' - expected 'on' or 'off', or no argument to toggle."],ae,e8))end;return end else mc[md]=true end end;for md,e8 in pairs(mc)do local me;if e8==true then local id=ls(cB,lp,fP,"get",md)if fP.tristate then if id then id=nil elseif id==nil then id=false else id=true end else id=not id end;me=id else if e8==cr["on"]then me=true elseif e8==cr["off"]then me=false elseif e8==cr["default"]then me=nil end end;lv(cB,lp,fP,"set",md,me)end elseif fP.type=="color"then local d6=lj(li(m8))if d6==""then return end;local ib,ic,id,ie;local mf=fP.hasAlpha;if type(mf)=="function"or type(mf)=="string"then cB.hasAlpha=mf;mf=ls(cB,lp,fP,'hasAlpha')cB.hasAlpha=nil end;if mf then if d6:len()==8 and d6:find("^%x*$")then ib,ic,id,ie=tonumber(d6:sub(1,2),16)/255,tonumber(d6:sub(3,4),16)/255,tonumber(d6:sub(5,6),16)/255,tonumber(d6:sub(7,8),16)/255 else ib,ic,id,ie=d6:match("^([%d%.]+) ([%d%.]+) ([%d%.]+) ([%d%.]+)$")ib,ic,id,ie=tonumber(ib),tonumber(ic),tonumber(id),tonumber(ie)end;if not(ib and ic and id and ie)then lr(cB,lp,bg(cr["'%s' - expected 'RRGGBBAA' or 'r g b a'."],d6))return end;if ib>=0.0 and ib<=1.0 and ic>=0.0 and ic<=1.0 and id>=0.0 and id<=1.0 and ie>=0.0 and ie<=1.0 then elseif ib>=0 and ib<=255 and ic>=0 and ic<=255 and id>=0 and id<=255 and ie>=0 and ie<=255 then ib=ib/255;ic=ic/255;id=id/255;ie=ie/255 else lr(cB,lp,bg(cr["'%s' - values must all be either in the range 0..1 or 0..255."],d6))end else ie=1.0;if d6:len()==6 and d6:find("^%x*$")then ib,ic,id=tonumber(d6:sub(1,2),16)/255,tonumber(d6:sub(3,4),16)/255,tonumber(d6:sub(5,6),16)/255 else ib,ic,id=d6:match("^([%d%.]+) ([%d%.]+) ([%d%.]+)$")ib,ic,id=tonumber(ib),tonumber(ic),tonumber(id)end;if not(ib and ic and id)then lr(cB,lp,bg(cr["'%s' - expected 'RRGGBB' or 'r g b'."],d6))return end;if ib>=0.0 and ib<=1.0 and ic>=0.0 and ic<=1.0 and id>=0.0 and id<=1.0 then elseif ib>=0 and ib<=255 and ic>=0 and ic<=255 and id>=0 and id<=255 then ib=ib/255;ic=ic/255;id=id/255 else lr(cB,lp,bg(cr["'%s' - values must all be either in the range 0-1 or 0-255."],d6))end end;lv(cB,lp,fP,"set",ib,ic,id,ie)elseif fP.type=="keybinding"then local d6=lj(li(m8))if d6==""then return end;local by=lT(d6:upper())if by==false then lr(cB,lp,bg(cr["'%s' - Invalid Keybinding."],d6))return end;lv(cB,lp,fP,"set",by)elseif fP.type=="description"then else T(cB,lp,"unknown options table item type '"..tostring(fP.type).."'")end end;function le:HandleCommand(mg,l7,d3)local mh=ld:GetOptionsTable(l7)if not mh then error([[Usage: HandleCommand("slashcmd", "appName", "input"): 'appName' - no options table "]]..tostring(l7)..[[" has been registered]],2)end;local l3=assert(mh("cmd",i))local cB={[0]=mg,appName=l7,options=l3,input=d3,self=self,handler=self,uiType="cmd",uiName=i}aP(cB,1,l3,0)end;function le:CreateChatCommand(mg,l7)if not cV then cV=LibStub(lg)end;if cV.RegisterChatCommand(self,mg,function(d3)le.HandleCommand(self,mg,l7,d3)end,true)then lf[mg]=l7 end end;function le:GetChatCommandOptions(mg)return lf[mg]end end;local function mi(...)local LibStub=LibStub;local mj=LibStub("AceGUI-3.0")local mk=LibStub("AceConfigRegistry-3.0")local i,k="AceConfigDialog-3.0",86;local ml,f=LibStub:NewLibrary(i,k)if not ml then return end;ml.OpenFrames=ml.OpenFrames or{}ml.Status=ml.Status or{}ml.frame=ml.frame or CreateFrame("Frame")ml.tooltip=ml.tooltip or CreateFrame("GameTooltip","AceConfigDialogTooltip",UIParent,"GameTooltipTemplate")ml.frame.apps=ml.frame.apps or{}ml.frame.closing=ml.frame.closing or{}ml.frame.closeAllOverride=ml.frame.closeAllOverride or{}local tinsert,io,Q,dg=table.insert,table.sort,table.remove,table.wipe;local kF,bg=string.match,string.format;local error=error;local pairs,next,select,type,unpack,ipairs=pairs,next,select,type,unpack,ipairs;local tostring,tonumber=tostring,tonumber;local di,dh,mm=math.min,math.max,math.floor;local mn={}local xpcall=xpcall;local function S(T)return geterrorhandler()(T)end;local function U(J,...)if J then return xpcall(J,S,...)end end;local mo=170;local aH,gx,mp;do local gy=setmetatable({},{__mode="k"})function aH()local aU=next(gy)if aU then gy[aU]=nil;return aU else return{}end end;function mp(aU)local jM=aH()for ad,ae in pairs(aU)do jM[ad]=ae end;return jM end;function gx(aU)dg(aU)gy[aU]=true end end;local function lo(...)for M=1,select("#",...)do if select(M,...)~=nil then return select(M,...)end end end;local function mq(eX,o)if eX.plugins then for l6,aU in pairs(eX.plugins)do if aU[o]then return aU[o]end end end;return eX.args[o]end;local mr={set=true,get=true,func=true,confirm=true,validate=true,disabled=true,hidden=true}local ms={name=true,desc=true,icon=true,usage=true,width=true,image=true,fontSize=true,tooltipHyperlink=true}local mt={type=true,descStyle=true,imageWidth=true,imageHeight=true}local function mu(mv,mw,l3,hk,l7,...)local mx=mr[mv]local my;if mx then local eX=l3;if eX[mv]~=nil then my=eX[mv]end;for M=1,#hk do eX=mq(eX,hk[M])if eX[mv]~=nil then my=eX[mv]end end else my=mw[mv]end;if not mt[mv]and(type(my)=="function"or not ms[mv]and type(my)=="string")then local cB=aH()local eX=l3;local bl=eX.handler;for M=1,#hk do eX=mq(eX,hk[M])cB[M]=hk[M]bl=eX.handler or bl end;cB.options=l3;cB.appName=l7;cB[0]=l7;cB.arg=mw.arg;cB.handler=bl;cB.option=mw;cB.type=mw.type;cB.uiType="dialog"cB.uiName=i;local ie,id,jM,mz;if type(my)=="function"then ie,id,jM,mz=my(cB,...)else if bl and bl[my]then ie,id,jM,mz=bl[my](bl,cB,...)else error(bg("Method %s doesn't exist in handler for type %s",my,mv))end end;gx(cB)return ie,id,jM,mz else return my end end;local mA;local mB;local function mC(ie,id)if not ie then return true end;if not id then return false end;local mD,mE=mA[ie]or 100,mA[id]or 100;if mD==mE then local mF=type(mB[ie])=="string"and mB[ie]or""local mG=type(mB[id])=="string"and mB[id]or""return mF:upper()<mG:upper()end;if mD<0 then if mE>=0 then return false end else if mE<0 then return true end end;return mD<mE end;local function mH(eX,mI,mJ,l3,hk,l7)mA=aH()mB=aH()if eX.plugins then for l6,aU in pairs(eX.plugins)do for ad,ae in pairs(aU)do if not mJ[ad]then tinsert(mI,ad)mJ[ad]=ae;hk[#hk+1]=ad;mA[ad]=mu("order",ae,l3,hk,l7)mB[ad]=mu("name",ae,l3,hk,l7)hk[#hk]=nil end end end end;for ad,ae in pairs(eX.args)do if not mJ[ad]then tinsert(mI,ad)mJ[ad]=ae;hk[#hk+1]=ad;mA[ad]=mu("order",ae,l3,hk,l7)mB[ad]=mu("name",ae,l3,hk,l7)hk[#hk]=nil end end;io(mI,mC)gx(mA)gx(mB)end;local function mK(gO)if gO.children then local mL=gO.children;for M=1,#mL do mK(mL[M])gx(mL[M])end;gx(mL)end end;local function mM(dt,F)local mN=dt:GetUserDataTable()if mN.path then gx(mN.path)end;if dt.type=="TreeGroup"then local gO=mN.tree;dt:SetTree(nil)if gO then for M=1,#gO do mK(gO[M])gx(gO[M])end;gx(gO)end end;if dt.type=="TabGroup"then dt:SetTabs(nil)if mN.tablist then gx(mN.tablist)end end;if dt.type=="DropdownGroup"then dt:SetGroupList(nil)if mN.grouplist then gx(mN.grouplist)end;if mN.orderlist then gx(mN.orderlist)end end end;function ml:GetStatusTable(l7,hk)local eY=self.Status;if not eY[l7]then eY[l7]={}eY[l7].status={}eY[l7].children={}end;eY=eY[l7]if hk then for M=1,#hk do local ae=hk[M]if not eY.children[ae]then eY.children[ae]={}eY.children[ae].status={}eY.children[ae].children={}end;eY=eY.children[ae]end end;return eY.status end;function ml:SelectGroup(l7,...)local hk=aH()local cT=mk:GetOptionsTable(l7)if not cT then error(("%s isn't registed with AceConfigRegistry, unable to open config"):format(l7),2)end;local l3=cT("dialog",i)local eX=l3;local eY=self:GetStatusTable(l7,hk)if not eY.groups then eY.groups={}end;eY=eY.groups;local mO;local mP;for d0=1,select("#",...)do local o=select(d0,...)if eX.childGroups=="tab"or eX.childGroups=="select"then eY.selected=o;mO=nil else if mO then mO=mO.."\001"..o else mO=o;if not eY.groups then eY.groups={}end;mP=eY end;mP.selected=mO;mP.groups[mO]=true end;eX=mq(eX,o)if not eX then break end;tinsert(hk,o)eY=self:GetStatusTable(l7,hk)if not eY.groups then eY.groups={}end;eY=eY.groups end;gx(hk)mk:NotifyChange(l7)end;local function mQ(dt,F)local mN=dt:GetUserDataTable()local md=mN.option;local l3=mN.options;local hk=mN.path;local l7=mN.appName;local gW=ml.tooltip;gW:SetOwner(dt.frame,"ANCHOR_TOPRIGHT")local mR=mu("tooltipHyperlink",md,l3,hk,l7)if mR then gW:SetHyperlink(mR)gW:Show()return end;local aa=mu("name",md,l3,hk,l7)local i7=mu("desc",md,l3,hk,l7)local bu=mu("usage",md,l3,hk,l7)local mS=md.descStyle;if mS and mS~="tooltip"then return end;gW:SetText(aa,1,.82,0,true)if md.type=="multiselect"then gW:AddLine(mN.text,0.5,0.5,0.8,true)end;if type(i7)=="string"then gW:AddLine(i7,1,1,1,true)end;if type(bu)=="string"then gW:AddLine("Usage: "..bu,NORMAL_FONT_COLOR.r,NORMAL_FONT_COLOR.g,NORMAL_FONT_COLOR.b,true)end;gW:Show()end;local function mT(dt,F)ml.tooltip:Hide()end;local function mU(mw)if mw.type=="execute"then return"func"else return"set"end end;do local bx=ml.popup;if not bx or f<81 then bx=CreateFrame("Frame",nil,UIParent)ml.popup=bx;bx:Hide()bx:SetPoint("CENTER",UIParent,"CENTER")bx:SetSize(320,72)bx:EnableMouse(true)bx:SetFrameStrata("TOOLTIP")bx:SetFrameLevel(100)bx:SetScript("OnKeyDown",function(self,o)if o=="ESCAPE"then self:SetPropagateKeyboardInput(false)if self.cancel:IsShown()then self.cancel:Click()else self:Hide()end else self:SetPropagateKeyboardInput(true)end end)local f3=CreateFrame("Frame",nil,bx,"DialogBorderOpaqueTemplate")f3:SetAllPoints(bx)bx:SetFixedFrameStrata(true)bx:SetFixedFrameLevel(true)local fh=bx:CreateFontString(nil,"ARTWORK","GameFontHighlight")fh:SetSize(290,0)fh:SetPoint("TOP",0,-16)bx.text=fh;local function mV(mW)local gE=CreateFrame("Button",nil,bx)gE:SetSize(128,21)gE:SetNormalFontObject(GameFontNormal)gE:SetHighlightFontObject(GameFontHighlight)gE:SetNormalTexture(130763)gE:GetNormalTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gE:SetPushedTexture(130761)gE:GetPushedTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gE:SetHighlightTexture(130762)gE:GetHighlightTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gE:SetText(mW)return gE end;local mX=mV(ACCEPT)mX:SetPoint("BOTTOMRIGHT",bx,"BOTTOM",-6,16)bx.accept=mX;local eN=mV(CANCEL)eN:SetPoint("LEFT",mX,"RIGHT",13,0)bx.cancel=eN end end;local function mY(l7,mZ,m_,cB,b8,J,...)local bx=ml.popup;bx:Show()bx.text:SetText(b8)local dy=61+bx.text:GetHeight()bx:SetHeight(dy)bx.accept:ClearAllPoints()bx.accept:SetPoint("BOTTOMRIGHT",bx,"BOTTOM",-6,16)bx.cancel:Show()local aU={...}local n0=select("#",...)bx.accept:SetScript("OnClick",function(self)U(J,unpack(aU,1,n0))ml:Open(l7,mZ,unpack(m_ or mn))bx:Hide()self:SetScript("OnClick",nil)bx.cancel:SetScript("OnClick",nil)gx(cB)end)bx.cancel:SetScript("OnClick",function(self)ml:Open(l7,mZ,unpack(m_ or mn))bx:Hide()self:SetScript("OnClick",nil)bx.accept:SetScript("OnClick",nil)gx(cB)end)end;local function n1(b8)local bx=ml.popup;bx:Show()bx.text:SetText(b8)local dy=61+bx.text:GetHeight()bx:SetHeight(dy)bx.accept:ClearAllPoints()bx.accept:SetPoint("BOTTOM",bx,"BOTTOM",0,16)bx.cancel:Hide()bx.accept:SetScript("OnClick",function()bx:Hide()end)end;local function n2(dt,F,...)local mN=dt:GetUserDataTable()local mw=mN.option;local l3=mN.options;local hk=mN.path;local cB=aH()local J;local eX=l3;local n3=mU(mw)local bl;local n4;local l2;if eX[n3]~=nil then J=eX[n3]end;bl=eX.handler;n4=eX.confirm;l2=eX.validate;for M=1,#hk do local ae=hk[M]eX=mq(eX,ae)cB[M]=ae;if eX[n3]~=nil then J=eX[n3]end;bl=eX.handler or bl;if eX.confirm~=nil then n4=eX.confirm end;if eX.validate~=nil then l2=eX.validate end end;cB.options=l3;cB.appName=mN.appName;cB.arg=mw.arg;cB.handler=bl;cB.option=mw;cB.type=mw.type;cB.uiType="dialog"cB.uiName=i;local aa;if type(mw.name)=="function"then aa=mw.name(cB)elseif type(mw.name)=="string"then aa=mw.name else aa=""end;local bu=mw.usage;local n5=mw.pattern;local n6=true;if mw.type=="input"then if type(n5)=="string"then if not kF(...,n5)then n6=false end end end;local dv;if n6 and mw.type~="execute"then if type(l2)=="string"then if bl and bl[l2]then dv,n6=U(bl[l2],bl,cB,...)if not dv then n6=false end else error(bg("Method %s doesn't exist in handler for type execute",l2))end elseif type(l2)=="function"then dv,n6=U(l2,cB,...)if not dv then n6=false end end end;if not n6 or type(n6)=="string"then if not n6 then if bu then n6=aa..": "..bu else if n5 then n6=aa..": Expected "..n5 else n6=aa..": Invalid Value"end end end;if mN.rootframe.SetStatusText then mN.rootframe:SetStatusText(n6)else n1(n6)end;PlaySound(882)gx(cB)return true else local n7=mw.confirmText;if type(n4)=="string"then if bl and bl[n4]then dv,n4=U(bl[n4],bl,cB,...)if dv and type(n4)=="string"then n7=n4;n4=true elseif not dv then n4=false end else error(bg("Method %s doesn't exist in handler for type confirm",n4))end elseif type(n4)=="function"then dv,n4=U(n4,cB,...)if dv and type(n4)=="string"then n7=n4;n4=true elseif not dv then n4=false end end;if type(n4)=="boolean"then if n4 then if not n7 then local n8,i7=mw.name,mw.desc;if type(n8)=="function"then n8=n8(cB)end;if type(i7)=="function"then i7=i7(cB)end;n7=n8;if i7 then n7=n7 .." - "..i7 end end;local n9=mN.rootframe:GetUserData("iscustom")local mZ;if n9 then mZ=mN.rootframe end;local m_=mN.rootframe:GetUserData("basepath")if type(J)=="string"then if bl and bl[J]then mY(mN.appName,mZ,m_,cB,n7,bl[J],bl,cB,...)else error(bg("Method %s doesn't exist in handler for type func",J))end elseif type(J)=="function"then mY(mN.appName,mZ,m_,cB,n7,J,cB,...)end;return end end;if type(J)=="string"then if bl and bl[J]then U(bl[J],bl,cB,...)else error(bg("Method %s doesn't exist in handler for type func",J))end elseif type(J)=="function"then U(J,cB,...)end;local n9=mN.rootframe:GetUserData("iscustom")local m_=mN.rootframe:GetUserData("basepath")or mn;if mw.type=="color"then if F=="OnValueConfirmed"then if n9 then ml:Open(mN.appName,mN.rootframe,unpack(m_))else ml:Open(mN.appName,unpack(m_))end end elseif mw.type=="range"then if F=="OnMouseUp"then if n9 then ml:Open(mN.appName,mN.rootframe,unpack(m_))else ml:Open(mN.appName,unpack(m_))end end elseif mw.type=="multiselect"then mN.valuechanged=true else if n9 then ml:Open(mN.appName,mN.rootframe,unpack(m_))else ml:Open(mN.appName,unpack(m_))end end end;gx(cB)end;local function na(dt,F,by)local mw=dt:GetUserData("option")local fw,cY,ky=mw.min or(not mw.softMin and 0 or nil),mw.max or(not mw.softMax and 100 or nil),mw.step;if fw then if ky then by=mm((by-fw)/ky+0.5)*ky+fw end;by=dh(by,fw)end;if cY then by=di(by,cY)end;n2(dt,F,by)end;local function nb(dt,F,...)n2(dt,F,dt:GetUserData("value"),...)local mN=dt:GetUserDataTable()local n9=mN.rootframe:GetUserData("iscustom")local m_=mN.rootframe:GetUserData("basepath")or mn;if n9 then ml:Open(mN.appName,mN.rootframe,unpack(m_))else ml:Open(mN.appName,unpack(m_))end end;local function nc(dt,F,...)local mN=dt:GetUserDataTable()if mN.valuechanged and not dt:IsReleasing()then local n9=mN.rootframe:GetUserData("iscustom")local m_=mN.rootframe:GetUserData("basepath")or mn;if n9 then ml:Open(mN.appName,mN.rootframe,unpack(m_))else ml:Open(mN.appName,unpack(m_))end end end;local function nd(dt,F)local l7=dt:GetUserData("appName")ml.OpenFrames[l7]=nil;mj:Release(dt)end;local function ne(mw,l3,hk,l7)local lJ=lo(mw.dialogHidden,mw.guiHidden)if lJ~=nil then return lJ end;return mu("hidden",mw,l3,hk,l7)end;local function nf(mw,l3,hk,l7)local gg=lo(mw.dialogDisabled,mw.guiDisabled)if gg~=nil then return gg end;return mu("disabled",mw,l3,hk,l7)end;local function ng(eX,l3,hk,l7)local h9=aH()local e_=aH()local mI=aH()local mJ=aH()mH(eX,mI,mJ,l3,hk,l7)for M=1,#mI do local ad=mI[M]local ae=mJ[ad]if ae.type=="group"then hk[#hk+1]=ad;local nh=lo(ae.dialogInline,ae.guiInline,ae.inline,false)local lJ=ne(ae,l3,hk,l7)if not nh and not lJ then h9[ad]=mu("name",ae,l3,hk,l7)tinsert(e_,ad)end;hk[#hk]=nil end end;gx(mJ)gx(mI)return h9,e_ end;local function ni(eX,gO,l3,hk,l7)local mI=aH()local mJ=aH()mH(eX,mI,mJ,l3,hk,l7)for M=1,#mI do local ad=mI[M]local ae=mJ[ad]if ae.type=="group"then hk[#hk+1]=ad;local nh=lo(ae.dialogInline,ae.guiInline,ae.inline,false)local lJ=ne(ae,l3,hk,l7)if not nh and not lJ then local nj=aH()nj.value=ad;nj.text=mu("name",ae,l3,hk,l7)nj.icon=mu("icon",ae,l3,hk,l7)nj.iconCoords=mu("iconCoords",ae,l3,hk,l7)nj.disabled=nf(ae,l3,hk,l7)if not gO.children then gO.children=aH()end;tinsert(gO.children,nj)if(ae.childGroups or"tree")=="tree"then ni(ae,nj,l3,hk,l7)end end;hk[#hk]=nil end end;gx(mI)gx(mJ)end;local function nk(eX,l3,hk,l7,nl)local gO=aH()local mI=aH()local mJ=aH()mH(eX,mI,mJ,l3,hk,l7)for M=1,#mI do local ad=mI[M]local ae=mJ[ad]if ae.type=="group"then hk[#hk+1]=ad;local nh=lo(ae.dialogInline,ae.guiInline,ae.inline,false)local lJ=ne(ae,l3,hk,l7)if not nh and not lJ then local nj=aH()nj.value=ad;nj.text=mu("name",ae,l3,hk,l7)nj.icon=mu("icon",ae,l3,hk,l7)nj.iconCoords=mu("iconCoords",ae,l3,hk,l7)nj.disabled=nf(ae,l3,hk,l7)tinsert(gO,nj)if nl and(ae.childGroups or"tree")=="tree"then ni(ae,nj,l3,hk,l7)end end;hk[#hk]=nil end end;gx(mI)gx(mJ)return gO end;local function nm(nn,l3,mw,hk,mZ,l7)local mN=nn:GetUserDataTable()for M=1,#hk do mN[M]=hk[M]end;mN.rootframe=mZ;mN.option=mw;mN.options=l3;mN.path=mp(hk)mN.appName=l7;nn:SetCallback("OnRelease",mM)nn:SetCallback("OnLeave",mT)nn:SetCallback("OnEnter",mQ)end;local function no(np,nq)local nn;if np then nn=mj:Create(np)if not nn then geterrorhandler()(("Invalid Custom Control Type - %s"):format(tostring(np)))end end;if not nn then nn=mj:Create(nq)end;return nn end;local function nr(x,y)return tostring(x)<tostring(y)end;local function ns(l7,l3,nt,mZ,hk,eX,nh)local mI=aH()local mJ=aH()mH(eX,mI,mJ,l3,hk,l7)for M=1,#mI do local ad=mI[M]local ae=mJ[ad]tinsert(hk,ad)local lJ=ne(ae,l3,hk,l7)local aa=mu("name",ae,l3,hk,l7)if not lJ then if ae.type=="group"then if nh or lo(ae.dialogInline,ae.guiInline,ae.inline,false)then local nu;if aa and aa~=""then nu=mj:Create("InlineGroup")nu:SetTitle(aa or"")else nu=mj:Create("SimpleGroup")end;nu.width="fill"nu:SetLayout("flow")nt:AddChild(nu)ns(l7,l3,nu,mZ,hk,ae,true)end else local nn;if ae.type=="execute"then local nv=mu("imageCoords",ae,l3,hk,l7)local i8,dx,dy=mu("image",ae,l3,hk,l7)local nw=type(i8)=="string"or type(i8)=="number"nn=no(ae.dialogControl or ae.control,nw and"Icon"or"Button")if nw then if not dx then dx=mu("imageWidth",ae,l3,hk,l7)end;if not dy then dy=mu("imageHeight",ae,l3,hk,l7)end;if type(nv)=="table"then nn:SetImage(i8,unpack(nv))else nn:SetImage(i8)end;if type(dx)~="number"then dx=32 end;if type(dy)~="number"then dy=32 end;nn:SetImageSize(dx,dy)nn:SetLabel(aa)else nn:SetText(aa)end;nn:SetCallback("OnClick",n2)elseif ae.type=="input"then nn=no(ae.dialogControl or ae.control,ae.multiline and"MultiLineEditBox"or"EditBox")if ae.multiline and nn.SetNumLines then nn:SetNumLines(tonumber(ae.multiline)or 4)end;nn:SetLabel(aa)nn:SetCallback("OnEnterPressed",n2)local fh=mu("get",ae,l3,hk,l7)if type(fh)~="string"then fh=""end;nn:SetText(fh)elseif ae.type=="toggle"then nn=no(ae.dialogControl or ae.control,"CheckBox")nn:SetLabel(aa)nn:SetTriState(ae.tristate)local by=mu("get",ae,l3,hk,l7)nn:SetValue(by)nn:SetCallback("OnValueChanged",n2)if ae.descStyle=="inline"then local i7=mu("desc",ae,l3,hk,l7)nn:SetDescription(i7)end;local i8=mu("image",ae,l3,hk,l7)local nv=mu("imageCoords",ae,l3,hk,l7)if type(i8)=="string"or type(i8)=="number"then if type(nv)=="table"then nn:SetImage(i8,unpack(nv))else nn:SetImage(i8)end end elseif ae.type=="range"then nn=no(ae.dialogControl or ae.control,"Slider")nn:SetLabel(aa)nn:SetSliderValues(ae.softMin or ae.min or 0,ae.softMax or ae.max or 100,ae.bigStep or ae.step or 0)nn:SetIsPercent(ae.isPercent)local by=mu("get",ae,l3,hk,l7)if type(by)~="number"then by=0 end;nn:SetValue(by)nn:SetCallback("OnValueChanged",na)nn:SetCallback("OnMouseUp",na)elseif ae.type=="select"then local m9=mu("values",ae,l3,hk,l7)local nx=mu("sorting",ae,l3,hk,l7)if ae.style=="radio"then local gg=nf(ae,l3,hk,l7)local dx=mu("width",ae,l3,hk,l7)nn=mj:Create("InlineGroup")nn:SetLayout("Flow")nn:SetTitle(aa)nn.width="fill"nn:PauseLayout()local ny=mu("get",ae,l3,hk,l7)if not nx then nx={}for by,fh in pairs(m9)do nx[#nx+1]=by end;io(nx,nr)end;for aV,by in ipairs(nx)do local fh=m9[by]local nz=mj:Create("CheckBox")nz:SetLabel(fh)nz:SetUserData("value",by)nz:SetUserData("text",fh)nz:SetDisabled(gg)nz:SetType("radio")nz:SetValue(ny==by)nz:SetCallback("OnValueChanged",nb)nm(nz,l3,ae,hk,mZ,l7)nn:AddChild(nz)if dx=="double"then nz:SetWidth(mo*2)elseif dx=="half"then nz:SetWidth(mo/2)elseif type(dx)=="number"then nz:SetWidth(mo*dx)elseif dx=="full"then nz.width="fill"else nz:SetWidth(mo)end end;nn:ResumeLayout()nn:DoLayout()else nn=no(ae.dialogControl or ae.control,"Dropdown")local jb=ae.itemControl;if jb and not mj:GetWidgetVersion(jb)then geterrorhandler()(("Invalid Custom Item Type - %s"):format(tostring(jb)))jb=nil end;nn:SetLabel(aa)nn:SetList(m9,nx,jb)local by=mu("get",ae,l3,hk,l7)if not m9[by]then by=nil end;nn:SetValue(by)nn:SetCallback("OnValueChanged",n2)end elseif ae.type=="multiselect"then local m9=mu("values",ae,l3,hk,l7)local gg=nf(ae,l3,hk,l7)local nA=aH()if m9 then for by,fh in pairs(m9)do tinsert(nA,by)end end;io(nA)local nB=ae.dialogControl or ae.control;if nB then nn=mj:Create(nB)if not nn then geterrorhandler()(("Invalid Custom Control Type - %s"):format(tostring(nB)))end end;if nn then nn:SetMultiselect(true)nn:SetLabel(aa)nn:SetList(m9)nn:SetDisabled(gg)nn:SetCallback("OnValueChanged",n2)nn:SetCallback("OnClosed",nc)local dx=mu("width",ae,l3,hk,l7)if dx=="double"then nn:SetWidth(mo*2)elseif dx=="half"then nn:SetWidth(mo/2)elseif type(dx)=="number"then nn:SetWidth(mo*dx)elseif dx=="full"then nn.width="fill"else nn:SetWidth(mo)end;for lY=1,#nA do local o=nA[lY]local by=mu("get",ae,l3,hk,l7,o)nn:SetItemValue(o,by)end else nn=mj:Create("InlineGroup")nn:SetLayout("Flow")nn:SetTitle(aa)nn.width="fill"nn:PauseLayout()local dx=mu("width",ae,l3,hk,l7)for lY=1,#nA do local by=nA[lY]local fh=m9[by]local i2=mj:Create("CheckBox")i2:SetLabel(fh)i2:SetUserData("value",by)i2:SetUserData("text",fh)i2:SetDisabled(gg)i2:SetTriState(ae.tristate)i2:SetValue(mu("get",ae,l3,hk,l7,by))i2:SetCallback("OnValueChanged",nb)nm(i2,l3,ae,hk,mZ,l7)nn:AddChild(i2)if dx=="double"then i2:SetWidth(mo*2)elseif dx=="half"then i2:SetWidth(mo/2)elseif type(dx)=="number"then i2:SetWidth(mo*dx)elseif dx=="full"then i2.width="fill"else i2:SetWidth(mo)end end;nn:ResumeLayout()nn:DoLayout()end;gx(nA)elseif ae.type=="color"then nn=no(ae.dialogControl or ae.control,"ColorPicker")nn:SetLabel(aa)nn:SetHasAlpha(mu("hasAlpha",ae,l3,hk,l7))nn:SetColor(mu("get",ae,l3,hk,l7))nn:SetCallback("OnValueChanged",n2)nn:SetCallback("OnValueConfirmed",n2)elseif ae.type=="keybinding"then nn=no(ae.dialogControl or ae.control,"Keybinding")nn:SetLabel(aa)nn:SetKey(mu("get",ae,l3,hk,l7))nn:SetCallback("OnKeyChanged",n2)elseif ae.type=="header"then nn=no(ae.dialogControl or ae.control,"Heading")nn:SetText(aa)nn.width="fill"elseif ae.type=="description"then nn=no(ae.dialogControl or ae.control,"Label")nn:SetText(aa)local nC=mu("fontSize",ae,l3,hk,l7)if nC=="medium"then nn:SetFontObject(GameFontHighlight)elseif nC=="large"then nn:SetFontObject(GameFontHighlightLarge)else nn:SetFontObject(GameFontHighlightSmall)end;local nv=mu("imageCoords",ae,l3,hk,l7)local i8,dx,dy=mu("image",ae,l3,hk,l7)if type(i8)=="string"or type(i8)=="number"then if not dx then dx=mu("imageWidth",ae,l3,hk,l7)end;if not dy then dy=mu("imageHeight",ae,l3,hk,l7)end;if type(nv)=="table"then nn:SetImage(i8,unpack(nv))else nn:SetImage(i8)end;if type(dx)~="number"then dx=32 end;if type(dy)~="number"then dy=32 end;nn:SetImageSize(dx,dy)end;local nD=mu("width",ae,l3,hk,l7)nn.width=not nD and"fill"end;if nn then if nn.width~="fill"then local dx=mu("width",ae,l3,hk,l7)if dx=="double"then nn:SetWidth(mo*2)elseif dx=="half"then nn:SetWidth(mo/2)elseif type(dx)=="number"then nn:SetWidth(mo*dx)elseif dx=="full"then nn.width="fill"else nn:SetWidth(mo)end end;if nn.SetDisabled then local gg=nf(ae,l3,hk,l7)nn:SetDisabled(gg)end;nm(nn,l3,ae,hk,mZ,l7)nt:AddChild(nn)end end end;Q(hk)end;nt:ResumeLayout()nt:DoLayout()gx(mI)gx(mJ)end;local function nE(hk,...)for M=1,select("#",...)do tinsert(hk,(select(M,...)))end end;local function nF(dt,F,gM,gE)local mN=dt:GetUserDataTable()if not mN then return end;local l3=mN.options;local mw=mN.option;local hk=mN.path;local l7=mN.appName;local gW=ml.tooltip;local nG=aH()for M=1,#hk do nG[M]=hk[M]end;nE(nG,("\001"):split(gM))local eX=l3;for M=1,#nG do if not eX then return end;eX=mq(eX,nG[M])end;local aa=mu("name",eX,l3,nG,l7)local i7=mu("desc",eX,l3,nG,l7)gW:SetOwner(gE,"ANCHOR_NONE")gW:ClearAllPoints()if dt.type=="TabGroup"then gW:SetPoint("BOTTOM",gE,"TOP")else gW:SetPoint("LEFT",gE,"RIGHT")end;gW:SetText(aa,1,.82,0,true)if type(i7)=="string"then gW:AddLine(i7,1,1,1,true)end;gW:Show()end;local function nH(dt,F,by,gE)ml.tooltip:Hide()end;local function nI(l7,l3,hk,gM)if not gM then return false end;local nG=aH()local nJ=aH()for M=1,#hk do nG[M]=hk[M]end;nE(nG,("\001"):split(gM))local eX=l3;for M=1,#nG do local ae=nG[M]nJ[M]=ae;eX=mq(eX,ae)if not eX or eX.type~="group"or ne(eX,l3,nJ,l7)then gx(nG)gx(nJ)return false end end;gx(nG)gx(nJ)return true end;local function nK(dt,F,gM)local mN=dt:GetUserDataTable()local l3=mN.options;local mw=mN.option;local hk=mN.path;local mZ=mN.rootframe;local nG=aH()for M=1,#hk do nG[M]=hk[M]end;nE(nG,("\001"):split(gM))dt:ReleaseChildren()ml:FeedGroup(mN.appName,l3,dt,mZ,nG)gx(nG)end;function ml:FeedGroup(l7,l3,nt,mZ,hk,nL)local eX=l3;local nh;local nM,nN=l3.childGroups,"none"for M=1,#hk do local ae=hk[M]eX=mq(eX,ae)nh=nh or lo(ae.dialogInline,ae.guiInline,ae.inline,false)nN=nM;nM=eX.childGroups end;if not nN then nN="tree"end;local nO;for ad,ae in pairs(eX.args)do if ae.type=="group"and not lo(ae.dialogInline,ae.guiInline,ae.inline,false)and not ne(ae,l3,hk,l7)then nO=true end end;if eX.plugins then for l6,aU in pairs(eX.plugins)do for ad,ae in pairs(aU)do if ae.type=="group"and not lo(ae.dialogInline,ae.guiInline,ae.inline,false)and not ne(ae,l3,hk,l7)then nO=true end end end end;nt:SetLayout("flow")local nP;if not(nO and not nh)or nM~="tab"and nM~="select"and(nN=="tree"and not nL)then if nt.type~="InlineGroup"and nt.type~="SimpleGroup"then nP=mj:Create("ScrollFrame")nP:SetLayout("flow")nP.width="fill"nP.height="fill"nt:SetLayout("fill")nt:AddChild(nP)nt=nP end end;ns(l7,l3,nt,mZ,hk,eX,nil)if nP then nt:PerformLayout()local eY=self:GetStatusTable(l7,hk)if not eY.scroll then eY.scroll={}end;nP:SetStatusTable(eY.scroll)end;if nO and not nh then local aa=mu("name",eX,l3,hk,l7)if nM=="tab"then local fP=mj:Create("TabGroup")nm(fP,l3,eX,hk,mZ,l7)fP:SetCallback("OnGroupSelected",nK)fP:SetCallback("OnTabEnter",nF)fP:SetCallback("OnTabLeave",nH)local eY=ml:GetStatusTable(l7,hk)if not eY.groups then eY.groups={}end;fP:SetStatusTable(eY.groups)fP.width="fill"fP.height="fill"local go=nk(eX,l3,hk,l7)fP:SetTabs(go)fP:SetUserData("tablist",go)for M=1,#go do local nj=go[M]if not nj.disabled then fP:SelectTab(nI(l7,l3,hk,eY.groups.selected)and eY.groups.selected or nj.value)break end end;nt:AddChild(fP)elseif nM=="select"then local nQ=mj:Create("DropdownGroup")nQ:SetTitle(aa)nm(nQ,l3,eX,hk,mZ,l7)nQ:SetCallback("OnGroupSelected",nK)local eY=ml:GetStatusTable(l7,hk)if not eY.groups then eY.groups={}end;nQ:SetStatusTable(eY.groups)local nR,nS=ng(eX,l3,hk,l7)nQ:SetGroupList(nR,nS)nQ:SetUserData("grouplist",nR)nQ:SetUserData("orderlist",nS)local nT=nS[1]if nT then nQ:SetGroup(nI(l7,l3,hk,eY.groups.selected)and eY.groups.selected or nT)end;nQ.width="fill"nQ.height="fill"nt:AddChild(nQ)elseif nN~="tree"or nL then local gO=mj:Create("TreeGroup")nm(gO,l3,eX,hk,mZ,l7)gO:EnableButtonTooltips(false)gO.width="fill"gO.height="fill"gO:SetCallback("OnGroupSelected",nK)gO:SetCallback("OnButtonEnter",nF)gO:SetCallback("OnButtonLeave",nH)local eY=ml:GetStatusTable(l7,hk)if not eY.groups then eY.groups={}end;local nU=nk(eX,l3,hk,l7,true)gO:SetStatusTable(eY.groups)gO:SetTree(nU)gO:SetUserData("tree",nU)for M=1,#nU do local nj=nU[M]if not nj.disabled then gO:SelectByValue(nI(l7,l3,hk,eY.groups.selected)and eY.groups.selected or nj.value)break end end;nt:AddChild(gO)end end end;local nV;local function nW(ay)for l7 in pairs(ay.closing)do if ml.OpenFrames[l7]then ml.OpenFrames[l7]:Hide()end;if ml.BlizOptions and ml.BlizOptions[l7]then for o,dt in pairs(ml.BlizOptions[l7])do if not dt:IsVisible()then dt:ReleaseChildren()end end end;ay.closing[l7]=nil end;if ay.closeAll then for ad,ae in pairs(ml.OpenFrames)do if not ay.closeAllOverride[ad]then ae:Hide()end end;ay.closeAll=nil;dg(ay.closeAllOverride)end;for l7 in pairs(ay.apps)do if ml.OpenFrames[l7]then local mN=ml.OpenFrames[l7]:GetUserDataTable()ml:Open(l7,unpack(mN.basepath or mn))end;if ml.BlizOptions and ml.BlizOptions[l7]then for o,dt in pairs(ml.BlizOptions[l7])do local mN=dt:GetUserDataTable()if dt:IsVisible()then ml:Open(dt:GetUserData("appName"),dt,unpack(mN.basepath or mn))end end end;ay.apps[l7]=nil end;ay:SetScript("OnUpdate",nil)end;if ml.frame:GetScript("OnUpdate")then ml.frame:SetScript("OnUpdate",nW)end;function ml:CloseAll()ml.frame.closeAll=true;ml.frame:SetScript("OnUpdate",nW)if next(self.OpenFrames)then return true end end;function ml:Close(l7)if self.OpenFrames[l7]then ml.frame.closing[l7]=true;ml.frame:SetScript("OnUpdate",nW)return true end end;function ml:ConfigTableChanged(F,l7)ml.frame.apps[l7]=true;ml.frame:SetScript("OnUpdate",nW)end;mk.RegisterCallback(ml,"ConfigTableChange","ConfigTableChanged")function ml:SetDefaultSize(l7,dx,dy)local eY=ml:GetStatusTable(l7)if type(dx)=="number"and type(dy)=="number"then eY.width=dx;eY.height=dy end end;function ml:Open(l7,nt,...)if not nV then nV=CloseSpecialWindows;CloseSpecialWindows=function()local gn=nV()return self:CloseAll()or gn end end;local cT=mk:GetOptionsTable(l7)if not cT then error(("%s isn't registed with AceConfigRegistry, unable to open config"):format(l7),2)end;local l3=cT("dialog",i)local ew;local hk=aH()local aa=mu("name",l3,l3,hk,l7)if type(nt)=="string"then tinsert(hk,nt)nt=nil end;for d0=1,select("#",...)do tinsert(hk,(select(d0,...)))end;local mw=l3;if type(nt)=="table"and nt.type=="BlizOptionsGroup"and#hk>0 then for M=1,#hk do mw=l3.args[hk[M]]end;aa=bg("%s - %s",aa,mu("name",mw,l3,hk,l7))end;if nt then ew=nt;ew:ReleaseChildren()ew:SetUserData("appName",l7)ew:SetUserData("iscustom",true)if#hk>0 then ew:SetUserData("basepath",mp(hk))end;local eY=ml:GetStatusTable(l7)if not eY.width then eY.width=700 end;if not eY.height then eY.height=500 end;if ew.SetStatusTable then ew:SetStatusTable(eY)end;if ew.SetTitle then ew:SetTitle(aa or"")end else if not self.OpenFrames[l7]then ew=mj:Create("Frame")self.OpenFrames[l7]=ew else ew=self.OpenFrames[l7]end;ew:ReleaseChildren()ew:SetCallback("OnClose",nd)ew:SetUserData("appName",l7)if#hk>0 then ew:SetUserData("basepath",mp(hk))end;ew:SetTitle(aa or"")local eY=ml:GetStatusTable(l7)ew:SetStatusTable(eY)end;self:FeedGroup(l7,l3,ew,ew,hk,true)if ew.Show then ew:Show()end;gx(hk)if ml.frame.closeAll then ml.frame.closeAllOverride[l7]=true end end;if f and f<39 and ml.BlizOptions then local lC=ml.BlizOptions;local nX={}for o,dt in pairs(lC)do local l7=dt:GetUserData("appName")if not nX[l7]then nX[l7]={}end;nX[l7][o]=dt end;ml.BlizOptions=nX else ml.BlizOptions=ml.BlizOptions or{}end;local function nY(dt,F)local hk=dt:GetUserData("path")ml:Open(dt:GetUserData("appName"),dt,unpack(hk or mn))end;local function nZ(dt,F)local l7=dt:GetUserData("appName")ml.frame.closing[l7]=true;ml.frame:SetScript("OnUpdate",nW)end;function ml:AddToBlizOptions(l7,aa,cd,...)local n_=ml.BlizOptions;local o=l7;for d0=1,select("#",...)do o=o.."\001"..select(d0,...)end;if not n_[l7]then n_[l7]={}end;if not n_[l7][o]then local eX=mj:Create("BlizOptionsGroup")n_[l7][o]=eX;eX:SetTitle(aa or l7)eX:SetUserData("appName",l7)if select("#",...)>0 then local hk={}for d0=1,select("#",...)do tinsert(hk,(select(d0,...)))end;eX:SetUserData("path",hk)end;eX:SetCallback("OnShow",nY)eX:SetCallback("OnHide",nZ)if Settings and Settings.RegisterCanvasLayoutCategory then local o0=aa or l7;if cd then local o1=Settings.GetCategory(cd)if not o1 then error(("The parent category '%s' was not found"):format(cd),2)end;local o2=Settings.RegisterCanvasLayoutSubcategory(o1,eX.frame,o0)eX:SetName(o2.ID,cd)else local o1=Settings.RegisterCanvasLayoutCategory(eX.frame,o0)o1.ID=o0;eX:SetName(o0,cd)Settings.RegisterAddOnCategory(o1)end else eX:SetName(aa or l7,cd)InterfaceOptions_AddCategory(eX.frame)end;return eX.frame,eX.frame.name else error(("%s has already been added to the Blizzard Options Window with the given path"):format(l7),2)end end end;local function o3(...)local ld=LibStub("AceConfigRegistry-3.0")local o4=LibStub("AceConfigCmd-3.0")local i,k="AceConfig-3.0",3;local o5=LibStub:NewLibrary(i,k)if not o5 then return end;local pcall,error,type,pairs=pcall,error,type,pairs;function o5:RegisterOptionsTable(l7,l3,mg)local mb,jY=pcall(ld.RegisterOptionsTable,self,l7,l3)if not mb then error(jY,2)end;if mg then if type(mg)=="table"then for aV,o6 in pairs(mg)do o4:CreateChatCommand(o6,l7)end else o4:CreateChatCommand(mg,l7)end end end end;local function o7(...)local o8=24;local _G=_G;if _G.ChatThrottleLib then if _G.ChatThrottleLib.version>=o8 then return elseif not _G.ChatThrottleLib.securelyHooked then print("ChatThrottleLib: Warning: There's an ANCIENT ChatThrottleLib.lua (pre-wow 2.0, <v16) in an addon somewhere. Get the addon updated or copy in a newer ChatThrottleLib.lua (>=v16) in it!")_G.SendChatMessage=_G.ChatThrottleLib.ORIG_SendChatMessage;if _G.ChatThrottleLib.ORIG_SendAddonMessage then _G.SendAddonMessage=_G.ChatThrottleLib.ORIG_SendAddonMessage end end;_G.ChatThrottleLib.ORIG_SendChatMessage=nil;_G.ChatThrottleLib.ORIG_SendAddonMessage=nil end;if not _G.ChatThrottleLib then _G.ChatThrottleLib={}end;ChatThrottleLib=_G.ChatThrottleLib;local ChatThrottleLib=_G.ChatThrottleLib;ChatThrottleLib.version=o8;ChatThrottleLib.MAX_CPS=800;ChatThrottleLib.MSG_OVERHEAD=40;ChatThrottleLib.BURST=4000;ChatThrottleLib.MIN_FPS=20;local setmetatable=setmetatable;local o9=table.remove;local tostring=tostring;local GetTime=GetTime;local di=math.min;local dh=math.max;local next=next;local oa=string.len;local GetFramerate=GetFramerate;local li=string.lower;local unpack,type,pairs,dg=unpack,type,pairs,table.wipe;local UnitInRaid,UnitInParty=UnitInRaid,UnitInParty;local ob={}local oc={__index=ob}function ob:New()local dw={}setmetatable(dw,oc)return dw end;function ob:Add(bq)if self.pos then bq.prev=self.pos.prev;bq.prev.next=bq;bq.next=self.pos;bq.next.prev=bq else bq.next=bq;bq.prev=bq;self.pos=bq end end;function ob:Remove(bq)bq.next.prev=bq.prev;bq.prev.next=bq.next;if self.pos==bq then self.pos=bq.next;if self.pos==bq then self.pos=nil end end end;ChatThrottleLib.PipeBin=nil;local od=setmetatable({},{__mode="k"})local function oe(of)od[of]=true end;local function og()local of=next(od)if of then dg(of)od[of]=nil;return of end;return{}end;ChatThrottleLib.MsgBin=nil;local oh=setmetatable({},{__mode="k"})local function oi(jY)jY[1]=nil;oh[jY]=true end;local function oj()local jY=next(oh)if jY then oh[jY]=nil;return jY end;return{}end;function ChatThrottleLib:Init()if not self.Prio then self.Prio={}self.Prio["ALERT"]={ByName={},Ring=ob:New(),avail=0}self.Prio["NORMAL"]={ByName={},Ring=ob:New(),avail=0}self.Prio["BULK"]={ByName={},Ring=ob:New(),avail=0}end;for aV,ok in pairs(self.Prio)do ok.nTotalSent=ok.nTotalSent or 0 end;if not self.avail then self.avail=0 end;if not self.nTotalSent then self.nTotalSent=0 end;if not self.Frame then self.Frame=CreateFrame("Frame")self.Frame:Hide()end;self.Frame:SetScript("OnUpdate",self.OnUpdate)self.Frame:SetScript("OnEvent",self.OnEvent)self.Frame:RegisterEvent("PLAYER_ENTERING_WORLD")self.OnUpdateDelay=0;self.LastAvailUpdate=GetTime()self.HardThrottlingBeginTime=GetTime()if not self.securelyHooked then self.securelyHooked=true;hooksecurefunc("SendChatMessage",function(...)return ChatThrottleLib.Hook_SendChatMessage(...)end)if _G.C_ChatInfo then hooksecurefunc(_G.C_ChatInfo,"SendAddonMessage",function(...)return ChatThrottleLib.Hook_SendAddonMessage(...)end)else hooksecurefunc("SendAddonMessage",function(...)return ChatThrottleLib.Hook_SendAddonMessage(...)end)end end;self.nBypass=0 end;local ol=false;function ChatThrottleLib.Hook_SendChatMessage(fh,om,on,oo,...)if ol then return end;local self=ChatThrottleLib;local i6=oa(tostring(fh or""))+oa(tostring(oo or""))+self.MSG_OVERHEAD;self.avail=self.avail-i6;self.nBypass=self.nBypass+i6 end;function ChatThrottleLib.Hook_SendAddonMessage(op,fh,om,oo,...)if ol then return end;local self=ChatThrottleLib;local i6=tostring(fh or""):len()+tostring(op or""):len()i6=i6+tostring(oo or""):len()+self.MSG_OVERHEAD;self.avail=self.avail-i6;self.nBypass=self.nBypass+i6 end;function ChatThrottleLib:UpdateAvail()local oq=GetTime()local os=self.MAX_CPS;local ot=os*(oq-self.LastAvailUpdate)local ou=self.avail;if oq-self.HardThrottlingBeginTime<5 then ou=di(ou+ot*0.1,os*0.5)self.bChoking=true elseif GetFramerate()<self.MIN_FPS then ou=di(os,ou+ot*0.5)self.bChoking=true else ou=di(self.BURST,ou+ot)self.bChoking=false end;ou=dh(ou,0-os*2)self.avail=ou;self.LastAvailUpdate=oq;return ou end;function ChatThrottleLib:Despool(ok)local ov=ok.Ring;while ov.pos and ok.avail>ov.pos[1].nSize do local jY=o9(ov.pos,1)if not ov.pos[1]then local of=ok.Ring.pos;ok.Ring:Remove(of)ok.ByName[of.name]=nil;oe(of)else ok.Ring.pos=ok.Ring.pos.next end;local ow=false;local ox=li(jY[3]or"")if ox=="raid"and not UnitInRaid("player")then elseif ox=="party"and not UnitInParty("player")then else ok.avail=ok.avail-jY.nSize;ol=true;jY.f(unpack(jY,1,jY.n))ol=false;ok.nTotalSent=ok.nTotalSent+jY.nSize;oi(jY)ow=true end;if jY.callbackFn then jY.callbackFn(jY.callbackArg,ow)end end end;function ChatThrottleLib.OnEvent(ay,F)local self=ChatThrottleLib;if F=="PLAYER_ENTERING_WORLD"then self.HardThrottlingBeginTime=GetTime()self.avail=0 end end;function ChatThrottleLib.OnUpdate(ay,aJ)local self=ChatThrottleLib;self.OnUpdateDelay=self.OnUpdateDelay+aJ;if self.OnUpdateDelay<0.08 then return end;self.OnUpdateDelay=0;self:UpdateAvail()if self.avail<0 then return end;local d0=0;for oy,ok in pairs(self.Prio)do if ok.Ring.pos or ok.avail<0 then d0=d0+1 end end;if d0<1 then for oy,ok in pairs(self.Prio)do self.avail=self.avail+ok.avail;ok.avail=0 end;self.bQueueing=false;self.Frame:Hide()return end;local ou=self.avail/d0;self.avail=0;for oy,ok in pairs(self.Prio)do if ok.Ring.pos or ok.avail<0 then ok.avail=ok.avail+ou;if ok.Ring.pos and ok.avail>ok.Ring.pos[1].nSize then self:Despool(ok)end end end end;function ChatThrottleLib:Enqueue(oy,oz,jY)local ok=self.Prio[oy]local of=ok.ByName[oz]if not of then self.Frame:Show()of=og()of.name=oz;ok.ByName[oz]=of;ok.Ring:Add(of)end;of[#of+1]=jY;self.bQueueing=true end;function ChatThrottleLib:SendChatMessage(oA,op,fh,om,on,oo,oB,oC,oD)if not self or not oA or not op or not fh or not self.Prio[oA]then error('Usage: ChatThrottleLib:SendChatMessage("{BULK||NORMAL||ALERT}", "prefix", "text"[, "chattype"[, "language"[, "destination"]]]',2)end;if oC and type(oC)~="function"then error('ChatThrottleLib:ChatMessage(): callbackFn: expected function, got '..type(oC),2)end;local oE=fh:len()if oE>255 then error("ChatThrottleLib:SendChatMessage(): message length cannot exceed 255 bytes",2)end;oE=oE+self.MSG_OVERHEAD;if not self.bQueueing and oE<self:UpdateAvail()then self.avail=self.avail-oE;ol=true;_G.SendChatMessage(fh,om,on,oo)ol=false;self.Prio[oA].nTotalSent=self.Prio[oA].nTotalSent+oE;if oC then oC(oD,true)end;return end;local jY=oj()jY.f=_G.SendChatMessage;jY[1]=fh;jY[2]=om or"SAY"jY[3]=on;jY[4]=oo;jY.n=4;jY.nSize=oE;jY.callbackFn=oC;jY.callbackArg=oD;self:Enqueue(oA,oB or op..(om or"SAY")..(oo or""),jY)end;function ChatThrottleLib:SendAddonMessage(oA,op,fh,om,u,oB,oC,oD)if not self or not oA or not op or not fh or not om or not self.Prio[oA]then error('Usage: ChatThrottleLib:SendAddonMessage("{BULK||NORMAL||ALERT}", "prefix", "text", "chattype"[, "target"])',2)end;if oC and type(oC)~="function"then error('ChatThrottleLib:SendAddonMessage(): callbackFn: expected function, got '..type(oC),2)end;local oE=fh:len()if C_ChatInfo or RegisterAddonMessagePrefix then if oE>255 then error("ChatThrottleLib:SendAddonMessage(): message length cannot exceed 255 bytes",2)end else oE=oE+op:len()+1;if oE>255 then error("ChatThrottleLib:SendAddonMessage(): prefix + message length cannot exceed 254 bytes",2)end end;oE=oE+self.MSG_OVERHEAD;if not self.bQueueing and oE<self:UpdateAvail()then self.avail=self.avail-oE;ol=true;if _G.C_ChatInfo then _G.C_ChatInfo.SendAddonMessage(op,fh,om,u)else _G.SendAddonMessage(op,fh,om,u)end;ol=false;self.Prio[oA].nTotalSent=self.Prio[oA].nTotalSent+oE;if oC then oC(oD,true)end;return end;local jY=oj()jY.f=_G.C_ChatInfo and _G.C_ChatInfo.SendAddonMessage or _G.SendAddonMessage;jY[1]=op;jY[2]=fh;jY[3]=om;jY[4]=u;jY.n=u~=nil and 4 or 3;jY.nSize=oE;jY.callbackFn=oC;jY.callbackArg=oD;self:Enqueue(oA,oB or op..om..(u or""),jY)end;ChatThrottleLib:Init()end;local function oF(...)local l=LibStub("CallbackHandler-1.0")local oG=assert(ChatThrottleLib,"AceComm-3.0 requires ChatThrottleLib")local i,k="AceComm-3.0",12;local oH,f=LibStub:NewLibrary(i,k)if not oH then return end;local type,next,pairs,tostring=type,next,pairs,tostring;local cX,cW=string.sub,string.find;local oI=string.match;local tinsert,P=table.insert,table.concat;local error,assert=error,assert;local Ambiguate=Ambiguate;oH.embeds=oH.embeds or{}local oJ="\001"local oK="\002"local oL="\003"local oM="\004"oH.multipart_origprefixes=nil;oH.multipart_reassemblers=nil;oH.multipart_spool=oH.multipart_spool or{}function oH:RegisterComm(op,s)if s==nil then s="OnCommReceived"end;if#op>16 then error("AceComm:RegisterComm(prefix,method): prefix length is limited to 16 characters")end;if C_ChatInfo then C_ChatInfo.RegisterAddonMessagePrefix(op)else RegisterAddonMessagePrefix(op)end;return oH._RegisterComm(self,op,s)end;local oN=false;function oH:SendCommMessage(op,fh,oO,u,oA,oC,oD)oA=oA or"NORMAL"if not(type(op)=="string"and type(fh)=="string"and type(oO)=="string"and(u==nil or type(u)=="string"or type(u)=="number")and(oA=="BULK"or oA=="NORMAL"or oA=="ALERT"))then error('Usage: SendCommMessage(addon, "prefix", "text", "distribution"[, "target"[, "prio"[, callbackFn, callbackarg]]])',2)end;local oP=#fh;local oQ=255;local oB=op..oO..(u or"")local oR=nil;if oC then oR=function(oS)return oC(oD,oS,oP)end end;local oT;if oI(fh,"^[\001-\009]")then if oP+1>oQ then oT=true else fh="\004"..fh end end;if not oT and oP<=oQ then oG:SendAddonMessage(oA,op,fh,oO,u,oB,oR,oP)else oQ=oQ-1;local oU=cX(fh,1,oQ)oG:SendAddonMessage(oA,op,oJ..oU,oO,u,oB,oR,oQ)local d9=1+oQ;while d9+oQ<=oP do oU=cX(fh,d9,d9+oQ-1)oG:SendAddonMessage(oA,op,oK..oU,oO,u,oB,oR,d9+oQ-1)d9=d9+oQ end;oU=cX(fh,d9)oG:SendAddonMessage(oA,op,oL..oU,oO,u,oB,oR,oP)end end;do local oV=setmetatable({},{__mode="k"})local function aH()local aU=next(oV)if aU then oV[aU]=nil;for M=#aU,3,-1 do aU[M]=nil end;return aU end;return{}end;local function oW(op,oX,oY)DEFAULT_CHAT_FRAME:AddMessage(i..": Warning: lost network data regarding '"..tostring(op).."' from '"..tostring(oX).."' (in "..oY..")")end;function oH:OnReceiveMultipartFirst(op,b8,oO,oX)local o=op.."\t"..oO.."\t"..oX;local oZ=oH.multipart_spool;oZ[o]=b8 end;function oH:OnReceiveMultipartNext(op,b8,oO,oX)local o=op.."\t"..oO.."\t"..oX;local oZ=oH.multipart_spool;local o_=oZ[o]if not o_ then return end;if type(o_)~="table"then local aU=aH()aU[1]=o_;aU[2]=b8;oZ[o]=aU else tinsert(o_,b8)end end;function oH:OnReceiveMultipartLast(op,b8,oO,oX)local o=op.."\t"..oO.."\t"..oX;local oZ=oH.multipart_spool;local o_=oZ[o]if not o_ then return end;oZ[o]=nil;if type(o_)=="table"then tinsert(o_,b8)oH.callbacks:Fire(op,P(o_,""),oO,oX)oV[o_]=true else oH.callbacks:Fire(op,o_..b8,oO,oX)end end end;if not oH.callbacks then oH.callbacks=l:New(oH,"_RegisterComm","UnregisterComm","UnregisterAllComm")end;oH.callbacks.OnUsed=nil;oH.callbacks.OnUnused=nil;local function p0(self,F,op,b8,oO,oX)if F=="CHAT_MSG_ADDON"then oX=Ambiguate(oX,"none")local nn,p1=oI(b8,"^([\001-\009])(.*)")if nn then if nn==oJ then oH:OnReceiveMultipartFirst(op,p1,oO,oX)elseif nn==oK then oH:OnReceiveMultipartNext(op,p1,oO,oX)elseif nn==oL then oH:OnReceiveMultipartLast(op,p1,oO,oX)elseif nn==oM then oH.callbacks:Fire(op,p1,oO,oX)else end else oH.callbacks:Fire(op,b8,oO,oX)end else assert(false,"Received "..tostring(F).." event?!")end end;oH.frame=oH.frame or CreateFrame("Frame","AceComm30Frame")oH.frame:SetScript("OnEvent",p0)oH.frame:UnregisterAllEvents()oH.frame:RegisterEvent("CHAT_MSG_ADDON")local aq={"RegisterComm","UnregisterComm","UnregisterAllComm","SendCommMessage"}function oH:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;function oH:OnEmbedDisable(u)u:UnregisterAllComm()end;for u,ae in pairs(oH.embeds)do oH:Embed(u)end end;local function p2(...)local p3,p4='AceTab-3.0',9;local p5,f=LibStub:NewLibrary(p3,p4)if not p5 then return end;p5.registry=p5.registry or{}local _G=_G;local pairs=pairs;local ipairs=ipairs;local type=type;local C=p5.registry;local cW=string.find;local cX=string.sub;local li=string.lower;local p6=string.format;local kF=string.match;local function p7(...)DEFAULT_CHAT_FRAME:AddMessage(p6(...))end;local function p8(ay,p9)return cX(ay:GetText(),p9 or 1,ay:GetCursorPosition())end;local function pa(ew)if ew.hookedByAceTab3 then return end;ew.hookedByAceTab3=true;if ew==ChatEdit_GetActiveWindow()then local pb=ChatEdit_CustomTabPressed;function ChatEdit_CustomTabPressed(...)if p5:OnTabPressed(ew)then return pb(...)else return true end end else local pc=ew:GetScript('OnTabPressed')if type(pc)~='function'then pc=function()end end;ew:SetScript('OnTabPressed',function(...)if p5:OnTabPressed(ew)then return pc(...)end end)end;ew.at3curMatch=0;ew.at3matches={}end;local pd,pe={},{}local pf={}function p5:RegisterTabCompletion(pg,ph,pi,pj,pk,pl,pm)if type(pg)~='string'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'descriptor' - string expected.",3)end;if ph and type(ph)~='string'and type(ph)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'prematches' - string, table, or nil expected.",3)end;if type(pi)~='function'and type(pi)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'wordlist' - function or table expected.",3)end;if pj and type(pj)~='function'and type(pj)~='boolean'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'usagefunc' - function or boolean expected.",3)end;if pk and type(pk)~='string'and type(pk)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'listenframes' - string or table expected.",3)end;if pl and type(pl)~='function'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'postfunc' - function expected.",3)end;if pm and type(pm)~='boolean'and type(pm)~='number'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'pmoverwrite' - boolean or number expected.",3)end;local pn;if type(ph)=='table'then pn=ph;pe[pg]=true else pn={}if not ph then pn[1]=""pd[pg]=true elseif type(ph)=='string'then pn[1]=ph;if ph==""then pd[pg]=true else pe[pg]=true end end end;if not pk then pk={}for M=1,NUM_CHAT_WINDOWS do pk[M]=_G["ChatFrame"..M.."EditBox"]end elseif type(pk)~='table'or type(pk[0])=='userdata'and type(pk.IsObjectType)=='function'then pk={pk}end;for aV,ew in pairs(pk)do if type(ew)=='string'then ew=_G[ew]end;if type(ew)~='table'or type(ew[0])~='userdata'or type(ew.IsObjectType)~='function'then error(p6(p3 ..": Cannot register frame %q; it does not exist",ew:GetName()))end;if ew then if ew:GetObjectType()~='EditBox'then error(p6(p3 ..": Cannot register frame %q; it is not an EditBox",ew:GetName()))else pa(ew)end end end;if not C[pg]then C[pg]={prematches=pn,wordlist=pi,usagefunc=pj,listenframes=pk,postfunc=pl,pmoverwrite=pm}end end;function p5:IsTabCompletionRegistered(pg)return C and C[pg]end;function p5:UnregisterTabCompletion(pg)C[pg]=nil;pf[pg]=nil;pd[pg]=nil;pe[pg]=nil end;local function po(pp,pq)if not pp and not pq then return end;if not pp then pp=pq end;if not pq then pq=pp end;if#pq<#pp then pp,pq=pq,pp end;if cW(li(pq),"^"..li(pp))then return pp else return po(cX(pp,1,-2),pq)end end;local pr;local ps,pt,pu,pv;local function pw(ay)pt=0;pu=false;for i7,px in pairs(ay.at3matches)do for py,pz in pairs(px)do pt=pt+1;if pt==ay.at3curMatch then ay.at3lastMatch=py;ay.at3lastWord=pz;ay.at3curMatch=pt+1;pu=true;break end end;if pu then break end end;if not pu then ay.at3lastMatch=ay.at3origMatch;ay.at3lastWord=ay.at3origWord;ay.at3curMatch=1 end;ay:HighlightText(ay.at3matchStart-1,pr)ay:Insert(ay.at3lastWord or'')ay.at3_last_precursor=p8(ay)or''end;local IsSecureCmd=IsSecureCmd;local pA={}local pB=0;local pC,pD,pE,pF,bu;local pG,pH,pI;local pJ,pK,pL,pM,pN,pO,nj;local function pP(ay,i7,pQ)nj=C[i7]for aV,ew in ipairs(nj.listenframes)do if ew==ay then for aV,pR in ipairs(nj.prematches)do if pQ then pR="%s"end;pJ,pK,pL=nil,1,''pO,pN,pM=nil,nil,nil;while true do pJ,pK,pL=cW(pG,"("..pR..")",pK)if pJ then pM,pN,pO=pJ,pK,pL;pK=pK+1 else break end end;if not pM and pQ then pM,pN,pO=0,0,''end;if pM then pI=cX(pG,pN+1)pf[i7]=nj.pmoverwrite==true and#pO or nj.pmoverwrite or 0;ay.at3matchStart=pN+1-(pf[i7]or 0)local pi=nj.wordlist;local pS=type(pi)=='table'and pi or{}if type(pi)=='function'then pi(pS,pH,pN+1,pI)end;if pS~=false then local pT=ay.at3matches[i7]or{}for M in pairs(pT)do pT[M]=nil end;for aV,py in ipairs(pS)do if cW(li(py),li(pI),1,1)==1 then pD=pD or not pQ;pT[py]=nj.postfunc and nj.postfunc(py,pN+1,pH)or py;pB=pB+1;if pB==1 then pC=pT[py]end end end;ay.at3matches[i7]=pB>0 and pT or nil end end end end end end;function p5:OnTabPressed(ay)if ay:GetText()==''then return true end;if ay==ChatEdit_GetActiveWindow()then local d1=ay:GetText()if cW(d1,"^/[%a%d_]+$")then return true end;local o6=kF(d1,"^/[%a%d_]+")if o6 and IsSecureCmd(o6)then return true end end;pr=ay:GetCursorPosition()pH=ay:GetText()pG=p8(ay)or''ay.at3lastMatch=ay.at3curMatch>0 and(ay.at3lastMatch or ay.at3origWord)if pG==ay.at3_last_precursor then return pw(ay)else for M in pairs(ay.at3matches)do ay.at3matches[M]=nil end;ay.at3curMatch=0;ay.at3origWord=nil;ay.at3origMatch=nil;ay.at3lastWord=nil;ay.at3lastMatch=nil;ay.at3_last_precursor=pG end;pB=0;pC=nil;pD=false;for M in pairs(pf)do pf[M]=nil end;for i7 in pairs(pe)do pP(ay,i7)end;if not pD then for i7 in pairs(pd)do pP(ay,i7,true)end end;if not pC then ay.at3_last_precursor="\0"return true end;if pB==1 then ay:HighlightText(ay.at3matchStart-1,pr)ay:Insert(pC)ay:Insert(" ")else pE=nil;for i7,pT in pairs(ay.at3matches)do if pD and pd[i7]then break end;DEFAULT_CHAT_FRAME:AddMessage(i7 ..":")local pj=C[i7].usagefunc;if not pj then for py,pU in pairs(pT)do DEFAULT_CHAT_FRAME:AddMessage(pU)pE=po(pE,py)end else if type(pj)=='function'then for M in pairs(pA)do pA[M]=nil end;pF=nil;for py in pairs(pT)do pF=po(pF,py)end;pE=po(pE,pF)bu=pj(pA,pT,pF,cX(pG,1,pN))if type(bu)=='string'then DEFAULT_CHAT_FRAME:AddMessage(bu)elseif next(pA)and pB>0 then for py,pU in pairs(pT)do if pA[py]then DEFAULT_CHAT_FRAME:AddMessage(p6("%s - %s",pU,pA[py]))end end end end end;if next(pT)then ay.at3curMatch=1;ay.at3origWord=cX(pG,ay.at3matchStart,ay.at3matchStart+pf[i7]-1)..pE or""ay.at3origMatch=pE or""ay.at3lastWord=ay.at3origWord;ay.at3lastMatch=ay.at3origMatch;ay:HighlightText(ay.at3matchStart-1,pr)ay:Insert(ay.at3origWord)ay.at3_last_precursor=p8(ay)or''end end end end end;local function pV(...)local i,k="AceSerializer-3.0",5;local pW,f=LibStub:NewLibrary(i,k)if not pW then return end;local pX,pY,pZ,p_,bg=string.byte,string.char,string.gsub,string.gmatch,string.format;local assert,error,pcall=assert,error,pcall;local type,tostring,tonumber=type,tostring,tonumber;local pairs,select,q0=pairs,select,math.frexp;local P=table.concat;local q1=math.huge;local q2;local q3,q4="1.#INF","inf"local q5,q6="-1.#INF","-inf"local function q7(db)local d0=pX(db)if d0==30 then return"\126\122"elseif d0<=32 then return"\126"..pY(d0+64)elseif d0==94 then return"\126\125"elseif d0==126 then return"\126\124"elseif d0==127 then return"\126\123"else assert(false)end end;local function q8(ae,lw,q9)local aU=type(ae)if aU=="string"then lw[q9+1]="^S"lw[q9+2]=pZ(ae,"[%c \94\126\127]",q7)q9=q9+2 elseif aU=="number"then local d6=tostring(ae)if tonumber(d6)==ae then lw[q9+1]="^N"lw[q9+2]=d6;q9=q9+2 elseif ae==q1 or ae==-q1 then lw[q9+1]="^N"lw[q9+2]=ae==q1 and q3 or q5;q9=q9+2 else local py,b7=q0(ae)lw[q9+1]="^F"lw[q9+2]=bg("%.0f",py*2^53)lw[q9+3]="^f"lw[q9+4]=tostring(b7-53)q9=q9+4 end elseif aU=="table"then q9=q9+1;lw[q9]="^T"for o,by in pairs(ae)do q9=q8(o,lw,q9)q9=q8(by,lw,q9)end;q9=q9+1;lw[q9]="^t"elseif aU=="boolean"then q9=q9+1;if ae then lw[q9]="^B"else lw[q9]="^b"end elseif aU=="nil"then q9=q9+1;lw[q9]="^Z"else error(i..": Cannot serialize a value of type '"..aU.."'")end;return q9 end;local qa={"^1"}function pW:Serialize(...)local q9=1;for M=1,select("#",...)do local ae=select(M,...)q9=q8(ae,qa,q9)end;qa[q9+1]="^^"return P(qa,"",1,q9+1)end;local function qb(qc)if qc<"~\122"then return pY(pX(qc,2,2)-64)elseif qc=="~\122"then return"\030"elseif qc=="~\123"then return"\127"elseif qc=="~\124"then return"\126"elseif qc=="~\125"then return"\94"end;error("DeserializeStringHelper got called for '"..qc.."'?!?")end;local function qd(qe)if qe==q5 or qe==q6 then return-q1 elseif qe==q3 or qe==q4 then return q1 else return tonumber(qe)end end;local function qf(qg,qh,qi,qj)if not qh then qi,qj=qg()end;if not qi then error("Supplied data misses AceSerializer terminator ('^^')")end;if qi=="^^"then return end;local lw;if qi=="^S"then lw=pZ(qj,"~.",qb)elseif qi=="^N"then lw=qd(qj)if not lw then error("Invalid serialized number: '"..tostring(qj).."'")end elseif qi=="^F"then local qk,b7=qg()if qk~="^f"then error("Invalid serialized floating-point number, expected '^f', not '"..tostring(qk).."'")end;local py=tonumber(qj)b7=tonumber(b7)if not(py and b7)then error("Invalid serialized floating-point number, expected mantissa and exponent, got '"..tostring(py).."' and '"..tostring(b7).."'")end;lw=py*2^b7 elseif qi=="^B"then lw=true elseif qi=="^b"then lw=false elseif qi=="^Z"then lw=nil elseif qi=="^T"then lw={}local ad,ae;while true do qi,qj=qg()if qi=="^t"then break end;ad=qf(qg,true,qi,qj)if ad==nil then error("Invalid AceSerializer table format (no table end marker)")end;qi,qj=qg()ae=qf(qg,true,qi,qj)if ae==nil then error("Invalid AceSerializer table format (no table end marker)")end;lw[ad]=ae end else error("Invalid AceSerializer control code '"..qi.."'")end;if not qh then return lw,qf(qg)else return lw end end;function pW:Deserialize(d6)d6=pZ(d6,"[%c ]","")local qg=p_(d6,"(^.)([^^]*)")local qi,qj=qg()if not qi or qi~="^1"then return false,"Supplied data is not AceSerializer data (rev 1)"end;return pcall(qf,qg)end;pW.internals={SerializeValue=q8,SerializeStringHelper=q7}local aq={"Serialize","Deserialize"}pW.embeds=pW.embeds or{}function pW:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;for u,ae in pairs(pW.embeds)do pW:Embed(u)end end;local function ql(...)BINDING_HEADER_ACE3="Ace3"BINDING_NAME_RELOADUI="ReloadUI"local mj=LibStub("AceGUI-3.0")local mk=LibStub("AceConfigRegistry-3.0")local qm=LibStub("AceConfigDialog-3.0")Ace3=LibStub("AceAddon-3.0"):NewAddon("Ace3","AceConsole-3.0")local Ace3=Ace3;local qn;local bx;local select;local eY={}local qo={}local function hs()mj:Release(bx)bx=nil end;local function qp()for aa in mk:IterateOptionsTables()do qo[aa]=aa end end;local function qq(dt,F,by)qn=by;qm:Open(by,dt)end;local nV;function Ace3:Open()if not nV then nV=CloseSpecialWindows;CloseSpecialWindows=function()local gn=nV()if bx then bx:Hide()return true end;return gn end end;qp()if next(qo)==nil then self:Print("No Configs are Registered")return end;if not bx then bx=mj:Create("Frame")bx:ReleaseChildren()bx:SetTitle("Ace3 Options")bx:SetLayout("FILL")bx:SetCallback("OnClose",hs)select=mj:Create("DropdownGroup")select:SetGroupList(qo)select:SetCallback("OnGroupSelected",qq)bx:AddChild(select)end;if not qn then qn=next(qo)end;select:SetGroup(qn)bx:Show()end;local function nW(ay)select:SetGroup(qn)ay:SetScript("OnUpdate",nil)end;function Ace3:ConfigTableChanged(F,l7)if qn==l7 and bx then bx.frame:SetScript("OnUpdate",nW)end end;mk.RegisterCallback(Ace3,"ConfigTableChange","ConfigTableChanged")function Ace3:PrintCmd(d3)d3=d3:trim():match("^(.-);*$")local J,T=loadstring("LibStub(\"AceConsole-3.0\"):Print("..d3 ..")")if not J then LibStub("AceConsole-3.0"):Print("Error: "..T)else J()end end;function Ace3:OnInitialize()self:RegisterChatCommand("ace3",function()self:Open()end)self:RegisterChatCommand("rl",function()ReloadUI()end)self:RegisterChatCommand("print","PrintCmd")end end;local function qr(...)function __DUMPMACRO(qs)end;local i,k="ScrollingTable",tonumber("@project-timestamp@")or 40300;local ah,f=LibStub:NewLibrary(i,k)if not ah then return end;do ah.SORT_ASC=1;ah.SORT_DSC=2;local qt={["r"]=1.0,["g"]=1.0,["b"]=1.0,["a"]=1.0}local qu={["r"]=1.0,["g"]=0.9,["b"]=0.0,["a"]=0.5}local qv={["r"]=0.0,["g"]=0.0,["b"]=0.0,["a"]=0.0}local qw=2.5;local qx={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local qy=function(self)self.frame:SetHeight(self.displayRows*self.rowHeight+10)self:Refresh()end;local qz=function(self)local dx=13;for fF,col in pairs(self.cols)do dx=dx+(col.width and col.width or 10)end;self.frame:SetWidth(dx+20)self:Refresh()end;local function qA(self,bx,qB)if not bx.highlight then bx.highlight=bx:CreateTexture(nil,"OVERLAY")bx.highlight:SetAllPoints(bx)end;bx.highlight:SetColorTexture(qB.r,qB.g,qB.b,qB.a)end;local qC=function(self,bx,F,bl,...)if not bl(...)then if self.DefaultEvents[F]then self.DefaultEvents[F](...)end end end;local function qD(self,B,qE)local table=self;for M,eq in ipairs(self.rows)do for j,col in ipairs(eq.cols)do if qE and self.events then for F,bl in pairs(self.events)do col:SetScript(F,nil)end end;for F,bl in pairs(B)do col:SetScript(F,function(qF,...)local qG=table.filtered[M+table.offset]table:FireUserEvent(col,F,bl,eq,qF,table.data,table.cols,M,qG,j,table,...)end)end end end;for j,col in ipairs(self.head.cols)do if qE and self.events then for F,bl in pairs(self.events)do col:SetScript(F,nil)end end;for F,bl in pairs(B)do col:SetScript(F,function(qF,...)table:FireUserEvent(col,F,bl,self.head,qF,table.data,table.cols,nil,nil,j,table,...)end)end end;self.events=B end;local function qH(self,fF,qI)local table=self;self.displayRows=fF;self.rowHeight=qI;if not self.rows then self.rows={}end;for M=1,fF do local eq=self.rows[M]if not eq then eq=CreateFrame("Button",self.frame:GetName().."Row"..M,self.frame)self.rows[M]=eq;if M>1 then eq:SetPoint("TOPLEFT",self.rows[M-1],"BOTTOMLEFT",0,0)eq:SetPoint("TOPRIGHT",self.rows[M-1],"BOTTOMRIGHT",0,0)else eq:SetPoint("TOPLEFT",self.frame,"TOPLEFT",4,-5)eq:SetPoint("TOPRIGHT",self.frame,"TOPRIGHT",-4,-5)end;eq:SetHeight(qI)end;if not eq.cols then eq.cols={}end;for j=1,#self.cols do local col=eq.cols[j]if not col then col=CreateFrame("Button",eq:GetName().."col"..j,eq)col.text=eq:CreateFontString(col:GetName().."text","OVERLAY","GameFontHighlightSmall")eq.cols[j]=col;local eD=self.cols[j].align or"LEFT"col.text:SetJustifyH(eD)col:EnableMouse(true)col:RegisterForClicks("AnyUp")if self.events then for F,bl in pairs(self.events)do col:SetScript(F,function(qF,...)if table.offset then local qG=table.filtered[M+table.offset]table:FireUserEvent(col,F,bl,eq,qF,table.data,table.cols,M,qG,j,table,...)end end)end end end;if j>1 then col:SetPoint("LEFT",eq.cols[j-1],"RIGHT",0,0)else col:SetPoint("LEFT",eq,"LEFT",2,0)end;col:SetHeight(qI)col:SetWidth(self.cols[j].width)col.text:SetPoint("TOP",col,"TOP",0,0)col.text:SetPoint("BOTTOM",col,"BOTTOM",0,0)col.text:SetWidth(self.cols[j].width-2*qw)end;j=#self.cols+1;col=eq.cols[j]while col do col:Hide()j=j+1;col=eq.cols[j]end end;for M=fF+1,#self.rows do self.rows[M]:Hide()end;self:SetHeight()end;local function qJ(self,ef)local table=self;self.cols=ef;local eq=self.head;if not eq then eq=CreateFrame("Frame",self.frame:GetName().."Head",self.frame)eq:SetPoint("BOTTOMLEFT",self.frame,"TOPLEFT",4,0)eq:SetPoint("BOTTOMRIGHT",self.frame,"TOPRIGHT",-4,0)eq:SetHeight(self.rowHeight)eq.cols={}self.head=eq end;for M=1,#ef do if type(ef[M].defaultsort)=="string"then if ef[M].defaultsort:lower()=="asc"then ef[M].defaultsort=ah.SORT_DSC elseif ef[M].defaultsort:lower()=="dsc"then ef[M].defaultsort=ah.SORT_ASC else ef[M].defaultsort=nil end end;if type(ef[M].sort)=="string"then if ef[M].sort:lower()=="asc"then ef[M].sort=ah.SORT_DSC elseif ef[M].sort:lower()=="dsc"then ef[M].sort=ah.SORT_ASC else ef[M].sort=nil end end;local qK=eq:GetName().."Col"..M;local col=getglobal(qK)if not col then col=CreateFrame("Button",qK,eq)col:RegisterForClicks("AnyUp")if self.events then for F,bl in pairs(self.events)do col:SetScript(F,function(qF,...)table:FireUserEvent(col,F,bl,eq,qF,table.data,table.cols,nil,nil,M,table,...)end)end end end;eq.cols[M]=col;local qL=col:GetFontString()or col:CreateFontString(col:GetName().."fs","OVERLAY","GameFontHighlightSmall")qL:SetAllPoints(col)qL:SetPoint("LEFT",col,"LEFT",qw,0)qL:SetPoint("RIGHT",col,"RIGHT",-qw,0)local eD=ef[M].align or"LEFT"qL:SetJustifyH(eD)col:SetFontString(qL)qL:SetText(ef[M].name)qL:SetTextColor(0,1.0,1.0,1.0)col:SetPushedTextOffset(0,0)if M>1 then col:SetPoint("LEFT",eq.cols[M-1],"RIGHT",0,0)else col:SetPoint("LEFT",eq,"LEFT",2,0)end;col:SetHeight(self.rowHeight)col:SetWidth(ef[M].width)local qB=ef[M].bgcolor;if qB then local qM="col"..M.."bg"local qN=self.frame[qM]if not qN then qN=self.frame:CreateTexture(nil,"OVERLAY")self.frame[qM]=qN end;qN:SetPoint("BOTTOM",self.frame,"BOTTOM",0,4)qN:SetPoint("TOPLEFT",col,"BOTTOMLEFT",0,-4)qN:SetPoint("TOPRIGHT",col,"BOTTOMRIGHT",0,-4)qN:SetColorTexture(qB.r,qB.g,qB.b,qB.a)end end;self:SetDisplayRows(self.displayRows,self.rowHeight)self:SetWidth()end;local function hE(self)self.frame:Show()self.scrollframe:Show()self.showing=true end;local function hD(self)self.frame:Hide()self.showing=false end;local function qO(self)if not self.sorttable or#self.sorttable~=#self.data then self.sorttable={}end;if#self.sorttable~=#self.data then for M=1,#self.data do self.sorttable[M]=M end end;local M,qP=1,nil;while M<=#self.cols and not qP do if self.cols[M].sort then qP=M end;M=M+1 end;if qP then table.sort(self.sorttable,function(qQ,qR)local qS=self.cols[qP]if qS.comparesort then return qS.comparesort(self,qQ,qR,qP)else return self:CompareSort(qQ,qR,qP)end end)end;self.filtered=self:DoFilter()self:Refresh()end;local qT=function(d6)if d6==""then return 0 else return tonumber(d6)end end;local function qU(self,qQ,qR,qV)local qW,qX=self:GetCell(qQ,qV),self:GetCell(qR,qV)local qY,qZ=qW,qX;if type(qY)=='table'then qY=qY.value end;if type(qZ)=='table'then qZ=qZ.value end;local qS=self.cols[qV]if type(qY)=="function"then if qW.args then qY=qY(unpack(qW.args))else qY=qY(self.data,self.cols,qQ,qV,self)end end;if type(qZ)=="function"then if qX.args then qZ=qZ(unpack(qX.args))else qZ=qZ(self.data,self.cols,qR,qV,self)end end;if type(qY)~=type(qZ)then local q_,r0=type(qY),type(qZ)if q_=="number"and r0=="string"then if tonumber(qZ)then qZ=qT(qZ)else qY=tostring(qY)end elseif q_=="string"and r0=="number"then if tonumber(qY)then qY=qT(qY)else qZ=tostring(qZ)end end end;if qY==qZ then if qS.sortnext then local r1=self.cols[qS.sortnext]if not r1.sort then if r1.comparesort then return r1.comparesort(self,qQ,qR,qS.sortnext)else return self:CompareSort(qQ,qR,qS.sortnext)end else return false end else return false end else local jU=qS.sort or qS.defaultsort or ah.SORT_DSC;if jU==ah.SORT_ASC then return qY<qZ else return qY>qZ end end end;local r2=function(self,r3)return true end;local function r4(self,r2)self.Filter=r2;self:SortData()end;local r5=function(self)local gP={}for eq=1,#self.data do local r6=self.sorttable[eq]local r7=self:GetRow(r6)if self:Filter(r7)then table.insert(gP,r6)end end;return gP end;function GetDefaultHighlightBlank(self)return self.defaulthighlightblank end;function SetDefaultHighlightBlank(self,r8,r9,ra,rb)if not self.defaulthighlightblank then self.defaulthighlightblank=qv end;if r8 then self.defaulthighlightblank["r"]=r8 end;if r9 then self.defaulthighlightblank["g"]=r9 end;if ra then self.defaulthighlightblank["b"]=ra end;if rb then self.defaulthighlightblank["a"]=rb end end;function GetDefaultHighlight(self)return self.defaulthighlight end;function SetDefaultHighlight(self,r8,r9,ra,rb)if not self.defaulthighlight then self.defaulthighlight=qu end;if r8 then self.defaulthighlight["r"]=r8 end;if r9 then self.defaulthighlight["g"]=r9 end;if ra then self.defaulthighlight["b"]=ra end;if rb then self.defaulthighlight["a"]=rb end end;local function rc(self,rd)self.fSelect=rd end;local function re(self)self:SetSelection(nil)end;local function rf(self,r6)self.selected=r6;self:Refresh()end;local function rg(self)return self.selected end;local function rh(ri,qF,qj,ef,eq,r6,qS,rj,table,...)if rj then local r3=table:GetRow(r6)local rk=table:GetCell(r3,qS)local rl=rk;if type(rk)=="table"then rl=rk.value end;if type(rl)=="function"then if rk.args then qF.text:SetText(rl(unpack(rk.args)))else qF.text:SetText(rl(qj,ef,r6,qS,table))end else qF.text:SetText(rl)end;local qB=nil;if type(rk)=="table"then qB=rk.color end;local rm=nil;if not qB then qB=ef[qS].color;if not qB then qB=r3.color;if not qB then qB=qt else rm=r3.colorargs end else rm=ef[qS].colorargs end else rm=rk.colorargs end;if type(qB)=="function"then if rm then qB=qB(unpack(rm))else qB=qB(qj,ef,r6,qS,table)end end;qF.text:SetTextColor(qB.r,qB.g,qB.b,qB.a)local i5=nil;if type(rk)=="table"then i5=rk.highlight end;if table.fSelect then if table.selected==r6 then table:SetHighLightColor(ri,i5 or ef[qS].highlight or r3.highlight or table:GetDefaultHighlight())else table:SetHighLightColor(ri,table:GetDefaultHighlightBlank())end end else qF.text:SetText("")end end;local function rn(self,qj,ro)self.isMinimalDataformat=ro;self.data=qj;self:SortData()end;local function rp(self,r6)return self.data[r6]end;local function rq(self,eq,col)local r3=eq;if type(eq)=="number"then r3=self:GetRow(eq)end;if self.isMinimalDataformat then return r3[col]else return r3.cols[col]end end;local function rr(self,r6)local rs=1+(self.offset or 0)local rt=rs+self.displayRows-1;for M=rs,rt do if self.filtered[M]==r6 and r6~=nil then return true end end;return false end;function ah:CreateST(ef,ru,qI,i5,cd)local rv={}self.framecount=self.framecount or 1;local ew=CreateFrame("Frame","ScrollTable"..self.framecount,cd or UIParent,BackdropTemplateMixin and"BackdropTemplate")self.framecount=self.framecount+1;rv.showing=true;rv.frame=ew;rv.Show=hE;rv.Hide=hD;rv.SetDisplayRows=qH;rv.SetRowHeight=SetRowHeight;rv.SetHeight=qy;rv.SetWidth=qz;rv.SetDisplayCols=qJ;rv.SetData=rn;rv.SortData=qO;rv.CompareSort=qU;rv.RegisterEvents=qD;rv.FireUserEvent=qC;rv.SetDefaultHighlightBlank=SetDefaultHighlightBlank;rv.SetDefaultHighlight=SetDefaultHighlight;rv.GetDefaultHighlightBlank=GetDefaultHighlightBlank;rv.GetDefaultHighlight=GetDefaultHighlight;rv.EnableSelection=rc;rv.SetHighLightColor=qA;rv.ClearSelection=re;rv.SetSelection=rf;rv.GetSelection=rg;rv.GetCell=rq;rv.GetRow=rp;rv.DoCellUpdate=rh;rv.IsRowVisible=rr;rv.RowIsVisible=rr;rv.SetFilter=r4;rv.DoFilter=r5;i5=i5 or{}rv:SetDefaultHighlight(i5["r"],i5["g"],i5["b"],i5["a"])rv:SetDefaultHighlightBlank()rv.displayRows=ru or 12;rv.rowHeight=qI or 15;rv.cols=ef;rv.DefaultEvents={["OnEnter"]=function(ri,qF,qj,ef,eq,r6,qS,table,...)if eq and r6 then local r3=table:GetRow(r6)local rk=table:GetCell(r3,qS)local i5=nil;if type(rk)=="table"then i5=rk.highlight end;table:SetHighLightColor(ri,i5 or ef[qS].highlight or r3.highlight or table:GetDefaultHighlight())end;return true end,["OnLeave"]=function(ri,qF,qj,ef,eq,r6,qS,table,...)if eq and r6 then local r3=table:GetRow(r6)local rk=table:GetCell(r3,qS)if r6~=table.selected or not table.fSelect then table:SetHighLightColor(ri,table:GetDefaultHighlightBlank())end end;return true end,["OnClick"]=function(ri,qF,qj,ef,eq,r6,qS,table,gE,...)if gE=="LeftButton"then if not(eq or r6)then for M,col in ipairs(rv.cols)do if M~=qS then ef[M].sort=nil end end;local rw=ah.SORT_DSC;if not ef[qS].sort and ef[qS].defaultsort then rw=ef[qS].defaultsort elseif ef[qS].sort and ef[qS].sort==ah.SORT_DSC then rw=ah.SORT_ASC end;ef[qS].sort=rw;table:SortData()else if table:GetSelection()==r6 then table:ClearSelection()else table:SetSelection(r6)end end;return true end end}rv.data={}ew:SetBackdrop(qx)ew:SetBackdropColor(0.1,0.1,0.1)ew:SetPoint("CENTER",cd or UIParent,"CENTER",0,0)local fG=CreateFrame("ScrollFrame",ew:GetName().."ScrollFrame",ew,"FauxScrollFrameTemplate")rv.scrollframe=fG;fG:Show()fG:SetScript("OnHide",function(self,...)self:Show()end)fG:SetPoint("TOPLEFT",ew,"TOPLEFT",0,-4)fG:SetPoint("BOTTOMRIGHT",ew,"BOTTOMRIGHT",-26,3)local rx=CreateFrame("Frame",ew:GetName().."ScrollTrough",fG)rx:SetWidth(17)rx:SetPoint("TOPRIGHT",ew,"TOPRIGHT",-4,-3)rx:SetPoint("BOTTOMRIGHT",ew,"BOTTOMRIGHT",-4,4)rx.background=rx:CreateTexture(nil,"BACKGROUND")rx.background:SetAllPoints(rx)rx.background:SetColorTexture(0.05,0.05,0.05,1.0)local ry=CreateFrame("Frame",ew:GetName().."ScrollTroughBorder",fG)ry:SetWidth(1)ry:SetPoint("TOPRIGHT",rx,"TOPLEFT")ry:SetPoint("BOTTOMRIGHT",rx,"BOTTOMLEFT")ry.background=rx:CreateTexture(nil,"BACKGROUND")ry.background:SetAllPoints(ry)ry.background:SetColorTexture(0.5,0.5,0.5,1.0)rv.Refresh=function(self)FauxScrollFrame_Update(fG,#rv.filtered,rv.displayRows,rv.rowHeight)local rz=FauxScrollFrame_GetOffset(fG)rv.offset=rz;for M=1,rv.displayRows do local eq=M+rz;if rv.rows then local ri=rv.rows[M]local r6=rv.filtered[eq]local r7=rv:GetRow(r6)local rj=true;for col=1,#rv.cols do local qF=ri.cols[col]local rA=rv.DoCellUpdate;if r7 then rv.rows[M]:Show()local rB=rv:GetCell(r7,col)if type(rB)=="table"and rB.DoCellUpdate then rA=rB.DoCellUpdate elseif rv.cols[col].DoCellUpdate then rA=rv.cols[col].DoCellUpdate elseif r7.DoCellUpdate then rA=r7.DoCellUpdate end else rv.rows[M]:Hide()rj=false end;rA(ri,qF,rv.data,rv.cols,eq,rv.filtered[eq],col,rj,rv)end end end end;fG:SetScript("OnVerticalScroll",function(self,ag)FauxScrollFrame_OnVerticalScroll(self,ag,rv.rowHeight,function()rv:Refresh()end)end)rv:SetFilter(r2)rv:SetDisplayCols(rv.cols)rv:RegisterEvents(rv.DefaultEvents)return rv end end end;local function rC(...)function _iter_props(bq)for ad,ae in pairs(bq)do print("k: "..ad.." v: "..type(ae))end end;local eJ,dL="SearchTable",28;local df=LibStub and LibStub("AceGUI-3.0",true)local rD=LibStub("ScrollingTable")if not df or(df:GetWidgetVersion(eJ)or 0)>=dL then return end;local tostring,pairs=tostring,pairs;local PlaySound=PlaySound;local GetCursorInfo,ClearCursor,GetSpellInfo=GetCursorInfo,ClearCursor,GetSpellInfo;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIEditBoxInsertLink(...)end)end;function _G.AceGUIEditBoxInsertLink(fh)for M=1,df:GetWidgetCount(eJ)do local jz=_G["AceGUI-3.0EditBox"..M]if jz and jz:IsVisible()and jz:HasFocus()then jz:Insert(fh)return true end end end;local function jA(self)if not self.disablebutton then self.button:Show()self.editbox:SetTextInsets(0,20,3,3)end end;local function jB(self)self.button:Hide()self.editbox:SetTextInsets(0,0,3,3)end;local function hV(bx)bx.obj:Fire("OnEnter")end;local function hW(bx)bx.obj:Fire("OnLeave")end;local function jC(bx)bx.obj.editbox:SetFocus()bx:SetScript("OnShow",nil)end;local function jD(bx)df:ClearFocus()end;local function jE(bx)local self=bx.obj;local by=bx:GetText()local eN=self:Fire("OnEnterPressed",by)if not eN then PlaySound(856)jB(self)end end;local function jF(bx)local self=bx.obj;local type,aN,cB=GetCursorInfo()local aa;if type=="item"then aa=cB elseif type=="spell"then aa=GetSpellInfo(aN,cB)elseif type=="macro"then aa=GetMacroInfo(aN)end;if aa then self:SetText(aa)self:Fire("OnEnterPressed",aa)ClearCursor()jB(self)df:ClearFocus()end end;local function jG(bx)local self=bx.obj;local by=bx:GetText()if tostring(by)~=tostring(self.lasttext)then self:Fire("OnTextChanged",by)self.lasttext=by;jA(self)end end;local function jH(bx)df:SetFocus(bx.obj)end;local function f5(bx)local jz=bx.obj.editbox;jz:ClearFocus()jE(jz)end;local eQ={["OnAcquire"]=function(self)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gg)self.disabled=gg;if gg then self.editbox:EnableMouse(false)self.editbox:ClearFocus()self.editbox:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)else self.editbox:EnableMouse(true)self.editbox:SetTextColor(1,1,1)self.label:SetTextColor(1,.82,0)end end,["SetText"]=function(self,fh)self.lasttext=fh or""self.editbox:SetText(fh or"")self.editbox:SetCursorPosition(0)jB(self)end,["GetText"]=function(self,fh)return self.editbox:GetText()end,["SetLabel"]=function(self,fh)if fh and fh~=""then self.label:SetText(fh)self.label:Show()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,-18)self:SetHeight(44)self.alignoffset=30 else self.label:SetText("")self.label:Hide()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,0)self:SetHeight(26)self.alignoffset=12 end end,["DisableButton"]=function(self,gg)self.disablebutton=gg;if gg then jB(self)end end,["SetMaxLetters"]=function(self,fF)self.editbox:SetMaxLetters(fF or 0)end,["ClearFocus"]=function(self)self.editbox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editbox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",jC)end end,["HighlightText"]=function(self,eb,ec)self.editbox:HighlightText(eb,ec)end,["SetColumns"]=function(self,ef)self.cols=ef;self:SortData()end}local function dK(rE)local fF=df:GetNextWidgetNum(eJ)local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()print(rE)ScrollTableInstance=rD:CreateST(rE,nil,nil,nil,bx)local dt={alignoffset=30,frame=ScrollTableInstance.frame,type=eJ,scrollInstance=ScrollTableInstance}for s,J in pairs(eQ)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eJ,dK,dL)end;local function rF(...)Class={}function Class:init(...)end;function Class:extend(bq,rG)local bq=bq or{}bq.__class__=rG and rG or"class"local function bF(table,oo)local table=table or{}local gP=oo or{}for ad,ae in pairs(table)do if not gP[ad]then if type(ae)=="table"and ad~="__index"and ad~="__newindex"then gP[ad]=bF(ae)else gP[ad]=ae end end end;return gP end;bF(self,bq)bq._=bq._ or{}local al={}al.__call=function(self,...)return self:new(...)end;al.__index=function(table,o)local e8=rawget(table._,o)if e8 and type(e8)=="table"and(e8.get~=nil or e8.value~=nil)then if e8.get then if type(e8.get)=="function"then return e8.get(table,e8.value)else return e8.get end elseif e8.value then return e8.value end else return e8 end end;al.__newindex=function(table,o,by)local e8=rawget(table._,o)if e8 and type(e8)=="table"and(e8.set~=nil and e8._==nil or e8.value~=nil)then local ae=by;if e8.set then if type(e8.set)=="function"then ae=e8.set(table,by,e8.value)else ae=e8.set end end;e8.value=ae;if e8 and e8.afterSet then e8.afterSet(table,ae)end else table._[o]=by end end;setmetatable(bq,al)return bq end;function Class:set(rH,by)if not by and type(rH)=="table"then for ad,ae in pairs(rH)do rawset(self._,ad,ae)end else rawset(self._,rH,by)end end;function Class:new(...)local bq=self:extend({})if bq.init then bq:init(...)end;return bq end;function class(rI,rG)rI=rI and rI or{}rI.__class__=rG and rG or"class"return Class:extend(rI)end;function typeof(bq)if bq==nil then return"nil"end;if bq.__class__ then return bq.__class__ else return type(bq)end end;function settype(bq,class)bq.__class__=class end end;local function rJ(...)tt={}tt.rotations={}tt.botbases={}tt.Classes={}tt.LocalPlayer=nil;tt.time=GetTime()tt.mountID=nil;tt.running=false;tt.doDebugging=true;local rK=0;tt.draw=nil;tt.scoredraw=nil;tt.bgdraw=nil;tt.combatrange=25;tt.pullrange=35;setfenv(1,localenv)tt.AceGUI=LibStub and LibStub("AceGUI-3.0",true)tt.chatcom=LibStub("AceAddon-3.0"):NewAddon("tt","AceConsole-3.0")tt.frame=CreateFrame("Frame","bro",UIParent)tt.frame:SetScript("OnUpdate",function(self,aT)if tt.draw==nil then tt.draw=Draw:New()end;if tt.scoredraw==nil then tt.scoredraw=Draw:New()end;if not tt.running then return end;tt.time=tt.time+aT;if tt.time>rK+.1 then if tt.mountID==nil then for M=1,C_MountJournal.GetNumMounts(),1 do local rL,rM,gJ,rN,rO,rP,rQ,rR,rS,rT,rU=C_MountJournal.GetMountInfoByID(M)if rO and rU then tt.mountID=M;break end end end;tt.scoredraw:ClearCanvas()rK=tt.time;tt:UpdateOM()tt:updateObjectViewer()if tt.botbase then if tt.doDebugging then tt.botbases[tt.botbase]:Debug()else tt.draw:ClearCanvas()tt.scoredraw:ClearCanvas()end;tt.rotations[tt.rotation]:SetRange()tt.botbases[tt.botbase]:Pulse()end end end)function tt:tcount(aU)local jM=0;for ad,ae in pairs(aU)do jM=jM+1 end;return jM end;tt.frame:SetScript("OnKeyDown",function(self,o)if o=="`"then print("Hotkey toggling bot")tt.running=not tt.running;tt:UpdateHUD()end;tt.frame:SetPropagateKeyboardInput(true)end)function tt:Cast(aa,tar)print("Casting "..aa)localenv["CastSpellByName"](aa,tar)end;function tt:MakeTabs(nt,eT,go)local rV=tt.AceGUI:Create("TabGroup")rV:SetLayout("Flow")rV:SetTabs(go)rV:SetTitle(eT)nt:AddChild(rV)end end;local function rW(...)local tt=tt;function tt:RegisterBotBase(aa,rX)tt.botbases[aa]=rX end;function tt:RegisterRotation(aa,rY)tt.rotations[aa]=rY end;function tt:getBotBaseIndex(aa)local M=1;for ad,ae in pairs(tt.botbases)do if ad==aa then return M end;M=M+1 end end;function tt:getRotationIndex(aa)local M=1;for ad,ae in pairs(tt.rotations)do if ad==aa then return M end;M=M+1 end end end;local function rZ(...)local tt=tt;tt.players,tt.units,tt.gameobjects={},{},{}local r_,s0,s1=tt.players,tt.units,tt.gameobjects;function tt:FlushOM()self:UpdateOM()end;function tt:UpdateOM()local s2={}for M=1,dmc.GetObjectCount(),1 do local I=dmc.GetObjectWithIndex(M)if I then table.insert(s2,I)end end;if#s2>0 then for aV,ae in pairs(s2)do if dmc.ObjectType(ae)==7 then if tt.LocalPlayer==nil then tt.LocalPlayer=tt.Classes.LocalPlayer(ae)else tt.LocalPlayer:Update(ae)end end;if dmc.ObjectType(ae)==8 then if tt.gameobjects[ae]then tt.gameobjects[ae]:Update(ae)else tt.gameobjects[ae]=tt.Classes.GameObject(ae)end end;if dmc.ObjectType(ae)==5 then if tt.units[ae]then tt.units[ae]:Update(ae)else tt.units[ae]=tt.Classes.Unit(ae)end end;if dmc.ObjectType(ae)==6 then if tt.players[ae]then tt.players[ae]:Update(ae)else tt.players[ae]=tt.Classes.Player(ae)end end end end;tt:ClearOldObjects()end;function tt:GetObjectByGUID(s3)for ad,ae in pairs(tt.gameobjects)do if ae.pointer==s3 then return ae end end;for ad,ae in pairs(tt.units)do if ae.pointer==s3 then return ae end end;for ad,ae in pairs(tt.players)do if ae.pointer==s3 then return ae end end end;function tt:ClearOldObjects()for ad,ae in pairs(tt.gameobjects)do if not dmc.ObjectExists(ae.pointer)then tt.gameobjects[ad]=nil end end;for ad,ae in pairs(tt.units)do if not dmc.ObjectExists(ae.pointer)then tt.units[ad]=nil end end;for ad,ae in pairs(tt.players)do if not dmc.ObjectExists(ae.pointer)then tt.players[ad]=nil end end end end;local function s4(...)local tt=tt;function tt:NavTo(x,y,z)if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then localenv["MoveForwardStop"]()return end;local s5,s6,s7=dmc.GetUnitPosition("player")if dmc.GetDistance3D(tt.LocalPlayer.x,tt.LocalPlayer.y,tt.LocalPlayer.z,x,y,z)>100 and not IsMounted()and not UnitCastingInfo("player")~=nil then local s8=UnitClass("player")=="Druid"and GetShapeshiftForm()~=3;if s8 then tt:Cast("Travel Form")else if tt.mountID~=nil then localenv["MoveForwardStop"]()C_MountJournal.SummonByID(tt.mountID)return end end end;local s9=dmc.GetMapID()local sa=dmc.FindPath(s9,s5,s6,s7,x,y,z)if sa==0 then return end;local sb,sc,sd=dmc.GetPathNode(2)if sb==nil then return end;local se=dmc.GetDistance3D(s5,s6,s7,sb,sc,sd)local sf=dmc.GetDistance3D(PathX,PathY,PathZ,sb,sc,sd)if sb then local sg,sh,si=s5-sb,s6-sc,s7-sd;local sj=math.atan2(-sh,-sg)if sj<0 then sj=sj+math.pi*2 end;dmc.FaceDirection(sj,false)if se>.1 then localenv["MoveForwardStart"]()else localenv["MoveForwardStop"]()end end end end;local function sk(...)local tt=tt;tt.Classes.GameObject=class()local sl=tt.Classes.GameObject;function sl:init(point)self.pointer=point;self.Name=dmc.ObjectName(point)self.NextUpdate=tt.time+1;self.x,self.y,self.z=dmc.GetUnitPosition(point)self.Distance=dmc.GetDistance3D(x,y,z,self.x,self.y,self.z)self.score=0 end;function sl:Update(point)local x,y,z=dmc.GetUnitPosition("player")self.x,self.y,self.z=dmc.GetUnitPosition(self.pointer)self.Distance=dmc.GetDistance3D(x,y,z,self.x,self.y,self.z)end;function sl:HasPath()local x,y,z=dmc.GetUnitPosition("player")local s9=dmc.GetMapID()local sa=dmc.FindPath(s9,self.x,self.y,self.z,x,y,z,true)if sa==0 then return false else return true end end;function sl:LOS()local x,y,z=dmc.GetUnitPosition("player")local sm=dmc.TraceLine(x,y,z,self.x,self.y,self.z,0x10)if sm==0 then return true end;return false end;function sl:GetEnemiesAround(sn)local iS=0;for ad,ae in pairs(tt.players)do if dmc.GetDistance3D(self.x,self.y,self.z,ae.x,ae.y,ae.z)<sn and ae.Reaction<=3 and not ae.Dead then iS=iS+1 end end;return iS end;function sl:GetFriendsAround(sn)local iS=0;for ad,ae in pairs(tt.players)do if dmc.GetDistance3D(self.x,self.y,self.z,ae.x,ae.y,ae.z)<sn and ae.Reaction>4 and not ae.Dead then iS=iS+1 end end;return iS end;function sl:DistanceFrom(I)return dmc.GetDistance3D(self.x,self.y,self.z,I.x,I.y,I.z)end end;local function so(...)local tt=tt;tt.Classes.Unit=tt.Classes.GameObject:extend()local sp=tt.Classes.Unit;function sp:init(point)tt.Classes.GameObject.init(self,point)self.Reaction=localenv["UnitReaction"]("player",point)self.HP=localenv["UnitHealth"](point)/localenv["UnitHealthMax"](point)*100;self.Health=localenv["UnitHealth"](point)self.HealthMax=localenv["UnitHealthMax"](point)self.lastupdate=0;self.EnemiesAround=0;self.FriendsAround=0;self.Dead=localenv["UnitIsDead"](self.pointer)self.targetScore=0;self.attackable=localenv["UnitCanAttack"]("player",point)end;function sp:Update()tt.Classes.GameObject.Update(self,self.pointer)self.Dead=localenv["UnitIsDead"](self.pointer)self.Health=localenv["UnitHealth"](self.pointer)self.HealthMax=localenv["UnitHealthMax"](self.pointer)self.HP=self.Health/self.HealthMax*100;self.attackable=localenv["UnitCanAttack"]("player",self.pointer)self.los=self:LOS()end;function sp:IsCasting()local aa,aV,aV,aV,sq,sr,aV,aV,aV=localenv["UnitCastingInfo"](self.pointer)local ss,aV,aV,aV,st,su,aV,aV,aV=localenv["UnitChannelInfo"](self.pointer)if aa~=nil then return true end;if ss~=nil then return true end;return false end;function sp:HasBuff(sv,sw)sw=sw or false;for M=1,40 do local aa,aV,iS,sx,aS,sy,sz,aV,aV,sA,aV,aV,aV,aV,sB=localenv["UnitAura"](self.pointer,M,"HELPFUL")if sw then if sz=="player"and aa==sv then return true end else if aa==sv then return true end end end;return false end;function sp:HasDebuff(sv,sw)for M=1,40 do local aa,aV,iS,sx,aS,sy,sz,aV,aV,sA,aV,aV,aV,aV,sB=localenv["UnitAura"](self.pointer,M,"HARMFUL")if sw then if sz=="player"and aa==sv then return true end else if aa==sv then return true end end end;return false end;function sp:TargetingMe()local u=dmc.UnitTarget(self.pointer)if u==tt.LocalPlayer.pointer then return true end;return false end end;local function sC(...)local tt=tt;tt.Classes.Player=tt.Classes.Unit:extend()local sD=tt.Classes.Player;function sD:init(point)tt.Classes.Unit.init(self,point)self.power=localenv["UnitPower"](self.pointer)self.combo=localenv["UnitPower"](self.pointer,4)end;function sD:Update()tt.Classes.Unit.Update(self,point)self.power=localenv["UnitPower"](self.pointer)self.combo=localenv["UnitPower"](self.pointer,4)self:Debug()end;function sD:Debug()if tt.scoredraw==nil then tt.scoredraw=Draw:New()end;if self.score~=nil and self.score>0 then tt.scoredraw:SetColor(0,255,0,255)tt.scoredraw:Text(self.Name.." "..string.format("%0d",self.HP),"GameFontNormal",self.x,self.y,self.z+5)end;if self.targetScore~=nil and self.targetScore>0 then tt.scoredraw:SetColor(255,0,0,255)tt.scoredraw:Text(self.Name.." "..string.format("%0d",self.targetScore),"GameFontNormal",self.x,self.y,self.z+5)end end end;local function sE(...)local tt=tt;tt.Classes.LocalPlayer=tt.Classes.Player:extend()local sF=tt.Classes.LocalPlayer;function sF:init(point)tt.Classes.Player.init(self,point)end;function sF:Update()tt.Classes.Player.Update(self,point)self.arcane=localenv["UnitPower"]("player",16)end;function sF:Debug()end end;local function sG(...)local tt=tt;tt.Classes.Spot=class()local sH=tt.Classes.Spot;function sH:init(x,y,z,sI,sJ,sK,sL)self.x=x;self.y=y;self.z=z;self.mapID=sI;self.facex=sJ;self.facey=sK;self.facez=sL end end;local function sM(...)local tt=tt;tt.botbases.BGBot=class()local sN=tt.botbases.BGBot;sN.name="BGBot"sN.allowMovement=true;function sN:init()self.allowMovement=true end;local sO=0;local sP=0;local sQ=0;tt.movespot={}tt.badspot={}tt.bestmove=nil;tt.besttarget=nil;local sR=nil;local sS=nil;tt.bgdraw=dmc.Draw:New()tt.PVPMoveScores={}tt.PVPTargetScores={}local sT=tt.Classes.Spot(628.09710693359,230.25869750977,328.99182128906,727,675.06805419922,222.31399536133,319.90646362305)local sU=tt.Classes.Spot(1816.8699951172,160.08299255371,1.8064399957657,726,1812.6453857422,200.64604187012,-20.939380645752)local sV=tt.Classes.Spot(1061.9154052734,1378.19140625,328.5080871582,726,1090.0329589844,1397.9826660156,319.44784545898)tinsert(tt.movespot,sT)tinsert(tt.movespot,sU)tinsert(tt.movespot,sV)local sW=tt.Classes.Spot(1803.0208740234,1539.9670410156,1249.1867675781,566,671.68951416016,222.47822570801,320.1237487793)tinsert(tt.badspot,sW)function sN:Pulse()self:BuildMoveScores()self:BuildTargetScores()tt.LocalPlayer:HasBuff("Regrowth")if not UnitInBattleground("player")then if HonorFrameQueueButton==nil or not HonorFrameQueueButton:IsVisible()and GetBattlefieldStatus(1)~="queued"then TogglePVPUI()end;if GetBattlefieldStatus(1)~="queued"and GetBattlefieldStatus(1)~="confirm"then localenv["RunMacroText"]("/click HonorFrameQueueButton")tt:SetStatusText("Queueing for BG")end;if GetBattlefieldStatus(1)=="queued"then tt:SetStatusText("Waiting for BG to pop currently waited "..tt:ConvertToMS(GetBattlefieldTimeWaited(1)))if PVPQueueFrame~=nil and PVPQueueFrame:IsVisible()then TogglePVPUI()end end;if GetBattlefieldStatus(1)=="confirm"then localenv["AcceptBattlefieldPort"](1,true)tt:SetStatusText("Accepting BG")end else local sX=UnitGroupRolesAssigned("player")self:BuildMoveScores()self:BuildTargetScores()if GetBattlefieldWinner()then LeaveBattlefield()return end;if UnitIsDeadOrGhost("player")then localenv["MoveForwardStop"]()RepopMe()tt:SetStatusText("Releasing and waiting to be alive")return end;if TimerTrackerTimer1~=nil and TimerTrackerTimer1.barShowing then tt:SetStatusText("Waiting for BG to start")return end;local point=dmc.ObjectMover('player')if point~=nil then tt:SetStatusText("Moving off boat")localenv["MoveForwardStart"]()local x,y,z=dmc.GetUnitPosition("player")local s5,s6,s7=5,31,34;local sg,sh,si=x-s5,y-s6,z-s7;local sj=math.atan2(-sh,-sg)if dmc.GetDistance3D(x,y,z,s5,s6,s7)<10 then return end;dmc.FaceDirection(sj,false)return end;if self:InMoveSpot()then print("in move spot")return end;for ad,ae in pairs(tt.PVPMoveScores)do if ae.player:HasPath()and ae.player.Distance~=nil then sR=ae.player;break end end;for ad,ae in pairs(tt.PVPTargetScores)do if ae.player:HasPath()and ae.player.Distance~=nil and ae.player.Reaction<=3 and ae.player.Distance<70 and not ae.player:LOS()then sS=ae.player end end;sS=self:ClosestTarget()local sY=tt.CombatHelpers:GetClosestHeal(101,40)tt.besttarget=sS;if sS~=nil and sX~="HEALER"then if sS.Distance<tt.pullrange then localenv["MoveForwardStop"]()tt:SetStatusText("Targeting best target "..sS.Name.." "..sS.Distance)localenv["TargetUnit"](sS.pointer)local x,y,z=dmc.GetUnitPosition("player")local s5,s6,s7=dmc.GetUnitPosition(sS.pointer)if s5==nil then return end;local sg,sh,si=x-s5,y-s6,z-s7;local sj=math.atan2(-sh,-sg)dmc.FaceDirection(sj,false)tt.rotations[tt.rotation]:Pulse(sS)return else tt:SetStatusText("Moving to best target "..sS.Name.." "..sS.Distance)tt:NavTo(sS.x,sS.y,sS.z)return end end;if sR~=nil then if sR.Distance<tt.pullrange then localenv["MoveForwardStop"]()if sX=="HEALER"then local x,y,z=dmc.GetUnitPosition("player")local s5,s6,s7=dmc.GetUnitPosition(sR.pointer)if s5==nil then return end;local sg,sh,si=x-s5,y-s6,z-s7;local sj=math.atan2(-sh,-sg)dmc.FaceDirection(sj,false)tt.rotations[tt.rotation]:Pulse(sR)end;return else tt:SetStatusText("Moving to best move spot "..sR.Name.." "..sR.Distance)tt:NavTo(sR.x,sR.y,sR.z)return end end end end;function sN:BuildMoveScores()if GetTime()-sP<2.5 then return end;for ad,ae in pairs(tt.PVPMoveScores)do tt.PVPMoveScores[ad]=nil end;local sZ=4;local s_=2;local sX=UnitGroupRolesAssigned("player")if sX=="HEALER"then sZ=5;s_=2 else s_=5;sZ=2 end;for ad,ae in pairs(tt.players)do if ae.pointer~=tt.LocalPlayer.pointer and not ae.Dead and dmc.ObjectExists(ae.pointer)and ae.Reaction>=5 then local t0=ae:GetFriendsAround(30)local t1=ae:GetEnemiesAround(30)local t2=(1000+t0*sZ+t1*s_)*15;if ae.Distance==nil then t2=t2-100000 else t2=t2-ae.Distance*.5 end;if t1/t0>2 then t2=t2-5000 end;if localenv["UnitAffectingCombat"](ae.pointer)then t2=t2+500 end;ae.score=t2;tinsert(tt.PVPMoveScores,{score=t2,player=ae})end end;table.sort(tt.PVPMoveScores,function(x,y)return x.score>y.score end)sP=GetTime()end;function sN:BuildTargetScores()if GetTime()-sQ<.5 then return end;for ad,ae in pairs(tt.PVPTargetScores)do tt.PVPTargetScores[ad]=nil end;for ad,ae in pairs(tt.players)do if not ae.Dead and ae.Reaction<=3 and ae.Distance~=nil and ae.Distance<60 and not ae:LOS()then local t2=1000;if ae.Distance==nil then t2=t2-100000 else t2=t2-dmc.GetDistance3D("player",ae.pointer)end;if ae:TargetingMe()then t2=t2+100 end;if ae.Distance~=nil and ae.Distance<15 then t2=t2+100000 end;ae.targetScore=t2;tinsert(tt.PVPTargetScores,{score=t2,player=ae})end end;table.sort(tt.PVPTargetScores,function(x,y)return x.score>y.score end)sQ=GetTime()end;function sN:InMoveSpot()local x,y,z=dmc.GetUnitPosition("player")for ad,ae in pairs(tt.movespot)do if dmc.GetDistance3D(x,y,z,ae.x,ae.y,ae.z)<35 then local s5,s6,s7=ae.facex,ae.facey,ae.facez;local sg,sh,si=x-s5,y-s6,z-s7;local sj=math.atan2(-sh,-sg)localenv["MoveForwardStart"]()return true end end;return false end;function sN:IsInSpawn(x,y,z)for ad,ae in pairs(tt.badspot)do if dmc.GetDistance3D(x,y,z,ae.x,ae.y,ae.z)<35 then print("in bad spot not going here")return true end end;return false end;function tt:ConvertToMS(t3)local t4=t3/1000;local t5=math.floor(t4/60)local t6=t4-t5*60;return string.format("%02d:%02d",t5,t6)end;function sN:ClosestTarget()local t7=nil;local t8=999999;for ad,ae in pairs(tt.players)do if ae.pointer~="player"then if ae.Distance~=nil and dmc.GetDistance3D("player",ae.pointer)<150 and dmc.GetDistance3D("player",ae.pointer)<t8 and ae.Reaction<=3 and not ae.Dead then t8=ae.Distance;t7=ae end end end;return t7 end;function sN:Debug()tt.draw:ClearCanvas()tt.draw:SetColor(0,255,0)local x,y,z=dmc.GetUnitPosition("player")if sS~=nil then tt.draw:SetColor(255,0,0)tt.draw:Line(sS.x,sS.y,sS.z,x,y,z,true)end;if sR~=nil then tt.draw:SetColor(0,255,0)tt.draw:Line(sR.x,sR.y,sR.z,x,y,z,true)end end;tt:RegisterBotBase(sN.name,sN)end;local function t9(...)local tt=tt;tt.botbases.RotationBot=class()local ta=tt.botbases.RotationBot;ta.name="RotationBot"ta.allowMovement=false;function ta:init()end;function ta:Pulse()if localenv["UnitAffectingCombat"]("player")then tt.rotations[tt.rotation]:Pulse(dmc.UnitTarget("player"))end end;function ta:Debug()end;tt:RegisterBotBase(ta.name,ta)end;local function tb(...)local tt=tt;tt.botbases.DungeonBot=class()local tc=tt.botbases.DungeonBot;tc.name="DungeonBot"function tc:init()end;function tc:Pulse()if IsInInstance()then local td=self:GetNearestEnemy()if td then local x,y,z=dmc.GetUnitPosition("player")if dmc.GetDistance3D(td.x,td.y,td.z,x,y,z)>tt.combatrange then tt:NavTo(td.x,td.y,td.z)tt.rotations[tt.rotation]:Pulse()else localenv["MoveForwardStop"]()localenv["TargetUnit"](td.pointer)tt.rotations[tt.rotation]:Pulse()end end end end;function tc:GetNearestEnemy()local te=nil;local tf=999999;for ad,ae in pairs(tt.units)do if ae.attackable and not ae.Dead then local x,y,z=dmc.GetUnitPosition("player")local tg=dmc.GetDistance3D(ae.x,ae.y,ae.z,x,y,z)if tg<tf then te=ae;tf=tg end end end;return te end;function tc:Debug()end;tt:RegisterBotBase(tc.name,tc)end;local function th(...)local tt=tt;tt.rotations.External=class()local ti=tt.rotations.External;ti.name="External"ti.class="all"function ti:init()end;function ti:Pulse()return end;tt:RegisterRotation(ti.name,ti)end;local function tj(...)local tt=tt;tt.rotations.Druid=class()local tk=tt.rotations.Druid;tk.name="Druid"tk.class="druid"local tl;function tk:init()end;function tk:Pull()end;function tk:SetRange()tt.combatrange=5;tt.pullrange=25;if GetSpecialization()==1 then tt.combatrange=35;tt.pullrange=35 end;if GetSpecialization()==4 then tt.combatrange=35;tt.pullrange=35 end end;function tk:Pulse(u)local tm=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then if type(u)=="string"then u=tt:GetObjectByGUID(u)end;local tn=tt:GetObjectByGUID(u)if tm==1 then if u.Distance>tt.combatrange and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.PosX,u.PosY,u.PosZ)end;local to=tt.CombatHelpers:GetClosestCaster(40)if to~=nil then tt:Cast("Solar Beam",to.pointer)end;if GetShapeshiftForm()~=4 then tt:Cast("Moonkin Form","player")end;if not u:HasDebuff("Moonfire",u.pointer)then tt:Cast("Moonfire",u.pointer)end;if not u:HasDebuff("Sunfire",u.pointer)then tt:Cast("Sunfire",u.pointer)end;local tp=tt.CombatHelpers:GetDebuffCount("Moonfire")local tq=tt.CombatHelpers:GetDebuffCount("Sunfire")local tr=tt.CombatHelpers:ClosestWithoutDebuff("Moonfire")tt:Cast("Celestial Alignment","player")tt:Cast("Convoke the Spirits",u.pointer)tt:Cast("Starsurge",u.pointer)if tt.LocalPlayer:HasBuff("Ownkin Frenzy")then tt:Cast("Starfire",u.pointer)end;tt:Cast("wrath",u.pointer)end;if tm==2 then if u.Distance>tt.combatrange and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)end;if GetShapeshiftForm()~=2 then tt:Cast("Cat Form","player")end;if not localenv["UnitAffectingCombat"]("player")and not tt.LocalPlayer:HasBuff("Prowl")then tt:Cast("Prowl","player")end;if tt.LocalPlayer:HasBuff("Predatory Swiftness")then tt:Cast("Regrowth","player")end;tt:Cast("Wild Charge",u.pointer)if tt.LocalPlayer.power<40 then tt:Cast("Tiger's Fury","player")end;if tt.LocalPlayer:HasBuff("Tiger's Fury")then tt:Cast("Berserk",u.pointer)end;if not u:HasDebuff("Adaptive Swarm")then tt:Cast("Adaptive Swarm",u.pointer)end;tt:Cast("Feral Frenzy",u.pointer)if tt.LocalPlayer:HasBuff("Apex Predator's Craving")then tt:Cast("Ferocious Bite",u.pointer)end;if tt.LocalPlayer.combo==3 then tt:Cast("Brutal Slash",u.pointer)end;if not u:HasDebuff("Rip")and tt.LocalPlayer.combo>=5 then tt:Cast("Rip",u.pointer)end;if tt.LocalPlayer.combo>=5 then tt:Cast("Ferocious Bite",u.pointer)end;if not u:HasDebuff("Rake")then tt:Cast("Rake",u.pointer)end;tt:Cast("Shred",u)end;if tm==4 then local ts=tt.CombatHelpers:LowestFriend()local tu=tt.CombatHelpers:GetBuffCount("Lifebloom")print("lbcount is "..tu)if ts~=nil then print("lowest is "..ts.Name.." "..ts.HP)if ts.HP<95 and tu<1 then tt:Cast("Lifebloom",ts.pointer)end;if ts.HP<50 and ts:HasBuff("Regrowth")then tt:Cast("Swiftmend",ts.pointer)end;if ts.HP<65 then tt:Cast("Regrowth",ts.pointer)end;if ts.HP<80 and not ts:HasBuff("Rejuvenation")then tt:Cast("Rejuvenation",ts.pointer)end end end end end;function tk:PVPTarget()end;function tk:BuildConfig()if tl==nil then tl=tt.AceGUI:Create("Frame")tl:SetTitle("Druid Config")tl:SetStatusText("Druid Config")tl:SetWidth(800)tl:SetHeight(800)local rV=tt:MakeTabs(tl,"Druid Config",{{value="Resto",text="Resto"},{value="Feral",text="Feral"},{value="Balance",text="Balance"},{value="Guardian",text="Guardian"}})end end;function tk:OpenConfig()if tl==nil then tk:BuildConfig()end;print("Opening Druid Config")tl:Show()end;tt:RegisterRotation(tk.name,tk)end;local function tv(...)local tt=tt;tt.rotations.Warrior=class()local tw=tt.rotations.Warrior;tw.name="Warrior"tw.class="Warrior"function tw:init()end;function tw:SetRange()tt.combatrange=5;tt.pullrange=25 end;function tw:Pull()if localenv["UnitAffectingCombat"]("player")then return self:Pulse()end end;function tw:Pulse(u)local tm=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then if type(u)=="string"then u=tt:GetObjectByGUID(u)end;local tn=tt:GetObjectByGUID(u)local x,y,z=dmc.GetUnitPosition("player")local s5,s6,s7=dmc.GetUnitPosition(u.pointer)if s5==nil then return end;local sg,sh,si=x-s5,y-s6,z-s7;local sj=math.atan2(-sh,-sg)if tt.botbases[tt.botbase].allowMovement then dmc.FaceDirection(sj,false)end;if tm==2 then if u.Distance>5 and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)end;if not tt.LocalPlayer:HasBuff("Battle Shout")then tt:Cast("Battle Shout","player")end;if not u:HasDebuff("Rend")then tt:Cast("Rend",u.pointer)end;if not tt.LocalPlayer:HasBuff("Enrage")then tt:Cast("Enrage","player")end;tt:Cast("Execute",u.pointer)tt:Cast("Bloodthirst",u.pointer)tt:Cast("Raging Blow",u.pointer)end;if tm==1 then if u.Distance>5 and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)else end;tt:Cast("Charge",u.pointer)if not tt.LocalPlayer:HasBuff("Battle Shout")then tt:Cast("Battle Shout","player")end;if not tt.LocalPlayer:HasBuff("Enrage")then tt:Cast("Enrage","player")end;tt:Cast("Warbreaker",u.pointer)tt:Cast("Execute",u.pointer)tt:Cast("Overpower",u.pointer)tt:Cast("Mortal Strike",u.pointer)end;if tm==2 then end end end;tt:RegisterRotation(tw.name,tw)end;local function tx(...)local tt=tt;tt.rotations.Mage=class()local ty=tt.rotations.Mage;ty.name="Mage"ty.class="mage"function ty:init()end;function ty:SetRange()tt.combatrange=35;tt.pullrange=35 end;function ty:Pull()if localenv["UnitAffectingCombat"]("player")then return self:Pulse()end;tt:Cast("Fireball",tar)end;function ty:Pulse(u)local tm=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then if type(u)=="string"then u=tt:GetObjectByGUID(u)end;local tn=tt:GetObjectByGUID(u)local x,y,z=dmc.GetUnitPosition("player")local s5,s6,s7=dmc.GetUnitPosition(u.pointer)if s5==nil then return end;local sg,sh,si=x-s5,y-s6,z-s7;local sj=math.atan2(-sh,-sg)if tt.botbases[tt.botbase].allowMovement then dmc.FaceDirection(sj,false)end;if tm==1 then if u.Distance>30 and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)end;if not tt.LocalPlayer:HasBuff("Arcane Power")then tt:Cast("Arcane Power","player")end;if not tt.LocalPlayer:HasBuff("Rune of Power")then tt:Cast("Rune of Power","player")end;if not tt.LocalPlayer:HasBuff("Arcane Familiar")then tt:Cast("Arcane Familiar","player")end;if not tt.LocalPlayer:HasBuff("Arcane Intellect")then tt:Cast("Arcane Intellect","player")end;if tt.LocalPlayer:HasBuff("Clearcasting")then tt:Cast("Arcane Missiles",u.pointer)end;if tt.LocalPlayer.arcane~=nil and tt.LocalPlayer.arcane<4 then tt:Cast("Arcane Blast",u.pointer)end;if tt.LocalPlayer.arcane==4 then tt:Cast("Arcane Barrage",u.pointer)end end;if tm==3 then if u.Distance>30 and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)end;if not tt.LocalPlayer:HasBuff("Icy Veins")then tt:Cast("Icy Veins","player")end;if not tt.LocalPlayer:HasBuff("Rune of Power")then tt:Cast("Rune of Power","player")end;if not tt.LocalPlayer:HasBuff("Arcane Intellect")then tt:Cast("Arcane Intellect","player")end;if tt.LocalPlayer:HasBuff("Brain Freeze")then tt:Cast("Flurry",u.pointer)end;if tt.LocalPlayer:HasBuff("Fingers of Frost")then tt:Cast("Ice Lance",u.pointer)end;tt:Cast("Frozen Orb",u.pointer)tt:Cast("Ice Nova",u.pointer)tt:Cast("Frostbolt",u.pointer)end;if tm==2 then if u.Distance>30 and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)end;if not tt.LocalPlayer:HasBuff("Blazing Barrier")then tt:Cast("Blazing Barrier","player")end;tt:Cast("Combustion","player")if tt.LocalPlayer:HasBuff("Hot Streak!")then tt:Cast("Pyroblast",u.pointer)end;if tt.LocalPlayer:HasBuff("Heating Up")then tt:Cast("Fire Blast",u.pointer)end;tt:Cast("Fireball",u.pointer)end end end;tt:RegisterRotation(ty.name,ty)end;local function tz(...)local tt=tt;tt.rotations.Paladin=class()local tA=tt.rotations.Paladin;tA.name="Paladin"tA.class="paladin"function tA:init()end;function tA:Pull()end;function tA:SetRange()tt.combatrange=5;tt.pullrange=25;if GetSpecialization()==1 then tt.combatrange=35;tt.pullrange=35 end;if GetSpecialization()==4 then tt.combatrange=35;tt.pullrange=35 end end;function tA:Pulse(u)local tm=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then if type(u)=="string"then u=tt:GetObjectByGUID(u)end;local tn=tt:GetObjectByGUID(u)local x,y,z=dmc.GetUnitPosition("player")local s5,s6,s7=dmc.GetUnitPosition(u.pointer)if s5==nil then return end;local sg,sh,si=x-s5,y-s6,z-s7;local sj=math.atan2(-sh,-sg)dmc.FaceDirection(sj,false)if tm==3 then if u.Distance>5 then tt:NavTo(u.x,u.y,u.z)end;tt:Cast("Blade of Justice",u.pointer)tt:Cast("Judgment",u.pointer)tt:Cast("Avenge Wrath","player")tt:Cast("Hammer of Wrath",u.pointer)tt:Cast("Templar's Verdict",u.pointer)tt:Cast("Crusader Strike",u.pointer)end;if tm==2 then if u.Distance>5 then tt:NavTo(u.x,u.y,u.z)end;tt:Cast("Avenger's Shield",u.pointer)tt:Cast("Judgment",u.pointer)tt:Cast("Hammer of Wrath",u.pointer)tt:Cast("Consecration",u.pointer)tt:Cast("Holy Wrath",u.pointer)tt:Cast("Shield of the Righteous",u.pointer)tt:Cast("Hammer of the Righteous",u.pointer)end end end;tt:RegisterRotation(tA.name,tA)end;local function tB(...)local tt=tt;tt.rotations.Monk=class()local tC=tt.rotations.Monk;tC.name="Monk"tC.class="Monk"function tC:init()end;function tC:SetRange()tt.combatrange=5;tt.pullrange=25 end;function tC:Pull()if localenv["UnitAffectingCombat"]("player")then return self:Pulse()end end;function tC:Pulse(u)local tm=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then if type(u)=="string"then u=tt:GetObjectByGUID(u)end;local tn=tt:GetObjectByGUID(u)local x,y,z=dmc.GetUnitPosition("player")local s5,s6,s7=dmc.GetUnitPosition(u.pointer)if s5==nil then return end;local sg,sh,si=x-s5,y-s6,z-s7;local sj=math.atan2(-sh,-sg)if tt.botbases[tt.botbase].allowMovement then dmc.FaceDirection(sj,false)end;if tm==1 then if u.Distance>5 and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)end;if not tt.LocalPlayer:HasBuff("Ironskin Brew")then tt:Cast("Ironskin Brew","player")end;if not tt.LocalPlayer:HasBuff("Stagger")then tt:Cast("Stagger","player")end;if not tt.LocalPlayer:HasBuff("Fortifying Brew")then tt:Cast("Fortifying Brew","player")end;if not tt.LocalPlayer:HasBuff("Keg Smash")then tt:Cast("Keg Smash",u.pointer)end;if not tt.LocalPlayer:HasBuff("Breath of Fire")then tt:Cast("Breath of Fire",u.pointer)end;if not tt.LocalPlayer:HasBuff("Blackout Strike")then tt:Cast("Blackout Strike",u.pointer)end;if not tt.LocalPlayer:HasBuff("Tiger Palm")then tt:Cast("Tiger Palm",u.pointer)end;if not tt.LocalPlayer:HasBuff("Rushing Jade Wind")then tt:Cast("Rushing Jade Wind","player")end;if not tt.LocalPlayer:HasBuff("Black Ox Brew")then tt:Cast("Black Ox Brew","player")end;tt:Cast("Rising Sun Kick",u.pointer)end;if tm==3 then if u.Distance>30 and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)end;if not tt.LocalPlayer:HasBuff("Icy Veins")then tt:Cast("Icy Veins","player")end;if not tt.LocalPlayer:HasBuff("Rune of Power")then tt:Cast("Rune of Power","player")end;if not tt.LocalPlayer:HasBuff("Arcane Intellect")then tt:Cast("Arcane Intellect","player")end;if tt.LocalPlayer:HasBuff("Brain Freeze")then tt:Cast("Flurry",u.pointer)end;if tt.LocalPlayer:HasBuff("Fingers of Frost")then tt:Cast("Ice Lance",u.pointer)end;tt:Cast("Frozen Orb",u.pointer)tt:Cast("Ice Nova",u.pointer)tt:Cast("Frostbolt",u.pointer)end;if tm==2 then if u.Distance>30 and tt.botbases[tt.botbase].allowMovement then tt:NavTo(u.x,u.y,u.z)end;if not tt.LocalPlayer:HasBuff("Blazing Barrier")then tt:Cast("Blazing Barrier","player")end;tt:Cast("Combustion","player")if tt.LocalPlayer:HasBuff("Hot Streak!")then tt:Cast("Pyroblast",u.pointer)end;if tt.LocalPlayer:HasBuff("Heating Up")then tt:Cast("Fire Blast",u.pointer)end;tt:Cast("Fireball",u.pointer)end end end;tt:RegisterRotation(tC.name,tC)end;local function tD(...)local tt=tt;tt.CombatHelpers={}local tE=tt.CombatHelpers;function tE:GetClosestCaster(sn)local t7=nil;local tF=9999;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<tF and ae.Distance<sn and ae.Reaction<=3 and ae:IsCasting()then t7=ae;tF=ae.Distance end end;return t7 end;function tE:GetDebuffCount(tG)local iS=0;for ad,ae in pairs(tt.players)do if ae:HasDebuff(tG)then iS=iS+1 end end;return iS end;function tE:GetBuffCount(tG)local iS=0;for ad,ae in pairs(tt.players)do if ae:HasBuff(tG)then iS=iS+1 end end;return iS end;function tE:BelowHealthCount(tH)local iS=0;for ad,ae in pairs(tt.players)do if ae.HealthPercent<tH then iS=iS+1 end end;return iS end;function tE:ClosestWithOutBuff(tG)local t7=nil;local tF=9999;for ad,ae in pairs(tt.players)do if ae.Distance<tF and ae.Distance<40 and not ae:HasBuff(tG)then t7=ae;tF=ae.Distance end end;return t7 end;function tE:ClosestWithBuff(tG)local t7=nil;local tF=9999;for ad,ae in pairs(tt.players)do if ae.Distance<tF and ae.Distance<40 and ae:HasBuff(tG)then t7=ae;tF=ae.Distance end end;return t7 end;function tE:ClosestWithDebuff(tG)local t7=nil;local tF=9999;for ad,ae in pairs(tt.players)do if ae.Distance<tF and ae.Distance<40 and ae:HasDebuff(tG)then t7=ae;tF=ae.Distance end end;return t7 end;function tE:ClosestWithoutDebuff(tG)local t7=nil;local tF=9999;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<tF and ae.Distance<40 and not ae:HasDebuff(tG)then t7=ae;tF=ae.Distance end end;return t7 end;function tE:LowestFriend()local ts=nil;local tI=101;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<40 and ae.Reaction>4 and ae.HP<tI and not ae.Dead and ae.HP>0 then ts=ae;tI=ae.HP end end;return ts end;function tE:CountUnderHealth(tH)local iS=0;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<40 and ae.Reaction>4 and ae.HP<tH and not ae.Dead then iS=iS+1 end end;return iS end;function tE:GetClosestHeal(tJ,sn)local t7=nil;local tF=9999;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<tF and ae.Distance<sn and ae.Reaction>4 and ae.HP<tJ and not ae.Dead then t7=ae;tF=ae.Distance end end;return t7 end end;local function tK(...)local tt=tt;local df=LibStub and LibStub("AceGUI-3.0",true)local tL=LibStub("ScrollingTable")tt.ObjectViewer=class()local tM=tt.ObjectViewer;local tN=nil;local tO=nil;local nP=nil;local tP=nil;local r9="|cFF00FF00"local r8="|cffff0000"tM.mode="objects"local ef={}function tt:ToggleObjectViewer()if tN:IsShown()then tN:Hide()else tN:Show()end end;function tt:SelectGroup(eX)print("SelectGroup",eX)if eX=="objects"then tM.mode="objects"end;if eX=="players"then tM.mode="players"end;if eX=="units"then tM.mode="units"end;local d6=string.gsub(" "..tM.mode,"%W%l",string.upper):sub(2)tN:SetTitle("Object Manager - "..d6)end;function tt:AddColumn(aa)local qS={["name"]=aa,["width"]=100,["align"]="LEFT",["color"]={["r"]=1.0,["g"]=1.0,["b"]=1.0,["a"]=1.0},["colorargs"]=nil,["bgcolor"]={["r"]=0.0,["g"]=0.0,["b"]=0.0,["a"]=1.0},["defaultsort"]="dsc",["sortnext"]=4,["DoCellUpdate"]=nil}table.insert(ef,qS)end;function tt:updateObjectViewer()local qj={}if tM.mode=="objects"then for ad,ae in pairs(tt.gameobjects)do local gO={"",ae.Name,string.format("%0d",ae.Distance),0,0,0,0,string.format("%02d",ae.HP)}table.insert(qj,gO)end end;if tM.mode=="players"then table.sort(tt.players,function(x,y)return x.score>y.score end)for ad,ae in pairs(tt.players)do local tQ=""if ae.Reaction<=3 then tQ="Hostile"else tQ="Friendly"end;local gO={tQ,ae.Name,string.format("%0d",ae.Distance),ae.FriendsAround,ae.EnemiesAround,string.format("%0d",ae.score),string.format("%0d",ae.targetScore),string.format("%02d",ae.HP)}table.insert(qj,gO)end end;if tM.mode=="units"then for ad,ae in pairs(tt.units)do local gO={"",ae.Name,string.format("%0d",ae.Distance),ae.FriendsAround,ae.EnemiesAround,string.format("%0d",ae.score),ae.targetScore,string.format("%02d",ae.HP)}table.insert(qj,gO)end end;tP:SetData(qj,true)tP:SetWidth(950)end;if not tN then tN=df:Create("Window","ObjectViewerFrame",UIParent)local d6=string.gsub(" "..tM.mode,"%W%l",string.upper):sub(2)tN:SetTitle("Object Manager - "..d6)tN:SetLayout("Flow")tN:SetWidth(1024)local tR=df:Create("Button")tR:SetText("Objects")tR:SetWidth(100)tR:SetCallback("OnClick",function()tt:SelectGroup("objects")end)tN:AddChild(tR)local tS=df:Create("Button")tS:SetText("Players")tS:SetWidth(100)tS:SetCallback("OnClick",function()tt:SelectGroup("players")end)tN:AddChild(tS)local tT=df:Create("Button")tT:SetText("Units")tT:SetWidth(100)tT:SetCallback("OnClick",function()tt:SelectGroup("units")end)tN:AddChild(tT)tt:AddColumn("Reaction")tt:AddColumn("Name")tt:AddColumn("Distance")tt:AddColumn("Friends")tt:AddColumn("Enemies")tt:AddColumn("Score")tt:AddColumn("TargetScore")tt:AddColumn("HP")if tP==nil then tP=tL:CreateST(ef,nil,nil,nil,tN.frame)end;tt:updateObjectViewer()local tU=tt.AceGUI:Create("EditBox")tU:SetLabel("Pull Range")tU:SetWidth(100)tU:SetText(tt.pullrange)tU:SetCallback("OnEnterPressed",function(self,F,fh)tt.pullrange=tonumber(fh)print("tt.pullrange",tt.pullrange)end)tN:AddChild(tU)local tV=tt.AceGUI:Create("EditBox")tV:SetLabel("Combat Range")tV:SetWidth(100)tV:SetText(tt.combatrange)tV:SetCallback("OnEnterPressed",function(self,F,fh)tt.combatrange=tonumber(fh)print("tt.combatrange",tt.combatrange)end)tN:AddChild(tV)tN:Hide()end end;local function tW(...)local tt=tt;tt.HUD={}local tX=tt.HUD;local tY=tX.Frames;local r9="|cFF00FF00"local r8="|cffff0000"local tZ="|cffffffff"local t_=1;local u0={}local u1=1;local u2={}function tX:CreateHUDFrame(aa,dx,ag,u3,u4)print("CreateHUDFrame",aa,dx,ag,u3,u4)u4=u4 and u4 or 10;local ew=CreateFrame("Button",aa,tY)ew:SetNormalFontObject(GameFontNormalSmall)ew:SetHighlightFontObject(GameFontHighlightSmall)ew:SetWidth(dx)ew:SetHeight(20)ew:SetPoint("TOP",tY,u3,ag,u4)return ew end;tY=CreateFrame("Frame",nil,UIParent)tY:SetWidth(UIParent:GetWidth())tY:SetHeight(20)tY:SetPoint("TOP",UIParent,"TOP",0,0)tY.tex=tY:CreateTexture()tY.tex:SetAllPoints(tY)tY.tex:SetColorTexture(0,0,0,0.4)tY.Running=tX:CreateHUDFrame("Running",50,550,"LEFT")if tt.running then tY.Running:SetText(r9 .."Running")else tY.Running:SetText(r8 .."Stopped")end;tY.Running:SetScript("OnClick",function(self,gE,u5)if tt.running then tt.running=false;self:SetText(r8 .."Stopped")else tt.running=true;self:SetText(r9 .."Running")end end)for ad,ae in pairs(tt.botbases)do table.insert(u0,ad)end;for ad,ae in pairs(tt.rotations)do if string.lower(ae.class)==string.lower(UnitClass("player"))or ae.class=="all"then table.insert(u2,ad)end end;tY.Botbase=tX:CreateHUDFrame("Botbase",50,100,"LEFT")tY.Botbase:SetText(tZ..u0[t_])tY.Botbase:SetScript("OnClick",function()t_=t_+1;if t_>#u0 then t_=1 end;tt.botbase=u0[t_]tY:Update()end)tY.Botbase:Show()tY.Rotation=tX:CreateHUDFrame("Rotation",50,200,"LEFT")tY.Rotation:SetText(tZ..u2[u1])tY.Rotation:SetScript("OnClick",function()u1=u1+1;if u1>#u2 then u1=1 end;tt.rotation=u2[u1]tY:Update()end)tY.Botbase:Show()tY.RotationConfig=tX:CreateHUDFrame("Rotation",50,250,"LEFT")tY.RotationConfig:SetText(tZ.."Config")tY.RotationConfig:SetScript("OnClick",function()tt.rotations[tt.rotation]:OpenConfig()tY:Update()end)tY.Botbase:Show()tY.ToggleObjectViewer=tX:CreateHUDFrame("ObjectManager",150,350,"LEFT")tY.ToggleObjectViewer:SetText("Toggle OM")tY.ToggleObjectViewer:SetScript("OnClick",function()tt:ToggleObjectViewer()end)tY.ToggleObjectViewer:Show()tY.ToggleDebug=tX:CreateHUDFrame("ToggleDebug",150,450,"LEFT")tY.ToggleDebug:SetText("Toggle Debug")tY.ToggleDebug:SetScript("OnClick",function()if tt.doDebugging then tt.doDebugging=false else tt.doDebugging=true end;print("Debugging is now",tt.doDebugging)end)tY.StatusBarText=tX:CreateHUDFrame("StatusText",50,0,"CENTER")tY.StatusBarText:SetText("|c0000ff00Current Status")function tY:Update()tY.Botbase:SetText(tZ..u0[t_])tY.Rotation:SetText(tZ..u2[u1])if tt.running then tY.Running:SetText(r9 .."Running")else tY.Running:SetText(r8 .."Stopped")end end;function tt:UpdateHUD()tY:Update()end;function tt:SetStatusText(fh)tY.StatusBarText:SetText("|c0000ff00 ("..tt.combatrange.."/"..tt.pullrange..") Status: "..fh)end end;local function u6(...)local tt=tt;tt.ShowSpots={}local u7=tt.ShowSpots;local u8=nil;if not u8 then u8=tt.AceGUI:Create("Frame")u8:SetTitle("Spots")u8:SetStatusText("Spots")u8:SetLayout("Flow")u8:SetWidth(600)u8:SetHeight(650)u8:EnableResize(false)local u9=tt.AceGUI:Create("MultiLineEditBox")u9:SetLabel("Bad Spots")u9:SetWidth(600)u9:SetHeight(300)u8:AddChild(u9)local ua=tt.AceGUI:Create("MultiLineEditBox")ua:SetLabel("Move Spots")ua:SetWidth(600)ua:SetHeight(300)u8:AddChild(ua)end;u8:Show()end;local function ub(...)local tt=tt;tt.Log={}local uc=tt.Log;local bx;if not bx then bx=tt.AceGUI:Create("Frame")bx:SetTitle("Log")bx:SetLayout("Fill")bx:SetWidth(500)bx:SetHeight(500)bx:EnableResize(false)bx.editbox=tt.AceGUI:Create("MultiLineEditBox")bx.editbox:SetLabel("Log")bx.editbox:SetFullWidth(true)bx.editbox:SetFullHeight(true)bx.editbox:SetDisabled(false)bx:AddChild(bx.editbox)end;function uc:Add(b8)local ud=bx.editbox:GetText()bx.editbox:SetText(ud.."\n"..b8)end;local ue;local uf=print;print=function(...)if ue~=...then ue=...uf(...)tt.Log:Add(...)end end end;a(...)h(...)N(...)aB(...)aD(...)aW(...)b9(...)bz(...)cn(...)cG(...)cU(...)dc(...)eI(...)eV(...)f4(...)fu(...)fv(...)fJ(...)fK(...)gw(...)hq(...)hU(...)hY(...)i9(...)im(...)jo(...)jy(...)jI(...)jJ(...)jK(...)jN(...)jZ(...)k5(...)ko(...)kD(...)lc(...)mi(...)o3(...)o7(...)oF(...)p2(...)pV(...)ql(...)qr(...)rC(...)rF(...)rJ(...)rW(...)rZ(...)s4(...)sk(...)so(...)sC(...)sE(...)sG(...)sM(...)t9(...)tb(...)th(...)tj(...)tv(...)tx(...)tz(...)tB(...)tD(...)tK(...)tW(...)u6(...)ub(...)
