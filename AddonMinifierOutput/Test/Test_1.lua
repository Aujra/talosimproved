local function a(...)local b,c="LibStub",2;local LibStub=_G[b]if not LibStub or LibStub.minor<c then LibStub=LibStub or{libs={},minors={}}_G[b]=LibStub;LibStub.minor=c;function LibStub:NewLibrary(d,e)assert(type(d)=="string","Bad argument #2 to `NewLibrary' (string expected)")e=assert(tonumber(string.match(e,"%d+")),"Minor version must either be a number or contain a number.")local f=self.minors[d]if f and f>=e then return nil end;self.minors[d],self.libs[d]=e,self.libs[d]or{}return self.libs[d],f end;function LibStub:GetLibrary(d,g)if not self.libs[d]and not g then error(("Cannot find a library instance of %q."):format(tostring(d)),2)end;return self.libs[d],self.minors[d]end;function LibStub:IterateLibraries()return pairs(self.libs)end;setmetatable(LibStub,{__call=LibStub.GetLibrary})end end;local function h(...)local i,k="CallbackHandler-1.0",8;local l=LibStub:NewLibrary(i,k)if not l then return end;local m={__index=function(n,o)n[o]={}return n[o]end}local securecallfunction,error=securecallfunction,error;local setmetatable,rawget=setmetatable,rawget;local next,select,pairs,type,tostring=next,select,pairs,type,tostring;local function p(q,...)local r,s=next(q)if not s then return end;repeat securecallfunction(s,...)r,s=next(q,r)until not s end;function l.New(t,u,v,w,A)v=v or"RegisterCallback"w=w or"UnregisterCallback"if A==nil then A="UnregisterAllCallbacks"end;local B=setmetatable({},m)local C={recurse=0,events=B}function C:Fire(D,...)if not rawget(B,D)or not next(B[D])then return end;local E=C.recurse;C.recurse=E+1;p(B[D],D,...)C.recurse=E;if C.insertQueue and E==0 then for F,G in pairs(C.insertQueue)do local H=not rawget(B,F)or not next(B[F])for I,J in pairs(G)do B[F][I]=J;if H and C.OnUsed then C.OnUsed(C,u,F)H=nil end end end;C.insertQueue=nil end end;u[v]=function(self,D,s,...)if type(D)~="string"then error("Usage: "..v.."(eventname, method[, arg]): 'eventname' - string expected.",2)end;s=s or D;local H=not rawget(B,D)or not next(B[D])if type(s)~="string"and type(s)~="function"then error("Usage: "..v.."(\"eventname\", \"methodname\"): 'methodname' - string or function expected.",2)end;local K;if type(s)=="string"then if type(self)~="table"then error("Usage: "..v.."(\"eventname\", \"methodname\"): self was not a table?",2)elseif self==u then error("Usage: "..v.."(\"eventname\", \"methodname\"): do not use Library:"..v.."(), use your own 'self'",2)elseif type(self[s])~="function"then error("Usage: "..v.."(\"eventname\", \"methodname\"): 'methodname' - method '"..tostring(s).."' not found on self.",2)end;if select("#",...)>=1 then local L=select(1,...)K=function(...)self[s](self,L,...)end else K=function(...)self[s](self,...)end end else if type(self)~="table"and type(self)~="string"and type(self)~="thread"then error("Usage: "..v.."(self or \"addonId\", eventname, method): 'self or addonId': table or string or thread expected.",2)end;if select("#",...)>=1 then local L=select(1,...)K=function(...)s(L,...)end else K=s end end;if B[D][self]or C.recurse<1 then B[D][self]=K;if C.OnUsed and H then C.OnUsed(C,u,D)end else C.insertQueue=C.insertQueue or setmetatable({},m)C.insertQueue[D][self]=K end end;u[w]=function(self,D)if not self or self==u then error("Usage: "..w.."(eventname): bad 'self'",2)end;if type(D)~="string"then error("Usage: "..w.."(eventname): 'eventname' - string expected.",2)end;if rawget(B,D)and B[D][self]then B[D][self]=nil;if C.OnUnused and not next(B[D])then C.OnUnused(C,u,D)end end;if C.insertQueue and rawget(C.insertQueue,D)and C.insertQueue[D][self]then C.insertQueue[D][self]=nil end end;if A then u[A]=function(...)if select("#",...)<1 then error("Usage: "..A.."([whatFor]): missing 'self' or \"addonId\" to unregister events for.",2)end;if select("#",...)==1 and...==u then error("Usage: "..A.."([whatFor]): supply a meaningful 'self' or \"addonId\"",2)end;for M=1,select("#",...)do local self=select(M,...)if C.insertQueue then for D,G in pairs(C.insertQueue)do if G[self]then G[self]=nil end end end;for D,G in pairs(B)do if G[self]then G[self]=nil;if C.OnUnused and not next(G)then C.OnUnused(C,u,D)end end end end end end;return C end end;local function N(...)local i,k="AceAddon-3.0",13;local O,f=LibStub:NewLibrary(i,k)if not O then return end;O.frame=O.frame or CreateFrame("Frame","AceAddon30Frame")O.addons=O.addons or{}O.statuses=O.statuses or{}O.initializequeue=O.initializequeue or{}O.enablequeue=O.enablequeue or{}O.embeds=O.embeds or setmetatable({},{__index=function(n,o)n[o]={}return n[o]end})local tinsert,P,Q=table.insert,table.concat,table.remove;local R,tostring=string.format,tostring;local select,pairs,next,type,unpack=select,pairs,next,type,unpack;local loadstring,assert,error=loadstring,assert,error;local setmetatable,getmetatable,rawset,rawget=setmetatable,getmetatable,rawset,rawget;local xpcall=xpcall;local function S(T)return geterrorhandler()(T)end;local function U(J,...)if type(J)=="function"then return xpcall(J,S,...)end end;local V,W,X,Y,Z,_,a0,a1,a2,a3,a4,a5;local function a6(self)return self.name end;local function a7(a8)for M=1,#O.initializequeue do if O.initializequeue[M]==a8 then return true end end;return false end;function O:NewAddon(a9,...)local I,aa;local M=1;if type(a9)=="table"then I=a9;aa=...M=2 else aa=a9 end;if type(aa)~="string"then error(("Usage: NewAddon([object,] name, [lib, lib, lib, ...]): 'name' - string expected got '%s'."):format(type(aa)),2)end;if self.addons[aa]then error(("Usage: NewAddon([object,] name, [lib, lib, lib, ...]): 'name' - Addon '%s' already exists."):format(aa),2)end;I=I or{}I.name=aa;local ab={}local ac=getmetatable(I)if ac then for ad,ae in pairs(ac)do ab[ad]=ae end end;ab.__tostring=a6;setmetatable(I,ab)self.addons[aa]=I;I.modules={}I.orderedModules={}I.defaultModuleLibraries={}Z(I)self:EmbedLibraries(I,select(M,...))tinsert(self.initializequeue,I)return I end;function O:GetAddon(aa,g)if not g and not self.addons[aa]then error(("Usage: GetAddon(name): 'name' - Cannot find an AceAddon '%s'."):format(tostring(aa)),2)end;return self.addons[aa]end;function O:EmbedLibraries(a8,...)for M=1,select("#",...)do local af=select(M,...)self:EmbedLibrary(a8,af,false,4)end end;function O:EmbedLibrary(a8,af,g,ag)local ah=LibStub:GetLibrary(af,true)if not ah and not g then error(("Usage: EmbedLibrary(addon, libname, silent, offset): 'libname' - Cannot find a library instance of %q."):format(tostring(af)),ag or 2)elseif ah and type(ah.Embed)=="function"then ah:Embed(a8)tinsert(self.embeds[a8],af)return true elseif ah then error(("Usage: EmbedLibrary(addon, libname, silent, offset): 'libname' - Library '%s' is not Embed capable"):format(af),ag or 2)end end;function a0(self,aa,g)if not self.modules[aa]and not g then error(("Usage: GetModule(name, silent): 'name' - Cannot find module '%s'."):format(tostring(aa)),2)end;return self.modules[aa]end;local function ai(self)return true end;function _(self,aa,aj,...)if type(aa)~="string"then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'name' - string expected got '%s'."):format(type(aa)),2)end;if type(aj)~="string"and type(aj)~="table"and type(aj)~="nil"then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'prototype' - table (prototype), string (lib) or nil expected got '%s'."):format(type(aj)),2)end;if self.modules[aa]then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'name' - Module '%s' already exists."):format(aa),2)end;local ak=O:NewAddon(R("%s_%s",self.name or tostring(self),aa))ak.IsModule=ai;ak:SetEnabledState(self.defaultModuleState)ak.moduleName=aa;if type(aj)=="string"then O:EmbedLibraries(ak,aj,...)else O:EmbedLibraries(ak,...)end;O:EmbedLibraries(ak,unpack(self.defaultModuleLibraries))if not aj or type(aj)=="string"then aj=self.defaultModulePrototype or nil end;if type(aj)=="table"then local al=getmetatable(ak)al.__index=aj;setmetatable(ak,al)end;U(self.OnModuleCreated,self,ak)self.modules[aa]=ak;tinsert(self.orderedModules,ak)return ak end;function a1(self)return self.moduleName or self.name end;function V(self)self:SetEnabledState(true)if not a7(self)then return O:EnableAddon(self)end end;function W(self)self:SetEnabledState(false)return O:DisableAddon(self)end;function X(self,aa)local ak=self:GetModule(aa)return ak:Enable()end;function Y(self,aa)local ak=self:GetModule(aa)return ak:Disable()end;function a3(self,...)if next(self.modules)then error("Usage: SetDefaultModuleLibraries(...): cannot change the module defaults after a module has been registered.",2)end;self.defaultModuleLibraries={...}end;function a2(self,am)if next(self.modules)then error("Usage: SetDefaultModuleState(state): cannot change the module defaults after a module has been registered.",2)end;self.defaultModuleState=am end;function a5(self,aj)if next(self.modules)then error("Usage: SetDefaultModulePrototype(prototype): cannot change the module defaults after a module has been registered.",2)end;if type(aj)~="table"then error(("Usage: SetDefaultModulePrototype(prototype): 'prototype' - table expected got '%s'."):format(type(aj)),2)end;self.defaultModulePrototype=aj end;function a4(self,am)self.enabledState=am end;local function an(self)return pairs(self.modules)end;local function ao(self)return pairs(O.embeds[self])end;local function ap(self)return self.enabledState end;local aq={NewModule=_,GetModule=a0,Enable=V,Disable=W,EnableModule=X,DisableModule=Y,IsEnabled=ap,SetDefaultModuleLibraries=a3,SetDefaultModuleState=a2,SetDefaultModulePrototype=a5,SetEnabledState=a4,IterateModules=an,IterateEmbeds=ao,GetName=a1}local function ar(self)return false end;local as={defaultModuleState=true,enabledState=true,IsModule=ar}function Z(u,at)for ad,ae in pairs(aq)do u[ad]=ae end;if not at then for ad,ae in pairs(as)do u[ad]=u[ad]or ae end end end;function O:InitializeAddon(a8)U(a8.OnInitialize,a8)local au=self.embeds[a8]for M=1,#au do local ah=LibStub:GetLibrary(au[M],true)if ah then U(ah.OnEmbedInitialize,ah,a8)end end end;function O:EnableAddon(a8)if type(a8)=="string"then a8=O:GetAddon(a8)end;if self.statuses[a8.name]or not a8.enabledState then return false end;self.statuses[a8.name]=true;U(a8.OnEnable,a8)if self.statuses[a8.name]then local au=self.embeds[a8]for M=1,#au do local ah=LibStub:GetLibrary(au[M],true)if ah then U(ah.OnEmbedEnable,ah,a8)end end;local av=a8.orderedModules;for M=1,#av do self:EnableAddon(av[M])end end;return self.statuses[a8.name]end;function O:DisableAddon(a8)if type(a8)=="string"then a8=O:GetAddon(a8)end;if not self.statuses[a8.name]then return false end;self.statuses[a8.name]=false;U(a8.OnDisable,a8)if not self.statuses[a8.name]then local au=self.embeds[a8]for M=1,#au do local ah=LibStub:GetLibrary(au[M],true)if ah then U(ah.OnEmbedDisable,ah,a8)end end;local av=a8.orderedModules;for M=1,#av do self:DisableAddon(av[M])end end;return not self.statuses[a8.name]end;function O:IterateAddons()return pairs(self.addons)end;function O:IterateAddonStatus()return pairs(self.statuses)end;function O:IterateEmbedsOnAddon(a8)return pairs(self.embeds[a8])end;function O:IterateModulesOfAddon(a8)return pairs(a8.modules)end;local aw={Blizzard_DebugTools=true,Blizzard_TimeManager=true,Blizzard_BattlefieldMap=true,Blizzard_MapCanvas=true,Blizzard_SharedMapDataProviders=true,Blizzard_CombatLog=true}local function ax(ay,F,az)if F=="ADDON_LOADED"and(az==nil or not aw[az])or F=="PLAYER_LOGIN"then while#O.initializequeue>0 do local a8=Q(O.initializequeue,1)if F=="ADDON_LOADED"then a8.baseName=az end;O:InitializeAddon(a8)tinsert(O.enablequeue,a8)end;if IsLoggedIn()then while#O.enablequeue>0 do local a8=Q(O.enablequeue,1)O:EnableAddon(a8)end end end end;O.frame:RegisterEvent("ADDON_LOADED")O.frame:RegisterEvent("PLAYER_LOGIN")O.frame:SetScript("OnEvent",ax)for aa,a8 in pairs(O.addons)do Z(a8,true)end;if f and f<10 then for aa,a8 in pairs(O.addons)do a8.orderedModules={}for aA,ak in pairs(a8.modules)do tinsert(a8.orderedModules,ak)end end end end;local function aB(...)local l=LibStub("CallbackHandler-1.0")local i,k="AceEvent-3.0",4;local aC=LibStub:NewLibrary(i,k)if not aC then return end;local pairs=pairs;aC.frame=aC.frame or CreateFrame("Frame","AceEvent30Frame")aC.embeds=aC.embeds or{}if not aC.events then aC.events=l:New(aC,"RegisterEvent","UnregisterEvent","UnregisterAllEvents")end;function aC.events:OnUsed(u,D)aC.frame:RegisterEvent(D)end;function aC.events:OnUnused(u,D)aC.frame:UnregisterEvent(D)end;if not aC.messages then aC.messages=l:New(aC,"RegisterMessage","UnregisterMessage","UnregisterAllMessages")aC.SendMessage=aC.messages.Fire end;local aq={"RegisterEvent","UnregisterEvent","RegisterMessage","UnregisterMessage","SendMessage","UnregisterAllEvents","UnregisterAllMessages"}function aC:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;function aC:OnEmbedDisable(u)u:UnregisterAllEvents()u:UnregisterAllMessages()end;local B=aC.events;aC.frame:SetScript("OnEvent",function(ay,F,...)B:Fire(F,...)end)for u,ae in pairs(aC.embeds)do aC:Embed(u)end end;local function aD(...)local i,k="AceTimer-3.0",17;local aE,f=LibStub:NewLibrary(i,k)if not aE then return end;aE.activeTimers=aE.activeTimers or{}local aF=aE.activeTimers;local type,unpack,next,error,select=type,unpack,next,error,select;local GetTime,aG=GetTime,C_Timer.After;local function aH(self,aI,J,aJ,...)if aJ<0.01 then aJ=0.01 end;local aK={object=self,func=J,looping=aI,argsCount=select("#",...),delay=aJ,ends=GetTime()+aJ,...}aF[aK]=aK;aK.callback=function()if not aK.cancelled then if type(aK.func)=="string"then aK.object[aK.func](aK.object,unpack(aK,1,aK.argsCount))else aK.func(unpack(aK,1,aK.argsCount))end;if aK.looping and not aK.cancelled then local aL=GetTime()local aM=aK.delay-(aL-aK.ends)if aM<0.01 then aM=0.01 end;aG(aM,aK.callback)aK.ends=aL+aM else aF[aK.handle or aK]=nil end end end;aG(aJ,aK.callback)return aK end;function aE:ScheduleTimer(J,aJ,...)if not J or not aJ then error(i..": ScheduleTimer(callback, delay, args...): 'callback' and 'delay' must have set values.",2)end;if type(J)=="string"then if type(self)~="table"then error(i..": ScheduleTimer(callback, delay, args...): 'self' - must be a table.",2)elseif not self[J]then error(i..": ScheduleTimer(callback, delay, args...): Tried to register '"..J.."' as the callback, but it doesn't exist in the module.",2)end end;return aH(self,nil,J,aJ,...)end;function aE:ScheduleRepeatingTimer(J,aJ,...)if not J or not aJ then error(i..": ScheduleRepeatingTimer(callback, delay, args...): 'callback' and 'delay' must have set values.",2)end;if type(J)=="string"then if type(self)~="table"then error(i..": ScheduleRepeatingTimer(callback, delay, args...): 'self' - must be a table.",2)elseif not self[J]then error(i..": ScheduleRepeatingTimer(callback, delay, args...): Tried to register '"..J.."' as the callback, but it doesn't exist in the module.",2)end end;return aH(self,true,J,aJ,...)end;function aE:CancelTimer(aN)local aK=aF[aN]if not aK then return false else aK.cancelled=true;aF[aN]=nil;return true end end;function aE:CancelAllTimers()for ad,ae in next,aF do if ae.object==self then aE.CancelTimer(self,ad)end end end;function aE:TimeLeft(aN)local aK=aF[aN]if not aK then return 0 else return aK.ends-GetTime()end end;if f and f<10 then aE.frame:SetScript("OnUpdate",nil)aE.frame:SetScript("OnEvent",nil)aE.frame:UnregisterAllEvents()for I,aO in next,aE.selfs do for aP,aK in next,aO do if type(aK)=="table"and aK.callback then local aQ;if aK.delay then aQ=aE.ScheduleRepeatingTimer(aK.object,aK.callback,aK.delay,aK.arg)else aQ=aE.ScheduleTimer(aK.object,aK.callback,aK.when-GetTime(),aK.arg)end;aF[aQ]=nil;aF[aP]=aQ;aQ.handle=aP end end end;aE.selfs=nil;aE.hash=nil;aE.debug=nil elseif f and f<17 then aE.inactiveTimers=nil;aE.frame=nil;local aR=aE.activeTimers;aE.activeTimers={}aF=aE.activeTimers;for aP,aK in next,aR do local aQ;local aS,aT=aK:GetDuration(),aK:GetElapsed()aK:GetParent():Stop()if aK.looping then aQ=aE.ScheduleRepeatingTimer(aK.object,aK.func,aS,unpack(aK.args,1,aK.argsCount))else aQ=aE.ScheduleTimer(aK.object,aK.func,aS-aT,unpack(aK.args,1,aK.argsCount))end;aF[aQ]=nil;aF[aP]=aQ;aQ.handle=aP end;if f<13 and aE.hashCompatTable then for aP,aN in next,aE.hashCompatTable do local aU=aF[aN]if aU then aF[aN]=nil;aF[aP]=aU;aU.handle=aP end end;aE.hashCompatTable=nil end end;aE.embeds=aE.embeds or{}local aq={"ScheduleTimer","ScheduleRepeatingTimer","CancelTimer","CancelAllTimers","TimeLeft"}function aE:Embed(u)aE.embeds[u]=true;for aV,ae in next,aq do u[ae]=aE[ae]end;return u end;function aE:OnEmbedDisable(u)u:CancelAllTimers()end;for a8 in next,aE.embeds do aE:Embed(a8)end end;local function aW(...)local i,k="AceBucket-3.0",4;local aX,f=LibStub:NewLibrary(i,k)if not aX then return end;aX.buckets=aX.buckets or{}aX.embeds=aX.embeds or{}local aC,aE;local P=table.concat;local type,next,pairs,select=type,next,pairs,select;local tonumber,tostring,rawset=tonumber,tostring,rawset;local assert,loadstring,error=assert,loadstring,error;local aY=setmetatable({},{__mode='k'})local xpcall=xpcall;local function S(T)return geterrorhandler()(T)end;local function U(J,...)if J then return xpcall(J,S,...)end end;local function aZ(a_)local b0=a_.received;if next(b0)~=nil then local b1=a_.callback;if type(b1)=="string"then U(a_.object[b1],a_.object,b0)else U(b1,b0)end;for ad in pairs(b0)do b0[ad]=nil end;a_.timer=aE.ScheduleTimer(a_,aZ,a_.interval,a_)else a_.timer=nil end end;local function b2(self,F,az)if az==nil then az="nil"end;self.received[az]=(self.received[az]or 0)+1;if not self.timer then self.timer=aE.ScheduleTimer(self,aZ,self.interval,self)end end;local function b3(self,F,b4,b1,b5)if not aC or not aE then aC=LibStub:GetLibrary("AceEvent-3.0",true)aE=LibStub:GetLibrary("AceTimer-3.0",true)if not aC or not aE then error(i.." requires AceEvent-3.0 and AceTimer-3.0",3)end end;if type(F)~="string"and type(F)~="table"then error("Usage: RegisterBucket(event, interval, callback): 'event' - string or table expected.",3)end;if not b1 then if type(F)=="string"then b1=F else error("Usage: RegisterBucket(event, interval, callback): cannot omit callback when event is not a string.",3)end end;if not tonumber(b4)then error("Usage: RegisterBucket(event, interval, callback): 'interval' - number expected.",3)end;if type(b1)~="string"and type(b1)~="function"then error("Usage: RegisterBucket(event, interval, callback): 'callback' - string or function or nil expected.",3)end;if type(b1)=="string"and type(self[b1])~="function"then error("Usage: RegisterBucket(event, interval, callback): 'callback' - method not found on target object.",3)end;local a_=next(aY)if a_ then aY[a_]=nil else a_={handler=b2,received={}}end;a_.object,a_.callback,a_.interval=self,b1,tonumber(b4)local b6=b5 and aC.RegisterMessage or aC.RegisterEvent;if type(F)=="table"then for aV,b7 in pairs(F)do b6(a_,b7,"handler")end else b6(a_,F,"handler")end;local aP=tostring(a_)aX.buckets[aP]=a_;return aP end;function aX:RegisterBucketEvent(F,b4,b1)return b3(self,F,b4,b1,false)end;function aX:RegisterBucketMessage(b8,b4,b1)return b3(self,b8,b4,b1,true)end;function aX:UnregisterBucket(aP)local a_=aX.buckets[aP]if a_ then aC.UnregisterAllEvents(a_)aC.UnregisterAllMessages(a_)for ad in pairs(a_.received)do a_.received[ad]=nil end;if a_.timer then aE.CancelTimer(a_,a_.timer)a_.timer=nil end;aX.buckets[aP]=nil;aY[a_]=true end end;function aX:UnregisterAllBuckets()for aP,a_ in pairs(aX.buckets)do if a_.object==self then aX.UnregisterBucket(self,aP)end end end;local aq={"RegisterBucketEvent","RegisterBucketMessage","UnregisterBucket","UnregisterAllBuckets"}function aX:Embed(u)for aV,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;function aX:OnEmbedDisable(u)u:UnregisterAllBuckets()end;for a8 in pairs(aX.embeds)do aX:Embed(a8)end end;local function b9(...)local ba,bb="AceHook-3.0",9;local bc,f=LibStub:NewLibrary(ba,bb)if not bc then return end;bc.embeded=bc.embeded or{}bc.registry=bc.registry or setmetatable({},{__index=function(n,o)n[o]={}return n[o]end})bc.handlers=bc.handlers or{}bc.actives=bc.actives or{}bc.scripts=bc.scripts or{}bc.onceSecure=bc.onceSecure or{}bc.hooks=bc.hooks or{}local C=bc.registry;local q=bc.handlers;local bd=bc.actives;local be=bc.scripts;local bf=bc.onceSecure;local pairs,next,type=pairs,next,type;local bg=string.format;local assert,error=assert,error;local issecurevariable,hooksecurefunc=issecurevariable,hooksecurefunc;local _G=_G;local bh,bi,bj;local bk={OnClick=true}local aq={"Hook","SecureHook","HookScript","SecureHookScript","Unhook","UnhookAll","IsHooked","RawHook","RawHookScript"}function bc:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeded[u]=true;u.hooks=u.hooks or{}return u end;function bc:OnEmbedDisable(u)u:UnhookAll()end;function bi(self,bl,bm,bn,bo)local bp;local s=type(bl)=="string"if bo and not bn then bp=function(...)if bd[bp]then if s then self[bl](self,...)else bl(...)end end;return bm(...)end else bp=function(...)if bd[bp]then if s then return self[bl](self,...)else return bl(...)end elseif not bn then return bm(...)end end end;return bp end;function bh()end;function bj(self,bq,s,bl,br,bn,bs,bt,bu)if not bl then bl=s end;assert(not br or type(br)=="boolean")assert(not bn or type(bn)=="boolean")assert(not bs or type(bs)=="boolean")assert(not bt or type(bt)=="boolean")assert(bu)if bq and type(bq)~="table"then error(bg("%s: 'object' - nil or table expected got %s",bu,type(bq)),3)end;if type(s)~="string"then error(bg("%s: 'method' - string expected got %s",bu,type(s)),3)end;if type(bl)~="string"and type(bl)~="function"then error(bg("%s: 'handler' - nil, string, or function expected got %s",bu,type(bl)),3)end;if type(bl)=="string"and type(self[bl])~="function"then error(bg("%s: 'handler' - Handler specified does not exist at self[handler]",bu),3)end;if br then if not bq or not bq.GetScript or not bq:HasScript(s)then error(bg("%s: You can only hook a script on a frame object",bu),3)end;if not bn and bq.IsProtected and bq:IsProtected()and bk[s]then error(bg("Cannot hook secure script %q; Use SecureHookScript(obj, method, [handler]) instead.",s),3)end else local bv;if bq then bv=bf[bq]and bf[bq][s]or issecurevariable(bq,s)else bv=bf[s]or issecurevariable(s)end;if bv then if bt then if bq then bf[bq]=bf[bq]or{}bf[bq][s]=true else bf[s]=true end elseif not bn then error(bg("%s: Attempt to hook secure function %s. Use `SecureHook' or add `true' to the argument list to override.",bu,s),3)end end end;local bp;if bq then bp=C[self][bq]and C[self][bq][s]else bp=C[self][s]end;if bp then if bd[bp]then error(bg("Attempting to rehook already active hook %s.",s))end;if q[bp]==bl then bd[bp]=true;return elseif bq then if self.hooks and self.hooks[bq]then self.hooks[bq][s]=nil end;C[self][bq][s]=nil else if self.hooks then self.hooks[s]=nil end;C[self][s]=nil end;q[bp],bd[bp],be[bp]=nil,nil,nil end;local bm;if br then bm=bq:GetScript(s)or bh elseif bq then bm=bq[s]else bm=_G[s]end;if not bm then error(bg("%s: Attempting to hook a non existing target",bu),3)end;bp=bi(self,bl,bm,bn,not(bs or bn))if bq then self.hooks[bq]=self.hooks[bq]or{}C[self][bq]=C[self][bq]or{}C[self][bq][s]=bp;if not bn then self.hooks[bq][s]=bm end;if br then if not bn then bq:SetScript(s,bp)else bq:HookScript(s,bp)end else if not bn then bq[s]=bp else hooksecurefunc(bq,s,bp)end end else C[self][s]=bp;if not bn then _G[s]=bp;self.hooks[s]=bm else hooksecurefunc(s,bp)end end;bd[bp],q[bp],be[bp]=true,bl,br and true or nil end;function bc:Hook(I,s,bl,bw)if type(I)=="string"then s,bl,bw,I=I,s,bl,nil end;if bl==true then bl,bw=nil,true end;bj(self,I,s,bl,false,false,false,bw or false,"Usage: Hook([object], method, [handler], [hookSecure])")end;function bc:RawHook(I,s,bl,bw)if type(I)=="string"then s,bl,bw,I=I,s,bl,nil end;if bl==true then bl,bw=nil,true end;bj(self,I,s,bl,false,false,true,bw or false,"Usage: RawHook([object], method, [handler], [hookSecure])")end;function bc:SecureHook(I,s,bl)if type(I)=="string"then s,bl,I=I,s,nil end;bj(self,I,s,bl,false,true,false,false,"Usage: SecureHook([object], method, [handler])")end;function bc:HookScript(bx,br,bl)bj(self,bx,br,bl,true,false,false,false,"Usage: HookScript(object, method, [handler])")end;function bc:RawHookScript(bx,br,bl)bj(self,bx,br,bl,true,false,true,false,"Usage: RawHookScript(object, method, [handler])")end;function bc:SecureHookScript(bx,br,bl)bj(self,bx,br,bl,true,true,false,false,"Usage: SecureHookScript(object, method, [handler])")end;function bc:Unhook(bq,s)local bu="Usage: Unhook([obj], method)"if type(bq)=="string"then s,bq=bq,nil end;if bq and type(bq)~="table"then error(bg("%s: 'obj' - expecting nil or table got %s",bu,type(bq)),2)end;if type(s)~="string"then error(bg("%s: 'method' - expeting string got %s",bu,type(s)),2)end;local bp;if bq then bp=C[self][bq]and C[self][bq][s]else bp=C[self][s]end;if not bp or not bd[bp]then return false end;bd[bp],q[bp]=nil,nil;if bq then C[self][bq][s]=nil;C[self][bq]=next(C[self][bq])and C[self][bq]or nil;if not self.hooks[bq]or not self.hooks[bq][s]then return true end;if be[bp]and bq:GetScript(s)==bp then bq:SetScript(s,self.hooks[bq][s]~=bh and self.hooks[bq][s]or nil)be[bp]=nil elseif bq and self.hooks[bq]and self.hooks[bq][s]and bq[s]==bp then bq[s]=self.hooks[bq][s]end;self.hooks[bq][s]=nil;self.hooks[bq]=next(self.hooks[bq])and self.hooks[bq]or nil else C[self][s]=nil;if not self.hooks[s]then return true end;if self.hooks[s]and _G[s]==bp then _G[s]=self.hooks[s]end;self.hooks[s]=nil end;return true end;function bc:UnhookAll()for o,by in pairs(C[self])do if type(o)=="table"then for s in pairs(by)do bc.Unhook(self,o,s)end else bc.Unhook(self,o)end end end;function bc:IsHooked(bq,s)if type(bq)=="string"then if C[self][bq]and bd[C[self][bq]]then return true,q[C[self][bq]]end else if C[self][bq]and C[self][bq][s]and bd[C[self][bq][s]]then return true,q[C[self][bq][s]]end end;return false,nil end;for u,ae in pairs(bc.embeded)do bc:Embed(u)end end;local function bz(...)local bA,bB="AceDB-3.0",28;local bC=LibStub:NewLibrary(bA,bB)if not bC then return end;local type,pairs,next,error=type,pairs,next,error;local setmetatable,rawset,rawget=setmetatable,rawset,rawget;local _G=_G;bC.db_registry=bC.db_registry or{}bC.frame=bC.frame or CreateFrame("Frame")local l;local bD={Fire=function()end}local bE={}local function bF(bG,bH)if type(bH)~="table"then bH={}end;if type(bG)=="table"then for ad,ae in pairs(bG)do if type(ae)=="table"then ae=bF(ae,bH[ad])end;bH[ad]=ae end end;return bH end;local function bI(bH,bG)for ad,ae in pairs(bG)do if ad=="*"or ad=="**"then if type(ae)=="table"then local al={__index=function(aU,bJ)if bJ==nil then return nil end;local n={}bI(n,ae)rawset(aU,bJ,n)return n end}setmetatable(bH,al)for bK,bL in pairs(bH)do if not rawget(bG,bK)and type(bL)=="table"then bI(bL,ae)end end else local al={__index=function(aU,bJ)return bJ~=nil and ae or nil end}setmetatable(bH,al)end elseif type(ae)=="table"then if not rawget(bH,ad)then rawset(bH,ad,{})end;if type(bH[ad])=="table"then bI(bH[ad],ae)if bG['**']then bI(bH[ad],bG['**'])end end else if rawget(bH,ad)==nil then rawset(bH,ad,ae)end end end end;local function bM(bN,bO,bP)setmetatable(bN,nil)for ad,ae in pairs(bO)do if ad=="*"or ad=="**"then if type(ae)=="table"then for o,by in pairs(bN)do if type(by)=="table"then if bO[o]==nil and(not bP or bP[o]==nil)then bM(by,ae)if next(by)==nil then bN[o]=nil end elseif ad=="**"then bM(by,ae,bO[o])end end end elseif ad=="*"then for o,by in pairs(bN)do if bO[o]==nil and ae==by then bN[o]=nil end end end elseif type(ae)=="table"and type(bN[ad])=="table"then bM(bN[ad],ae,bP and bP[ad])if next(bN[ad])==nil then bN[ad]=nil end else if bN[ad]==bO[ad]and(not bP or bP[ad]==nil)then bN[ad]=nil end end end end;local function bQ(bN,bR,bS,o,bO)local bT=rawget(bN,"sv")local bU;if not bT[bS]then bT[bS]={}end;if not bT[bS][o]then bT[bS][o]={}bU=true end;local n=bT[bS][o]if bO then bI(n,bO)end;rawset(bN,bR,n)return bU,n end;local bV={__index=function(aU,bR)local bW=rawget(aU,"keys")local o=bW[bR]if o then local bX=rawget(aU,"defaults")local bO=bX and bX[bR]if bR=="profile"then local aH=bQ(aU,bR,"profiles",o,bO)if aH then aU.callbacks:Fire("OnNewProfile",aU,o)end elseif bR=="profiles"then local bT=rawget(aU,"sv")if not bT.profiles then bT.profiles={}end;rawset(aU,"profiles",bT.profiles)elseif bR=="global"then local bT=rawget(aU,"sv")if not bT.global then bT.global={}end;if bO then bI(bT.global,bO)end;rawset(aU,bR,bT.global)else bQ(aU,bR,bR,o,bO)end end;return rawget(aU,bR)end}local function bY(bO,bZ,ag)if not bO then return end;ag=ag or 0;for ad in pairs(bO)do if not bZ[ad]or ad=="profiles"then error(("Usage: AceDBObject:RegisterDefaults(defaults): '%s' is not a valid datatype."):format(ad),3+ag)end end end;local b_={["callbacks"]=true,["RegisterCallback"]=true,["UnregisterCallback"]=true,["UnregisterAllCallbacks"]=true,["children"]=true}local c0=GetRealmName()local c1=UnitName("player").." - "..c0;local aV,c2=UnitClass("player")local aV,c3=UnitRace("player")local c4=UnitFactionGroup("player")local c5=c4 .." - "..c0;local c6=GetLocale():lower()local c7={"US","KR","EU","TW","CN"}local c8=c7[GetCurrentRegion()]or GetCurrentRegionName()or"TR"local c9=c5 .." - "..c8;local function ca(bT,bO,cb,cc,cd)if cb==true then cb="Default"end;local ce;if not cd then if not bT.profileKeys then bT.profileKeys={}end;ce=bT.profileKeys[c1]or cb or c1;bT.profileKeys[c1]=ce else ce=cd.keys.profile or cb or c1;bT.profileKeys=nil end;local bZ={["char"]=c1,["realm"]=c0,["class"]=c2,["race"]=c3,["faction"]=c4,["factionrealm"]=c5,["factionrealmregion"]=c9,["profile"]=ce,["locale"]=c6,["global"]=true,["profiles"]=true}bY(bO,bZ,1)if cc then for ad,ae in pairs(cc)do if not b_[ad]then cc[ad]=nil end end end;local bN=setmetatable(cc or{},bV)if not rawget(bN,"callbacks")then if not l then l=LibStub:GetLibrary("CallbackHandler-1.0",true)end;bN.callbacks=l and l:New(bN)or bD end;if not cd then for aa,J in pairs(bE)do bN[aa]=J end else bN.RegisterDefaults=bE.RegisterDefaults;bN.ResetProfile=bE.ResetProfile end;bN.profiles=bT.profiles;bN.keys=bZ;bN.sv=bT;bN.defaults=bO;bN.parent=cd;bC.db_registry[bN]=true;return bN end;local function cf(bx,F)if F=="PLAYER_LOGOUT"then for bN in pairs(bC.db_registry)do bN.callbacks:Fire("OnDatabaseShutdown",bN)bN:RegisterDefaults(nil)local bT=rawget(bN,"sv")for bR in pairs(bN.keys)do if rawget(bT,bR)then if bR~="global"and(bR~="profiles"or rawget(bN,"parent"))then for o in pairs(bT[bR])do if not next(bT[bR][o])then bT[bR][o]=nil end end end;if not next(bT[bR])then bT[bR]=nil end end end end end end;bC.frame:RegisterEvent("PLAYER_LOGOUT")bC.frame:SetScript("OnEvent",cf)function bE:RegisterDefaults(bO)if bO and type(bO)~="table"then error(("Usage: AceDBObject:RegisterDefaults(defaults): 'defaults' - table or nil expected, got %q."):format(type(bO)),2)end;bY(bO,self.keys)if self.defaults then for bR,o in pairs(self.keys)do if self.defaults[bR]and rawget(self,bR)then bM(self[bR],self.defaults[bR])end end end;self.defaults=bO;if bO then for bR,o in pairs(self.keys)do if bO[bR]and rawget(self,bR)then bI(self[bR],bO[bR])end end end end;function bE:SetProfile(aa)if type(aa)~="string"then error(("Usage: AceDBObject:SetProfile(name): 'name' - string expected, got %q."):format(type(aa)),2)end;if aa==self.keys.profile then return end;local cg=self.profile;local bO=self.defaults and self.defaults.profile;self.callbacks:Fire("OnProfileShutdown",self)if cg and bO then bM(cg,bO)end;self.profile=nil;self.keys["profile"]=aa;if self.sv.profileKeys then self.sv.profileKeys[c1]=aa end;if self.children then for aV,bN in pairs(self.children)do bE.SetProfile(bN,aa)end end;self.callbacks:Fire("OnProfileChanged",self,aa)end;function bE:GetProfiles(n)if n and type(n)~="table"then error(("Usage: AceDBObject:GetProfiles(tbl): 'tbl' - table or nil expected, got %q."):format(type(n)),2)end;if n then for ad,ae in pairs(n)do n[ad]=nil end else n={}end;local ch=self.keys.profile;local M=0;for ce in pairs(self.profiles)do M=M+1;n[M]=ce;if ch and ce==ch then ch=nil end end;if ch then M=M+1;n[M]=ch end;return n,M end;function bE:GetCurrentProfile()return self.keys.profile end;function bE:DeleteProfile(aa,g)if type(aa)~="string"then error(("Usage: AceDBObject:DeleteProfile(name): 'name' - string expected, got %q."):format(type(aa)),2)end;if self.keys.profile==aa then error(("Cannot delete the active profile (%q) in an AceDBObject."):format(aa),2)end;if not rawget(self.profiles,aa)and not g then error(("Cannot delete profile %q as it does not exist."):format(aa),2)end;self.profiles[aa]=nil;if self.children then for aV,bN in pairs(self.children)do bE.DeleteProfile(bN,aa,true)end end;if self.sv.profileKeys then for o,ci in pairs(self.sv.profileKeys)do if ci==aa then self.sv.profileKeys[o]=nil end end end;self.callbacks:Fire("OnProfileDeleted",self,aa)end;function bE:CopyProfile(aa,g)if type(aa)~="string"then error(("Usage: AceDBObject:CopyProfile(name): 'name' - string expected, got %q."):format(type(aa)),2)end;if aa==self.keys.profile then error(("Cannot have the same source and destination profiles (%q)."):format(aa),2)end;if not rawget(self.profiles,aa)and not g then error(("Cannot copy profile %q as it does not exist."):format(aa),2)end;bE.ResetProfile(self,nil,true)local ci=self.profile;local cj=self.profiles[aa]bF(cj,ci)if self.children then for aV,bN in pairs(self.children)do bE.CopyProfile(bN,aa,true)end end;self.callbacks:Fire("OnProfileCopied",self,aa)end;function bE:ResetProfile(ck,cl)local ci=self.profile;for ad,ae in pairs(ci)do ci[ad]=nil end;local bO=self.defaults and self.defaults.profile;if bO then bI(ci,bO)end;if self.children and not ck then for aV,bN in pairs(self.children)do bE.ResetProfile(bN,nil,cl)end end;if not cl then self.callbacks:Fire("OnProfileReset",self)end end;function bE:ResetDB(cb)if cb and type(cb)~="string"then error(("Usage: AceDBObject:ResetDB(defaultProfile): 'defaultProfile' - string or nil expected, got %q."):format(type(cb)),2)end;local bT=self.sv;for ad,ae in pairs(bT)do bT[ad]=nil end;ca(bT,self.defaults,cb,self)if self.children then if not bT.namespaces then bT.namespaces={}end;for aa,bN in pairs(self.children)do if not bT.namespaces[aa]then bT.namespaces[aa]={}end;ca(bT.namespaces[aa],bN.defaults,self.keys.profile,bN,self)end end;self.callbacks:Fire("OnDatabaseReset",self)self.callbacks:Fire("OnProfileChanged",self,self.keys["profile"])return self end;function bE:RegisterNamespace(aa,bO)if type(aa)~="string"then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'name' - string expected, got %q."):format(type(aa)),2)end;if bO and type(bO)~="table"then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'defaults' - table or nil expected, got %q."):format(type(bO)),2)end;if self.children and self.children[aa]then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'name' - a namespace called %q already exists."):format(aa),2)end;local bT=self.sv;if not bT.namespaces then bT.namespaces={}end;if not bT.namespaces[aa]then bT.namespaces[aa]={}end;local cm=ca(bT.namespaces[aa],bO,self.keys.profile,nil,self)if not self.children then self.children={}end;self.children[aa]=cm;return cm end;function bE:GetNamespace(aa,g)if type(aa)~="string"then error(("Usage: AceDBObject:GetNamespace(name): 'name' - string expected, got %q."):format(type(aa)),2)end;if not g and not(self.children and self.children[aa])then error(("Usage: AceDBObject:GetNamespace(name): 'name' - namespace %q does not exist."):format(aa),2)end;if not self.children then self.children={}end;return self.children[aa]end;function bC:New(n,bO,cb)if type(n)=="string"then local aa=n;n=_G[aa]if not n then n={}_G[aa]=n end end;if type(n)~="table"then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'tbl' - table expected, got %q."):format(type(n)),2)end;if bO and type(bO)~="table"then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'defaults' - table expected, got %q."):format(type(bO)),2)end;if cb and type(cb)~="string"and cb~=true then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'defaultProfile' - string or true expected, got %q."):format(type(cb)),2)end;return ca(n,bO,cb)end;for bN in pairs(bC.db_registry)do if not bN.parent then for aa,J in pairs(bE)do bN[aa]=J end else bN.RegisterDefaults=bE.RegisterDefaults;bN.ResetProfile=bE.ResetProfile end end end;local function cn(...)local co,cp="AceDBOptions-3.0",15;local cq=LibStub:NewLibrary(co,cp)if not cq then return end;local pairs,next=pairs,next;local UnitClass=UnitClass;cq.optionTables=cq.optionTables or{}cq.handlers=cq.handlers or{}local cr={choose="Existing Profiles",choose_desc="You can either create a new profile by entering a name in the editbox, or choose one of the already existing profiles.",choose_sub="Select one of your currently available profiles.",copy="Copy From",copy_desc="Copy the settings from one existing profile into the currently active profile.",current="Current Profile:",default="Default",delete="Delete a Profile",delete_confirm="Are you sure you want to delete the selected profile?",delete_desc="Delete existing and unused profiles from the database to save space, and cleanup the SavedVariables file.",delete_sub="Deletes a profile from the database.",intro="You can change the active database profile, so you can have different settings for every character.",new="New",new_sub="Create a new empty profile.",profiles="Profiles",profiles_sub="Manage Profiles",reset="Reset Profile",reset_desc="Reset the current profile back to its default values, in case your configuration is broken, or you simply want to start over.",reset_sub="Reset the current profile to the default"}local cs=GetLocale()if cs=="deDE"then cr["choose"]="Vorhandene Profile"cr["choose_desc"]="Du kannst ein neues Profil erstellen, indem du einen neuen Namen in der Eingabebox 'Neu' eingibst, oder wähle eines der vorhandenen Profile aus."cr["choose_sub"]="Wählt ein bereits vorhandenes Profil aus."cr["copy"]="Kopieren von..."cr["copy_desc"]="Kopiere die Einstellungen von einem vorhandenen Profil in das aktive Profil."cr["current"]="Aktuelles Profil:"cr["default"]="Standard"cr["delete"]="Profil löschen"cr["delete_confirm"]="Willst du das ausgewählte Profil wirklich löschen?"cr["delete_desc"]="Lösche vorhandene oder unbenutzte Profile aus der Datenbank, um Platz zu sparen und die SavedVariables-Datei 'sauber' zu halten."cr["delete_sub"]="Löscht ein Profil aus der Datenbank."cr["intro"]="Hier kannst du das aktive Datenbankprofil ändern, damit du verschiedene Einstellungen für jeden Charakter erstellen kannst, wodurch eine sehr flexible Konfiguration möglich wird."cr["new"]="Neu"cr["new_sub"]="Ein neues Profil erstellen."cr["profiles"]="Profile"cr["profiles_sub"]="Profile verwalten"cr["reset"]="Profil zurücksetzen"cr["reset_desc"]="Setzt das momentane Profil auf Standardwerte zurück, für den Fall, dass mit der Konfiguration etwas schief lief oder weil du einfach neu starten willst."cr["reset_sub"]="Das aktuelle Profil auf Standard zurücksetzen."elseif cs=="frFR"then cr["choose"]="Profils existants"cr["choose_desc"]="Vous pouvez créer un nouveau profil en entrant un nouveau nom dans la boîte de saisie, ou en choississant un des profils déjà existants."cr["choose_sub"]="Permet de choisir un des profils déjà disponibles."cr["copy"]="Copier à partir de"cr["copy_desc"]="Copie les paramètres d'un profil déjà existant dans le profil actuellement actif."cr["current"]="Profil actuel :"cr["default"]="Défaut"cr["delete"]="Supprimer un profil"cr["delete_confirm"]="Etes-vous sûr de vouloir supprimer le profil sélectionné ?"cr["delete_desc"]="Supprime les profils existants inutilisés de la base de données afin de gagner de la place et de nettoyer le fichier SavedVariables."cr["delete_sub"]="Supprime un profil de la base de données."cr["intro"]="Vous pouvez changer le profil actuel afin d'avoir des paramètres différents pour chaque personnage, permettant ainsi d'avoir une configuration très flexible."cr["new"]="Nouveau"cr["new_sub"]="Créée un nouveau profil vierge."cr["profiles"]="Profils"cr["profiles_sub"]="Gestion des profils"cr["reset"]="Réinitialiser le profil"cr["reset_desc"]="Réinitialise le profil actuel au cas où votre configuration est corrompue ou si vous voulez tout simplement faire table rase."cr["reset_sub"]="Réinitialise le profil actuel avec les paramètres par défaut."elseif cs=="koKR"then cr["choose"]="기존 프로필"cr["choose_desc"]="편집 상자에 이름을 입력하여 새로운 프로필을 만들거나 이미 존재하는 프로필 중 하나를 선택할 수 있습니다."cr["choose_sub"]="현재 이용할 수 있는 프로필 중 하나를 선택합니다."cr["copy"]="복사해 올 프로필"cr["copy_desc"]="기존 프로필의 설정을 현재 활성화된 프로필로 복사합니다."cr["current"]="현재 프로필:"cr["default"]="기본값"cr["delete"]="프로필 삭제"cr["delete_confirm"]="선택한 프로필을 삭제하시겠습니까?"cr["delete_desc"]="데이터베이스에서 기존 프로필과 사용하지 않는 프로필을 삭제하여 공간을 절약하고 SavedVariables 파일을 정리합니다."cr["delete_sub"]="데이터베이스에서 프로필을 삭제합니다."cr["intro"]="활성 데이터베이스 프로필을 변경할 수 있으며, 모든 캐릭터마다 서로 다른 설정을 지정할 수 있습니다."cr["new"]="새로운 프로필"cr["new_sub"]="비어 있는 프로필을 새로 만듭니다."cr["profiles"]="프로필"cr["profiles_sub"]="프로필 관리"cr["reset"]="프로필 재설정"cr["reset_desc"]="구성이 손상되었거나 처음부터 다시 시작하고 싶은 경우 현재 프로필을 기본값으로 재설정하세요."cr["reset_sub"]="현재 프로필을 기본값으로 재설정합니다"elseif cs=="esES"or cs=="esMX"then cr["choose"]="Perfiles existentes"cr["choose_desc"]="Puedes crear un nuevo perfil introduciendo un nombre en el recuadro o puedes seleccionar un perfil de los ya existentes."cr["choose_sub"]="Selecciona uno de los perfiles disponibles."cr["copy"]="Copiar de"cr["copy_desc"]="Copia los ajustes de un perfil existente al perfil actual."cr["current"]="Perfil actual:"cr["default"]="Por defecto"cr["delete"]="Borrar un Perfil"cr["delete_confirm"]="¿Estas seguro que quieres borrar el perfil seleccionado?"cr["delete_desc"]="Borra los perfiles existentes y sin uso de la base de datos para ganar espacio y limpiar el archivo SavedVariables."cr["delete_sub"]="Borra un perfil de la base de datos."cr["intro"]="Puedes cambiar el perfil activo de tal manera que cada personaje tenga diferentes configuraciones."cr["new"]="Nuevo"cr["new_sub"]="Crear un nuevo perfil vacio."cr["profiles"]="Perfiles"cr["profiles_sub"]="Manejar Perfiles"cr["reset"]="Reiniciar Perfil"cr["reset_desc"]="Reinicia el perfil actual a los valores por defectos, en caso de que se haya estropeado la configuración o quieras volver a empezar de nuevo."cr["reset_sub"]="Reinicar el perfil actual al de por defecto"elseif cs=="zhTW"then cr["choose"]="現有的設定檔"cr["choose_desc"]="您可以在文字方塊內輸入名字以建立新的設定檔，或是選擇一個現有的設定檔使用。"cr["choose_sub"]="從當前可用的設定檔裡面選擇一個。"cr["copy"]="複製自"cr["copy_desc"]="從一個現有的設定檔，將設定複製到現在使用中的設定檔。"cr["current"]="目前設定檔："cr["default"]="預設"cr["delete"]="刪除一個設定檔"cr["delete_confirm"]="確定要刪除所選擇的設定檔嗎？"cr["delete_desc"]="從資料庫裡刪除不再使用的設定檔，以節省空間，並且清理 SavedVariables 檔案。"cr["delete_sub"]="從資料庫裡刪除一個設定檔。"cr["intro"]="您可以從資料庫中選擇一個設定檔來使用，如此就可以讓每個角色使用不同的設定。"cr["new"]="新建"cr["new_sub"]="新建一個空的設定檔。"cr["profiles"]="設定檔"cr["profiles_sub"]="管理設定檔"cr["reset"]="重置設定檔"cr["reset_desc"]="將現用的設定檔重置為預設值；用於設定檔損壞，或者單純想要重來的情況。"cr["reset_sub"]="將目前的設定檔重置為預設值"elseif cs=="zhCN"then cr["choose"]="现有的配置文件"cr["choose_desc"]="你可以通过在文本框内输入一个名字创立一个新的配置文件，也可以选择一个已经存在的配置文件。"cr["choose_sub"]="从当前可用的配置文件里面选择一个。"cr["copy"]="复制自"cr["copy_desc"]="从当前某个已保存的配置文件复制到当前正使用的配置文件。"cr["current"]="当前配置文件："cr["default"]="默认"cr["delete"]="删除一个配置文件"cr["delete_confirm"]="你确定要删除所选择的配置文件么？"cr["delete_desc"]="从数据库里删除不再使用的配置文件，以节省空间，并且清理SavedVariables文件。"cr["delete_sub"]="从数据库里删除一个配置文件。"cr["intro"]="你可以选择一个活动的数据配置文件，这样你的每个角色就可以拥有不同的设置值，可以给你的插件配置带来极大的灵活性。"cr["new"]="新建"cr["new_sub"]="新建一个空的配置文件。"cr["profiles"]="配置文件"cr["profiles_sub"]="管理配置文件"cr["reset"]="重置配置文件"cr["reset_desc"]="将当前的配置文件恢复到它的默认值，用于你的配置文件损坏，或者你只是想重来的情况。"cr["reset_sub"]="将当前的配置文件恢复为默认值"elseif cs=="ruRU"then cr["choose"]="Существующие профили"cr["choose_desc"]="Вы можете создать новый профиль, введя название в поле ввода, или выбрать один из уже существующих профилей."cr["choose_sub"]="Выбор одного из уже доступных профилей."cr["copy"]="Скопировать из"cr["copy_desc"]="Копирование настроек из выбранного профиля в активный."cr["current"]="Текущий профиль:"cr["default"]="По умолчанию"cr["delete"]="Удалить профиль"cr["delete_confirm"]="Вы уверены, что хотите удалить выбранный профиль?"cr["delete_desc"]="Удаление существующего и неиспользуемого профиля из базы данных для сохранения места, и очистка файла SavedVariables."cr["delete_sub"]="Удаление профиля из базы данных."cr["intro"]="Изменяя активный профиль, Вы можете задать разные настройки для каждого персонажа."cr["new"]="Новый"cr["new_sub"]="Создание нового чистого профиля."cr["profiles"]="Профили"cr["profiles_sub"]="Управление профилями"cr["reset"]="Сбросить профиль"cr["reset_desc"]="Сброс текущего профиля к стандартным настройкам, если Ваша конфигурация испорчена или Вы хотите настроить все заново."cr["reset_sub"]="Сброс текущего профиля на стандартный"elseif cs=="itIT"then cr["choose"]="Profili Esistenti"cr["choose_desc"]="Puoi creare un nuovo profilo digitando il nome della casella di testo, oppure scegliendone uno tra i profili già esistenti."cr["choose_sub"]="Seleziona uno dei profili attualmente disponibili."cr["copy"]="Copia Da"cr["copy_desc"]="Copia le impostazioni da un profilo esistente nel profilo attivo in questo momento."cr["current"]="Profilo Attivo:"cr["default"]="Predefinito"cr["delete"]="Cancella un Profilo"cr["delete_confirm"]="Sei sicuro di voler cancellare il profilo selezionato?"cr["delete_desc"]="Cancella i profili non utilizzati dal database per risparmiare spazio e mantenere puliti i file di configurazione SavedVariables."cr["delete_sub"]="Cancella un profilo dal Database."cr["intro"]="Puoi cambiare il profilo attivo, in modo da usare impostazioni diverse per ogni personaggio."cr["new"]="Nuovo"cr["new_sub"]="Crea un nuovo profilo vuoto."cr["profiles"]="Profili"cr["profiles_sub"]="Gestisci Profili"cr["reset"]="Reimposta Profilo"cr["reset_desc"]="Riporta il tuo profilo attivo alle sue impostazioni predefinite, nel caso in cui la tua configurazione si sia corrotta, o semplicemente tu voglia re-inizializzarla."cr["reset_sub"]="Reimposta il profilo ai suoi valori predefiniti."elseif cs=="ptBR"then cr["choose"]="Perfis Existentes"cr["choose_desc"]="Você pode tanto criar um perfil novo tanto digitando um nome na caixa de texto, quanto escolher um dos perfis já existentes."cr["choose_sub"]="Selecione um de seus perfis atualmente disponíveis."cr["copy"]="Copiar De"cr["copy_desc"]="Copia as definições de um perfil existente no perfil atualmente ativo."cr["current"]="Perfil Autal:"cr["default"]="Padrão"cr["delete"]="Remover um Perfil"cr["delete_confirm"]="Tem certeza que deseja remover o perfil selecionado?"cr["delete_desc"]="Remove perfis existentes e inutilizados do banco de dados para economizar espaço, e limpar o arquivo SavedVariables."cr["delete_sub"]="Remove um perfil do banco de dados."cr["intro"]="Você pode alterar o perfil do banco de dados ativo, para que possa ter definições diferentes para cada personagem."cr["new"]="Novo"cr["new_sub"]="Cria um novo perfil vazio."cr["profiles"]="Perfis"cr["profiles_sub"]="Gerenciar Perfis"cr["reset"]="Resetar Perfil"cr["reset_desc"]="Reseta o perfil atual para os valores padrões, no caso de sua configuração estar quebrada, ou simplesmente se deseja começar novamente."cr["reset_sub"]="Resetar o perfil atual ao padrão"end;local ct;local cu={}local function cv(bN,cw,cx)local cy={}local cz=bN:GetCurrentProfile()for M,ae in pairs(bN:GetProfiles(cu))do if not(cx and ae==cz)then cy[ae]=ae end end;for ad,ae in pairs(ct)do if(cw or cy[ad])and not(cx and ad==cz)then cy[ad]=ae end end;return cy end;local cA={}function cA:Reset()self.db:ResetProfile()end;function cA:SetProfile(cB,by)self.db:SetProfile(by)end;function cA:GetCurrentProfile()return self.db:GetCurrentProfile()end;function cA:ListProfiles(cB)local L=cB.arg;local cy;if L=="common"and not self.noDefaultProfiles then cy=cv(self.db,true,nil)elseif L=="nocurrent"then cy=cv(self.db,nil,true)elseif L=="both"then cy=cv(self.db,not self.noDefaultProfiles and true,true)else cy=cv(self.db)end;return cy end;function cA:HasNoProfiles(cB)local cy=self:ListProfiles(cB)return not next(cy)and true or false end;function cA:CopyProfile(cB,by)self.db:CopyProfile(by)end;function cA:DeleteProfile(cB,by)self.db:DeleteProfile(by)end;local function cC(bN)ct={["Default"]=cr["default"],[bN.keys.char]=bN.keys.char,[bN.keys.realm]=bN.keys.realm,[bN.keys.class]=UnitClass("player")}end;local function cD(bN,cE)if not ct then cC(bN)end;local bl=cq.handlers[bN]or{db=bN,noDefaultProfiles=cE}for ad,ae in pairs(cA)do bl[ad]=ae end;cq.handlers[bN]=bl;return bl end;local cF={desc={order=1,type="description",name=cr["intro"].."\n"},descreset={order=9,type="description",name=cr["reset_desc"]},reset={order=10,type="execute",name=cr["reset"],desc=cr["reset_sub"],func="Reset"},current={order=11,type="description",name=function(cB)return cr["current"].." "..NORMAL_FONT_COLOR_CODE..cB.handler:GetCurrentProfile()..FONT_COLOR_CODE_CLOSE end,width="default"},choosedesc={order=20,type="description",name="\n"..cr["choose_desc"]},new={name=cr["new"],desc=cr["new_sub"],type="input",order=30,get=false,set="SetProfile"},choose={name=cr["choose"],desc=cr["choose_sub"],type="select",order=40,get="GetCurrentProfile",set="SetProfile",values="ListProfiles",arg="common"},copydesc={order=50,type="description",name="\n"..cr["copy_desc"]},copyfrom={order=60,type="select",name=cr["copy"],desc=cr["copy_desc"],get=false,set="CopyProfile",values="ListProfiles",disabled="HasNoProfiles",arg="nocurrent"},deldesc={order=70,type="description",name="\n"..cr["delete_desc"]},delete={order=80,type="select",name=cr["delete"],desc=cr["delete_sub"],get=false,set="DeleteProfile",values="ListProfiles",disabled="HasNoProfiles",arg="nocurrent",confirm=true,confirmText=cr["delete_confirm"]}}function cq:GetOptionsTable(bN,cE)local n=cq.optionTables[bN]or{type="group",name=cr["profiles"],desc=cr["profiles_sub"]}n.handler=cD(bN,cE)n.args=cF;cq.optionTables[bN]=n;return n end;for bN,n in pairs(cq.optionTables)do n.handler=cD(bN)n.args=cF end end;local function cG(...)local i,k="AceLocale-3.0",6;local cH,f=LibStub:NewLibrary(i,k)if not cH then return end;local assert,tostring,error=assert,tostring,error;local getmetatable,setmetatable,rawset,rawget=getmetatable,setmetatable,rawset,rawget;local cI=GetLocale()if cI=="enGB"then cI="enUS"end;cH.apps=cH.apps or{}cH.appnames=cH.appnames or{}local cJ={__index=function(self,o)rawset(self,o,o)geterrorhandler()(i..": "..tostring(cH.appnames[self])..": Missing entry for '"..tostring(o).."'")return o end}local cK={__index=function(self,o)rawset(self,o,o)return o end}local cL;local cM=function()assert(false)end;local cN=setmetatable({},{__newindex=function(self,o,by)rawset(cL,o,by==true and o or by)end,__index=cM})local cO=setmetatable({},{__newindex=function(self,o,by)if not rawget(cL,o)then rawset(cL,o,by==true and o or by)end end,__index=cM})function cH:NewLocale(cP,cQ,cR,g)local cS=GAME_LOCALE or cI;local cT=cH.apps[cP]if g and cT and getmetatable(cT)~=cK then geterrorhandler()("Usage: NewLocale(application, locale[, isDefault[, silent]]): 'silent' must be specified for the first locale registered")end;if not cT then if g=="raw"then cT={}else cT=setmetatable({},g and cK or cJ)end;cH.apps[cP]=cT;cH.appnames[cT]=cP end;if cQ~=cS and not cR then return end;cL=cT;if cR then return cO end;return cN end;function cH:GetLocale(cP,g)if not g and not cH.apps[cP]then error("Usage: GetLocale(application[, silent]): 'application' - No locales registered for '"..tostring(cP).."'",2)end;return cH.apps[cP]end end;local function cU(...)local i,k="AceConsole-3.0",7;local cV,f=LibStub:NewLibrary(i,k)if not cV then return end;cV.embeds=cV.embeds or{}cV.commands=cV.commands or{}cV.weakcommands=cV.weakcommands or{}local P,tostring,select=table.concat,tostring,select;local type,pairs,error=type,pairs,error;local bg,cW,cX=string.format,string.find,string.sub;local cY=math.max;local _G=_G;local cZ={}local function c_(self,bx,...)local d0=0;if self~=cV then d0=d0+1;cZ[d0]="|cff33ff99"..tostring(self).."|r:"end;for M=1,select("#",...)do d0=d0+1;cZ[d0]=tostring(select(M,...))end;bx:AddMessage(P(cZ," ",1,d0))end;function cV:Print(...)local bx=...if type(bx)=="table"and bx.AddMessage then return c_(self,bx,select(2,...))else return c_(self,DEFAULT_CHAT_FRAME,...)end end;function cV:Printf(...)local bx=...if type(bx)=="table"and bx.AddMessage then return c_(self,bx,bg(select(2,...)))else return c_(self,DEFAULT_CHAT_FRAME,bg(...))end end;function cV:RegisterChatCommand(d1,J,d2)if type(d1)~="string"then error([[Usage: AceConsole:RegisterChatCommand( "command", func[, persist ]): 'command' - expected a string]],2)end;if d2==nil then d2=true end;local aa="ACECONSOLE_"..d1:upper()if type(J)=="string"then SlashCmdList[aa]=function(d3,d4)self[J](self,d3,d4)end else SlashCmdList[aa]=J end;_G["SLASH_"..aa.."1"]="/"..d1:lower()cV.commands[d1]=aa;if not d2 then if not cV.weakcommands[self]then cV.weakcommands[self]={}end;cV.weakcommands[self][d1]=J end;return true end;function cV:UnregisterChatCommand(d1)local aa=cV.commands[d1]if aa then SlashCmdList[aa]=nil;_G["SLASH_"..aa.."1"]=nil;hash_SlashCmdList["/"..d1:upper()]=nil;cV.commands[d1]=nil end end;function cV:IterateChatCommands()return pairs(cV.commands)end;local function d5(d0,...)if d0>1 then return nil,d5(d0-1,...)elseif d0==1 then return nil,...else return...end end;function cV:GetArgs(d6,d7,d8)d7=d7 or 1;d8=cY(d8 or 1,1)local d9=d8;d9=cW(d6,"[^ ]",d9)if not d9 then return d5(d7,1e9)end;if d7<1 then return d9 end;local da;local db=cX(d6,d9,d9)if db=='"'then d9=d9+1;da='([|"])'elseif db=="'"then d9=d9+1;da="([|'])"else da="([| ])"end;d8=d9;while true do local aV;d9,aV,db=cW(d6,da,d9)if not d9 then break end;if db=="|"then if cX(d6,d9,d9+1)=="|H"then d9=cW(d6,"|h",d9+2)if not d9 then break end;d9=cW(d6,"|h",d9+2)if not d9 then break end elseif cX(d6,d9,d9+1)=="|T"then d9=cW(d6,"|t",d9+2)if not d9 then break end end;d9=d9+2 else return cX(d6,d8,d9-1),cV:GetArgs(d6,d7-1,d9+1)end end;return cX(d6,d8),d5(d7-1,1e9)end;local aq={"Print","Printf","RegisterChatCommand","UnregisterChatCommand","GetArgs"}function cV:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;function cV:OnEmbedEnable(u)if cV.weakcommands[u]then for d1,J in pairs(cV.weakcommands[u])do u:RegisterChatCommand(d1,J,false,true)end end end;function cV:OnEmbedDisable(u)if cV.weakcommands[u]then for d1,J in pairs(cV.weakcommands[u])do u:UnregisterChatCommand(d1)end end end;for a8 in pairs(cV.embeds)do cV:Embed(a8)end end;local function dc(...)local dd,de="AceGUI-3.0",41;local df,f=LibStub:NewLibrary(dd,de)if not df then return end;local tinsert,dg=table.insert,table.wipe;local select,pairs,next,type=select,pairs,next,type;local error,assert=error,assert;local setmetatable,rawget=setmetatable,rawget;local dh,di,dj=math.max,math.min,math.ceil;local UIParent=UIParent;df.WidgetRegistry=df.WidgetRegistry or{}df.LayoutRegistry=df.LayoutRegistry or{}df.WidgetBase=df.WidgetBase or{}df.WidgetContainerBase=df.WidgetContainerBase or{}df.WidgetVersions=df.WidgetVersions or{}df.tooltip=df.tooltip or CreateFrame("GameTooltip","AceGUITooltip",UIParent,"GameTooltipTemplate")local dk=df.WidgetRegistry;local dl=df.LayoutRegistry;local dm=df.WidgetVersions;local xpcall=xpcall;local function S(T)return geterrorhandler()(T)end;local function U(J,...)if J then return xpcall(J,S,...)end end;local dn,dp;do if f and f<29 and df.objPools then df.objPools=nil end;df.objPools=df.objPools or{}local dq=df.objPools;function dn(dr)if not dk[dr]then error("Attempt to instantiate unknown widget type",2)end;if not dq[dr]then dq[dr]={}end;local ds=next(dq[dr])if not ds then ds=dk[dr]()ds.AceGUIWidgetVersion=dm[dr]else dq[dr][ds]=nil;if not ds.AceGUIWidgetVersion or ds.AceGUIWidgetVersion<dm[dr]then return dn(dr)end end;return ds end;function dp(bq,dr)if not dq[dr]then dq[dr]={}end;if dq[dr][bq]then error("Attempt to Release Widget that is already released",2)end;dq[dr][bq]=true end end;function df:Create(dr)if dk[dr]then local dt=dn(dr)if rawget(dt,"Acquire")then dt.OnAcquire=dt.Acquire;dt.Acquire=nil elseif rawget(dt,"Aquire")then dt.OnAcquire=dt.Aquire;dt.Aquire=nil end;if rawget(dt,"Release")then dt.OnRelease=rawget(dt,"Release")dt.Release=nil end;if dt.OnAcquire then dt:OnAcquire()else error(("Widget type %s doesn't supply an OnAcquire Function"):format(dr))end;U(dt.SetLayout,dt,"List")U(dt.ResumeLayout,dt)return dt end end;function df:Release(dt)if dt.isQueuedForRelease then return end;dt.isQueuedForRelease=true;U(dt.PauseLayout,dt)dt.frame:Hide()dt:Fire("OnRelease")U(dt.ReleaseChildren,dt)if dt.OnRelease then dt:OnRelease()end;for ad in pairs(dt.userdata)do dt.userdata[ad]=nil end;for ad in pairs(dt.events)do dt.events[ad]=nil end;dt.width=nil;dt.relWidth=nil;dt.height=nil;dt.relHeight=nil;dt.noAutoHeight=nil;dt.frame:ClearAllPoints()dt.frame:Hide()dt.frame:SetParent(UIParent)dt.frame.width=nil;dt.frame.height=nil;if dt.content then dt.content.width=nil;dt.content.height=nil end;dt.isQueuedForRelease=nil;dp(dt,dt.type)end;function df:IsReleasing(dt)if dt.isQueuedForRelease then return true end;if dt.parent and dt.parent.AceGUIWidgetVersion then return df:IsReleasing(dt.parent)end;return false end;function df:SetFocus(dt)if self.FocusedWidget and self.FocusedWidget~=dt then U(self.FocusedWidget.ClearFocus,self.FocusedWidget)end;self.FocusedWidget=dt end;function df:ClearFocus()if self.FocusedWidget then U(self.FocusedWidget.ClearFocus,self.FocusedWidget)self.FocusedWidget=nil end end;do local du=df.WidgetBase;du.SetParent=function(self,cd)local bx=self.frame;bx:SetParent(nil)bx:SetParent(cd.content)self.parent=cd end;du.SetCallback=function(self,aa,J)if type(J)=="function"then self.events[aa]=J end end;du.Fire=function(self,aa,...)if self.events[aa]then local dv,dw=U(self.events[aa],self,aa,...)if dv then return dw end end end;du.SetWidth=function(self,dx)self.frame:SetWidth(dx)self.frame.width=dx;if self.OnWidthSet then self:OnWidthSet(dx)end end;du.SetRelativeWidth=function(self,dx)if dx<=0 or dx>1 then error(":SetRelativeWidth(width): Invalid relative width.",2)end;self.relWidth=dx;self.width="relative"end;du.SetHeight=function(self,dy)self.frame:SetHeight(dy)self.frame.height=dy;if self.OnHeightSet then self:OnHeightSet(dy)end end;du.IsVisible=function(self)return self.frame:IsVisible()end;du.IsShown=function(self)return self.frame:IsShown()end;du.Release=function(self)df:Release(self)end;du.IsReleasing=function(self)return df:IsReleasing(self)end;du.SetPoint=function(self,...)return self.frame:SetPoint(...)end;du.ClearAllPoints=function(self)return self.frame:ClearAllPoints()end;du.GetNumPoints=function(self)return self.frame:GetNumPoints()end;du.GetPoint=function(self,...)return self.frame:GetPoint(...)end;du.GetUserDataTable=function(self)return self.userdata end;du.SetUserData=function(self,o,by)self.userdata[o]=by end;du.GetUserData=function(self,o)return self.userdata[o]end;du.IsFullHeight=function(self)return self.height=="fill"end;du.SetFullHeight=function(self,dz)if dz then self.height="fill"else self.height=nil end end;du.IsFullWidth=function(self)return self.width=="fill"end;du.SetFullWidth=function(self,dz)if dz then self.width="fill"else self.width=nil end end;local dA=df.WidgetContainerBase;dA.PauseLayout=function(self)self.LayoutPaused=true end;dA.ResumeLayout=function(self)self.LayoutPaused=nil end;dA.PerformLayout=function(self)if self.LayoutPaused then return end;U(self.LayoutFunc,self.content,self.children)end;dA.DoLayout=function(self)self:PerformLayout()end;dA.AddChild=function(self,dB,dC)if dC then local dD=1;for aV,dt in pairs(self.children)do if dt==dC then break end;dD=dD+1 end;tinsert(self.children,dD,dB)else tinsert(self.children,dB)end;dB:SetParent(self)dB.frame:Show()self:DoLayout()end;dA.AddChildren=function(self,...)for M=1,select("#",...)do local dB=select(M,...)tinsert(self.children,dB)dB:SetParent(self)dB.frame:Show()end;self:DoLayout()end;dA.ReleaseChildren=function(self)local dE=self.children;for M=1,#dE do df:Release(dE[M])dE[M]=nil end end;dA.SetLayout=function(self,dF)self.LayoutFunc=df:GetLayout(dF)end;dA.SetAutoAdjustHeight=function(self,dG)if dG then self.noAutoHeight=nil else self.noAutoHeight=true end end;local function dH(ay)local self=ay.obj;if ay:GetWidth()and ay:GetHeight()then if self.OnWidthSet then self:OnWidthSet(ay:GetWidth())end;if self.OnHeightSet then self:OnHeightSet(ay:GetHeight())end end end;local function dI(ay)if ay:GetWidth()and ay:GetHeight()then ay.width=ay:GetWidth()ay.height=ay:GetHeight()ay.obj:DoLayout()end end;setmetatable(dA,{__index=du})function df:RegisterAsContainer(dt)dt.children={}dt.userdata={}dt.events={}dt.base=dA;dt.content.obj=dt;dt.frame.obj=dt;dt.content:SetScript("OnSizeChanged",dI)dt.frame:SetScript("OnSizeChanged",dH)setmetatable(dt,{__index=dA})dt:SetLayout("List")return dt end;function df:RegisterAsWidget(dt)dt.userdata={}dt.events={}dt.base=du;dt.frame.obj=dt;dt.frame:SetScript("OnSizeChanged",dH)setmetatable(dt,{__index=du})return dt end end;function df:RegisterWidgetType(dJ,dK,dL)assert(type(dK)=="function")assert(type(dL)=="number")local dM=dm[dJ]if dM and dM>=dL then return end;dm[dJ]=dL;dk[dJ]=dK end;function df:RegisterLayout(dJ,dN)assert(type(dN)=="function")if type(dJ)=="string"then dJ=dJ:upper()end;dl[dJ]=dN end;function df:GetLayout(dJ)if type(dJ)=="string"then dJ=dJ:upper()end;return dl[dJ]end;df.counts=df.counts or{}function df:GetNextWidgetNum(dr)if not self.counts[dr]then self.counts[dr]=0 end;self.counts[dr]=self.counts[dr]+1;return self.counts[dr]end;function df:GetWidgetCount(dr)return self.counts[dr]or 0 end;function df:GetWidgetVersion(dr)return dm[dr]end;df:RegisterLayout("List",function(dO,dE)local dy=0;local dx=dO.width or dO:GetWidth()or 0;for M=1,#dE do local dB=dE[M]local bx=dB.frame;bx:ClearAllPoints()bx:Show()if M==1 then bx:SetPoint("TOPLEFT",dO)else bx:SetPoint("TOPLEFT",dE[M-1].frame,"BOTTOMLEFT")end;if dB.width=="fill"then dB:SetWidth(dx)bx:SetPoint("RIGHT",dO)if dB.DoLayout then dB:DoLayout()end elseif dB.width=="relative"then dB:SetWidth(dx*dB.relWidth)if dB.DoLayout then dB:DoLayout()end end;dy=dy+(bx.height or bx:GetHeight()or 0)end;U(dO.obj.LayoutFinished,dO.obj,nil,dy)end)df:RegisterLayout("Fill",function(dO,dE)if dE[1]then dE[1]:SetWidth(dO:GetWidth()or 0)dE[1]:SetHeight(dO:GetHeight()or 0)dE[1].frame:ClearAllPoints()dE[1].frame:SetAllPoints(dO)dE[1].frame:Show()U(dO.obj.LayoutFinished,dO.obj,nil,dE[1].frame:GetHeight())end end)local dP=nil;local function dQ(I,J,...)dP=true;I[J](I,...)dP=nil end;df:RegisterLayout("Flow",function(dO,dE)if dP then return end;local dy=0;local dR=0;local dS=0;local dT=0;local dx=dO.width or dO:GetWidth()or 0;local dU;local dV;local dW;local dX;local dY;local dZ;for M=1,#dE do local dB=dE[M]dZ=nil;local bx=dB.frame;local d_=bx.height or bx:GetHeight()or 0;local e0=bx.width or bx:GetWidth()or 0;dY=dX;dX=dB.alignoffset or d_/2;if dB.width=="relative"then e0=dx*dB.relWidth end;bx:Show()bx:ClearAllPoints()if M==1 then bx:SetPoint("TOPLEFT",dO)dS=d_;dT=dX;dU=bx;dV=dX;dR=e0;if dR>dx then dZ=true end else if dR==0 or e0+dR>dx or dB.width=="fill"then if dW then break end;dU:SetPoint("TOPLEFT",dO,"TOPLEFT",0,-(dy+dT-dV+3))dy=dy+dS+3;dU=bx;dV=dX;dS=d_;dT=dX;dR=e0;if dR>dx then dZ=true end else dT=dh(dT,dX)dS=dh(dS,dT+d_/2)bx:SetPoint("TOPLEFT",dE[M-1].frame,"TOPRIGHT",0,dX-dY)dR=e0+dR end end;if dB.width=="fill"then dQ(dB,"SetWidth",dx)bx:SetPoint("RIGHT",dO)dR=0;dU=bx;if dB.DoLayout then dB:DoLayout()end;dS=bx.height or bx:GetHeight()or 0;dT=dB.alignoffset or dS/2;dV=dT elseif dB.width=="relative"then dQ(dB,"SetWidth",dx*dB.relWidth)if dB.DoLayout then dB:DoLayout()end elseif dZ then if dx>1 then bx:SetPoint("RIGHT",dO)end end;if dB.height=="fill"then bx:SetPoint("BOTTOM",dO)dW=true end end;if dW then dU:SetPoint("TOPLEFT",dO,"TOPLEFT",0,-dy)elseif dU then dU:SetPoint("TOPLEFT",dO,"TOPLEFT",0,-(dy+dT-dV+3))end;dy=dy+dS+3;U(dO.obj.LayoutFinished,dO.obj,nil,dy)end)local e1=function(e2,e3,e4,e5,e6,dB)local e7=e5 and(e5["align"..e2]or e5.align)or e4 and(e4["align"..e2]or e4.align)or e3["align"..e2]or e3.align or"CENTERLEFT"local e8;dB,e6=dB or 0,e6 or 0;if type(e7)=="string"then e7=e7:lower()e7=e2=="V"and(e7:sub(1,3)=="top"and"start"or e7:sub(1,6)=="bottom"and"end"or e7:sub(1,6)=="center"and"middle")or e2=="H"and(e7:sub(-4)=="left"and"start"or e7:sub(-5)=="right"and"end"or e7:sub(-6)=="center"and"middle")or e7;e8=(e7=="start"or e7=="fill")and 0 or e7=="end"and e6-dB or(e6-dB)/2 elseif type(e7)=="function"then e8=e7(dB or 0,e6,e2)else e8=e7 end;return e7,dh(0,di(e8,e6))end;local e9=function(e2,ea,eb,ec,ed)local ee=0;for e6=eb,ec do ee=ee+(ea[e6]or 0)end;return ee+dh(0,ec-eb)*(ed or 0)end;df:RegisterLayout("Table",function(dO,dE)local bq=dO.obj;bq:PauseLayout()local e3=bq:GetUserData("table")local ef=e3.columns;local eg=e3.spaceH or e3.space or 0;local eh=e3.spaceV or e3.space or 0;local ei=(dO:GetWidth()or dO.width or 0)-eg*(#ef-1)local ej=bq:GetUserData("layoutCache")if not ej then ej={{},{},{},{},{},{}}bq:SetUserData("layoutCache",ej)end;local aU,ek,el,em,en,eo=unpack(ej)local d0,ep=0;for M,dB in ipairs(dE)do if dB:IsShown()then repeat d0=d0+1;local col=(d0-1)%#ef+1;local row=dj(d0/#ef)local eq=em[col]local e6=eq and eq.child or dB;local e5=e6:GetUserData("cell")ep=not eq;if not eq and e5 and e5.rowspan then eq={child=dB,from=row,to=row+e5.rowspan-1}em[col]=eq end;if eq and M==#dE then eq.to=row end;local er=dh(0,di((e5 and e5.colspan or 1)-1,#ef-col))d0=d0+er;if not eq or eq.to==row then aU[d0]=e6;en[e6]=eq and eq.from or row;eo[e6]=col;if eq then em[col]=nil end end until ep end end;local es=dj(d0/#ef)local et,eu=ei,0;for col,e4 in ipairs(ef)do ek[col]=0;if type(e4)=="number"then e4={[e4>=1 and e4<10 and"weight"or"width"]=e4}ef[col]=e4 end;if e4.weight then eu=eu+(e4.weight or 1)else if not e4.width or e4.width<=0 then for row=1,es do local dB=aU[(row-1)*#ef+col]if dB then local ev=dB.frame;ev:ClearAllPoints()local ew=ev:GetWidth()or 0;ek[col]=dh(ek[col],ew-e9("H",ek,eo[dB],col-1,eg))end end;ek[col]=dh(e4.min or e4[1]or 0,di(ek[col],e4.max or e4[2]or ek[col]))else ek[col]=e4.width<1 and e4.width*ei or e4.width end;et=dh(0,et-ek[col])end end;local ex=eu>0 and et/eu or 0;for col,e4 in pairs(ef)do if e4.weight then ek[col]=ex*e4.weight end end;for row=1,es do local ey=0;for col=1,#ef do local dB=aU[(row-1)*#ef+col]if dB then local e4=ef[eo[dB]]local e5=dB:GetUserData("cell")local ez=e9("H",ek,1,eo[dB]-1,eg)+(eo[dB]==1 and 0 or eg)local eA=e9("H",ek,eo[dB],col,eg)local ev=dB.frame;ev:ClearAllPoints()local ew=ev:GetWidth()or 0;local eB,eC=e1("H",e3,e4,e5,eA,ew)ev:SetPoint("LEFT",dO,ez+eC,0)if dB:IsFullWidth()or eB=="fill"or ew>eA then ev:SetPoint("RIGHT",dO,"LEFT",ez+eC+eA,0)end;if dB.DoLayout then dB:DoLayout()end;ey=dh(ey,(ev:GetHeight()or 0)-e9("V",el,en[dB],row-1,eh))end end;el[row]=ey;for col=1,#ef do local dB=aU[(row-1)*#ef+col]if dB then local e4=ef[eo[dB]]local e5=dB:GetUserData("cell")local eD=e9("V",el,1,en[dB]-1,eh)+(en[dB]==1 and 0 or eh)local eE=e9("V",el,en[dB],row,eh)local ev=dB.frame;local eF=ev:GetHeight()or 0;local eB,eC=e1("V",e3,e4,e5,eE,eF)if dB:IsFullHeight()or eB=="fill"then ev:SetHeight(eE)end;ev:SetPoint("TOP",dO,0,-(eD+eC))end end end;local eG=e9("V",el,1,#el,eh)for aV,ae in pairs(ej)do dg(ae)end;U(bq.LayoutFinished,bq,nil,eG)bq:ResumeLayout()end)end;local function eH(...)local eI,dL="BlizOptionsGroup",26;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs=pairs;local CreateFrame=CreateFrame;local function eJ(bx)bx.obj:Fire("OnShow")end;local function eK(bx)bx.obj:Fire("OnHide")end;local function eL(bx)bx.obj:Fire("okay")end;local function eM(bx)bx.obj:Fire("cancel")end;local function eN(bx)bx.obj:Fire("default")end;local function eO(bx)bx.obj:Fire("refresh")end;local eP={["OnAcquire"]=function(self)self:SetName()self:SetTitle()end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eQ=dx-63;if eQ<0 then eQ=0 end;dO:SetWidth(eQ)dO.width=eQ end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eR=dy-26;if eR<0 then eR=0 end;dO:SetHeight(eR)dO.height=eR end,["SetName"]=function(self,aa,cd)self.frame.name=aa;self.frame.parent=cd end,["SetTitle"]=function(self,eS)local dO=self.content;dO:ClearAllPoints()if not eS or eS==""then dO:SetPoint("TOPLEFT",10,-10)self.label:SetText("")else dO:SetPoint("TOPLEFT",10,-40)self.label:SetText(eS)end;dO:SetPoint("BOTTOMRIGHT",-10,10)end}local function dK()local bx=CreateFrame("Frame",nil,InterfaceOptionsFramePanelContainer)bx:Hide()bx.okay=eL;bx.cancel=eM;bx.default=eN;bx.refresh=eO;bx.OnCommit=eL;bx.OnDefault=eN;bx.OnRefresh=eO;bx:SetScript("OnHide",eK)bx:SetScript("OnShow",eJ)local eT=bx:CreateFontString(nil,"OVERLAY","GameFontNormalLarge")eT:SetPoint("TOPLEFT",10,-15)eT:SetPoint("BOTTOMRIGHT",bx,"TOPRIGHT",10,-45)eT:SetJustifyH("LEFT")eT:SetJustifyV("TOP")local dO=CreateFrame("Frame",nil,bx)dO:SetPoint("TOPLEFT",10,-10)dO:SetPoint("BOTTOMRIGHT",-10,10)local dt={label=eT,frame=bx,content=dO,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function eU(...)local eI,dL="DropdownGroup",22;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local assert,pairs,type=assert,pairs,type;local CreateFrame=CreateFrame;local function eV(self,F,by)local eW=self.parentgroup;local eX=eW.status or eW.localstatus;eX.selected=by;self.parentgroup:Fire("OnGroupSelected",by)end;local eP={["OnAcquire"]=function(self)self.dropdown:SetText("")self:SetDropdownWidth(200)self:SetTitle("")end,["OnRelease"]=function(self)self.dropdown.list=nil;self.status=nil;for ad in pairs(self.localstatus)do self.localstatus[ad]=nil end end,["SetTitle"]=function(self,eS)self.titletext:SetText(eS)self.dropdown.frame:ClearAllPoints()if eS and eS~=""then self.dropdown.frame:SetPoint("TOPRIGHT",-2,0)else self.dropdown.frame:SetPoint("TOPLEFT",-1,0)end end,["SetGroupList"]=function(self,eY,eZ)self.dropdown:SetList(eY,eZ)end,["SetStatusTable"]=function(self,eX)assert(type(eX)=="table")self.status=eX end,["SetGroup"]=function(self,eW)self.dropdown:SetValue(eW)local eX=self.status or self.localstatus;eX.selected=eW;self:Fire("OnGroupSelected",eW)end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eQ=dx-26;if eQ<0 then eQ=0 end;dO:SetWidth(eQ)dO.width=eQ end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eR=dy-63;if eR<0 then eR=0 end;dO:SetHeight(eR)dO.height=eR end,["LayoutFinished"]=function(self,dx,dy)self:SetHeight((dy or 0)+63)end,["SetDropdownWidth"]=function(self,dx)self.dropdown:SetWidth(dx)end}local e_={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dK()local bx=CreateFrame("Frame")bx:SetHeight(100)bx:SetWidth(100)bx:SetFrameStrata("FULLSCREEN_DIALOG")local f0=bx:CreateFontString(nil,"OVERLAY","GameFontNormal")f0:SetPoint("TOPLEFT",4,-5)f0:SetPoint("TOPRIGHT",-4,-5)f0:SetJustifyH("LEFT")f0:SetHeight(18)local f1=df:Create("Dropdown")f1.frame:SetParent(bx)f1.frame:SetFrameLevel(f1.frame:GetFrameLevel()+2)f1:SetCallback("OnValueChanged",eV)f1.frame:SetPoint("TOPLEFT",-1,0)f1.frame:Show()f1:SetLabel("")local f2=CreateFrame("Frame",nil,bx,"BackdropTemplate")f2:SetPoint("TOPLEFT",0,-26)f2:SetPoint("BOTTOMRIGHT",0,3)f2:SetBackdrop(e_)f2:SetBackdropColor(0.1,0.1,0.1,0.5)f2:SetBackdropBorderColor(0.4,0.4,0.4)local dO=CreateFrame("Frame",nil,f2)dO:SetPoint("TOPLEFT",10,-10)dO:SetPoint("BOTTOMRIGHT",-10,10)local dt={frame=bx,localstatus={},titletext=f0,dropdown=f1,border=f2,content=dO,type=eI}for s,J in pairs(eP)do dt[s]=J end;f1.parentgroup=dt;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function f3(...)local eI,dL="Frame",30;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs,assert,type=pairs,assert,type;local dg=table.wipe;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function f4(bx)PlaySound(799)bx.obj:Hide()end;local function f5(bx)bx.obj:Fire("OnShow")end;local function f6(bx)bx.obj:Fire("OnClose")end;local function f7(bx)df:ClearFocus()end;local function f8(bx)bx:GetParent():StartMoving()df:ClearFocus()end;local function f9(fa)local bx=fa:GetParent()bx:StopMovingOrSizing()local self=bx.obj;local eX=self.status or self.localstatus;eX.width=bx:GetWidth()eX.height=bx:GetHeight()eX.top=bx:GetTop()eX.left=bx:GetLeft()end;local function fb(bx)bx:GetParent():StartSizing("BOTTOMRIGHT")df:ClearFocus()end;local function fc(bx)bx:GetParent():StartSizing("BOTTOM")df:ClearFocus()end;local function fd(bx)bx:GetParent():StartSizing("RIGHT")df:ClearFocus()end;local function fe(bx)bx.obj:Fire("OnEnterStatusBar")end;local function ff(bx)bx.obj:Fire("OnLeaveStatusBar")end;local eP={["OnAcquire"]=function(self)self.frame:SetParent(UIParent)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")self.frame:SetFrameLevel(100)self:SetTitle()self:SetStatusText()self:ApplyStatus()self:Show()self:EnableResize(true)end,["OnRelease"]=function(self)self.status=nil;dg(self.localstatus)end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eQ=dx-34;if eQ<0 then eQ=0 end;dO:SetWidth(eQ)dO.width=eQ end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eR=dy-57;if eR<0 then eR=0 end;dO:SetHeight(eR)dO.height=eR end,["SetTitle"]=function(self,eS)self.titletext:SetText(eS)self.titlebg:SetWidth((self.titletext:GetWidth()or 0)+10)end,["SetStatusText"]=function(self,fg)self.statustext:SetText(fg)end,["Hide"]=function(self)self.frame:Hide()end,["Show"]=function(self)self.frame:Show()end,["EnableResize"]=function(self,am)local J=am and"Show"or"Hide"self.sizer_se[J](self.sizer_se)self.sizer_s[J](self.sizer_s)self.sizer_e[J](self.sizer_e)end,["SetStatusTable"]=function(self,eX)assert(type(eX)=="table")self.status=eX;self:ApplyStatus()end,["ApplyStatus"]=function(self)local eX=self.status or self.localstatus;local bx=self.frame;self:SetWidth(eX.width or 700)self:SetHeight(eX.height or 500)bx:ClearAllPoints()if eX.top and eX.left then bx:SetPoint("TOP",UIParent,"BOTTOM",0,eX.top)bx:SetPoint("LEFT",UIParent,"LEFT",eX.left,0)else bx:SetPoint("CENTER")end end}local fh={bgFile="Interface\\DialogFrame\\UI-DialogBox-Background",edgeFile="Interface\\DialogFrame\\UI-DialogBox-Border",tile=true,tileSize=32,edgeSize=32,insets={left=8,right=8,top=8,bottom=8}}local e_={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dK()local bx=CreateFrame("Frame",nil,UIParent,"BackdropTemplate")bx:Hide()bx:EnableMouse(true)bx:SetMovable(true)bx:SetResizable(true)bx:SetFrameStrata("FULLSCREEN_DIALOG")bx:SetFrameLevel(100)bx:SetBackdrop(fh)bx:SetBackdropColor(0,0,0,1)if bx.SetResizeBounds then bx:SetResizeBounds(400,200)else bx:SetMinResize(400,200)end;bx:SetToplevel(true)bx:SetScript("OnShow",f5)bx:SetScript("OnHide",f6)bx:SetScript("OnMouseDown",f7)local fi=CreateFrame("Button",nil,bx,"UIPanelButtonTemplate")fi:SetScript("OnClick",f4)fi:SetPoint("BOTTOMRIGHT",-27,17)fi:SetHeight(20)fi:SetWidth(100)fi:SetText(CLOSE)local fj=CreateFrame("Button",nil,bx,"BackdropTemplate")fj:SetPoint("BOTTOMLEFT",15,15)fj:SetPoint("BOTTOMRIGHT",-132,15)fj:SetHeight(24)fj:SetBackdrop(e_)fj:SetBackdropColor(0.1,0.1,0.1)fj:SetBackdropBorderColor(0.4,0.4,0.4)fj:SetScript("OnEnter",fe)fj:SetScript("OnLeave",ff)local fk=fj:CreateFontString(nil,"OVERLAY","GameFontNormal")fk:SetPoint("TOPLEFT",7,-2)fk:SetPoint("BOTTOMRIGHT",-7,2)fk:SetHeight(20)fk:SetJustifyH("LEFT")fk:SetText("")local fl=bx:CreateTexture(nil,"OVERLAY")fl:SetTexture(131080)fl:SetTexCoord(0.31,0.67,0,0.63)fl:SetPoint("TOP",0,12)fl:SetWidth(100)fl:SetHeight(40)local eS=CreateFrame("Frame",nil,bx)eS:EnableMouse(true)eS:SetScript("OnMouseDown",f8)eS:SetScript("OnMouseUp",f9)eS:SetAllPoints(fl)local f0=eS:CreateFontString(nil,"OVERLAY","GameFontNormal")f0:SetPoint("TOP",fl,"TOP",0,-14)local fm=bx:CreateTexture(nil,"OVERLAY")fm:SetTexture(131080)fm:SetTexCoord(0.21,0.31,0,0.63)fm:SetPoint("RIGHT",fl,"LEFT")fm:SetWidth(30)fm:SetHeight(40)local fn=bx:CreateTexture(nil,"OVERLAY")fn:SetTexture(131080)fn:SetTexCoord(0.67,0.77,0,0.63)fn:SetPoint("LEFT",fl,"RIGHT")fn:SetWidth(30)fn:SetHeight(40)local fo=CreateFrame("Frame",nil,bx)fo:SetPoint("BOTTOMRIGHT")fo:SetWidth(25)fo:SetHeight(25)fo:EnableMouse()fo:SetScript("OnMouseDown",fb)fo:SetScript("OnMouseUp",f9)local fp=fo:CreateTexture(nil,"BACKGROUND")fp:SetWidth(14)fp:SetHeight(14)fp:SetPoint("BOTTOMRIGHT",-8,8)fp:SetTexture(137057)local x=0.1*14/17;fp:SetTexCoord(0.05-x,0.5,0.05,0.5+x,0.05,0.5-x,0.5+x,0.5)local fq=fo:CreateTexture(nil,"BACKGROUND")fq:SetWidth(8)fq:SetHeight(8)fq:SetPoint("BOTTOMRIGHT",-8,8)fq:SetTexture(137057)x=0.1*8/17;fq:SetTexCoord(0.05-x,0.5,0.05,0.5+x,0.05,0.5-x,0.5+x,0.5)local fr=CreateFrame("Frame",nil,bx)fr:SetPoint("BOTTOMRIGHT",-25,0)fr:SetPoint("BOTTOMLEFT")fr:SetHeight(25)fr:EnableMouse(true)fr:SetScript("OnMouseDown",fc)fr:SetScript("OnMouseUp",f9)local fs=CreateFrame("Frame",nil,bx)fs:SetPoint("BOTTOMRIGHT",0,25)fs:SetPoint("TOPRIGHT")fs:SetWidth(25)fs:EnableMouse(true)fs:SetScript("OnMouseDown",fd)fs:SetScript("OnMouseUp",f9)local dO=CreateFrame("Frame",nil,bx)dO:SetPoint("TOPLEFT",17,-27)dO:SetPoint("BOTTOMRIGHT",-17,40)local dt={localstatus={},titletext=f0,statustext=fk,titlebg=fl,sizer_se=fo,sizer_s=fr,sizer_e=fs,content=dO,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;fi.obj,fj.obj=dt,dt;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function ft(...)local eI,dL="InlineGroup",22;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eP={["OnAcquire"]=function(self)self:SetWidth(300)self:SetHeight(100)self:SetTitle("")end,["SetTitle"]=function(self,eS)self.titletext:SetText(eS)end,["LayoutFinished"]=function(self,dx,dy)if self.noAutoHeight then return end;self:SetHeight((dy or 0)+40)end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eQ=dx-20;if eQ<0 then eQ=0 end;dO:SetWidth(eQ)dO.width=eQ end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eR=dy-20;if eR<0 then eR=0 end;dO:SetHeight(eR)dO.height=eR end}local e_={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:SetFrameStrata("FULLSCREEN_DIALOG")local f0=bx:CreateFontString(nil,"OVERLAY","GameFontNormal")f0:SetPoint("TOPLEFT",14,0)f0:SetPoint("TOPRIGHT",-14,0)f0:SetJustifyH("LEFT")f0:SetHeight(18)local f2=CreateFrame("Frame",nil,bx,"BackdropTemplate")f2:SetPoint("TOPLEFT",0,-17)f2:SetPoint("BOTTOMRIGHT",-1,3)f2:SetBackdrop(e_)f2:SetBackdropColor(0.1,0.1,0.1,0.5)f2:SetBackdropBorderColor(0.4,0.4,0.4)local dO=CreateFrame("Frame",nil,f2)dO:SetPoint("TOPLEFT",10,-10)dO:SetPoint("BOTTOMRIGHT",-10,10)local dt={frame=bx,content=dO,titletext=f0,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function fu(...)local eI,dL="ScrollFrame",26;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs,assert,type=pairs,assert,type;local fv,cY,fw=math.min,math.max,math.floor;local CreateFrame,UIParent=CreateFrame,UIParent;local function fx(bx)bx:SetScript("OnUpdate",nil)bx.obj:FixScroll()end;local function fy(bx,by)bx.obj:MoveScroll(by)end;local function fz(bx)bx:SetScript("OnUpdate",fx)end;local function fA(bx,by)bx.obj:SetScroll(by)end;local eP={["OnAcquire"]=function(self)self:SetScroll(0)self.scrollframe:SetScript("OnUpdate",fx)end,["OnRelease"]=function(self)self.status=nil;for ad in pairs(self.localstatus)do self.localstatus[ad]=nil end;self.scrollframe:SetPoint("BOTTOMRIGHT")self.scrollbar:Hide()self.scrollBarShown=nil;self.content.height,self.content.width,self.content.original_width=nil,nil,nil end,["SetScroll"]=function(self,by)local eX=self.status or self.localstatus;local fB=self.scrollframe:GetHeight()local dy=self.content:GetHeight()local ag;if fB>dy then ag=0 else ag=fw((dy-fB)/1000.0*by)end;self.content:ClearAllPoints()self.content:SetPoint("TOPLEFT",0,ag)self.content:SetPoint("TOPRIGHT",0,ag)eX.offset=ag;eX.scrollvalue=by end,["MoveScroll"]=function(self,by)local eX=self.status or self.localstatus;local dy,fB=self.scrollframe:GetHeight(),self.content:GetHeight()if self.scrollBarShown then local fC=dy-fB;local fD=1;if by<0 then fD=-1 end;self.scrollbar:SetValue(fv(cY(eX.scrollvalue+fD*1000/(fC/45),0),1000))end end,["FixScroll"]=function(self)if self.updateLock then return end;self.updateLock=true;local eX=self.status or self.localstatus;local dy,fB=self.scrollframe:GetHeight(),self.content:GetHeight()local ag=eX.offset or 0;if fB<dy+2 then if self.scrollBarShown then self.scrollBarShown=nil;self.scrollbar:Hide()self.scrollbar:SetValue(0)self.scrollframe:SetPoint("BOTTOMRIGHT")if self.content.original_width then self.content.width=self.content.original_width end;self:DoLayout()end else if not self.scrollBarShown then self.scrollBarShown=true;self.scrollbar:Show()self.scrollframe:SetPoint("BOTTOMRIGHT",-20,0)if self.content.original_width then self.content.width=self.content.original_width-20 end;self:DoLayout()end;local by=ag/(fB-dy)*1000;if by>1000 then by=1000 end;self.scrollbar:SetValue(by)self:SetScroll(by)if by<1000 then self.content:ClearAllPoints()self.content:SetPoint("TOPLEFT",0,ag)self.content:SetPoint("TOPRIGHT",0,ag)eX.offset=ag end end;self.updateLock=nil end,["LayoutFinished"]=function(self,dx,dy)self.content:SetHeight(dy or 0+20)self:FixScroll()self.scrollframe:SetScript("OnUpdate",fx)end,["SetStatusTable"]=function(self,eX)assert(type(eX)=="table")self.status=eX;if not eX.scrollvalue then eX.scrollvalue=0 end end,["OnWidthSet"]=function(self,dx)local dO=self.content;dO.width=dx-(self.scrollBarShown and 20 or 0)dO.original_width=dx end,["OnHeightSet"]=function(self,dy)local dO=self.content;dO.height=dy end}local function dK()local bx=CreateFrame("Frame",nil,UIParent)local fE=df:GetNextWidgetNum(eI)local fF=CreateFrame("ScrollFrame",nil,bx)fF:SetPoint("TOPLEFT")fF:SetPoint("BOTTOMRIGHT")fF:EnableMouseWheel(true)fF:SetScript("OnMouseWheel",fy)fF:SetScript("OnSizeChanged",fz)local fG=CreateFrame("Slider",("AceConfigDialogScrollFrame%dScrollBar"):format(fE),fF,"UIPanelScrollBarTemplate")fG:SetPoint("TOPLEFT",fF,"TOPRIGHT",4,-16)fG:SetPoint("BOTTOMLEFT",fF,"BOTTOMRIGHT",4,16)fG:SetMinMaxValues(0,1000)fG:SetValueStep(1)fG:SetValue(0)fG:SetWidth(16)fG:Hide()fG:SetScript("OnValueChanged",fA)local fH=fG:CreateTexture(nil,"BACKGROUND")fH:SetAllPoints(fG)fH:SetColorTexture(0,0,0,0.4)local dO=CreateFrame("Frame",nil,fF)dO:SetPoint("TOPLEFT")dO:SetPoint("TOPRIGHT")dO:SetHeight(400)fF:SetScrollChild(dO)local dt={localstatus={scrollvalue=0},scrollframe=fF,scrollbar=fG,content=dO,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;fF.obj,fG.obj=dt,dt;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function fI(...)local eI,dL="SimpleGroup",20;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eP={["OnAcquire"]=function(self)self:SetWidth(300)self:SetHeight(100)end,["LayoutFinished"]=function(self,dx,dy)if self.noAutoHeight then return end;self:SetHeight(dy or 0)end,["OnWidthSet"]=function(self,dx)local dO=self.content;dO:SetWidth(dx)dO.width=dx end,["OnHeightSet"]=function(self,dy)local dO=self.content;dO:SetHeight(dy)dO.height=dy end}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:SetFrameStrata("FULLSCREEN_DIALOG")local dO=CreateFrame("Frame",nil,bx)dO:SetPoint("TOPLEFT")dO:SetPoint("BOTTOMRIGHT")local dt={frame=bx,content=dO,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function fJ(...)local eI,dL="TabGroup",38;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs,ipairs,assert,type,dg=pairs,ipairs,assert,type,table.wipe;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;local fK={}local fL={}local fM={}local function fN(fO,fP,fQ,fR,fS,fT)local fU=fO:GetName()local fV=fO.Middle or fO.middleTexture or _G[fU.."Middle"]local fW=fO.MiddleDisabled or fU and _G[fU.."MiddleDisabled"]local fX=fO.Left or fO.leftTexture or _G[fU.."Left"]local fY=2*fX:GetWidth()local fZ=fO.Text or _G[fO:GetName().."Text"]local f_=fO.HighlightTexture or fU and _G[fU.."HighlightTexture"]local dx,g0;local g1;if fT then g1=fT else fZ:SetWidth(0)g1=fZ:GetWidth()end;if fQ then if fQ<fY then dx=1;g0=fY else dx=fQ-fY;g0=fQ end;fZ:SetWidth(dx)else if fP then dx=g1+fP else dx=g1+24 end;if fS and dx>fS then if fP then dx=fS+fP else dx=fS+24 end;fZ:SetWidth(dx)else fZ:SetWidth(0)end;if fR and dx<fR then dx=fR end;g0=dx+fY end;if fV then fV:SetWidth(dx)end;if fW then fW:SetWidth(dx)end;fO:SetWidth(g0)if f_ then f_:SetWidth(g0)end end;local function g2(fO)local aa=fO:GetName()local fX=fO.Left or _G[aa.."Left"]local g3=fO.Middle or _G[aa.."Middle"]local g4=fO.Right or _G[aa.."Right"]fX:Show()g3:Show()g4:Show()fO:Enable()local fg=fO.Text or _G[aa.."Text"]fg:SetPoint("CENTER",fO,"CENTER",fO.deselectedTextX or 0,fO.deselectedTextY or 2)local g5=fO.LeftDisabled or _G[aa.."LeftDisabled"]local g6=fO.MiddleDisabled or _G[aa.."MiddleDisabled"]local g7=fO.RightDisabled or _G[aa.."RightDisabled"]g5:Hide()g6:Hide()g7:Hide()end;local function g8(fO)local aa=fO:GetName()local fX=fO.Left or _G[aa.."Left"]local g3=fO.Middle or _G[aa.."Middle"]local g4=fO.Right or _G[aa.."Right"]fX:Hide()g3:Hide()g4:Hide()fO:Disable()fO:SetDisabledFontObject(GameFontHighlightSmall)local fg=fO.Text or _G[aa.."Text"]fg:SetPoint("CENTER",fO,"CENTER",fO.selectedTextX or 0,fO.selectedTextY or-3)local g5=fO.LeftDisabled or _G[aa.."LeftDisabled"]local g6=fO.MiddleDisabled or _G[aa.."MiddleDisabled"]local g7=fO.RightDisabled or _G[aa.."RightDisabled"]g5:Show()g6:Show()g7:Show()if GameTooltip:IsOwned(fO)then GameTooltip:Hide()end end;local function g9(fO)local aa=fO:GetName()local fX=fO.Left or _G[aa.."Left"]local g3=fO.Middle or _G[aa.."Middle"]local g4=fO.Right or _G[aa.."Right"]fX:Show()g3:Show()g4:Show()fO:Disable()fO.text=fO:GetText()fO:SetDisabledFontObject(GameFontDisableSmall)local g5=fO.LeftDisabled or _G[aa.."LeftDisabled"]local g6=fO.MiddleDisabled or _G[aa.."MiddleDisabled"]local g7=fO.RightDisabled or _G[aa.."RightDisabled"]g5:Hide()g6:Hide()g7:Hide()end;local function ga(bx)if bx.disabled then g9(bx)elseif bx.selected then g8(bx)else g2(bx)end end;local function gb(bx,fg)bx:_SetText(fg)local dx=bx.obj.frame.width or bx.obj.frame:GetWidth()or 0;fN(bx,0,nil,nil,dx,bx:GetFontString():GetStringWidth())end;local function gc(bx,gd)bx.selected=gd;ga(bx)end;local function ge(bx,gf)bx.disabled=gf;ga(bx)end;local function gg(bx)local self=bx.obj;self:BuildTabs()bx:SetScript("OnUpdate",nil)end;local function gh(bx)if not(bx.selected or bx.disabled)then PlaySound(841)bx.obj:SelectTab(bx.value)end end;local function gi(bx)local self=bx.obj;self:Fire("OnTabEnter",self.tabs[bx.id].value,bx)end;local function gj(bx)local self=bx.obj;self:Fire("OnTabLeave",self.tabs[bx.id].value,bx)end;local function gk(bx)_G[bx:GetName().."HighlightTexture"]:SetWidth(bx:GetTextWidth()+30)end;local eP={["OnAcquire"]=function(self)self:SetTitle()end,["OnRelease"]=function(self)self.status=nil;for ad in pairs(self.localstatus)do self.localstatus[ad]=nil end;self.tablist=nil;for aV,fO in pairs(self.tabs)do fO:Hide()end end,["CreateTab"]=function(self,aN)local gl=("AceGUITabGroup%dTab%d"):format(self.num,aN)local fO=CreateFrame("Button",gl,self.border)fO:SetSize(115,24)fO.deselectedTextY=-3;fO.selectedTextY=-2;fO.LeftDisabled=fO:CreateTexture(gl.."LeftDisabled","BORDER")fO.LeftDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fO.LeftDisabled:SetSize(20,24)fO.LeftDisabled:SetPoint("BOTTOMLEFT",0,-3)fO.LeftDisabled:SetTexCoord(0,0.15625,0,1.0)fO.MiddleDisabled=fO:CreateTexture(gl.."MiddleDisabled","BORDER")fO.MiddleDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fO.MiddleDisabled:SetSize(88,24)fO.MiddleDisabled:SetPoint("LEFT",fO.LeftDisabled,"RIGHT")fO.MiddleDisabled:SetTexCoord(0.15625,0.84375,0,1.0)fO.RightDisabled=fO:CreateTexture(gl.."RightDisabled","BORDER")fO.RightDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fO.RightDisabled:SetSize(20,24)fO.RightDisabled:SetPoint("LEFT",fO.MiddleDisabled,"RIGHT")fO.RightDisabled:SetTexCoord(0.84375,1.0,0,1.0)fO.Left=fO:CreateTexture(gl.."Left","BORDER")fO.Left:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fO.Left:SetSize(20,24)fO.Left:SetPoint("TOPLEFT")fO.Left:SetTexCoord(0,0.15625,0,1.0)fO.Middle=fO:CreateTexture(gl.."Middle","BORDER")fO.Middle:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fO.Middle:SetSize(88,24)fO.Middle:SetPoint("LEFT",fO.Left,"RIGHT")fO.Middle:SetTexCoord(0.15625,0.84375,0,1.0)fO.Right=fO:CreateTexture(gl.."Right","BORDER")fO.Right:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fO.Right:SetSize(20,24)fO.Right:SetPoint("LEFT",fO.Middle,"RIGHT")fO.Right:SetTexCoord(0.84375,1.0,0,1.0)fO.Text=fO:CreateFontString(gl.."Text")fO:SetFontString(fO.Text)fO:SetNormalFontObject(GameFontNormalSmall)fO:SetHighlightFontObject(GameFontHighlightSmall)fO:SetDisabledFontObject(GameFontHighlightSmall)fO:SetHighlightTexture("Interface\\PaperDollInfoFrame\\UI-Character-Tab-Highlight","ADD")fO.HighlightTexture=fO:GetHighlightTexture()fO.HighlightTexture:ClearAllPoints()fO.HighlightTexture:SetPoint("LEFT",fO,"LEFT",10,-4)fO.HighlightTexture:SetPoint("RIGHT",fO,"RIGHT",-10,-4)_G[gl.."HighlightTexture"]=fO.HighlightTexture;fO.obj=self;fO.id=aN;fO.text=fO.Text;fO.text:ClearAllPoints()fO.text:SetPoint("LEFT",14,-3)fO.text:SetPoint("RIGHT",-12,-3)fO:SetScript("OnClick",gh)fO:SetScript("OnEnter",gi)fO:SetScript("OnLeave",gj)fO:SetScript("OnShow",gk)fO._SetText=fO.SetText;fO.SetText=gb;fO.SetSelected=gc;fO.SetDisabled=ge;return fO end,["SetTitle"]=function(self,fg)self.titletext:SetText(fg or"")if fg and fg~=""then self.alignoffset=25 else self.alignoffset=18 end;self:BuildTabs()end,["SetStatusTable"]=function(self,eX)assert(type(eX)=="table")self.status=eX end,["SelectTab"]=function(self,by)local eX=self.status or self.localstatus;local gm;for M,ae in ipairs(self.tabs)do if ae.value==by then ae:SetSelected(true)gm=true else ae:SetSelected(false)end end;eX.selected=by;if gm then self:Fire("OnGroupSelected",by)end end,["SetTabs"]=function(self,gn)self.tablist=gn;self:BuildTabs()end,["BuildTabs"]=function(self)local go=self.titletext:GetText()and self.titletext:GetText()~=""local gp=self.tablist;local gn=self.tabs;if not gp then return end;local dx=self.frame.width or self.frame:GetWidth()or 0;dg(fK)dg(fL)dg(fM)for M,ae in ipairs(gp)do local fO=gn[M]if not fO then fO=self:CreateTab(M)gn[M]=fO end;fO:Show()fO:SetText(ae.text)fO:SetDisabled(ae.disabled)fO.value=ae.value;fK[M]=fO:GetWidth()-6 end;for M=#gp+1,#gn,1 do gn[M]:Hide()end;local gq=#gp;local gr=1;local dR=0;for M=1,#gp do if dR~=0 and dx-dR-fK[M]<0 then fL[gr]=dR+10;fM[gr]=M-1;gr=gr+1;dR=0 end;dR=dR+fK[M]end;fL[gr]=dR+10;fM[gr]=#gp;if gr>1 then if fM[gr-1]==gq-1 then if gr==2 and fM[gr-1]>2 or fM[gr]-fM[gr-1]>2 then if fL[gr]+fK[gq-1]<=dx then fM[gr-1]=fM[gr-1]-1;fL[gr]=fL[gr]+fK[gq-1]fL[gr-1]=fL[gr-1]-fK[gq-1]end end end end;local gs=1;for row,gt in ipairs(fM)do local H=true;for gu=gs,gt do local fO=gn[gu]fO:ClearAllPoints()if H then fO:SetPoint("TOPLEFT",self.frame,"TOPLEFT",0,-(go and 14 or 7)-(row-1)*20)H=false else fO:SetPoint("LEFT",gn[gu-1],"RIGHT",-10,0)end end;local fP=0;if not(gr==1 and fL[1]<dx*0.75-18)then fP=(dx-fL[row])/(gt-gs+1)end;for M=gs,gt do fN(gn[M],fP+4,nil,nil,dx,gn[M]:GetFontString():GetStringWidth())end;gs=gt+1 end;self.borderoffset=(go and 17 or 10)+gr*20;self.border:SetPoint("TOPLEFT",1,-self.borderoffset)end,["OnWidthSet"]=function(self,dx)local dO=self.content;local eQ=dx-60;if eQ<0 then eQ=0 end;dO:SetWidth(eQ)dO.width=eQ;self:BuildTabs(self)self.frame:SetScript("OnUpdate",gg)end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eR=dy-(self.borderoffset+23)if eR<0 then eR=0 end;dO:SetHeight(eR)dO.height=eR end,["LayoutFinished"]=function(self,dx,dy)if self.noAutoHeight then return end;self:SetHeight((dy or 0)+self.borderoffset+23)end}local e_={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dK()local fE=df:GetNextWidgetNum(eI)local bx=CreateFrame("Frame",nil,UIParent)bx:SetHeight(100)bx:SetWidth(100)bx:SetFrameStrata("FULLSCREEN_DIALOG")local f0=bx:CreateFontString(nil,"OVERLAY","GameFontNormal")f0:SetPoint("TOPLEFT",14,0)f0:SetPoint("TOPRIGHT",-14,0)f0:SetJustifyH("LEFT")f0:SetHeight(18)f0:SetText("")local f2=CreateFrame("Frame",nil,bx,"BackdropTemplate")f2:SetPoint("TOPLEFT",1,-27)f2:SetPoint("BOTTOMRIGHT",-1,3)f2:SetBackdrop(e_)f2:SetBackdropColor(0.1,0.1,0.1,0.5)f2:SetBackdropBorderColor(0.4,0.4,0.4)local dO=CreateFrame("Frame",nil,f2)dO:SetPoint("TOPLEFT",10,-7)dO:SetPoint("BOTTOMRIGHT",-10,7)local dt={num=fE,frame=bx,localstatus={},alignoffset=18,titletext=f0,border=f2,borderoffset=27,tabs={},content=dO,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function gv(...)local eI,dL="TreeGroup",47;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local next,pairs,ipairs,assert,type=next,pairs,ipairs,assert,type;local di,dh,fw=math.min,math.max,math.floor;local select,Q,unpack,P=select,table.remove,unpack,table.concat;local CreateFrame,UIParent=CreateFrame,UIParent;local aH,gw;do local gx=setmetatable({},{__mode='k'})function aH()local aU=next(gx)if aU then gx[aU]=nil;return aU else return{}end end;function gw(aU)for ad in pairs(aU)do aU[ad]=nil end;gx[aU]=true end end;local gy=175;local gz=true;local function gA(gB)local cd=gB.parent;if cd and cd.value then return gA(cd).."\001"..gB.value else return gB.value end end;local function gC(gD,gE,gd,gF,gG)local self=gD.obj;local gH=gD.toggle;local fg=gE.text or""local gI=gE.icon;local gJ=gE.iconCoords;local gK=gE.level;local by=gE.value;local gL=gE.uniquevalue;local gf=gE.disabled;gD.treeline=gE;gD.value=by;gD.uniquevalue=gL;if gd then gD:LockHighlight()gD.selected=true else gD:UnlockHighlight()gD.selected=false end;gD.level=gK;if gK==1 then gD:SetNormalFontObject("GameFontNormal")gD:SetHighlightFontObject("GameFontHighlight")gD.text:SetPoint("LEFT",(gI and 16 or 0)+8,2)else gD:SetNormalFontObject("GameFontHighlightSmall")gD:SetHighlightFontObject("GameFontHighlightSmall")gD.text:SetPoint("LEFT",(gI and 16 or 0)+8*gK,2)end;if gf then gD:EnableMouse(false)gD.text:SetText("|cff808080"..fg..FONT_COLOR_CODE_CLOSE)else gD.text:SetText(fg)gD:EnableMouse(true)end;if gI then gD.icon:SetTexture(gI)gD.icon:SetPoint("LEFT",8*gK,gK==1 and 0 or 1)else gD.icon:SetTexture(nil)end;if gJ then gD.icon:SetTexCoord(unpack(gJ))else gD.icon:SetTexCoord(0,1,0,1)end;if gF then if not gG then gH:SetNormalTexture(130838)gH:SetPushedTexture(130836)else gH:SetNormalTexture(130821)gH:SetPushedTexture(130820)end;gH:Show()else gH:Hide()end end;local function gM(gN)local gO=false;for ad,ae in ipairs(gN)do if ae.children==nil and ae.visible~=false then gO=true elseif ae.children then gO=gO or gM(ae.children)end;if gO then return gO end end;return false end;local function gP(self,ae,gN,gK,cd)local gB=aH()gB.value=ae.value;gB.text=ae.text;gB.icon=ae.icon;gB.iconCoords=ae.iconCoords;gB.disabled=ae.disabled;gB.tree=gN;gB.level=gK;gB.parent=cd;gB.visible=ae.visible;gB.uniquevalue=gA(gB)if ae.children then gB.hasChildren=true else gB.hasChildren=nil end;self.lines[#self.lines+1]=gB;return gB end;local function gQ(bx)local self=bx.obj;bx:SetScript("OnUpdate",nil)self:RefreshTree(nil,true)end;local function gR(...)local d0=select('#',...)if d0==1 then return...else return....."\001"..gR(select(2,...))end end;local function gS(bx)local gD=bx.button;local self=gD.obj;local eX=(self.status or self.localstatus).groups;eX[gD.uniquevalue]=not eX[gD.uniquevalue]self:RefreshTree()end;local function f4(bx)local self=bx.obj;self:Fire("OnClick",bx.uniquevalue,bx.selected)if not bx.selected then self:SetSelected(bx.uniquevalue)bx.selected=true;bx:LockHighlight()self:RefreshTree()end;df:ClearFocus()end;local function gT(gD)local self=gD.obj;local eX=(self.status or self.localstatus).groups;eX[gD.uniquevalue]=not eX[gD.uniquevalue]self:RefreshTree()end;local function gU(bx)local self=bx.obj;self:Fire("OnButtonEnter",bx.uniquevalue,bx)if self.enabletooltips then local gV=df.tooltip;gV:SetOwner(bx,"ANCHOR_NONE")gV:ClearAllPoints()gV:SetPoint("LEFT",bx,"RIGHT")gV:SetText(bx.text:GetText()or"",1,.82,0,true)gV:Show()end end;local function gW(bx)local self=bx.obj;self:Fire("OnButtonLeave",bx.uniquevalue,bx)if self.enabletooltips then df.tooltip:Hide()end end;local function gX(bx,by)if bx.obj.noupdate then return end;local self=bx.obj;local eX=self.status or self.localstatus;eX.scrollvalue=fw(by+0.5)self:RefreshTree()df:ClearFocus()end;local function gY(bx)bx.obj:RefreshTree()end;local function gZ(bx,fD)local self=bx.obj;if self.showscroll then local fG=self.scrollbar;local fv,cY=fG:GetMinMaxValues()local by=fG:GetValue()local g_=di(cY,dh(fv,by-fD))if by~=g_ then fG:SetValue(g_)end end end;local function h0(bx)bx:SetBackdropColor(1,1,1,0)end;local function h1(bx)bx:SetBackdropColor(1,1,1,0.8)end;local function h2(bx)local h3=bx:GetParent()h3:StartSizing("RIGHT")end;local function h4(bx)local h3=bx:GetParent()local self=h3.obj;local h5=h3:GetParent()h3:StopMovingOrSizing()h3:SetUserPlaced(false)h3:SetHeight(0)h3:ClearAllPoints()h3:SetPoint("TOPLEFT",h5,"TOPLEFT",0,0)h3:SetPoint("BOTTOMLEFT",h5,"BOTTOMLEFT",0,0)local eX=self.status or self.localstatus;eX.treewidth=h3:GetWidth()h3.obj:Fire("OnTreeResize",h3:GetWidth())h3.obj:OnWidthSet(eX.fullwidth)h3.obj:DoLayout()end;local eP={["OnAcquire"]=function(self)self:SetTreeWidth(gy,gz)self:EnableButtonTooltips(true)self.frame:SetScript("OnUpdate",gQ)end,["OnRelease"]=function(self)self.status=nil;self.tree=nil;self.frame:SetScript("OnUpdate",nil)for ad,ae in pairs(self.localstatus)do if ad=="groups"then for bJ in pairs(ae)do ae[bJ]=nil end else self.localstatus[ad]=nil end end;self.localstatus.scrollvalue=0;self.localstatus.treewidth=gy;self.localstatus.treesizable=gz end,["EnableButtonTooltips"]=function(self,h6)self.enabletooltips=h6 end,["CreateButton"]=function(self)local fE=df:GetNextWidgetNum("TreeGroupButton")local gD=CreateFrame("Button",("AceGUI30TreeButton%d"):format(fE),self.treeframe,"OptionsListButtonTemplate")gD.obj=self;local gI=gD:CreateTexture(nil,"OVERLAY")gI:SetWidth(14)gI:SetHeight(14)gD.icon=gI;gD:SetScript("OnClick",f4)gD:SetScript("OnDoubleClick",gT)gD:SetScript("OnEnter",gU)gD:SetScript("OnLeave",gW)gD.toggle.button=gD;gD.toggle:SetScript("OnClick",gS)gD.text:SetHeight(14)return gD end,["SetStatusTable"]=function(self,eX)assert(type(eX)=="table")self.status=eX;if not eX.groups then eX.groups={}end;if not eX.scrollvalue then eX.scrollvalue=0 end;if not eX.treewidth then eX.treewidth=gy end;if eX.treesizable==nil then eX.treesizable=gz end;self:SetTreeWidth(eX.treewidth,eX.treesizable)self:RefreshTree()end,["SetTree"]=function(self,gN,h7)self.filter=h7;if gN then assert(type(gN)=="table")end;self.tree=gN;self:RefreshTree()end,["BuildLevel"]=function(self,gN,gK,cd)local h8=(self.status or self.localstatus).groups;for M,ae in ipairs(gN)do if ae.children then if not self.filter or gM(ae.children)then local gB=gP(self,ae,gN,gK,cd)if h8[gB.uniquevalue]then self:BuildLevel(ae.children,gK+1,gB)end end elseif ae.visible~=false or not self.filter then gP(self,ae,gN,gK,cd)end end end,["RefreshTree"]=function(self,h9,ha)local hb=self.buttons;local hc=self.lines;for M,ae in ipairs(hb)do ae:Hide()end;while hc[1]do local aU=Q(hc)for ad in pairs(aU)do aU[ad]=nil end;gw(aU)end;if not self.tree then return end;local eX=self.status or self.localstatus;local hd=eX.groups;local gN=self.tree;local h3=self.treeframe;eX.scrollToSelection=eX.scrollToSelection or h9;self:BuildLevel(gN,1)local he=#hc;local hf=fw(((self.treeframe:GetHeight()or 0)-20)/18)if hf<=0 then return end;if self.frame:GetParent()==UIParent and not ha then self.frame:SetScript("OnUpdate",gQ)return end;local H,hg;h9=eX.scrollToSelection;eX.scrollToSelection=nil;if he<=hf then eX.scrollvalue=0;self:ShowScroll(false)H,hg=1,he else self:ShowScroll(true)self.noupdate=true;self.scrollbar:SetMinMaxValues(0,he-hf)if he-eX.scrollvalue<hf then eX.scrollvalue=he-hf end;self.noupdate=nil;H,hg=eX.scrollvalue+1,eX.scrollvalue+hf;if h9 and eX.selected then local hh;for M,gB in ipairs(hc)do if gB.uniquevalue==eX.selected then hh=M end end;if not hh then elseif hh>=H and hh<=hg then else if hh<H then eX.scrollvalue=hh-1 else eX.scrollvalue=hh-hf end;H,hg=eX.scrollvalue+1,eX.scrollvalue+hf end end;if self.scrollbar:GetValue()~=eX.scrollvalue then self.scrollbar:SetValue(eX.scrollvalue)end end;local hi=1;for M=H,hg do local gB=hc[M]local gD=hb[hi]if not gD then gD=self:CreateButton()hb[hi]=gD;gD:SetParent(h3)gD:SetFrameLevel(h3:GetFrameLevel()+1)gD:ClearAllPoints()if hi==1 then if self.showscroll then gD:SetPoint("TOPRIGHT",-22,-10)gD:SetPoint("TOPLEFT",0,-10)else gD:SetPoint("TOPRIGHT",0,-10)gD:SetPoint("TOPLEFT",0,-10)end else gD:SetPoint("TOPRIGHT",hb[hi-1],"BOTTOMRIGHT",0,0)gD:SetPoint("TOPLEFT",hb[hi-1],"BOTTOMLEFT",0,0)end end;gC(gD,gB,eX.selected==gB.uniquevalue,gB.hasChildren,hd[gB.uniquevalue])gD:Show()hi=hi+1 end end,["SetSelected"]=function(self,by)local eX=self.status or self.localstatus;if eX.selected~=by then eX.selected=by;self:Fire("OnGroupSelected",by)end end,["Select"]=function(self,gL,...)self.filter=false;local eX=self.status or self.localstatus;local h8=eX.groups;local hj={...}for M=1,#hj do h8[P(hj,"\001",1,M)]=true end;eX.selected=gL;self:RefreshTree(true)self:Fire("OnGroupSelected",gL)end,["SelectByPath"]=function(self,...)self:Select(gR(...),...)end,["SelectByValue"]=function(self,gL)self:Select(gL,("\001"):split(gL))end,["ShowScroll"]=function(self,hh)self.showscroll=hh;if hh then self.scrollbar:Show()if self.buttons[1]then self.buttons[1]:SetPoint("TOPRIGHT",self.treeframe,"TOPRIGHT",-22,-10)end else self.scrollbar:Hide()if self.buttons[1]then self.buttons[1]:SetPoint("TOPRIGHT",self.treeframe,"TOPRIGHT",0,-10)end end end,["OnWidthSet"]=function(self,dx)local dO=self.content;local h3=self.treeframe;local eX=self.status or self.localstatus;eX.fullwidth=dx;local eQ=dx-eX.treewidth-20;if eQ<0 then eQ=0 end;dO:SetWidth(eQ)dO.width=eQ;local hk=di(400,dx-50)if hk>100 and eX.treewidth>hk then self:SetTreeWidth(hk,eX.treesizable)end;if h3.SetResizeBounds then h3:SetResizeBounds(100,1,hk,1600)else h3:SetMaxResize(hk,1600)end end,["OnHeightSet"]=function(self,dy)local dO=self.content;local eR=dy-20;if eR<0 then eR=0 end;dO:SetHeight(eR)dO.height=eR end,["SetTreeWidth"]=function(self,hl,hm)if not hm then if type(hl)=='number'then hm=false elseif type(hl)=='boolean'then hm=hl;hl=gy else hm=false;hl=gy end end;self.treeframe:SetWidth(hl)self.dragger:EnableMouse(hm)local eX=self.status or self.localstatus;eX.treewidth=hl;eX.treesizable=hm;if eX.fullwidth then self:OnWidthSet(eX.fullwidth)end end,["GetTreeWidth"]=function(self)local eX=self.status or self.localstatus;return eX.treewidth or gy end,["LayoutFinished"]=function(self,dx,dy)if self.noAutoHeight then return end;self:SetHeight((dy or 0)+20)end}local e_={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local hn={bgFile="Interface\\Tooltips\\UI-Tooltip-Background",edgeFile=nil,tile=true,tileSize=16,edgeSize=1,insets={left=3,right=3,top=7,bottom=7}}local function dK()local fE=df:GetNextWidgetNum(eI)local bx=CreateFrame("Frame",nil,UIParent)local h3=CreateFrame("Frame",nil,bx,"BackdropTemplate")h3:SetPoint("TOPLEFT")h3:SetPoint("BOTTOMLEFT")h3:SetWidth(gy)h3:EnableMouseWheel(true)h3:SetBackdrop(e_)h3:SetBackdropColor(0.1,0.1,0.1,0.5)h3:SetBackdropBorderColor(0.4,0.4,0.4)h3:SetResizable(true)if h3.SetResizeBounds then h3:SetResizeBounds(100,1,400,1600)else h3:SetMinResize(100,1)h3:SetMaxResize(400,1600)end;h3:SetScript("OnUpdate",gQ)h3:SetScript("OnSizeChanged",gY)h3:SetScript("OnMouseWheel",gZ)local ho=CreateFrame("Frame",nil,h3,"BackdropTemplate")ho:SetWidth(8)ho:SetPoint("TOP",h3,"TOPRIGHT")ho:SetPoint("BOTTOM",h3,"BOTTOMRIGHT")ho:SetBackdrop(hn)ho:SetBackdropColor(1,1,1,0)ho:SetScript("OnEnter",h1)ho:SetScript("OnLeave",h0)ho:SetScript("OnMouseDown",h2)ho:SetScript("OnMouseUp",h4)local fG=CreateFrame("Slider",("AceConfigDialogTreeGroup%dScrollBar"):format(fE),h3,"UIPanelScrollBarTemplate")fG:SetScript("OnValueChanged",nil)fG:SetPoint("TOPRIGHT",-10,-26)fG:SetPoint("BOTTOMRIGHT",-10,26)fG:SetMinMaxValues(0,0)fG:SetValueStep(1)fG:SetValue(0)fG:SetWidth(16)fG:SetScript("OnValueChanged",gX)local fH=fG:CreateTexture(nil,"BACKGROUND")fH:SetAllPoints(fG)fH:SetColorTexture(0,0,0,0.4)local f2=CreateFrame("Frame",nil,bx,"BackdropTemplate")f2:SetPoint("TOPLEFT",h3,"TOPRIGHT")f2:SetPoint("BOTTOMRIGHT")f2:SetBackdrop(e_)f2:SetBackdropColor(0.1,0.1,0.1,0.5)f2:SetBackdropBorderColor(0.4,0.4,0.4)local dO=CreateFrame("Frame",nil,f2)dO:SetPoint("TOPLEFT",10,-10)dO:SetPoint("BOTTOMRIGHT",-10,10)local dt={frame=bx,lines={},levels={},buttons={},hasChildren={},localstatus={groups={},scrollvalue=0},filter=false,treeframe=h3,dragger=ho,scrollbar=fG,border=f2,content=dO,type=eI}for s,J in pairs(eP)do dt[s]=J end;h3.obj,ho.obj,fG.obj=dt,dt,dt;return df:RegisterAsContainer(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function hp(...)local df=LibStub("AceGUI-3.0")local pairs,assert,type=pairs,assert,type;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;do local eI="Window"local dL=8;local function hq(ay)ay.obj:Fire("OnShow")end;local function hr(ay)ay.obj:Fire("OnClose")end;local function hs(ay)PlaySound(799)ay.obj:Hide()end;local function ht(ay)df:ClearFocus()end;local function hu(ay)ay:GetParent():StartMoving()df:ClearFocus()end;local function hv(ay)local bx=ay:GetParent()bx:StopMovingOrSizing()local self=bx.obj;local eX=self.status or self.localstatus;eX.width=bx:GetWidth()eX.height=bx:GetHeight()eX.top=bx:GetTop()eX.left=bx:GetLeft()end;local function hw(ay)ay:GetParent():StartSizing("BOTTOMRIGHT")df:ClearFocus()end;local function hx(ay)ay:GetParent():StartSizing("BOTTOM")df:ClearFocus()end;local function hy(ay)ay:GetParent():StartSizing("RIGHT")df:ClearFocus()end;local function hz(ay)ay:GetParent():StopMovingOrSizing()end;local function hA(self,eS)self.titletext:SetText(eS)end;local function hB(self,fg)end;local function hC(self)self.frame:Hide()end;local function hD(self)self.frame:Show()end;local function hE(self)self.frame:SetParent(UIParent)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")self:ApplyStatus()self:EnableResize(true)self:Show()end;local function hF(self)self.status=nil;for ad in pairs(self.localstatus)do self.localstatus[ad]=nil end end;local function hG(self,eX)assert(type(eX)=="table")self.status=eX;self:ApplyStatus()end;local function hH(self)local eX=self.status or self.localstatus;local bx=self.frame;self:SetWidth(eX.width or 700)self:SetHeight(eX.height or 500)if eX.top and eX.left then bx:SetPoint("TOP",UIParent,"BOTTOM",0,eX.top)bx:SetPoint("LEFT",UIParent,"LEFT",eX.left,0)else bx:SetPoint("CENTER",UIParent,"CENTER")end end;local function hI(self,dx)local dO=self.content;local eQ=dx-34;if eQ<0 then eQ=0 end;dO:SetWidth(eQ)dO.width=eQ end;local function hJ(self,dy)local dO=self.content;local eR=dy-57;if eR<0 then eR=0 end;dO:SetHeight(eR)dO.height=eR end;local function hK(self,am)local J=am and"Show"or"Hide"self.sizer_se[J](self.sizer_se)self.sizer_s[J](self.sizer_s)self.sizer_e[J](self.sizer_e)end;local function dK()local bx=CreateFrame("Frame",nil,UIParent)local self={}self.type="Window"self.Hide=hC;self.Show=hD;self.SetTitle=hA;self.OnRelease=hF;self.OnAcquire=hE;self.SetStatusText=hB;self.SetStatusTable=hG;self.ApplyStatus=hH;self.OnWidthSet=hI;self.OnHeightSet=hJ;self.EnableResize=hK;self.localstatus={}self.frame=bx;bx.obj=self;bx:SetWidth(700)bx:SetHeight(500)bx:SetPoint("CENTER",UIParent,"CENTER",0,0)bx:EnableMouse()bx:SetMovable(true)bx:SetResizable(true)bx:SetFrameStrata("FULLSCREEN_DIALOG")bx:SetScript("OnMouseDown",ht)bx:SetScript("OnShow",hq)bx:SetScript("OnHide",hr)if bx.SetResizeBounds then bx:SetResizeBounds(240,240)else bx:SetMinResize(240,240)end;bx:SetToplevel(true)local fl=bx:CreateTexture(nil,"BACKGROUND")fl:SetTexture(251966)fl:SetPoint("TOPLEFT",9,-6)fl:SetPoint("BOTTOMRIGHT",bx,"TOPRIGHT",-28,-24)local hL=bx:CreateTexture(nil,"BACKGROUND")hL:SetTexture(137056)hL:SetPoint("TOPLEFT",8,-24)hL:SetPoint("BOTTOMRIGHT",-6,8)hL:SetVertexColor(0,0,0,.75)local hM=bx:CreateTexture(nil,"BORDER")hM:SetTexture(251963)hM:SetWidth(64)hM:SetHeight(64)hM:SetPoint("TOPLEFT")hM:SetTexCoord(0.501953125,0.625,0,1)local hN=bx:CreateTexture(nil,"BORDER")hN:SetTexture(251963)hN:SetWidth(64)hN:SetHeight(64)hN:SetPoint("TOPRIGHT")hN:SetTexCoord(0.625,0.75,0,1)local hO=bx:CreateTexture(nil,"BORDER")hO:SetTexture(251963)hO:SetHeight(64)hO:SetPoint("TOPLEFT",hM,"TOPRIGHT")hO:SetPoint("TOPRIGHT",hN,"TOPLEFT")hO:SetTexCoord(0.25,0.369140625,0,1)local hP=bx:CreateTexture(nil,"BORDER")hP:SetTexture(251963)hP:SetWidth(64)hP:SetHeight(64)hP:SetPoint("BOTTOMLEFT")hP:SetTexCoord(0.751953125,0.875,0,1)local hQ=bx:CreateTexture(nil,"BORDER")hQ:SetTexture(251963)hQ:SetWidth(64)hQ:SetHeight(64)hQ:SetPoint("BOTTOMRIGHT")hQ:SetTexCoord(0.875,1,0,1)local hR=bx:CreateTexture(nil,"BORDER")hR:SetTexture(251963)hR:SetHeight(64)hR:SetPoint("BOTTOMLEFT",hP,"BOTTOMRIGHT")hR:SetPoint("BOTTOMRIGHT",hQ,"BOTTOMLEFT")hR:SetTexCoord(0.376953125,0.498046875,0,1)local fX=bx:CreateTexture(nil,"BORDER")fX:SetTexture(251963)fX:SetWidth(64)fX:SetPoint("TOPLEFT",hM,"BOTTOMLEFT")fX:SetPoint("BOTTOMLEFT",hP,"TOPLEFT")fX:SetTexCoord(0.001953125,0.125,0,1)local g4=bx:CreateTexture(nil,"BORDER")g4:SetTexture(251963)g4:SetWidth(64)g4:SetPoint("TOPRIGHT",hN,"BOTTOMRIGHT")g4:SetPoint("BOTTOMRIGHT",hQ,"TOPRIGHT")g4:SetTexCoord(0.1171875,0.2421875,0,1)local hS=CreateFrame("Button",nil,bx,"UIPanelCloseButton")hS:SetPoint("TOPRIGHT",2,1)hS:SetScript("OnClick",hs)self.closebutton=hS;hS.obj=self;local f0=bx:CreateFontString(nil,"ARTWORK")f0:SetFontObject(GameFontNormal)f0:SetPoint("TOPLEFT",12,-8)f0:SetPoint("TOPRIGHT",-32,-8)self.titletext=f0;local eS=CreateFrame("Button",nil,bx)eS:SetPoint("TOPLEFT",fl)eS:SetPoint("BOTTOMRIGHT",fl)eS:EnableMouse()eS:SetScript("OnMouseDown",hu)eS:SetScript("OnMouseUp",hv)self.title=eS;local fo=CreateFrame("Frame",nil,bx)fo:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",0,0)fo:SetWidth(25)fo:SetHeight(25)fo:EnableMouse()fo:SetScript("OnMouseDown",hw)fo:SetScript("OnMouseUp",hz)self.sizer_se=fo;local fp=fo:CreateTexture(nil,"BACKGROUND")self.line1=fp;fp:SetWidth(14)fp:SetHeight(14)fp:SetPoint("BOTTOMRIGHT",-8,8)fp:SetTexture(137057)local x=0.1*14/17;fp:SetTexCoord(0.05-x,0.5,0.05,0.5+x,0.05,0.5-x,0.5+x,0.5)local fq=fo:CreateTexture(nil,"BACKGROUND")self.line2=fq;fq:SetWidth(8)fq:SetHeight(8)fq:SetPoint("BOTTOMRIGHT",-8,8)fq:SetTexture(137057)x=0.1*8/17;fq:SetTexCoord(0.05-x,0.5,0.05,0.5+x,0.05,0.5-x,0.5+x,0.5)local fr=CreateFrame("Frame",nil,bx)fr:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",-25,0)fr:SetPoint("BOTTOMLEFT",bx,"BOTTOMLEFT",0,0)fr:SetHeight(25)fr:EnableMouse()fr:SetScript("OnMouseDown",hx)fr:SetScript("OnMouseUp",hz)self.sizer_s=fr;local fs=CreateFrame("Frame",nil,bx)fs:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",0,25)fs:SetPoint("TOPRIGHT",bx,"TOPRIGHT",0,0)fs:SetWidth(25)fs:EnableMouse()fs:SetScript("OnMouseDown",hy)fs:SetScript("OnMouseUp",hz)self.sizer_e=fs;local dO=CreateFrame("Frame",nil,bx)self.content=dO;dO.obj=self;dO:SetPoint("TOPLEFT",bx,"TOPLEFT",12,-32)dO:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",-12,13)df:RegisterAsContainer(self)return self end;df:RegisterWidgetType(eI,dK,dL)end end;local function hT(...)local eI,dL="Button",24;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs=pairs;local _G=_G;local PlaySound,CreateFrame,UIParent=PlaySound,CreateFrame,UIParent;local function f4(bx,...)df:ClearFocus()PlaySound(852)bx.obj:Fire("OnClick",...)end;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local eP={["OnAcquire"]=function(self)self:SetHeight(24)self:SetWidth(200)self:SetDisabled(false)self:SetAutoWidth(false)self:SetText()end,["SetText"]=function(self,fg)self.text:SetText(fg)if self.autoWidth then self:SetWidth(self.text:GetStringWidth()+30)end end,["SetAutoWidth"]=function(self,hW)self.autoWidth=hW;if self.autoWidth then self:SetWidth(self.text:GetStringWidth()+30)end end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.frame:Disable()else self.frame:Enable()end end}local function dK()local aa="AceGUI30Button"..df:GetNextWidgetNum(eI)local bx=CreateFrame("Button",aa,UIParent,"UIPanelButtonTemplate")bx:Hide()bx:EnableMouse(true)bx:SetScript("OnClick",f4)bx:SetScript("OnEnter",hU)bx:SetScript("OnLeave",hV)local fg=bx:GetFontString()fg:ClearAllPoints()fg:SetPoint("TOPLEFT",15,-1)fg:SetPoint("BOTTOMRIGHT",-15,1)fg:SetJustifyV("MIDDLE")local dt={text=fg,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function hX(...)local eI,dL="CheckBox",26;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local select,pairs=select,pairs;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function hY(self)local hZ=self.image:GetTexture()self.text:ClearAllPoints()if not hZ then self.text:SetPoint("LEFT",self.checkbg,"RIGHT")self.text:SetPoint("RIGHT")else self.text:SetPoint("LEFT",self.image,"RIGHT",1,0)self.text:SetPoint("RIGHT")end end;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local function h_(bx)local self=bx.obj;if not self.disabled then if self.image:GetTexture()then self.text:SetPoint("LEFT",self.image,"RIGHT",2,-1)else self.text:SetPoint("LEFT",self.checkbg,"RIGHT",1,-1)end end;df:ClearFocus()end;local function i0(bx)local self=bx.obj;if not self.disabled then self:ToggleChecked()if self.checked then PlaySound(856)else PlaySound(857)end;self:Fire("OnValueChanged",self.checked)hY(self)end end;local eP={["OnAcquire"]=function(self)self:SetType()self:SetValue(false)self:SetTriState(nil)self:SetWidth(200)self:SetImage()self:SetDisabled(nil)self:SetDescription(nil)end,["OnWidthSet"]=function(self,dx)if self.desc then self.desc:SetWidth(dx-30)if self.desc:GetText()and self.desc:GetText()~=""then self:SetHeight(28+self.desc:GetStringHeight())end end end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.frame:Disable()self.text:SetTextColor(0.5,0.5,0.5)SetDesaturation(self.check,true)if self.desc then self.desc:SetTextColor(0.5,0.5,0.5)end else self.frame:Enable()self.text:SetTextColor(1,1,1)if self.tristate and self.checked==nil then SetDesaturation(self.check,true)else SetDesaturation(self.check,false)end;if self.desc then self.desc:SetTextColor(1,1,1)end end end,["SetValue"]=function(self,by)local i1=self.check;self.checked=by;if by then SetDesaturation(i1,false)i1:Show()else if self.tristate and by==nil then SetDesaturation(i1,true)i1:Show()else SetDesaturation(i1,false)i1:Hide()end end;self:SetDisabled(self.disabled)end,["GetValue"]=function(self)return self.checked end,["SetTriState"]=function(self,i2)self.tristate=i2;self:SetValue(self:GetValue())end,["SetType"]=function(self,type)local i3=self.checkbg;local i1=self.check;local i4=self.highlight;local i5;if type=="radio"then i5=16;i3:SetTexture(130843)i3:SetTexCoord(0,0.25,0,1)i1:SetTexture(130843)i1:SetTexCoord(0.25,0.5,0,1)i1:SetBlendMode("ADD")i4:SetTexture(130843)i4:SetTexCoord(0.5,0.75,0,1)else i5=24;i3:SetTexture(130755)i3:SetTexCoord(0,1,0,1)i1:SetTexture(130751)i1:SetTexCoord(0,1,0,1)i1:SetBlendMode("BLEND")i4:SetTexture(130753)i4:SetTexCoord(0,1,0,1)end;i3:SetHeight(i5)i3:SetWidth(i5)end,["ToggleChecked"]=function(self)local by=self:GetValue()if self.tristate then if by then self:SetValue(nil)elseif by==nil then self:SetValue(false)else self:SetValue(true)end else self:SetValue(not self:GetValue())end end,["SetLabel"]=function(self,eT)self.text:SetText(eT)end,["SetDescription"]=function(self,i6)if i6 then if not self.desc then local ev=self.frame:CreateFontString(nil,"OVERLAY","GameFontHighlightSmall")ev:ClearAllPoints()ev:SetPoint("TOPLEFT",self.checkbg,"TOPRIGHT",5,-21)ev:SetWidth(self.frame.width-30)ev:SetPoint("RIGHT",self.frame,"RIGHT",-30,0)ev:SetJustifyH("LEFT")ev:SetJustifyV("TOP")self.desc=ev end;self.desc:Show()self.desc:SetText(i6)self:SetHeight(28+self.desc:GetStringHeight())else if self.desc then self.desc:SetText("")self.desc:Hide()end;self:SetHeight(24)end end,["SetImage"]=function(self,hj,...)local i7=self.image;i7:SetTexture(hj)if i7:GetTexture()then local d0=select("#",...)if d0==4 or d0==8 then i7:SetTexCoord(...)else i7:SetTexCoord(0,1,0,1)end end;hY(self)end}local function dK()local bx=CreateFrame("Button",nil,UIParent)bx:Hide()bx:EnableMouse(true)bx:SetScript("OnEnter",hU)bx:SetScript("OnLeave",hV)bx:SetScript("OnMouseDown",h_)bx:SetScript("OnMouseUp",i0)local i3=bx:CreateTexture(nil,"ARTWORK")i3:SetWidth(24)i3:SetHeight(24)i3:SetPoint("TOPLEFT")i3:SetTexture(130755)local i1=bx:CreateTexture(nil,"OVERLAY")i1:SetAllPoints(i3)i1:SetTexture(130751)local fg=bx:CreateFontString(nil,"OVERLAY","GameFontHighlight")fg:SetJustifyH("LEFT")fg:SetHeight(18)fg:SetPoint("LEFT",i3,"RIGHT")fg:SetPoint("RIGHT")local i4=bx:CreateTexture(nil,"HIGHLIGHT")i4:SetTexture(130753)i4:SetBlendMode("ADD")i4:SetAllPoints(i3)local i7=bx:CreateTexture(nil,"OVERLAY")i7:SetHeight(16)i7:SetWidth(16)i7:SetPoint("LEFT",i3,"RIGHT",1,0)local dt={checkbg=i3,check=i1,text=fg,highlight=i4,image=i7,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function i8(...)local eI,dL="ColorPicker",25;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local function i9(self,ia,ib,ic,id,ie)if not self.HasAlpha then id=1 end;self:SetColor(ia,ib,ic,id)if ColorPickerFrame:IsVisible()then self:Fire("OnValueChanged",ia,ib,ic,id)else if ie then self:Fire("OnValueConfirmed",ia,ib,ic,id)end end end;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local function ig(bx)ColorPickerFrame:Hide()local self=bx.obj;if not self.disabled then ColorPickerFrame:SetFrameStrata("FULLSCREEN_DIALOG")ColorPickerFrame:SetFrameLevel(bx:GetFrameLevel()+10)ColorPickerFrame:SetClampedToScreen(true)ColorPickerFrame.func=function()local ia,ib,ic=ColorPickerFrame:GetColorRGB()local id=1-OpacitySliderFrame:GetValue()i9(self,ia,ib,ic,id)end;ColorPickerFrame.hasOpacity=self.HasAlpha;ColorPickerFrame.opacityFunc=function()local ia,ib,ic=ColorPickerFrame:GetColorRGB()local id=1-OpacitySliderFrame:GetValue()i9(self,ia,ib,ic,id,true)end;local ia,ib,ic,id=self.r,self.g,self.b,self.a;if self.HasAlpha then ColorPickerFrame.opacity=1-(id or 0)end;ColorPickerFrame:SetColorRGB(ia,ib,ic)ColorPickerFrame.cancelFunc=function()i9(self,ia,ib,ic,id,true)end;ColorPickerFrame:Show()end;df:ClearFocus()end;local eP={["OnAcquire"]=function(self)self:SetHeight(24)self:SetWidth(200)self:SetHasAlpha(false)self:SetColor(0,0,0,1)self:SetDisabled(nil)self:SetLabel(nil)end,["SetLabel"]=function(self,fg)self.text:SetText(fg)end,["SetColor"]=function(self,ia,ib,ic,id)self.r=ia;self.g=ib;self.b=ic;self.a=id or 1;self.colorSwatch:SetVertexColor(ia,ib,ic,id)end,["SetHasAlpha"]=function(self,ih)self.HasAlpha=ih end,["SetDisabled"]=function(self,gf)self.disabled=gf;if self.disabled then self.frame:Disable()self.text:SetTextColor(0.5,0.5,0.5)else self.frame:Enable()self.text:SetTextColor(1,1,1)end end}local function dK()local bx=CreateFrame("Button",nil,UIParent)bx:Hide()bx:EnableMouse(true)bx:SetScript("OnEnter",hU)bx:SetScript("OnLeave",hV)bx:SetScript("OnClick",ig)local ii=bx:CreateTexture(nil,"OVERLAY")ii:SetWidth(19)ii:SetHeight(19)ii:SetTexture(130939)ii:SetPoint("LEFT")local ij=bx:CreateTexture(nil,"BACKGROUND")ii.background=ij;ij:SetWidth(16)ij:SetHeight(16)ij:SetColorTexture(1,1,1)ij:SetPoint("CENTER",ii)ij:Show()local ik=bx:CreateTexture(nil,"BACKGROUND")ii.checkers=ik;ik:SetWidth(14)ik:SetHeight(14)ik:SetTexture(188523)ik:SetTexCoord(.25,0,0.5,.25)ik:SetDesaturated(true)ik:SetVertexColor(1,1,1,0.75)ik:SetPoint("CENTER",ii)ik:Show()local fg=bx:CreateFontString(nil,"OVERLAY","GameFontHighlight")fg:SetHeight(24)fg:SetJustifyH("LEFT")fg:SetTextColor(1,1,1)fg:SetPoint("LEFT",ii,"RIGHT",2,0)fg:SetPoint("RIGHT")local dt={colorSwatch=ii,text=fg,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function il(...)local df=LibStub("AceGUI-3.0")local fv,cY,fw=math.min,math.max,math.floor;local select,pairs,ipairs,type,tostring=select,pairs,ipairs,type,tostring;local im=table.sort;local PlaySound=PlaySound;local UIParent,CreateFrame=UIParent,CreateFrame;local _G=_G;local function io(cd,...)local M=1;local dB=select(M,...)while dB do dB:SetFrameLevel(cd:GetFrameLevel()+1)io(dB,dB:GetChildren())M=M+1;dB=select(M,...)end end;local function ip(iq,cd,...)local M=1;local dB=select(M,...)cd:SetFrameStrata(iq)while dB do ip(iq,dB,dB:GetChildren())M=M+1;dB=select(M,...)end end;do local dr="Dropdown-Pullout"local ir=5;local is={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\DialogFrame\\UI-DialogBox-Border",edgeSize=32,tileSize=32,tile=true,insets={left=11,right=12,top=12,bottom=11}}local it={bgFile="Interface\\Buttons\\UI-SliderBar-Background",edgeFile="Interface\\Buttons\\UI-SliderBar-Border",tile=true,tileSize=8,edgeSize=8,insets={left=3,right=3,top=3,bottom=3}}local iu=200;local iv=600;local function iw(ix)local self=ix.pullout;for ad,ae in ipairs(self.items)do if ae.CloseMenu and ae~=ix then ae:CloseMenu()end end end;local function iy(ay,by)ay.obj:MoveScroll(by)end;local function gX(ay,by)ay.obj:SetScroll(by)end;local function iz(ay)ay.obj:FixScroll()end;local function iA(self,by)local eX=self.scrollStatus;local bx,dB=self.scrollFrame,self.itemFrame;local dy,fB=bx:GetHeight(),dB:GetHeight()local ag;if dy>fB then ag=0 else ag=fw((fB-dy)/1000*by)end;dB:ClearAllPoints()dB:SetPoint("TOPLEFT",bx,"TOPLEFT",0,ag)dB:SetPoint("TOPRIGHT",bx,"TOPRIGHT",self.slider:IsShown()and-12 or 0,ag)eX.offset=ag;eX.scrollvalue=by end;local function iB(self,by)local eX=self.scrollStatus;local bx,dB=self.scrollFrame,self.itemFrame;local dy,fB=bx:GetHeight(),dB:GetHeight()if dy>fB then self.slider:Hide()else self.slider:Show()local fC=dy-fB;local fD=1;if by<0 then fD=-1 end;self.slider:SetValue(fv(cY(eX.scrollvalue+fD*1000/(fC/45),0),1000))end end;local function iC(self)local eX=self.scrollStatus;local bx,dB=self.scrollFrame,self.itemFrame;local dy,fB=bx:GetHeight(),dB:GetHeight()local ag=eX.offset or 0;if fB<dy then self.slider:Hide()dB:SetPoint("TOPRIGHT",bx,"TOPRIGHT",0,ag)self.slider:SetValue(0)else self.slider:Show()local by=ag/(fB-dy)*1000;if by>1000 then by=1000 end;self.slider:SetValue(by)self:SetScroll(by)if by<1000 then dB:ClearAllPoints()dB:SetPoint("TOPLEFT",bx,"TOPLEFT",0,ag)dB:SetPoint("TOPRIGHT",bx,"TOPRIGHT",-12,ag)eX.offset=ag end end end;local function hE(self)self.frame:SetParent(UIParent)end;local function hF(self)self:Clear()self.frame:ClearAllPoints()self.frame:Hide()end;local function iD(self,ix)self.items[#self.items+1]=ix;local iE=#self.items*16;self.itemFrame:SetHeight(iE)self.frame:SetHeight(fv(iE+34,self.maxHeight))ix.frame:SetPoint("LEFT",self.itemFrame,"LEFT")ix.frame:SetPoint("RIGHT",self.itemFrame,"RIGHT")ix:SetPullout(self)ix:SetOnEnter(iw)end;local function iF(self,point,iG,iH,x,y)local iI=self.items;local bx=self.frame;local iJ=self.itemFrame;bx:SetPoint(point,iG,iH,x,y)local dy=8;for M,ix in pairs(iI)do ix:SetPoint("TOP",iJ,"TOP",0,-2+(M-1)*-16)ix:Show()dy=dy+16 end;iJ:SetHeight(dy)ip("TOOLTIP",bx,bx:GetChildren())bx:Show()self:Fire("OnOpen")end;local function iK(self)self.frame:Hide()self:Fire("OnClose")end;local function iL(self)local iI=self.items;for M,ix in pairs(iI)do df:Release(ix)iI[M]=nil end end;local function iM(self)return ipairs(self.items)end;local function iN(self,e8)self.hideOnLeave=e8 end;local function iO(self,dy)self.maxHeight=dy or iv;if self.frame:GetHeight()>dy then self.frame:SetHeight(dy)elseif self.itemFrame:GetHeight()+34<dy then self.frame:SetHeight(self.itemFrame:GetHeight()+34)end end;local function iP(self)return 6+(self.slider:IsShown()and 12 or 0)end;local function iQ(self)return 6 end;local function dK()local iR=df:GetNextWidgetNum(dr)local bx=CreateFrame("Frame","AceGUI30Pullout"..iR,UIParent,"BackdropTemplate")local self={}self.count=iR;self.type=dr;self.frame=bx;bx.obj=self;self.OnAcquire=hE;self.OnRelease=hF;self.AddItem=iD;self.Open=iF;self.Close=iK;self.Clear=iL;self.IterateItems=iM;self.SetHideOnLeave=iN;self.SetScroll=iA;self.MoveScroll=iB;self.FixScroll=iC;self.SetMaxHeight=iO;self.GetRightBorderWidth=iP;self.GetLeftBorderWidth=iQ;self.items={}self.scrollStatus={scrollvalue=0}self.maxHeight=iv;bx:SetBackdrop(is)bx:SetBackdropColor(0,0,0)bx:SetFrameStrata("FULLSCREEN_DIALOG")bx:SetClampedToScreen(true)bx:SetWidth(iu)bx:SetHeight(self.maxHeight)local iS=CreateFrame("ScrollFrame",nil,bx)local iJ=CreateFrame("Frame",nil,iS)self.scrollFrame=iS;self.itemFrame=iJ;iS.obj=self;iJ.obj=self;local iT=CreateFrame("Slider","AceGUI30PulloutScrollbar"..iR,iS,"BackdropTemplate")iT:SetOrientation("VERTICAL")iT:SetHitRectInsets(0,0,-10,0)iT:SetBackdrop(it)iT:SetWidth(8)iT:SetThumbTexture("Interface\\Buttons\\UI-SliderBar-Button-Vertical")iT:SetFrameStrata("FULLSCREEN_DIALOG")self.slider=iT;iT.obj=self;iS:SetScrollChild(iJ)iS:SetPoint("TOPLEFT",bx,"TOPLEFT",6,-12)iS:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",-6,12)iS:EnableMouseWheel(true)iS:SetScript("OnMouseWheel",iy)iS:SetScript("OnSizeChanged",iz)iS:SetToplevel(true)iS:SetFrameStrata("FULLSCREEN_DIALOG")iJ:SetPoint("TOPLEFT",iS,"TOPLEFT",0,0)iJ:SetPoint("TOPRIGHT",iS,"TOPRIGHT",-12,0)iJ:SetHeight(400)iJ:SetToplevel(true)iJ:SetFrameStrata("FULLSCREEN_DIALOG")iT:SetPoint("TOPLEFT",iS,"TOPRIGHT",-16,0)iT:SetPoint("BOTTOMLEFT",iS,"BOTTOMRIGHT",-16,0)iT:SetScript("OnValueChanged",gX)iT:SetMinMaxValues(0,1000)iT:SetValueStep(1)iT:SetValue(0)iS:Show()iJ:Show()iT:Hide()self:FixScroll()df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,ir)end;do local dr="Dropdown"local ir=36;local function hU(ay)ay.obj.button:LockHighlight()ay.obj:Fire("OnEnter")end;local function hV(ay)ay.obj.button:UnlockHighlight()ay.obj:Fire("OnLeave")end;local function iU(ay)local self=ay.obj;if self.open then self.pullout:Close()end end;local function iV(ay)local self=ay.obj;if self.open then self.open=nil;self.pullout:Close()df:ClearFocus()else self.open=true;self.pullout:SetWidth(self.pulloutWidth or self.frame:GetWidth())self.pullout:Open("TOPLEFT",self.frame,"BOTTOMLEFT",0,self.label:IsShown()and-2 or 0)df:SetFocus(self)end end;local function iW(ay)local self=ay.userdata.obj;local by=self.value;if not self.multiselect then for M,ix in ay:IterateItems()do ix:SetValue(ix.userdata.value==by)end end;self.open=true;self:Fire("OnOpened")end;local function iX(ay)local self=ay.userdata.obj;self.open=nil;self:Fire("OnClosed")end;local function iY(self)local fg;for M,dt in self.pullout:IterateItems()do if dt.type=="Dropdown-Item-Toggle"then if dt:GetValue()then if fg then fg=fg..", "..dt:GetText()else fg=dt:GetText()end end end end;self:SetText(fg)end;local function iZ(ay,F,i_)local self=ay.userdata.obj;if self.multiselect then self:Fire("OnValueChanged",ay.userdata.value,i_)iY(self)else if i_ then self:SetValue(ay.userdata.value)self:Fire("OnValueChanged",ay.userdata.value)else ay:SetValue(true)end;if self.open then self.pullout:Close()end end end;local function hE(self)local j0=df:Create("Dropdown-Pullout")self.pullout=j0;j0.userdata.obj=self;j0:SetCallback("OnClose",iX)j0:SetCallback("OnOpen",iW)self.pullout.frame:SetFrameLevel(self.frame:GetFrameLevel()+1)io(self.pullout.frame,self.pullout.frame:GetChildren())self:SetHeight(44)self:SetWidth(200)self:SetLabel()self:SetPulloutWidth(nil)self.list={}end;local function hF(self)if self.open then self.pullout:Close()end;df:Release(self.pullout)self.pullout=nil;self:SetText("")self:SetDisabled(false)self:SetMultiselect(false)self.value=nil;self.list=nil;self.open=nil;self.hasClose=nil;self.frame:ClearAllPoints()self.frame:Hide()end;local function j1(self,gf)self.disabled=gf;if gf then self.text:SetTextColor(0.5,0.5,0.5)self.button:Disable()self.button_cover:Disable()self.label:SetTextColor(0.5,0.5,0.5)else self.button:Enable()self.button_cover:Enable()self.label:SetTextColor(1,.82,0)self.text:SetTextColor(1,1,1)end end;local function j2(self)if self.open then self.pullout:Close()end end;local function j3(self,fg)self.text:SetText(fg or"")end;local function j4(self,fg)if fg and fg~=""then self.label:SetText(fg)self.label:Show()self.dropdown:SetPoint("TOPLEFT",self.frame,"TOPLEFT",-15,-14)self:SetHeight(40)self.alignoffset=26 else self.label:SetText("")self.label:Hide()self.dropdown:SetPoint("TOPLEFT",self.frame,"TOPLEFT",-15,0)self:SetHeight(26)self.alignoffset=12 end end;local function j5(self,by)self:SetText(self.list[by]or"")self.value=by end;local function j6(self)return self.value end;local function j7(self,ix,by)if not self.multiselect then return end;for M,dt in self.pullout:IterateItems()do if dt.userdata.value==ix then if dt.SetValue then dt:SetValue(by)end end end;iY(self)end;local function j8(self,ix,gf)for M,dt in self.pullout:IterateItems()do if dt.userdata.value==ix then dt:SetDisabled(gf)end end end;local function j9(self,by,fg,ja)if not ja then ja="Dropdown-Item-Toggle"end;local jb=df:GetWidgetVersion(ja)if not jb then error(("The given item type, %q, does not exist within AceGUI-3.0"):format(tostring(ja)),2)end;local ix=df:Create(ja)ix:SetText(fg)ix.userdata.obj=self;ix.userdata.value=by;ix:SetCallback("OnValueChanged",iZ)self.pullout:AddItem(ix)end;local function jc(self)if not self.hasClose then local hS=df:Create("Dropdown-Item-Execute")hS:SetText(CLOSE)self.pullout:AddItem(hS)self.hasClose=true end end;local jd={}local function je(x,y)local jf,jg=tonumber(x),tonumber(y)if jf and jg then return jf<jg else return tostring(x)<tostring(y)end end;local function jh(self,eY,eZ,ja)self.list=eY or{}self.pullout:Clear()self.hasClose=nil;if not eY then return end;if type(eZ)~="table"then for ae in pairs(eY)do jd[#jd+1]=ae end;im(jd,je)for M,o in ipairs(jd)do j9(self,o,eY[o],ja)jd[M]=nil end else for M,o in ipairs(eZ)do j9(self,o,eY[o],ja)end end;if self.multiselect then iY(self)jc(self)end end;local function iD(self,by,fg,ja)self.list[by]=fg;j9(self,by,fg,ja)end;local function ji(self,jj)self.multiselect=jj;if jj then iY(self)jc(self)end end;local function jk(self)return self.multiselect end;local function jl(self,dx)self.pulloutWidth=dx end;local function dK()local iR=df:GetNextWidgetNum(dr)local bx=CreateFrame("Frame",nil,UIParent)local f1=CreateFrame("Frame","AceGUI30DropDown"..iR,bx,"UIDropDownMenuTemplate")local self={}self.type=dr;self.frame=bx;self.dropdown=f1;self.count=iR;bx.obj=self;f1.obj=self;self.OnRelease=hF;self.OnAcquire=hE;self.ClearFocus=j2;self.SetText=j3;self.SetValue=j5;self.GetValue=j6;self.SetList=jh;self.SetLabel=j4;self.SetDisabled=j1;self.AddItem=iD;self.SetMultiselect=ji;self.GetMultiselect=jk;self.SetItemValue=j7;self.SetItemDisabled=j8;self.SetPulloutWidth=jl;self.alignoffset=26;bx:SetScript("OnHide",iU)f1:ClearAllPoints()f1:SetPoint("TOPLEFT",bx,"TOPLEFT",-15,0)f1:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",17,0)f1:SetScript("OnHide",nil)local fX=_G[f1:GetName().."Left"]local g3=_G[f1:GetName().."Middle"]local g4=_G[f1:GetName().."Right"]g3:ClearAllPoints()g4:ClearAllPoints()g3:SetPoint("LEFT",fX,"RIGHT",0,0)g3:SetPoint("RIGHT",g4,"LEFT",0,0)g4:SetPoint("TOPRIGHT",f1,"TOPRIGHT",0,17)local gD=_G[f1:GetName().."Button"]self.button=gD;gD.obj=self;gD:SetScript("OnEnter",hU)gD:SetScript("OnLeave",hV)gD:SetScript("OnClick",iV)local jm=CreateFrame("BUTTON",nil,self.frame)self.button_cover=jm;jm.obj=self;jm:SetPoint("TOPLEFT",self.frame,"BOTTOMLEFT",0,25)jm:SetPoint("BOTTOMRIGHT",self.frame,"BOTTOMRIGHT")jm:SetScript("OnEnter",hU)jm:SetScript("OnLeave",hV)jm:SetScript("OnClick",iV)local fg=_G[f1:GetName().."Text"]self.text=fg;fg.obj=self;fg:ClearAllPoints()fg:SetPoint("RIGHT",g4,"RIGHT",-43,2)fg:SetPoint("LEFT",fX,"LEFT",25,2)local eT=bx:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eT:SetPoint("TOPLEFT",bx,"TOPLEFT",0,0)eT:SetPoint("TOPRIGHT",bx,"TOPRIGHT",0,0)eT:SetJustifyH("LEFT")eT:SetHeight(18)eT:Hide()self.label=eT;df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,ir)end end;local function jn(...)local df=LibStub("AceGUI-3.0")local select,assert=select,assert;local PlaySound=PlaySound;local CreateFrame=CreateFrame;local function io(cd,...)local M=1;local dB=select(M,...)while dB do dB:SetFrameLevel(cd:GetFrameLevel()+1)io(dB,dB:GetChildren())M=M+1;dB=select(M,...)end end;local function ip(iq,cd,...)local M=1;local dB=select(M,...)cd:SetFrameStrata(iq)while dB do ip(iq,dB,dB:GetChildren())M=M+1;dB=select(M,...)end end;local jo={version=2000,counter=0}function jo.Frame_OnEnter(ay)local self=ay.obj;if self.useHighlight then self.highlight:Show()end;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end end;function jo.Frame_OnLeave(ay)local self=ay.obj;self.highlight:Hide()self:Fire("OnLeave")if self.specialOnLeave then self.specialOnLeave(self)end end;function jo.OnAcquire(self)self.frame:SetToplevel(true)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")end;function jo.OnRelease(self)self:SetDisabled(false)self.pullout=nil;self.frame:SetParent(nil)self.frame:ClearAllPoints()self.frame:Hide()end;function jo.SetPullout(self,j0)self.pullout=j0;self.frame:SetParent(nil)self.frame:SetParent(j0.itemFrame)self.parent=j0.itemFrame;io(j0.itemFrame,j0.itemFrame:GetChildren())end;function jo.SetText(self,fg)self.text:SetText(fg or"")end;function jo.GetText(self)return self.text:GetText()end;function jo.SetPoint(self,...)self.frame:SetPoint(...)end;function jo.Show(self)self.frame:Show()end;function jo.Hide(self)self.frame:Hide()end;function jo.SetDisabled(self,gf)self.disabled=gf;if gf then self.useHighlight=false;self.text:SetTextColor(.5,.5,.5)else self.useHighlight=true;self.text:SetTextColor(1,1,1)end end;function jo.SetOnLeave(self,J)self.specialOnLeave=J end;function jo.SetOnEnter(self,J)self.specialOnEnter=J end;function jo.Create(type)local iR=df:GetNextWidgetNum(type)local bx=CreateFrame("Button","AceGUI30DropDownItem"..iR)local self={}self.frame=bx;bx.obj=self;self.type=type;self.useHighlight=true;bx:SetHeight(17)bx:SetFrameStrata("FULLSCREEN_DIALOG")local fg=bx:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")fg:SetTextColor(1,1,1)fg:SetJustifyH("LEFT")fg:SetPoint("TOPLEFT",bx,"TOPLEFT",18,0)fg:SetPoint("BOTTOMRIGHT",bx,"BOTTOMRIGHT",-8,0)self.text=fg;local i4=bx:CreateTexture(nil,"OVERLAY")i4:SetTexture(136810)i4:SetBlendMode("ADD")i4:SetHeight(14)i4:ClearAllPoints()i4:SetPoint("RIGHT",bx,"RIGHT",-3,0)i4:SetPoint("LEFT",bx,"LEFT",5,0)i4:Hide()self.highlight=i4;local i1=bx:CreateTexture(nil,"OVERLAY")i1:SetWidth(16)i1:SetHeight(16)i1:SetPoint("LEFT",bx,"LEFT",3,-1)i1:SetTexture(130751)i1:Hide()self.check=i1;local jp=bx:CreateTexture(nil,"OVERLAY")jp:SetWidth(16)jp:SetHeight(16)jp:SetPoint("RIGHT",bx,"RIGHT",-3,-1)jp:SetTexture(130940)jp:Hide()self.sub=jp;bx:SetScript("OnEnter",jo.Frame_OnEnter)bx:SetScript("OnLeave",jo.Frame_OnLeave)self.OnAcquire=jo.OnAcquire;self.OnRelease=jo.OnRelease;self.SetPullout=jo.SetPullout;self.GetText=jo.GetText;self.SetText=jo.SetText;self.SetDisabled=jo.SetDisabled;self.SetPoint=jo.SetPoint;self.Show=jo.Show;self.Hide=jo.Hide;self.SetOnLeave=jo.SetOnLeave;self.SetOnEnter=jo.SetOnEnter;return self end;local jq=LibStub:NewLibrary("AceGUI-3.0-DropDown-ItemBase",jo.version)if jq then jq.GetItemBase=function()return jo end end;do local dr="Dropdown-Item-Header"local ir=1;local function iw(ay)local self=ay.obj;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end end;local function jr(ay)local self=ay.obj;self:Fire("OnLeave")if self.specialOnLeave then self.specialOnLeave(self)end end;local function j1(self,gf)jo.SetDisabled(self,gf)if not gf then self.text:SetTextColor(1,1,0)end end;local function dK()local self=jo.Create(dr)self.SetDisabled=j1;self.frame:SetScript("OnEnter",iw)self.frame:SetScript("OnLeave",jr)self.text:SetTextColor(1,1,0)df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,ir+jo.version)end;do local dr="Dropdown-Item-Execute"local ir=1;local function js(ay,gD)local self=ay.obj;if self.disabled then return end;self:Fire("OnClick")if self.pullout then self.pullout:Close()end end;local function dK()local self=jo.Create(dr)self.frame:SetScript("OnClick",js)df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,ir+jo.version)end;do local dr="Dropdown-Item-Toggle"local ir=4;local function jt(self)if self.value then self.check:Show()else self.check:Hide()end end;local function hF(self)jo.OnRelease(self)self:SetValue(nil)end;local function js(ay,gD)local self=ay.obj;if self.disabled then return end;self.value=not self.value;if self.value then PlaySound(856)else PlaySound(857)end;jt(self)self:Fire("OnValueChanged",self.value)end;local function j5(self,by)self.value=by;jt(self)end;local function j6(self)return self.value end;local function dK()local self=jo.Create(dr)self.frame:SetScript("OnClick",js)self.SetValue=j5;self.GetValue=j6;self.OnRelease=hF;df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,ir+jo.version)end;do local dr="Dropdown-Item-Menu"local ir=2;local function iw(ay)local self=ay.obj;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end;self.highlight:Show()if not self.disabled and self.submenu then self.submenu:Open("TOPLEFT",self.frame,"TOPRIGHT",self.pullout:GetRightBorderWidth(),0,self.frame:GetFrameLevel()+100)end end;local function eK(ay)local self=ay.obj;if self.submenu then self.submenu:Close()end end;local function ju(self,jv)assert(jv.type=="Dropdown-Pullout")self.submenu=jv end;local function jw(self)self.submenu:Close()end;local function dK()local self=jo.Create(dr)self.sub:Show()self.frame:SetScript("OnEnter",iw)self.frame:SetScript("OnHide",eK)self.SetMenu=ju;self.CloseMenu=jw;df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,ir+jo.version)end;do local dr="Dropdown-Item-Separator"local ir=2;local function j1(self,gf)jo.SetDisabled(self,gf)self.useHighlight=false end;local function dK()local self=jo.Create(dr)self.SetDisabled=j1;local gB=self.frame:CreateTexture(nil,"OVERLAY")gB:SetHeight(1)gB:SetColorTexture(.5,.5,.5)gB:SetPoint("LEFT",self.frame,"LEFT",10,0)gB:SetPoint("RIGHT",self.frame,"RIGHT",-10,0)self.text:Hide()self.useHighlight=false;df:RegisterAsWidget(self)return self end;df:RegisterWidgetType(dr,dK,ir+jo.version)end end;local function jx(...)local eI,dL="EditBox",28;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local tostring,pairs=tostring,pairs;local PlaySound=PlaySound;local GetCursorInfo,ClearCursor,GetSpellInfo=GetCursorInfo,ClearCursor,GetSpellInfo;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIEditBoxInsertLink(...)end)end;function _G.AceGUIEditBoxInsertLink(fg)for M=1,df:GetWidgetCount(eI)do local jy=_G["AceGUI-3.0EditBox"..M]if jy and jy:IsVisible()and jy:HasFocus()then jy:Insert(fg)return true end end end;local function jz(self)if not self.disablebutton then self.button:Show()self.editbox:SetTextInsets(0,20,3,3)end end;local function jA(self)self.button:Hide()self.editbox:SetTextInsets(0,0,3,3)end;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local function jB(bx)bx.obj.editbox:SetFocus()bx:SetScript("OnShow",nil)end;local function jC(bx)df:ClearFocus()end;local function jD(bx)local self=bx.obj;local by=bx:GetText()local eM=self:Fire("OnEnterPressed",by)if not eM then PlaySound(856)jA(self)end end;local function jE(bx)local self=bx.obj;local type,aN,cB=GetCursorInfo()local aa;if type=="item"then aa=cB elseif type=="spell"then aa=GetSpellInfo(aN,cB)elseif type=="macro"then aa=GetMacroInfo(aN)end;if aa then self:SetText(aa)self:Fire("OnEnterPressed",aa)ClearCursor()jA(self)df:ClearFocus()end end;local function jF(bx)local self=bx.obj;local by=bx:GetText()if tostring(by)~=tostring(self.lasttext)then self:Fire("OnTextChanged",by)self.lasttext=by;jz(self)end end;local function jG(bx)df:SetFocus(bx.obj)end;local function f4(bx)local jy=bx.obj.editbox;jy:ClearFocus()jD(jy)end;local eP={["OnAcquire"]=function(self)self:SetWidth(200)self:SetDisabled(false)self:SetLabel()self:SetText()self:DisableButton(false)self:SetMaxLetters(0)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.editbox:EnableMouse(false)self.editbox:ClearFocus()self.editbox:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)else self.editbox:EnableMouse(true)self.editbox:SetTextColor(1,1,1)self.label:SetTextColor(1,.82,0)end end,["SetText"]=function(self,fg)self.lasttext=fg or""self.editbox:SetText(fg or"")self.editbox:SetCursorPosition(0)jA(self)end,["GetText"]=function(self,fg)return self.editbox:GetText()end,["SetLabel"]=function(self,fg)if fg and fg~=""then self.label:SetText(fg)self.label:Show()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,-18)self:SetHeight(44)self.alignoffset=30 else self.label:SetText("")self.label:Hide()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,0)self:SetHeight(26)self.alignoffset=12 end end,["DisableButton"]=function(self,gf)self.disablebutton=gf;if gf then jA(self)end end,["SetMaxLetters"]=function(self,fE)self.editbox:SetMaxLetters(fE or 0)end,["ClearFocus"]=function(self)self.editbox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editbox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",jB)end end,["HighlightText"]=function(self,eb,ec)self.editbox:HighlightText(eb,ec)end}local function dK()local fE=df:GetNextWidgetNum(eI)local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local jy=CreateFrame("EditBox","AceGUI-3.0EditBox"..fE,bx,"InputBoxTemplate")jy:SetAutoFocus(false)jy:SetFontObject(ChatFontNormal)jy:SetScript("OnEnter",hU)jy:SetScript("OnLeave",hV)jy:SetScript("OnEscapePressed",jC)jy:SetScript("OnEnterPressed",jD)jy:SetScript("OnTextChanged",jF)jy:SetScript("OnReceiveDrag",jE)jy:SetScript("OnMouseDown",jE)jy:SetScript("OnEditFocusGained",jG)jy:SetTextInsets(0,0,3,3)jy:SetMaxLetters(256)jy:SetPoint("BOTTOMLEFT",6,0)jy:SetPoint("BOTTOMRIGHT")jy:SetHeight(19)local eT=bx:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eT:SetPoint("TOPLEFT",0,-2)eT:SetPoint("TOPRIGHT",0,-2)eT:SetJustifyH("LEFT")eT:SetHeight(18)local gD=CreateFrame("Button",nil,jy,"UIPanelButtonTemplate")gD:SetWidth(40)gD:SetHeight(20)gD:SetPoint("RIGHT",-2,0)gD:SetText(OKAY)gD:SetScript("OnClick",f4)gD:Hide()local dt={alignoffset=30,editbox=jy,label=eT,button=gD,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;jy.obj,gD.obj=dt,dt;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function jH(...)local eI,dL="Heading",20;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eP={["OnAcquire"]=function(self)self:SetText()self:SetFullWidth()self:SetHeight(18)end,["SetText"]=function(self,fg)self.label:SetText(fg or"")if fg and fg~=""then self.left:SetPoint("RIGHT",self.label,"LEFT",-5,0)self.right:Show()else self.left:SetPoint("RIGHT",-3,0)self.right:Hide()end end}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local eT=bx:CreateFontString(nil,"BACKGROUND","GameFontNormal")eT:SetPoint("TOP")eT:SetPoint("BOTTOM")eT:SetJustifyH("CENTER")local fX=bx:CreateTexture(nil,"BACKGROUND")fX:SetHeight(8)fX:SetPoint("LEFT",3,0)fX:SetPoint("RIGHT",eT,"LEFT",-5,0)fX:SetTexture(137057)fX:SetTexCoord(0.81,0.94,0.5,1)local g4=bx:CreateTexture(nil,"BACKGROUND")g4:SetHeight(8)g4:SetPoint("RIGHT",-3,0)g4:SetPoint("LEFT",eT,"RIGHT",5,0)g4:SetTexture(137057)g4:SetTexCoord(0.81,0.94,0.5,1)local dt={label=eT,left=fX,right=g4,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function jI(...)local eI,dL="Icon",21;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local select,pairs,print=select,pairs,print;local CreateFrame,UIParent=CreateFrame,UIParent;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local function f4(bx,gD)bx.obj:Fire("OnClick",gD)df:ClearFocus()end;local eP={["OnAcquire"]=function(self)self:SetHeight(110)self:SetWidth(110)self:SetLabel()self:SetImage(nil)self:SetImageSize(64,64)self:SetDisabled(false)end,["SetLabel"]=function(self,fg)if fg and fg~=""then self.label:Show()self.label:SetText(fg)self:SetHeight(self.image:GetHeight()+25)else self.label:Hide()self:SetHeight(self.image:GetHeight()+10)end end,["SetImage"]=function(self,hj,...)local i7=self.image;i7:SetTexture(hj)if i7:GetTexture()then local d0=select("#",...)if d0==4 or d0==8 then i7:SetTexCoord(...)else i7:SetTexCoord(0,1,0,1)end end end,["SetImageSize"]=function(self,dx,dy)self.image:SetWidth(dx)self.image:SetHeight(dy)if self.label:IsShown()then self:SetHeight(dy+25)else self:SetHeight(dy+10)end end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.frame:Disable()self.label:SetTextColor(0.5,0.5,0.5)self.image:SetVertexColor(0.5,0.5,0.5,0.5)else self.frame:Enable()self.label:SetTextColor(1,1,1)self.image:SetVertexColor(1,1,1,1)end end}local function dK()local bx=CreateFrame("Button",nil,UIParent)bx:Hide()bx:EnableMouse(true)bx:SetScript("OnEnter",hU)bx:SetScript("OnLeave",hV)bx:SetScript("OnClick",f4)local eT=bx:CreateFontString(nil,"BACKGROUND","GameFontHighlight")eT:SetPoint("BOTTOMLEFT")eT:SetPoint("BOTTOMRIGHT")eT:SetJustifyH("CENTER")eT:SetJustifyV("TOP")eT:SetHeight(18)local i7=bx:CreateTexture(nil,"BACKGROUND")i7:SetWidth(64)i7:SetHeight(64)i7:SetPoint("TOP",0,-5)local i4=bx:CreateTexture(nil,"HIGHLIGHT")i4:SetAllPoints(i7)i4:SetTexture(136580)i4:SetTexCoord(0,1,0.23,0.77)i4:SetBlendMode("ADD")local dt={label=eT,image=i7,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;dt.SetText=function(self,...)print("AceGUI-3.0-Icon: SetText is deprecated! Use SetLabel instead!")self:SetLabel(...)end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function jJ(...)local eI,dL="InteractiveLabel",21;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local select,pairs=select,pairs;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local function jK(bx,gD)bx.obj:Fire("OnClick",gD)df:ClearFocus()end;local eP={["OnAcquire"]=function(self)self:LabelOnAcquire()self:SetHighlight()self:SetHighlightTexCoord()self:SetDisabled(false)end,["SetHighlight"]=function(self,...)self.highlight:SetTexture(...)end,["SetHighlightTexCoord"]=function(self,...)local jL=select("#",...)if jL==4 or jL==8 then self.highlight:SetTexCoord(...)else self.highlight:SetTexCoord(0,1,0,1)end end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.frame:EnableMouse(false)self.label:SetTextColor(0.5,0.5,0.5)else self.frame:EnableMouse(true)self.label:SetTextColor(1,1,1)end end}local function dK()local eT=df:Create("Label")local bx=eT.frame;bx:EnableMouse(true)bx:SetScript("OnEnter",hU)bx:SetScript("OnLeave",hV)bx:SetScript("OnMouseDown",jK)local i4=bx:CreateTexture(nil,"HIGHLIGHT")i4:SetTexture(nil)i4:SetAllPoints()i4:SetBlendMode("ADD")eT.highlight=i4;eT.type=eI;eT.LabelOnAcquire=eT.OnAcquire;for s,J in pairs(eP)do eT[s]=J end;return eT end;df:RegisterWidgetType(eI,dK,dL)end;local function jM(...)local eI,dL="Keybinding",26;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs=pairs;local IsShiftKeyDown,IsControlKeyDown,IsAltKeyDown=IsShiftKeyDown,IsControlKeyDown,IsAltKeyDown;local CreateFrame,UIParent=CreateFrame,UIParent;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local function jN(bx,gD)if gD=="LeftButton"or gD=="RightButton"then local self=bx.obj;if self.waitingForKey then bx:EnableKeyboard(false)bx:EnableMouseWheel(false)self.msgframe:Hide()bx:UnlockHighlight()self.waitingForKey=nil else bx:EnableKeyboard(true)bx:EnableMouseWheel(true)self.msgframe:Show()bx:LockHighlight()self.waitingForKey=true end end;df:ClearFocus()end;local jO={["BUTTON1"]=true,["BUTTON2"]=true,["UNKNOWN"]=true,["LSHIFT"]=true,["LCTRL"]=true,["LALT"]=true,["RSHIFT"]=true,["RCTRL"]=true,["RALT"]=true}local function jP(bx,o)local self=bx.obj;if self.waitingForKey then local jQ=o;if jQ=="ESCAPE"then jQ=""else if jO[jQ]then return end;if IsShiftKeyDown()then jQ="SHIFT-"..jQ end;if IsControlKeyDown()then jQ="CTRL-"..jQ end;if IsAltKeyDown()then jQ="ALT-"..jQ end end;bx:EnableKeyboard(false)bx:EnableMouseWheel(false)self.msgframe:Hide()bx:UnlockHighlight()self.waitingForKey=nil;if not self.disabled then self:SetKey(jQ)self:Fire("OnKeyChanged",jQ)end end end;local function jR(bx,gD)if gD=="LeftButton"or gD=="RightButton"then return elseif gD=="MiddleButton"then gD="BUTTON3"elseif gD=="Button4"then gD="BUTTON4"elseif gD=="Button5"then gD="BUTTON5"end;jP(bx,gD)end;local function jS(bx,jT)local gD;if jT>=0 then gD="MOUSEWHEELUP"else gD="MOUSEWHEELDOWN"end;jP(bx,gD)end;local eP={["OnAcquire"]=function(self)self:SetWidth(200)self:SetLabel("")self:SetKey("")self.waitingForKey=nil;self.msgframe:Hide()self:SetDisabled(false)self.button:EnableKeyboard(false)self.button:EnableMouseWheel(false)end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.button:Disable()self.label:SetTextColor(0.5,0.5,0.5)else self.button:Enable()self.label:SetTextColor(1,1,1)end end,["SetKey"]=function(self,o)if(o or"")==""then self.button:SetText(NOT_BOUND)self.button:SetNormalFontObject("GameFontNormal")else self.button:SetText(o)self.button:SetNormalFontObject("GameFontHighlight")end end,["GetKey"]=function(self)local o=self.button:GetText()if o==NOT_BOUND then o=nil end;return o end,["SetLabel"]=function(self,eT)self.label:SetText(eT or"")if(eT or"")==""then self.alignoffset=nil;self:SetHeight(24)else self.alignoffset=30;self:SetHeight(44)end end}local jU={bgFile="Interface\\Tooltips\\UI-Tooltip-Background",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=3,bottom=3}}local function jV(bx)bx:SetWidth(bx.msg:GetWidth()+10)bx:SetScript("OnUpdate",nil)end;local function dK()local aa="AceGUI30KeybindingButton"..df:GetNextWidgetNum(eI)local bx=CreateFrame("Frame",nil,UIParent)local gD=CreateFrame("Button",aa,bx,"UIPanelButtonTemplate")gD:EnableMouse(true)gD:EnableMouseWheel(false)gD:RegisterForClicks("AnyDown")gD:SetScript("OnEnter",hU)gD:SetScript("OnLeave",hV)gD:SetScript("OnClick",jN)gD:SetScript("OnKeyDown",jP)gD:SetScript("OnMouseDown",jR)gD:SetScript("OnMouseWheel",jS)gD:SetPoint("BOTTOMLEFT")gD:SetPoint("BOTTOMRIGHT")gD:SetHeight(24)gD:EnableKeyboard(false)local fg=gD:GetFontString()fg:SetPoint("LEFT",7,0)fg:SetPoint("RIGHT",-7,0)local eT=bx:CreateFontString(nil,"OVERLAY","GameFontHighlight")eT:SetPoint("TOPLEFT")eT:SetPoint("TOPRIGHT")eT:SetJustifyH("CENTER")eT:SetHeight(18)local jW=CreateFrame("Frame",nil,UIParent,"BackdropTemplate")jW:SetHeight(30)jW:SetBackdrop(jU)jW:SetBackdropColor(0,0,0)jW:SetFrameStrata("FULLSCREEN_DIALOG")jW:SetFrameLevel(1000)jW:SetToplevel(true)local jX=jW:CreateFontString(nil,"OVERLAY","GameFontNormal")jX:SetText("Press a key to bind, ESC to clear the binding or click the button again to cancel.")jW.msg=jX;jX:SetPoint("TOPLEFT",5,-5)jW:SetScript("OnUpdate",jV)jW:SetPoint("BOTTOM",gD,"TOP")jW:Hide()local dt={button=gD,label=eT,msgframe=jW,frame=bx,alignoffset=30,type=eI}for s,J in pairs(eP)do dt[s]=J end;gD.obj=dt;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function jY(...)local eI,dL="Label",28;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local cY,select,pairs=math.max,select,pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local function jZ(self)if self.resizing then return end;local bx=self.frame;local dx=bx.width or bx:GetWidth()or 0;local i7=self.image;local eT=self.label;local dy;eT:ClearAllPoints()i7:ClearAllPoints()if self.imageshown then local j_=i7:GetWidth()if dx-j_<200 or(eT:GetText()or"")==""then i7:SetPoint("TOP")eT:SetPoint("TOP",i7,"BOTTOM")eT:SetPoint("LEFT")eT:SetWidth(dx)dy=i7:GetHeight()+eT:GetStringHeight()else i7:SetPoint("TOPLEFT")if i7:GetHeight()>eT:GetStringHeight()then eT:SetPoint("LEFT",i7,"RIGHT",4,0)else eT:SetPoint("TOPLEFT",i7,"TOPRIGHT",4,0)end;eT:SetWidth(dx-j_-4)dy=cY(i7:GetHeight(),eT:GetStringHeight())end else eT:SetPoint("TOPLEFT")eT:SetWidth(dx)dy=eT:GetStringHeight()end;if not dy or dy==0 then dy=1 end;self.resizing=true;bx:SetHeight(dy)bx.height=dy;self.resizing=nil end;local eP={["OnAcquire"]=function(self)self.resizing=true;self:SetWidth(200)self:SetText()self:SetImage(nil)self:SetImageSize(16,16)self:SetColor()self:SetFontObject()self:SetJustifyH("LEFT")self:SetJustifyV("TOP")self.resizing=nil;jZ(self)end,["OnWidthSet"]=function(self,dx)jZ(self)end,["SetText"]=function(self,fg)self.label:SetText(fg)jZ(self)end,["SetColor"]=function(self,ia,ib,ic)if not(ia and ib and ic)then ia,ib,ic=1,1,1 end;self.label:SetVertexColor(ia,ib,ic)end,["SetImage"]=function(self,hj,...)local i7=self.image;i7:SetTexture(hj)if i7:GetTexture()then self.imageshown=true;local d0=select("#",...)if d0==4 or d0==8 then i7:SetTexCoord(...)else i7:SetTexCoord(0,1,0,1)end else self.imageshown=nil end;jZ(self)end,["SetFont"]=function(self,k0,dy,k1)if not self.fontObject then self.fontObject=CreateFont("AceGUI30LabelFont"..df:GetNextWidgetNum(eI))end;self.fontObject:SetFont(k0,dy,k1)self:SetFontObject(self.fontObject)end,["SetFontObject"]=function(self,k0)self.label:SetFontObject(k0 or GameFontHighlightSmall)jZ(self)end,["SetImageSize"]=function(self,dx,dy)self.image:SetWidth(dx)self.image:SetHeight(dy)jZ(self)end,["SetJustifyH"]=function(self,k2)self.label:SetJustifyH(k2)end,["SetJustifyV"]=function(self,k3)self.label:SetJustifyV(k3)end}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local eT=bx:CreateFontString(nil,"BACKGROUND","GameFontHighlightSmall")local i7=bx:CreateTexture(nil,"BACKGROUND")local dt={label=eT,image=i7,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function k4(...)local eI,dL="MultiLineEditBox",32;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local pairs=pairs;local GetCursorInfo,GetSpellInfo,ClearCursor=GetCursorInfo,GetSpellInfo,ClearCursor;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIMultiLineEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIMultiLineEditBoxInsertLink(...)end)end;function _G.AceGUIMultiLineEditBoxInsertLink(fg)for M=1,df:GetWidgetCount(eI)do local jy=_G[("MultiLineEditBox%uEdit"):format(M)]if jy and jy:IsVisible()and jy:HasFocus()then jy:Insert(fg)return true end end end;local function dF(self)self:SetHeight(self.numlines*14+(self.disablebutton and 19 or 41)+self.labelHeight)if self.labelHeight==0 then self.scrollBar:SetPoint("TOP",self.frame,"TOP",0,-23)else self.scrollBar:SetPoint("TOP",self.label,"BOTTOM",0,-19)end;if self.disablebutton then self.scrollBar:SetPoint("BOTTOM",self.frame,"BOTTOM",0,21)self.scrollBG:SetPoint("BOTTOMLEFT",0,4)else self.scrollBar:SetPoint("BOTTOM",self.button,"TOP",0,18)self.scrollBG:SetPoint("BOTTOMLEFT",self.button,"TOPLEFT")end end;local function k5(self)self=self.obj;self.editBox:ClearFocus()if not self:Fire("OnEnterPressed",self.editBox:GetText())then self.button:Disable()end end;local function k6(self,aV,y,aV,k7)self,y=self.obj.scrollFrame,-y;local ag=self:GetVerticalScroll()if y<ag then self:SetVerticalScroll(y)else y=y+k7-self:GetHeight()if y>ag then self:SetVerticalScroll(y)end end end;local function k8(self)self:HighlightText(0,0)self.obj:Fire("OnEditFocusLost")end;local function iw(self)self=self.obj;if not self.entered then self.entered=true;self:Fire("OnEnter")end end;local function jr(self)self=self.obj;if self.entered then self.entered=nil;self:Fire("OnLeave")end end;local function k9(self)self=self.obj.editBox;self:SetFocus()self:SetCursorPosition(self:GetNumLetters())end;local function ka(self)local type,aN,cB=GetCursorInfo()if type=="spell"then cB=GetSpellInfo(aN,cB)elseif type~="item"then return end;ClearCursor()self=self.obj;local d4=self.editBox;if not d4:HasFocus()then d4:SetFocus()d4:SetCursorPosition(d4:GetNumLetters())end;d4:Insert(cB)self.button:Enable()end;local function iz(self,dx,dy)self.obj.editBox:SetWidth(dx)end;local function kb(self,kc)if kc then self=self.obj;self:Fire("OnTextChanged",self.editBox:GetText())self.button:Enable()end end;local function kd(self)self:HighlightText(0,0)self:SetCursorPosition(self:GetNumLetters())self:SetCursorPosition(0)self.obj.button:Disable()end;local function ke(self,ag)local d4=self.obj.editBox;d4:SetHitRectInsets(0,0,ag,d4:GetHeight()-ag-self:GetHeight())end;local function kf(self,kg,kh)if kh==0 then self.obj.editBox:SetHitRectInsets(0,0,0,0)else ke(self,self:GetVerticalScroll())end end;local function ki(bx)bx.obj.editBox:SetFocus()bx:SetScript("OnShow",nil)end;local function kj(bx)df:SetFocus(bx.obj)bx.obj:Fire("OnEditFocusGained")end;local eP={["OnAcquire"]=function(self)self.editBox:SetText("")self:SetDisabled(false)self:SetWidth(200)self:DisableButton(false)self:SetNumLines()self.entered=nil;self:SetMaxLetters(0)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gf)local d4=self.editBox;if gf then d4:ClearFocus()d4:EnableMouse(false)d4:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)self.scrollFrame:EnableMouse(false)self.button:Disable()else d4:EnableMouse(true)d4:SetTextColor(1,1,1)self.label:SetTextColor(1,0.82,0)self.scrollFrame:EnableMouse(true)end end,["SetLabel"]=function(self,fg)if fg and fg~=""then self.label:SetText(fg)if self.labelHeight~=10 then self.labelHeight=10;self.label:Show()end elseif self.labelHeight~=0 then self.labelHeight=0;self.label:Hide()end;dF(self)end,["SetNumLines"]=function(self,by)if not by or by<4 then by=4 end;self.numlines=by;dF(self)end,["SetText"]=function(self,fg)self.editBox:SetText(fg)end,["GetText"]=function(self)return self.editBox:GetText()end,["SetMaxLetters"]=function(self,fE)self.editBox:SetMaxLetters(fE or 0)end,["DisableButton"]=function(self,gf)self.disablebutton=gf;if gf then self.button:Hide()else self.button:Show()end;dF(self)end,["ClearFocus"]=function(self)self.editBox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editBox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",ki)end end,["HighlightText"]=function(self,eb,ec)self.editBox:HighlightText(eb,ec)end,["GetCursorPosition"]=function(self)return self.editBox:GetCursorPosition()end,["SetCursorPosition"]=function(self,...)return self.editBox:SetCursorPosition(...)end}local is={bgFile=[[Interface\Tooltips\UI-Tooltip-Background]],edgeFile=[[Interface\Tooltips\UI-Tooltip-Border]],edgeSize=16,insets={left=4,right=3,top=4,bottom=3}}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local kk=df:GetNextWidgetNum(eI)local eT=bx:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eT:SetPoint("TOPLEFT",bx,"TOPLEFT",0,-4)eT:SetPoint("TOPRIGHT",bx,"TOPRIGHT",0,-4)eT:SetJustifyH("LEFT")eT:SetText(ACCEPT)eT:SetHeight(10)local gD=CreateFrame("Button",("%s%dButton"):format(eI,kk),bx,"UIPanelButtonTemplate")gD:SetPoint("BOTTOMLEFT",0,4)gD:SetHeight(22)gD:SetWidth(eT:GetStringWidth()+24)gD:SetText(ACCEPT)gD:SetScript("OnClick",k5)gD:Disable()local fg=gD:GetFontString()fg:ClearAllPoints()fg:SetPoint("TOPLEFT",gD,"TOPLEFT",5,-5)fg:SetPoint("BOTTOMRIGHT",gD,"BOTTOMRIGHT",-5,1)fg:SetJustifyV("MIDDLE")local kl=CreateFrame("Frame",nil,bx,"BackdropTemplate")kl:SetBackdrop(is)kl:SetBackdropColor(0,0,0)kl:SetBackdropBorderColor(0.4,0.4,0.4)local iS=CreateFrame("ScrollFrame",("%s%dScrollFrame"):format(eI,kk),bx,"UIPanelScrollFrameTemplate")local km=_G[iS:GetName().."ScrollBar"]km:ClearAllPoints()km:SetPoint("TOP",eT,"BOTTOM",0,-19)km:SetPoint("BOTTOM",gD,"TOP",0,18)km:SetPoint("RIGHT",bx,"RIGHT")kl:SetPoint("TOPRIGHT",km,"TOPLEFT",0,19)kl:SetPoint("BOTTOMLEFT",gD,"TOPLEFT")iS:SetPoint("TOPLEFT",kl,"TOPLEFT",5,-6)iS:SetPoint("BOTTOMRIGHT",kl,"BOTTOMRIGHT",-4,4)iS:SetScript("OnEnter",iw)iS:SetScript("OnLeave",jr)iS:SetScript("OnMouseUp",k9)iS:SetScript("OnReceiveDrag",ka)iS:SetScript("OnSizeChanged",iz)iS:HookScript("OnVerticalScroll",ke)iS:HookScript("OnScrollRangeChanged",kf)local d4=CreateFrame("EditBox",("%s%dEdit"):format(eI,kk),iS)d4:SetAllPoints()d4:SetFontObject(ChatFontNormal)d4:SetMultiLine(true)d4:EnableMouse(true)d4:SetAutoFocus(false)d4:SetCountInvisibleLetters(false)d4:SetScript("OnCursorChanged",k6)d4:SetScript("OnEditFocusLost",k8)d4:SetScript("OnEnter",iw)d4:SetScript("OnEscapePressed",d4.ClearFocus)d4:SetScript("OnLeave",jr)d4:SetScript("OnMouseDown",ka)d4:SetScript("OnReceiveDrag",ka)d4:SetScript("OnTextChanged",kb)d4:SetScript("OnTextSet",kd)d4:SetScript("OnEditFocusGained",kj)iS:SetScrollChild(d4)local dt={button=gD,editBox=d4,frame=bx,label=eT,labelHeight=10,numlines=4,scrollBar=km,scrollBG=kl,scrollFrame=iS,type=eI}for s,J in pairs(eP)do dt[s]=J end;gD.obj,d4.obj,iS.obj=dt,dt,dt;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function kn(...)local eI,dL="Slider",23;local df=LibStub and LibStub("AceGUI-3.0",true)if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local fv,cY,fw=math.min,math.max,math.floor;local tonumber,pairs=tonumber,pairs;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function ko(self)local by=self.value or 0;if self.ispercent then self.editbox:SetText(("%s%%"):format(fw(by*1000+0.5)/10))else self.editbox:SetText(fw(by*100+0.5)/100)end end;local function kp(self)local kq,kr=self.min or 0,self.max or 100;if self.ispercent then self.lowtext:SetFormattedText("%s%%",kq*100)self.hightext:SetFormattedText("%s%%",kr*100)else self.lowtext:SetText(kq)self.hightext:SetText(kr)end end;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local function f7(bx)bx.obj.slider:EnableMouseWheel(true)df:ClearFocus()end;local function ks(bx,g_)local self=bx.obj;if not bx.setup then if self.step and self.step>0 then local kq=self.min or 0;g_=fw((g_-kq)/self.step+0.5)*self.step+kq end;if g_~=self.value and not self.disabled then self.value=g_;self:Fire("OnValueChanged",g_)end;if self.value then ko(self)end end end;local function kt(bx)local self=bx.obj;self:Fire("OnMouseUp",self.value)end;local function ku(bx,ae)local self=bx.obj;if not self.disabled then local by=self.value;if ae>0 then by=fv(by+(self.step or 1),self.max)else by=cY(by-(self.step or 1),self.min)end;self.slider:SetValue(by)end end;local function jC(bx)bx:ClearFocus()end;local function jD(bx)local self=bx.obj;local by=bx:GetText()if self.ispercent then by=by:gsub('%%','')by=tonumber(by)/100 else by=tonumber(by)end;if by then PlaySound(856)self.slider:SetValue(by)self:Fire("OnMouseUp",by)end end;local function kv(bx)bx:SetBackdropBorderColor(0.5,0.5,0.5,1)end;local function kw(bx)bx:SetBackdropBorderColor(0.3,0.3,0.3,0.8)end;local eP={["OnAcquire"]=function(self)self:SetWidth(200)self:SetHeight(44)self:SetDisabled(false)self:SetIsPercent(nil)self:SetSliderValues(0,100,1)self:SetValue(0)self.slider:EnableMouseWheel(false)end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.slider:EnableMouse(false)self.label:SetTextColor(.5,.5,.5)self.hightext:SetTextColor(.5,.5,.5)self.lowtext:SetTextColor(.5,.5,.5)self.editbox:SetTextColor(.5,.5,.5)self.editbox:EnableMouse(false)self.editbox:ClearFocus()else self.slider:EnableMouse(true)self.label:SetTextColor(1,.82,0)self.hightext:SetTextColor(1,1,1)self.lowtext:SetTextColor(1,1,1)self.editbox:SetTextColor(1,1,1)self.editbox:EnableMouse(true)end end,["SetValue"]=function(self,by)self.slider.setup=true;self.slider:SetValue(by)self.value=by;ko(self)self.slider.setup=nil end,["GetValue"]=function(self)return self.value end,["SetLabel"]=function(self,fg)self.label:SetText(fg)end,["SetSliderValues"]=function(self,kq,kr,kx)local bx=self.slider;bx.setup=true;self.min=kq;self.max=kr;self.step=kx;bx:SetMinMaxValues(kq or 0,kr or 100)kp(self)bx:SetValueStep(kx or 1)if self.value then bx:SetValue(self.value)end;bx.setup=nil end,["SetIsPercent"]=function(self,by)self.ispercent=by;kp(self)ko(self)end}local ky={bgFile="Interface\\Buttons\\UI-SliderBar-Background",edgeFile="Interface\\Buttons\\UI-SliderBar-Border",tile=true,tileSize=8,edgeSize=8,insets={left=3,right=3,top=6,bottom=6}}local kz={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\ChatFrame\\ChatFrameBackground",tile=true,edgeSize=1,tileSize=5}local function dK()local bx=CreateFrame("Frame",nil,UIParent)bx:EnableMouse(true)bx:SetScript("OnMouseDown",f7)local eT=bx:CreateFontString(nil,"OVERLAY","GameFontNormal")eT:SetPoint("TOPLEFT")eT:SetPoint("TOPRIGHT")eT:SetJustifyH("CENTER")eT:SetHeight(15)local iT=CreateFrame("Slider",nil,bx,"BackdropTemplate")iT:SetOrientation("HORIZONTAL")iT:SetHeight(15)iT:SetHitRectInsets(0,0,-10,0)iT:SetBackdrop(ky)iT:SetThumbTexture("Interface\\Buttons\\UI-SliderBar-Button-Horizontal")iT:SetPoint("TOP",eT,"BOTTOM")iT:SetPoint("LEFT",3,0)iT:SetPoint("RIGHT",-3,0)iT:SetValue(0)iT:SetScript("OnValueChanged",ks)iT:SetScript("OnEnter",hU)iT:SetScript("OnLeave",hV)iT:SetScript("OnMouseUp",kt)iT:SetScript("OnMouseWheel",ku)local kA=iT:CreateFontString(nil,"ARTWORK","GameFontHighlightSmall")kA:SetPoint("TOPLEFT",iT,"BOTTOMLEFT",2,3)local kB=iT:CreateFontString(nil,"ARTWORK","GameFontHighlightSmall")kB:SetPoint("TOPRIGHT",iT,"BOTTOMRIGHT",-2,3)local jy=CreateFrame("EditBox",nil,bx,"BackdropTemplate")jy:SetAutoFocus(false)jy:SetFontObject(GameFontHighlightSmall)jy:SetPoint("TOP",iT,"BOTTOM")jy:SetHeight(14)jy:SetWidth(70)jy:SetJustifyH("CENTER")jy:EnableMouse(true)jy:SetBackdrop(kz)jy:SetBackdropColor(0,0,0,0.5)jy:SetBackdropBorderColor(0.3,0.3,0.30,0.80)jy:SetScript("OnEnter",kv)jy:SetScript("OnLeave",kw)jy:SetScript("OnEnterPressed",jD)jy:SetScript("OnEscapePressed",jC)local dt={label=eT,slider=iT,lowtext=kA,hightext=kB,editbox=jy,alignoffset=25,frame=bx,type=eI}for s,J in pairs(eP)do dt[s]=J end;iT.obj,jy.obj=dt,dt;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function kC(...)local l=LibStub("CallbackHandler-1.0")local i,k="AceConfigRegistry-3.0",21;local kD=LibStub:NewLibrary(i,k)if not kD then return end;kD.tables=kD.tables or{}if not kD.callbacks then kD.callbacks=l:New(kD)end;local tinsert,P=table.insert,table.concat;local cW,kE=string.find,string.match;local type,tostring,select,pairs=type,tostring,select,pairs;local error,assert=error,assert;kD.validated={cmd={},dropdown={},dialog={}}local function T(jX,kF,...)local aU={}for M=select("#",...),1,-1 do tinsert(aU,(select(M,...)))end;error(i..":ValidateOptionsTable(): "..P(aU,".")..jX,kF+2)end;local kG={["string"]=true,_="string"}local kH={["string"]=true,["function"]=true,_="string or funcref"}local kI={["table"]=true,_="table"}local kJ={["table"]=true,["string"]=true,["function"]=true,_="methodname, funcref or table"}local kK={["nil"]=true,["string"]=true,_="string"}local kL={["nil"]=true,["string"]=true,["function"]=true,_="string or funcref"}local kM={["nil"]=true,["string"]=true,["number"]=true,["function"]=true,_="string, number or funcref"}local kN={["nil"]=true,["number"]=true,_="number"}local kO={["nil"]=true,["string"]=true,["function"]=true,["boolean"]={[false]=true},_="methodname, funcref or false"}local kP={["nil"]=true,["string"]=true,["function"]=true,["number"]=true,_="methodname, funcref or number"}local kQ={["nil"]=true,["string"]=true,["function"]=true,["table"]=true,_="methodname, funcref or table"}local kR={["nil"]=true,["string"]=true,["function"]=true,["boolean"]=true,_="methodname, funcref or boolean"}local kS={["nil"]=true,["table"]=true,_="table"}local kT={["nil"]=true,["boolean"]=true,_="boolean"}local kU={["nil"]=true,["boolean"]=true,["number"]=true,_="boolean or number"}local kV={["nil"]=true,["string"]=true,["number"]=true,_="string or number"}local kW={type=kG,name=kH,desc=kL,descStyle=kK,order=kP,validate=kO,confirm=kR,confirmText=kK,disabled=kR,hidden=kR,guiHidden=kR,dialogHidden=kR,dropdownHidden=kR,cmdHidden=kR,tooltipHyperlink=kL,icon=kM,iconCoords=kQ,handler=kS,get=kO,set=kO,func=kO,arg={["*"]=true},width=kV}local kX={header={control=kK,dialogControl=kK,dropdownControl=kK},description={image=kM,imageCoords=kQ,imageHeight=kN,imageWidth=kN,fontSize=kL,control=kK,dialogControl=kK,dropdownControl=kK},group={args=kI,plugins=kS,inline=kT,cmdInline=kT,guiInline=kT,dropdownInline=kT,dialogInline=kT,childGroups=kK},execute={image=kM,imageCoords=kQ,imageHeight=kN,imageWidth=kN,control=kK,dialogControl=kK,dropdownControl=kK},input={pattern=kK,usage=kK,control=kK,dialogControl=kK,dropdownControl=kK,multiline=kU},toggle={tristate=kT,image=kM,imageCoords=kQ,control=kK,dialogControl=kK,dropdownControl=kK},tristate={},range={min=kN,softMin=kN,max=kN,softMax=kN,step=kN,bigStep=kN,isPercent=kT,control=kK,dialogControl=kK,dropdownControl=kK},select={values=kJ,sorting=kQ,style={["nil"]=true,["string"]={dropdown=true,radio=true},_="string: 'dropdown' or 'radio'"},control=kK,dialogControl=kK,dropdownControl=kK,itemControl=kK},multiselect={values=kJ,style=kK,tristate=kT,control=kK,dialogControl=kK,dropdownControl=kK},color={hasAlpha=kR,control=kK,dialogControl=kK,dropdownControl=kK},keybinding={control=kK,dialogControl=kK,dropdownControl=kK}}local function kY(ad,kF,...)kF=(kF or 0)+1;if type(ad)~="string"then T("["..tostring(ad).."] - key is not a string",kF,...)end;if cW(ad,"[%c\127]")then T("["..tostring(ad).."] - key name contained control characters",kF,...)end end;local function kZ(ae,k_,kF,...)kF=(kF or 0)+1;local l0=k_[type(ae)]or k_["*"]if not l0 then T(": expected a "..k_._..", got '"..tostring(ae).."'",kF,...)end;if type(l0)=="table"then if not l0[ae]then T(": did not expect "..type(ae).." value '"..tostring(ae).."'",kF,...)end end end;local function l1(l2,kF,...)kF=(kF or 0)+1;if type(l2)~="table"then T(": expected a table, got a "..type(l2),kF,...)end;if type(l2.type)~="string"then T(".type: expected a string, got a "..type(l2.type),kF,...)end;local l3=kX[l2.type]if not l3 then T(".type: unknown type '"..l2.type.."'",kF,...)end;for ad,ae in pairs(l2)do if not(l3[ad]or kW[ad])then T(": unknown parameter",kF,tostring(ad),...)end end;for ad,k_ in pairs(kW)do kZ(l2[ad],k_,kF,ad,...)end;for ad,k_ in pairs(l3)do kZ(l2[ad],k_,kF,ad,...)end;if l2.type=="group"then for ad,ae in pairs(l2.args)do kY(ad,kF,"args",...)l1(ae,kF,ad,"args",...)end;if l2.plugins then for l4,l5 in pairs(l2.plugins)do if type(l5)~="table"then T(": expected a table, got '"..tostring(l5).."'",kF,tostring(l4),"plugins",...)end;for ad,ae in pairs(l5)do kY(ad,kF,tostring(l4),"plugins",...)l1(ae,kF,ad,tostring(l4),"plugins",...)end end end end end;function kD:ValidateOptionsTable(l2,aa,kF)kF=(kF or 0)+1;aa=aa or"Optionstable"if not l2.name then l2.name=aa end;l1(l2,kF,aa)end;function kD:NotifyChange(l6)if not kD.tables[l6]then return end;kD.callbacks:Fire("ConfigTableChange",l6)end;local function l7(l8,l9,kF)kF=(kF or 0)+2;if l8~="cmd"and l8~="dropdown"and l8~="dialog"then error(i..": Requesting options table: 'uiType' - invalid configuration UI type, expected 'cmd', 'dropdown' or 'dialog'",kF)end;if not kE(l9,"[A-Za-z]%-[0-9]")then error(i..": Requesting options table: 'uiName' - badly formatted or missing version number. Expected e.g. 'MyLib-1.2'",kF)end end;function kD:RegisterOptionsTable(l6,l2,la)if type(l2)=="table"then if l2.type~="group"then error(i..": RegisterOptionsTable(appName, options): 'options' - missing type='group' member in root group",2)end;kD.tables[l6]=function(l8,l9,kF)kF=(kF or 0)+1;l7(l8,l9,kF)if not kD.validated[l8][l6]and not la then kD:ValidateOptionsTable(l2,l6,kF)kD.validated[l8][l6]=true end;return l2 end elseif type(l2)=="function"then kD.tables[l6]=function(l8,l9,kF)kF=(kF or 0)+1;l7(l8,l9,kF)local fO=assert(l2(l8,l9,l6))if not kD.validated[l8][l6]and not la then kD:ValidateOptionsTable(fO,l6,kF)kD.validated[l8][l6]=true end;return fO end else error(i..": RegisterOptionsTable(appName, options): 'options' - expected table or function reference",2)end end;function kD:IterateOptionsTables()return pairs(kD.tables)end;function kD:GetOptionsTable(l6,l8,l9)local ev=kD.tables[l6]if not ev then return nil end;if l8 then return ev(l8,l9,1)else return ev end end end;local function lb(...)local lc=LibStub("AceConfigRegistry-3.0")local i,k="AceConfigCmd-3.0",14;local ld=LibStub:NewLibrary(i,k)if not ld then return end;ld.commands=ld.commands or{}local le=ld.commands;local cV;local lf="AceConsole-3.0"local cX,lg,lh,kE,li=string.sub,string.split,string.lower,string.match,string.trim;local bg,tonumber,tostring=string.format,tonumber,tostring;local im,tinsert=table.sort,table.insert;local select,pairs,next,type=select,pairs,next,type;local error,assert=error,assert;local _G=_G;local cr=setmetatable({},{__index=function(self,ad)return ad end})local function print(jX)(SELECTED_CHAT_FRAME or DEFAULT_CHAT_FRAME):AddMessage(jX)end;local lj={["table"]=true}local lk="expected a table"local ll={["function"]=true,["string"]=true}local lm="expected function or member name"local function ln(...)for M=1,select("#",...)do if select(M,...)~=nil then return select(M,...)end end end;local function T(cB,lo,jX)local lp=" "..cX(cB.input,1,lo-1)error(i..": /"..cB[0]..lp..": "..(jX or"malformed options table"),2)end;local function lq(cB,lo,jX)local lp=cX(cB.input,1,lo-1)print("/"..cB[0].." "..lp..": "..(jX or"malformed options table"))end;local function lr(cB,lo,fO,ls,...)local s=cB[ls]if not s then T(cB,lo,"'"..ls.."': not set")end;cB.arg=fO.arg;cB.option=fO;cB.type=fO.type;if type(s)=="function"then return s(cB,...)elseif type(s)=="string"then if type(cB.handler[s])~="function"then T(cB,lo,"'"..ls.."': '"..s.."' is not a member function of "..tostring(cB.handler))end;return cB.handler[s](cB.handler,cB,...)else assert(false)end end;local function lt(cB,fO,ls,...)local s=fO[ls]cB.arg=fO.arg;cB.option=fO;cB.type=fO.type;if type(s)=="function"then return s(cB,...)else assert(false)end end;local function lu(cB,lo,fO,ls,...)if cB.validate then local lv=lr(cB,lo,fO,"validate",...)if type(lv)=="string"then lq(cB,lo,"'"..cX(cB.input,lo).."' - "..lv)return end end;lr(cB,lo,fO,ls,...)end;local function lw(cB,lo,fO,lx,ly,lz,lA)local lB,lC=cB[ly],cB[ly.."_at"]local e8=fO[ly]if e8~=nil then if e8==false then e8=nil elseif not lz[type(e8)]then T(cB,lo,"'"..ly.."' - "..lA)end;cB[ly]=e8;cB[ly.."_at"]=lx end;return lB,lC end;local lD={}local function lE(fO)if not fO.plugins then return pairs(fO.args)end;local lF,lG=next(fO.plugins)local ae;return function(aV,ad)while lG do ad,ae=next(lG,ad)if ad then return ad,ae end;if lG==fO.args then lG=nil else lF,lG=next(fO.plugins,lF)if not lF then lG=fO.args end end end end end;local function lH(cB,lo,fO)if fO.cmdHidden~=nil then return fO.cmdHidden end;local lI=fO.hidden;if type(lI)=="function"or type(lI)=="string"then cB.hidden=lI;lI=lr(cB,lo,fO,'hidden')cB.hidden=nil end;return lI end;local function lJ(cB,lo,fO,lx,lK)if not lK then print("|cff33ff99"..cB.appName.."|r: Arguments to |cffffff78/"..cB[0].."|r "..cX(cB.input,1,lo-1)..":")end;local je={}local lL={}for ad,ae in lE(fO)do if not lL[ad]then tinsert(je,ad)lL[ad]=ae end end;im(je,function(lM,lN)local lO=lL[lM].order or 100;local lP=lL[lN].order or 100;if type(lO)=="function"or type(lO)=="string"then cB.order=lO;cB[#cB+1]=lM;lO=lr(cB,lo,lL[lM],"order")cB[#cB]=nil;cB.order=nil end;if type(lP)=="function"or type(lO)=="string"then cB.order=lP;cB[#cB+1]=lN;lP=lr(cB,lo,lL[lN],"order")cB[#cB]=nil;cB.order=nil end;if lO<0 and lP<0 then return lO<lP end;if lP<0 then return true end;if lO<0 then return false end;if lO==lP then return tostring(lM)<tostring(lN)end;return lO<lP end)for M=1,#je do local ad=je[M]local ae=lL[ad]if not lH(cB,lo,ae)then if ae.type~="description"and ae.type~="header"then local aa,i6=ae.name,ae.desc;if type(aa)=="function"then aa=lt(cB,ae,'name')end;if type(i6)=="function"then i6=lt(cB,ae,'desc')end;if ae.type=="group"and ln(ae.cmdInline,ae.inline,false)then print("  "..(i6 or aa)..":")local lQ,lR=lw(cB,lo,ae,lx,"handler",lj,lk)lJ(cB,lo,ae,lx,true)cB.handler,cB.handler_at=lQ,lR else local o=ad:gsub(" ","_")print("  |cffffff78"..o.."|r - "..(i6 or aa or""))end end end end end;local function lS(fg)if fg==nil or fg=="NONE"then return nil end;fg=fg:upper()local lT,lU,lV;local lW;while true do if fg=="-"then break end;lW,fg=lg('-',fg,2)if fg then if lW~="SHIFT"and lW~="CTRL"and lW~="ALT"then return false end;if lW=="SHIFT"then if lT then return false end;lT=true end;if lW=="CTRL"then if lU then return false end;lU=true end;if lW=="ALT"then if lV then return false end;lV=true end else fg=lW;break end end;if fg==""then return false end;if not fg:find("^F%d+$")and fg~="CAPSLOCK"and fg:len()~=1 and(fg:byte()<128 or fg:len()>4)and not _G["KEY_"..fg]then return false end;local lX=fg;if lT then lX="SHIFT-"..lX end;if lU then lX="CTRL-"..lX end;if lV then lX="ALT-"..lX end;return lX end;local function aP(cB,lo,fO,lx,lY)if not(type(fO)=="table"and type(fO.type)=="string")then T(cB,lo)end;local lQ,lR=lw(cB,lo,fO,lx,"handler",lj,lk)local lZ,l_=lw(cB,lo,fO,lx,"set",ll,lm)local m0,m1=lw(cB,lo,fO,lx,"get",ll,lm)local m2,m3=lw(cB,lo,fO,lx,"func",ll,lm)local m4,m5=lw(cB,lo,fO,lx,"validate",ll,lm)if fO.type=="group"then if type(fO.args)~="table"then T(cB,lo)end;if fO.plugins and type(fO.plugins)~="table"then T(cB,lo)end;local aV,m6,L=cB.input:find(" *([^ ]+) *",lo)if not L then lJ(cB,lo,fO,lx)return end;m6=m6+1;for ad,ae in lE(fO)do if not(type(ad)=="string"and type(ae)=="table"and type(ae.type)=="string")then T(cB,lo,"options table child '"..tostring(ad).."' is malformed")end;if ae.type=="group"and ln(ae.cmdInline,ae.inline,false)then cB[lx+1]=ad;if aP(cB,lo,ae,lx+1,true)==false then cB[lx+1]=nil else return end elseif lh(L)==lh(ad:gsub(" ","_"))then cB[lx+1]=ad;return aP(cB,m6,ae,lx+1)end end;if lY then cB.handler,cB.handler_at=lQ,lR;cB.set,cB.set_at=lZ,l_;cB.get,cB.get_at=m0,m1;cB.func,cB.func_at=m2,m3;cB.validate,cB.validate_at=m4,m5;return false end;lq(cB,lo,"'"..L.."' - "..cr["unknown argument"])return end;local m7=cX(cB.input,lo)if fO.type=="execute"then lu(cB,lo,fO,"func")elseif fO.type=="input"then local lv=true;if fO.pattern then if type(fO.pattern)~="string"then T(cB,lo,"'pattern' - expected a string")end;if not kE(m7,fO.pattern)then lq(cB,lo,"'"..m7 .."' - "..cr["invalid input"])return end end;lu(cB,lo,fO,"set",m7)elseif fO.type=="toggle"then local ic;local d6=li(lh(m7))if d6==""then ic=lr(cB,lo,fO,"get")if fO.tristate then if ic then ic=nil elseif ic==nil then ic=false else ic=true end else ic=not ic end elseif d6==cr["on"]then ic=true elseif d6==cr["off"]then ic=false elseif fO.tristate and d6==cr["default"]then ic=nil else if fO.tristate then lq(cB,lo,bg(cr["'%s' - expected 'on', 'off' or 'default', or no argument to toggle."],d6))else lq(cB,lo,bg(cr["'%s' - expected 'on' or 'off', or no argument to toggle."],d6))end;return end;lu(cB,lo,fO,"set",ic)elseif fO.type=="range"then local e8=tonumber(m7)if not e8 then lq(cB,lo,"'"..m7 .."' - "..cr["expected number"])return end;if type(cB.step)=="number"then e8=e8-e8%cB.step end;if type(cB.min)=="number"and e8<cB.min then lq(cB,lo,e8 .." - "..bg(cr["must be equal to or higher than %s"],tostring(cB.min)))return end;if type(cB.max)=="number"and e8>cB.max then lq(cB,lo,e8 .." - "..bg(cr["must be equal to or lower than %s"],tostring(cB.max)))return end;lu(cB,lo,fO,"set",e8)elseif fO.type=="select"then local d6=li(lh(m7))local m8=fO.values;if type(m8)=="function"or type(m8)=="string"then cB.values=m8;m8=lr(cB,lo,fO,"values")cB.values=nil end;if d6==""then local ic=lr(cB,lo,fO,"get")local R="|cffffff78- [%s]|r %s"local m9="|cffffff78- [%s]|r %s |cffff0000*|r"print(cr["Options for |cffffff78"..cB[#cB].."|r:"])for ad,ae in pairs(m8)do if ic==ad then print(m9:format(ad,ae))else print(R:format(ad,ae))end end;return end;local ma;for ad,ae in pairs(m8)do if lh(ad)==d6 then d6=ad;ma=true;break end end;if not ma then lq(cB,lo,"'"..d6 .."' - "..cr["unknown selection"])return end;lu(cB,lo,fO,"set",d6)elseif fO.type=="multiselect"then local d6=li(lh(m7))local m8=fO.values;if type(m8)=="function"or type(m8)=="string"then cB.values=m8;m8=lr(cB,lo,fO,"values")cB.values=nil end;if d6==""then local R="|cffffff78- [%s]|r %s"local m9="|cffffff78- [%s]|r %s |cffff0000*|r"print(cr["Options for |cffffff78"..cB[#cB].."|r (multiple possible):"])for ad,ae in pairs(m8)do if lr(cB,lo,fO,"get",ad)then print(m9:format(ad,ae))else print(R:format(ad,ae))end end;return end;local mb={}for ae in d6:gmatch("[^ ]+")do local mc,e8=ae:match('(.+)=(.+)')if not mc then mc=ae end;local ma;for ad in pairs(m8)do if lh(ad)==mc then mc=ad;ma=true;break end end;if not ma then lq(cB,lo,"'"..mc.."' - "..cr["unknown selection"])return end;if e8 then if e8==cr["on"]or e8==cr["off"]or fO.tristate and e8==cr["default"]then mb[mc]=e8 else if fO.tristate then lq(cB,lo,bg(cr["'%s' '%s' - expected 'on', 'off' or 'default', or no argument to toggle."],ae,e8))else lq(cB,lo,bg(cr["'%s' '%s' - expected 'on' or 'off', or no argument to toggle."],ae,e8))end;return end else mb[mc]=true end end;for mc,e8 in pairs(mb)do local md;if e8==true then local ic=lr(cB,lo,fO,"get",mc)if fO.tristate then if ic then ic=nil elseif ic==nil then ic=false else ic=true end else ic=not ic end;md=ic else if e8==cr["on"]then md=true elseif e8==cr["off"]then md=false elseif e8==cr["default"]then md=nil end end;lu(cB,lo,fO,"set",mc,md)end elseif fO.type=="color"then local d6=li(lh(m7))if d6==""then return end;local ia,ib,ic,id;local me=fO.hasAlpha;if type(me)=="function"or type(me)=="string"then cB.hasAlpha=me;me=lr(cB,lo,fO,'hasAlpha')cB.hasAlpha=nil end;if me then if d6:len()==8 and d6:find("^%x*$")then ia,ib,ic,id=tonumber(d6:sub(1,2),16)/255,tonumber(d6:sub(3,4),16)/255,tonumber(d6:sub(5,6),16)/255,tonumber(d6:sub(7,8),16)/255 else ia,ib,ic,id=d6:match("^([%d%.]+) ([%d%.]+) ([%d%.]+) ([%d%.]+)$")ia,ib,ic,id=tonumber(ia),tonumber(ib),tonumber(ic),tonumber(id)end;if not(ia and ib and ic and id)then lq(cB,lo,bg(cr["'%s' - expected 'RRGGBBAA' or 'r g b a'."],d6))return end;if ia>=0.0 and ia<=1.0 and ib>=0.0 and ib<=1.0 and ic>=0.0 and ic<=1.0 and id>=0.0 and id<=1.0 then elseif ia>=0 and ia<=255 and ib>=0 and ib<=255 and ic>=0 and ic<=255 and id>=0 and id<=255 then ia=ia/255;ib=ib/255;ic=ic/255;id=id/255 else lq(cB,lo,bg(cr["'%s' - values must all be either in the range 0..1 or 0..255."],d6))end else id=1.0;if d6:len()==6 and d6:find("^%x*$")then ia,ib,ic=tonumber(d6:sub(1,2),16)/255,tonumber(d6:sub(3,4),16)/255,tonumber(d6:sub(5,6),16)/255 else ia,ib,ic=d6:match("^([%d%.]+) ([%d%.]+) ([%d%.]+)$")ia,ib,ic=tonumber(ia),tonumber(ib),tonumber(ic)end;if not(ia and ib and ic)then lq(cB,lo,bg(cr["'%s' - expected 'RRGGBB' or 'r g b'."],d6))return end;if ia>=0.0 and ia<=1.0 and ib>=0.0 and ib<=1.0 and ic>=0.0 and ic<=1.0 then elseif ia>=0 and ia<=255 and ib>=0 and ib<=255 and ic>=0 and ic<=255 then ia=ia/255;ib=ib/255;ic=ic/255 else lq(cB,lo,bg(cr["'%s' - values must all be either in the range 0-1 or 0-255."],d6))end end;lu(cB,lo,fO,"set",ia,ib,ic,id)elseif fO.type=="keybinding"then local d6=li(lh(m7))if d6==""then return end;local by=lS(d6:upper())if by==false then lq(cB,lo,bg(cr["'%s' - Invalid Keybinding."],d6))return end;lu(cB,lo,fO,"set",by)elseif fO.type=="description"then else T(cB,lo,"unknown options table item type '"..tostring(fO.type).."'")end end;function ld:HandleCommand(mf,l6,d3)local mg=lc:GetOptionsTable(l6)if not mg then error([[Usage: HandleCommand("slashcmd", "appName", "input"): 'appName' - no options table "]]..tostring(l6)..[[" has been registered]],2)end;local l2=assert(mg("cmd",i))local cB={[0]=mf,appName=l6,options=l2,input=d3,self=self,handler=self,uiType="cmd",uiName=i}aP(cB,1,l2,0)end;function ld:CreateChatCommand(mf,l6)if not cV then cV=LibStub(lf)end;if cV.RegisterChatCommand(self,mf,function(d3)ld.HandleCommand(self,mf,l6,d3)end,true)then le[mf]=l6 end end;function ld:GetChatCommandOptions(mf)return le[mf]end end;local function mh(...)local LibStub=LibStub;local mi=LibStub("AceGUI-3.0")local mj=LibStub("AceConfigRegistry-3.0")local i,k="AceConfigDialog-3.0",86;local mk,f=LibStub:NewLibrary(i,k)if not mk then return end;mk.OpenFrames=mk.OpenFrames or{}mk.Status=mk.Status or{}mk.frame=mk.frame or CreateFrame("Frame")mk.tooltip=mk.tooltip or CreateFrame("GameTooltip","AceConfigDialogTooltip",UIParent,"GameTooltipTemplate")mk.frame.apps=mk.frame.apps or{}mk.frame.closing=mk.frame.closing or{}mk.frame.closeAllOverride=mk.frame.closeAllOverride or{}local tinsert,im,Q,dg=table.insert,table.sort,table.remove,table.wipe;local kE,bg=string.match,string.format;local error=error;local pairs,next,select,type,unpack,ipairs=pairs,next,select,type,unpack,ipairs;local tostring,tonumber=tostring,tonumber;local di,dh,ml=math.min,math.max,math.floor;local mm={}local xpcall=xpcall;local function S(T)return geterrorhandler()(T)end;local function U(J,...)if J then return xpcall(J,S,...)end end;local mn=170;local aH,gw,mo;do local gx=setmetatable({},{__mode="k"})function aH()local aU=next(gx)if aU then gx[aU]=nil;return aU else return{}end end;function mo(aU)local jL=aH()for ad,ae in pairs(aU)do jL[ad]=ae end;return jL end;function gw(aU)dg(aU)gx[aU]=true end end;local function ln(...)for M=1,select("#",...)do if select(M,...)~=nil then return select(M,...)end end end;local function mp(eW,o)if eW.plugins then for l5,aU in pairs(eW.plugins)do if aU[o]then return aU[o]end end end;return eW.args[o]end;local mq={set=true,get=true,func=true,confirm=true,validate=true,disabled=true,hidden=true}local mr={name=true,desc=true,icon=true,usage=true,width=true,image=true,fontSize=true,tooltipHyperlink=true}local ms={type=true,descStyle=true,imageWidth=true,imageHeight=true}local function mt(mu,mv,l2,hj,l6,...)local mw=mq[mu]local mx;if mw then local eW=l2;if eW[mu]~=nil then mx=eW[mu]end;for M=1,#hj do eW=mp(eW,hj[M])if eW[mu]~=nil then mx=eW[mu]end end else mx=mv[mu]end;if not ms[mu]and(type(mx)=="function"or not mr[mu]and type(mx)=="string")then local cB=aH()local eW=l2;local bl=eW.handler;for M=1,#hj do eW=mp(eW,hj[M])cB[M]=hj[M]bl=eW.handler or bl end;cB.options=l2;cB.appName=l6;cB[0]=l6;cB.arg=mv.arg;cB.handler=bl;cB.option=mv;cB.type=mv.type;cB.uiType="dialog"cB.uiName=i;local id,ic,jL,my;if type(mx)=="function"then id,ic,jL,my=mx(cB,...)else if bl and bl[mx]then id,ic,jL,my=bl[mx](bl,cB,...)else error(bg("Method %s doesn't exist in handler for type %s",mx,mu))end end;gw(cB)return id,ic,jL,my else return mx end end;local mz;local mA;local function mB(id,ic)if not id then return true end;if not ic then return false end;local mC,mD=mz[id]or 100,mz[ic]or 100;if mC==mD then local mE=type(mA[id])=="string"and mA[id]or""local mF=type(mA[ic])=="string"and mA[ic]or""return mE:upper()<mF:upper()end;if mC<0 then if mD>=0 then return false end else if mD<0 then return true end end;return mC<mD end;local function mG(eW,mH,mI,l2,hj,l6)mz=aH()mA=aH()if eW.plugins then for l5,aU in pairs(eW.plugins)do for ad,ae in pairs(aU)do if not mI[ad]then tinsert(mH,ad)mI[ad]=ae;hj[#hj+1]=ad;mz[ad]=mt("order",ae,l2,hj,l6)mA[ad]=mt("name",ae,l2,hj,l6)hj[#hj]=nil end end end end;for ad,ae in pairs(eW.args)do if not mI[ad]then tinsert(mH,ad)mI[ad]=ae;hj[#hj+1]=ad;mz[ad]=mt("order",ae,l2,hj,l6)mA[ad]=mt("name",ae,l2,hj,l6)hj[#hj]=nil end end;im(mH,mB)gw(mz)gw(mA)end;local function mJ(gN)if gN.children then local mK=gN.children;for M=1,#mK do mJ(mK[M])gw(mK[M])end;gw(mK)end end;local function mL(dt,F)local mM=dt:GetUserDataTable()if mM.path then gw(mM.path)end;if dt.type=="TreeGroup"then local gN=mM.tree;dt:SetTree(nil)if gN then for M=1,#gN do mJ(gN[M])gw(gN[M])end;gw(gN)end end;if dt.type=="TabGroup"then dt:SetTabs(nil)if mM.tablist then gw(mM.tablist)end end;if dt.type=="DropdownGroup"then dt:SetGroupList(nil)if mM.grouplist then gw(mM.grouplist)end;if mM.orderlist then gw(mM.orderlist)end end end;function mk:GetStatusTable(l6,hj)local eX=self.Status;if not eX[l6]then eX[l6]={}eX[l6].status={}eX[l6].children={}end;eX=eX[l6]if hj then for M=1,#hj do local ae=hj[M]if not eX.children[ae]then eX.children[ae]={}eX.children[ae].status={}eX.children[ae].children={}end;eX=eX.children[ae]end end;return eX.status end;function mk:SelectGroup(l6,...)local hj=aH()local cT=mj:GetOptionsTable(l6)if not cT then error(("%s isn't registed with AceConfigRegistry, unable to open config"):format(l6),2)end;local l2=cT("dialog",i)local eW=l2;local eX=self:GetStatusTable(l6,hj)if not eX.groups then eX.groups={}end;eX=eX.groups;local mN;local mO;for d0=1,select("#",...)do local o=select(d0,...)if eW.childGroups=="tab"or eW.childGroups=="select"then eX.selected=o;mN=nil else if mN then mN=mN.."\001"..o else mN=o;if not eX.groups then eX.groups={}end;mO=eX end;mO.selected=mN;mO.groups[mN]=true end;eW=mp(eW,o)if not eW then break end;tinsert(hj,o)eX=self:GetStatusTable(l6,hj)if not eX.groups then eX.groups={}end;eX=eX.groups end;gw(hj)mj:NotifyChange(l6)end;local function mP(dt,F)local mM=dt:GetUserDataTable()local mc=mM.option;local l2=mM.options;local hj=mM.path;local l6=mM.appName;local gV=mk.tooltip;gV:SetOwner(dt.frame,"ANCHOR_TOPRIGHT")local mQ=mt("tooltipHyperlink",mc,l2,hj,l6)if mQ then gV:SetHyperlink(mQ)gV:Show()return end;local aa=mt("name",mc,l2,hj,l6)local i6=mt("desc",mc,l2,hj,l6)local bu=mt("usage",mc,l2,hj,l6)local mR=mc.descStyle;if mR and mR~="tooltip"then return end;gV:SetText(aa,1,.82,0,true)if mc.type=="multiselect"then gV:AddLine(mM.text,0.5,0.5,0.8,true)end;if type(i6)=="string"then gV:AddLine(i6,1,1,1,true)end;if type(bu)=="string"then gV:AddLine("Usage: "..bu,NORMAL_FONT_COLOR.r,NORMAL_FONT_COLOR.g,NORMAL_FONT_COLOR.b,true)end;gV:Show()end;local function mS(dt,F)mk.tooltip:Hide()end;local function mT(mv)if mv.type=="execute"then return"func"else return"set"end end;do local bx=mk.popup;if not bx or f<81 then bx=CreateFrame("Frame",nil,UIParent)mk.popup=bx;bx:Hide()bx:SetPoint("CENTER",UIParent,"CENTER")bx:SetSize(320,72)bx:EnableMouse(true)bx:SetFrameStrata("TOOLTIP")bx:SetFrameLevel(100)bx:SetScript("OnKeyDown",function(self,o)if o=="ESCAPE"then self:SetPropagateKeyboardInput(false)if self.cancel:IsShown()then self.cancel:Click()else self:Hide()end else self:SetPropagateKeyboardInput(true)end end)local f2=CreateFrame("Frame",nil,bx,"DialogBorderOpaqueTemplate")f2:SetAllPoints(bx)bx:SetFixedFrameStrata(true)bx:SetFixedFrameLevel(true)local fg=bx:CreateFontString(nil,"ARTWORK","GameFontHighlight")fg:SetSize(290,0)fg:SetPoint("TOP",0,-16)bx.text=fg;local function mU(mV)local gD=CreateFrame("Button",nil,bx)gD:SetSize(128,21)gD:SetNormalFontObject(GameFontNormal)gD:SetHighlightFontObject(GameFontHighlight)gD:SetNormalTexture(130763)gD:GetNormalTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gD:SetPushedTexture(130761)gD:GetPushedTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gD:SetHighlightTexture(130762)gD:GetHighlightTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gD:SetText(mV)return gD end;local mW=mU(ACCEPT)mW:SetPoint("BOTTOMRIGHT",bx,"BOTTOM",-6,16)bx.accept=mW;local eM=mU(CANCEL)eM:SetPoint("LEFT",mW,"RIGHT",13,0)bx.cancel=eM end end;local function mX(l6,mY,mZ,cB,b8,J,...)local bx=mk.popup;bx:Show()bx.text:SetText(b8)local dy=61+bx.text:GetHeight()bx:SetHeight(dy)bx.accept:ClearAllPoints()bx.accept:SetPoint("BOTTOMRIGHT",bx,"BOTTOM",-6,16)bx.cancel:Show()local aU={...}local m_=select("#",...)bx.accept:SetScript("OnClick",function(self)U(J,unpack(aU,1,m_))mk:Open(l6,mY,unpack(mZ or mm))bx:Hide()self:SetScript("OnClick",nil)bx.cancel:SetScript("OnClick",nil)gw(cB)end)bx.cancel:SetScript("OnClick",function(self)mk:Open(l6,mY,unpack(mZ or mm))bx:Hide()self:SetScript("OnClick",nil)bx.accept:SetScript("OnClick",nil)gw(cB)end)end;local function n0(b8)local bx=mk.popup;bx:Show()bx.text:SetText(b8)local dy=61+bx.text:GetHeight()bx:SetHeight(dy)bx.accept:ClearAllPoints()bx.accept:SetPoint("BOTTOM",bx,"BOTTOM",0,16)bx.cancel:Hide()bx.accept:SetScript("OnClick",function()bx:Hide()end)end;local function n1(dt,F,...)local mM=dt:GetUserDataTable()local mv=mM.option;local l2=mM.options;local hj=mM.path;local cB=aH()local J;local eW=l2;local n2=mT(mv)local bl;local n3;local l1;if eW[n2]~=nil then J=eW[n2]end;bl=eW.handler;n3=eW.confirm;l1=eW.validate;for M=1,#hj do local ae=hj[M]eW=mp(eW,ae)cB[M]=ae;if eW[n2]~=nil then J=eW[n2]end;bl=eW.handler or bl;if eW.confirm~=nil then n3=eW.confirm end;if eW.validate~=nil then l1=eW.validate end end;cB.options=l2;cB.appName=mM.appName;cB.arg=mv.arg;cB.handler=bl;cB.option=mv;cB.type=mv.type;cB.uiType="dialog"cB.uiName=i;local aa;if type(mv.name)=="function"then aa=mv.name(cB)elseif type(mv.name)=="string"then aa=mv.name else aa=""end;local bu=mv.usage;local n4=mv.pattern;local n5=true;if mv.type=="input"then if type(n4)=="string"then if not kE(...,n4)then n5=false end end end;local dv;if n5 and mv.type~="execute"then if type(l1)=="string"then if bl and bl[l1]then dv,n5=U(bl[l1],bl,cB,...)if not dv then n5=false end else error(bg("Method %s doesn't exist in handler for type execute",l1))end elseif type(l1)=="function"then dv,n5=U(l1,cB,...)if not dv then n5=false end end end;if not n5 or type(n5)=="string"then if not n5 then if bu then n5=aa..": "..bu else if n4 then n5=aa..": Expected "..n4 else n5=aa..": Invalid Value"end end end;if mM.rootframe.SetStatusText then mM.rootframe:SetStatusText(n5)else n0(n5)end;PlaySound(882)gw(cB)return true else local n6=mv.confirmText;if type(n3)=="string"then if bl and bl[n3]then dv,n3=U(bl[n3],bl,cB,...)if dv and type(n3)=="string"then n6=n3;n3=true elseif not dv then n3=false end else error(bg("Method %s doesn't exist in handler for type confirm",n3))end elseif type(n3)=="function"then dv,n3=U(n3,cB,...)if dv and type(n3)=="string"then n6=n3;n3=true elseif not dv then n3=false end end;if type(n3)=="boolean"then if n3 then if not n6 then local n7,i6=mv.name,mv.desc;if type(n7)=="function"then n7=n7(cB)end;if type(i6)=="function"then i6=i6(cB)end;n6=n7;if i6 then n6=n6 .." - "..i6 end end;local n8=mM.rootframe:GetUserData("iscustom")local mY;if n8 then mY=mM.rootframe end;local mZ=mM.rootframe:GetUserData("basepath")if type(J)=="string"then if bl and bl[J]then mX(mM.appName,mY,mZ,cB,n6,bl[J],bl,cB,...)else error(bg("Method %s doesn't exist in handler for type func",J))end elseif type(J)=="function"then mX(mM.appName,mY,mZ,cB,n6,J,cB,...)end;return end end;if type(J)=="string"then if bl and bl[J]then U(bl[J],bl,cB,...)else error(bg("Method %s doesn't exist in handler for type func",J))end elseif type(J)=="function"then U(J,cB,...)end;local n8=mM.rootframe:GetUserData("iscustom")local mZ=mM.rootframe:GetUserData("basepath")or mm;if mv.type=="color"then if F=="OnValueConfirmed"then if n8 then mk:Open(mM.appName,mM.rootframe,unpack(mZ))else mk:Open(mM.appName,unpack(mZ))end end elseif mv.type=="range"then if F=="OnMouseUp"then if n8 then mk:Open(mM.appName,mM.rootframe,unpack(mZ))else mk:Open(mM.appName,unpack(mZ))end end elseif mv.type=="multiselect"then mM.valuechanged=true else if n8 then mk:Open(mM.appName,mM.rootframe,unpack(mZ))else mk:Open(mM.appName,unpack(mZ))end end end;gw(cB)end;local function n9(dt,F,by)local mv=dt:GetUserData("option")local fv,cY,kx=mv.min or(not mv.softMin and 0 or nil),mv.max or(not mv.softMax and 100 or nil),mv.step;if fv then if kx then by=ml((by-fv)/kx+0.5)*kx+fv end;by=dh(by,fv)end;if cY then by=di(by,cY)end;n1(dt,F,by)end;local function na(dt,F,...)n1(dt,F,dt:GetUserData("value"),...)local mM=dt:GetUserDataTable()local n8=mM.rootframe:GetUserData("iscustom")local mZ=mM.rootframe:GetUserData("basepath")or mm;if n8 then mk:Open(mM.appName,mM.rootframe,unpack(mZ))else mk:Open(mM.appName,unpack(mZ))end end;local function nb(dt,F,...)local mM=dt:GetUserDataTable()if mM.valuechanged and not dt:IsReleasing()then local n8=mM.rootframe:GetUserData("iscustom")local mZ=mM.rootframe:GetUserData("basepath")or mm;if n8 then mk:Open(mM.appName,mM.rootframe,unpack(mZ))else mk:Open(mM.appName,unpack(mZ))end end end;local function nc(dt,F)local l6=dt:GetUserData("appName")mk.OpenFrames[l6]=nil;mi:Release(dt)end;local function nd(mv,l2,hj,l6)local lI=ln(mv.dialogHidden,mv.guiHidden)if lI~=nil then return lI end;return mt("hidden",mv,l2,hj,l6)end;local function ne(mv,l2,hj,l6)local gf=ln(mv.dialogDisabled,mv.guiDisabled)if gf~=nil then return gf end;return mt("disabled",mv,l2,hj,l6)end;local function nf(eW,l2,hj,l6)local h8=aH()local eZ=aH()local mH=aH()local mI=aH()mG(eW,mH,mI,l2,hj,l6)for M=1,#mH do local ad=mH[M]local ae=mI[ad]if ae.type=="group"then hj[#hj+1]=ad;local ng=ln(ae.dialogInline,ae.guiInline,ae.inline,false)local lI=nd(ae,l2,hj,l6)if not ng and not lI then h8[ad]=mt("name",ae,l2,hj,l6)tinsert(eZ,ad)end;hj[#hj]=nil end end;gw(mI)gw(mH)return h8,eZ end;local function nh(eW,gN,l2,hj,l6)local mH=aH()local mI=aH()mG(eW,mH,mI,l2,hj,l6)for M=1,#mH do local ad=mH[M]local ae=mI[ad]if ae.type=="group"then hj[#hj+1]=ad;local ng=ln(ae.dialogInline,ae.guiInline,ae.inline,false)local lI=nd(ae,l2,hj,l6)if not ng and not lI then local ni=aH()ni.value=ad;ni.text=mt("name",ae,l2,hj,l6)ni.icon=mt("icon",ae,l2,hj,l6)ni.iconCoords=mt("iconCoords",ae,l2,hj,l6)ni.disabled=ne(ae,l2,hj,l6)if not gN.children then gN.children=aH()end;tinsert(gN.children,ni)if(ae.childGroups or"tree")=="tree"then nh(ae,ni,l2,hj,l6)end end;hj[#hj]=nil end end;gw(mH)gw(mI)end;local function nj(eW,l2,hj,l6,nk)local gN=aH()local mH=aH()local mI=aH()mG(eW,mH,mI,l2,hj,l6)for M=1,#mH do local ad=mH[M]local ae=mI[ad]if ae.type=="group"then hj[#hj+1]=ad;local ng=ln(ae.dialogInline,ae.guiInline,ae.inline,false)local lI=nd(ae,l2,hj,l6)if not ng and not lI then local ni=aH()ni.value=ad;ni.text=mt("name",ae,l2,hj,l6)ni.icon=mt("icon",ae,l2,hj,l6)ni.iconCoords=mt("iconCoords",ae,l2,hj,l6)ni.disabled=ne(ae,l2,hj,l6)tinsert(gN,ni)if nk and(ae.childGroups or"tree")=="tree"then nh(ae,ni,l2,hj,l6)end end;hj[#hj]=nil end end;gw(mH)gw(mI)return gN end;local function nl(nm,l2,mv,hj,mY,l6)local mM=nm:GetUserDataTable()for M=1,#hj do mM[M]=hj[M]end;mM.rootframe=mY;mM.option=mv;mM.options=l2;mM.path=mo(hj)mM.appName=l6;nm:SetCallback("OnRelease",mL)nm:SetCallback("OnLeave",mS)nm:SetCallback("OnEnter",mP)end;local function nn(no,np)local nm;if no then nm=mi:Create(no)if not nm then geterrorhandler()(("Invalid Custom Control Type - %s"):format(tostring(no)))end end;if not nm then nm=mi:Create(np)end;return nm end;local function nq(x,y)return tostring(x)<tostring(y)end;local function nr(l6,l2,ns,mY,hj,eW,ng)local mH=aH()local mI=aH()mG(eW,mH,mI,l2,hj,l6)for M=1,#mH do local ad=mH[M]local ae=mI[ad]tinsert(hj,ad)local lI=nd(ae,l2,hj,l6)local aa=mt("name",ae,l2,hj,l6)if not lI then if ae.type=="group"then if ng or ln(ae.dialogInline,ae.guiInline,ae.inline,false)then local nt;if aa and aa~=""then nt=mi:Create("InlineGroup")nt:SetTitle(aa or"")else nt=mi:Create("SimpleGroup")end;nt.width="fill"nt:SetLayout("flow")ns:AddChild(nt)nr(l6,l2,nt,mY,hj,ae,true)end else local nm;if ae.type=="execute"then local nu=mt("imageCoords",ae,l2,hj,l6)local i7,dx,dy=mt("image",ae,l2,hj,l6)local nv=type(i7)=="string"or type(i7)=="number"nm=nn(ae.dialogControl or ae.control,nv and"Icon"or"Button")if nv then if not dx then dx=mt("imageWidth",ae,l2,hj,l6)end;if not dy then dy=mt("imageHeight",ae,l2,hj,l6)end;if type(nu)=="table"then nm:SetImage(i7,unpack(nu))else nm:SetImage(i7)end;if type(dx)~="number"then dx=32 end;if type(dy)~="number"then dy=32 end;nm:SetImageSize(dx,dy)nm:SetLabel(aa)else nm:SetText(aa)end;nm:SetCallback("OnClick",n1)elseif ae.type=="input"then nm=nn(ae.dialogControl or ae.control,ae.multiline and"MultiLineEditBox"or"EditBox")if ae.multiline and nm.SetNumLines then nm:SetNumLines(tonumber(ae.multiline)or 4)end;nm:SetLabel(aa)nm:SetCallback("OnEnterPressed",n1)local fg=mt("get",ae,l2,hj,l6)if type(fg)~="string"then fg=""end;nm:SetText(fg)elseif ae.type=="toggle"then nm=nn(ae.dialogControl or ae.control,"CheckBox")nm:SetLabel(aa)nm:SetTriState(ae.tristate)local by=mt("get",ae,l2,hj,l6)nm:SetValue(by)nm:SetCallback("OnValueChanged",n1)if ae.descStyle=="inline"then local i6=mt("desc",ae,l2,hj,l6)nm:SetDescription(i6)end;local i7=mt("image",ae,l2,hj,l6)local nu=mt("imageCoords",ae,l2,hj,l6)if type(i7)=="string"or type(i7)=="number"then if type(nu)=="table"then nm:SetImage(i7,unpack(nu))else nm:SetImage(i7)end end elseif ae.type=="range"then nm=nn(ae.dialogControl or ae.control,"Slider")nm:SetLabel(aa)nm:SetSliderValues(ae.softMin or ae.min or 0,ae.softMax or ae.max or 100,ae.bigStep or ae.step or 0)nm:SetIsPercent(ae.isPercent)local by=mt("get",ae,l2,hj,l6)if type(by)~="number"then by=0 end;nm:SetValue(by)nm:SetCallback("OnValueChanged",n9)nm:SetCallback("OnMouseUp",n9)elseif ae.type=="select"then local m8=mt("values",ae,l2,hj,l6)local nw=mt("sorting",ae,l2,hj,l6)if ae.style=="radio"then local gf=ne(ae,l2,hj,l6)local dx=mt("width",ae,l2,hj,l6)nm=mi:Create("InlineGroup")nm:SetLayout("Flow")nm:SetTitle(aa)nm.width="fill"nm:PauseLayout()local nx=mt("get",ae,l2,hj,l6)if not nw then nw={}for by,fg in pairs(m8)do nw[#nw+1]=by end;im(nw,nq)end;for aV,by in ipairs(nw)do local fg=m8[by]local ny=mi:Create("CheckBox")ny:SetLabel(fg)ny:SetUserData("value",by)ny:SetUserData("text",fg)ny:SetDisabled(gf)ny:SetType("radio")ny:SetValue(nx==by)ny:SetCallback("OnValueChanged",na)nl(ny,l2,ae,hj,mY,l6)nm:AddChild(ny)if dx=="double"then ny:SetWidth(mn*2)elseif dx=="half"then ny:SetWidth(mn/2)elseif type(dx)=="number"then ny:SetWidth(mn*dx)elseif dx=="full"then ny.width="fill"else ny:SetWidth(mn)end end;nm:ResumeLayout()nm:DoLayout()else nm=nn(ae.dialogControl or ae.control,"Dropdown")local ja=ae.itemControl;if ja and not mi:GetWidgetVersion(ja)then geterrorhandler()(("Invalid Custom Item Type - %s"):format(tostring(ja)))ja=nil end;nm:SetLabel(aa)nm:SetList(m8,nw,ja)local by=mt("get",ae,l2,hj,l6)if not m8[by]then by=nil end;nm:SetValue(by)nm:SetCallback("OnValueChanged",n1)end elseif ae.type=="multiselect"then local m8=mt("values",ae,l2,hj,l6)local gf=ne(ae,l2,hj,l6)local nz=aH()if m8 then for by,fg in pairs(m8)do tinsert(nz,by)end end;im(nz)local nA=ae.dialogControl or ae.control;if nA then nm=mi:Create(nA)if not nm then geterrorhandler()(("Invalid Custom Control Type - %s"):format(tostring(nA)))end end;if nm then nm:SetMultiselect(true)nm:SetLabel(aa)nm:SetList(m8)nm:SetDisabled(gf)nm:SetCallback("OnValueChanged",n1)nm:SetCallback("OnClosed",nb)local dx=mt("width",ae,l2,hj,l6)if dx=="double"then nm:SetWidth(mn*2)elseif dx=="half"then nm:SetWidth(mn/2)elseif type(dx)=="number"then nm:SetWidth(mn*dx)elseif dx=="full"then nm.width="fill"else nm:SetWidth(mn)end;for lX=1,#nz do local o=nz[lX]local by=mt("get",ae,l2,hj,l6,o)nm:SetItemValue(o,by)end else nm=mi:Create("InlineGroup")nm:SetLayout("Flow")nm:SetTitle(aa)nm.width="fill"nm:PauseLayout()local dx=mt("width",ae,l2,hj,l6)for lX=1,#nz do local by=nz[lX]local fg=m8[by]local i1=mi:Create("CheckBox")i1:SetLabel(fg)i1:SetUserData("value",by)i1:SetUserData("text",fg)i1:SetDisabled(gf)i1:SetTriState(ae.tristate)i1:SetValue(mt("get",ae,l2,hj,l6,by))i1:SetCallback("OnValueChanged",na)nl(i1,l2,ae,hj,mY,l6)nm:AddChild(i1)if dx=="double"then i1:SetWidth(mn*2)elseif dx=="half"then i1:SetWidth(mn/2)elseif type(dx)=="number"then i1:SetWidth(mn*dx)elseif dx=="full"then i1.width="fill"else i1:SetWidth(mn)end end;nm:ResumeLayout()nm:DoLayout()end;gw(nz)elseif ae.type=="color"then nm=nn(ae.dialogControl or ae.control,"ColorPicker")nm:SetLabel(aa)nm:SetHasAlpha(mt("hasAlpha",ae,l2,hj,l6))nm:SetColor(mt("get",ae,l2,hj,l6))nm:SetCallback("OnValueChanged",n1)nm:SetCallback("OnValueConfirmed",n1)elseif ae.type=="keybinding"then nm=nn(ae.dialogControl or ae.control,"Keybinding")nm:SetLabel(aa)nm:SetKey(mt("get",ae,l2,hj,l6))nm:SetCallback("OnKeyChanged",n1)elseif ae.type=="header"then nm=nn(ae.dialogControl or ae.control,"Heading")nm:SetText(aa)nm.width="fill"elseif ae.type=="description"then nm=nn(ae.dialogControl or ae.control,"Label")nm:SetText(aa)local nB=mt("fontSize",ae,l2,hj,l6)if nB=="medium"then nm:SetFontObject(GameFontHighlight)elseif nB=="large"then nm:SetFontObject(GameFontHighlightLarge)else nm:SetFontObject(GameFontHighlightSmall)end;local nu=mt("imageCoords",ae,l2,hj,l6)local i7,dx,dy=mt("image",ae,l2,hj,l6)if type(i7)=="string"or type(i7)=="number"then if not dx then dx=mt("imageWidth",ae,l2,hj,l6)end;if not dy then dy=mt("imageHeight",ae,l2,hj,l6)end;if type(nu)=="table"then nm:SetImage(i7,unpack(nu))else nm:SetImage(i7)end;if type(dx)~="number"then dx=32 end;if type(dy)~="number"then dy=32 end;nm:SetImageSize(dx,dy)end;local nC=mt("width",ae,l2,hj,l6)nm.width=not nC and"fill"end;if nm then if nm.width~="fill"then local dx=mt("width",ae,l2,hj,l6)if dx=="double"then nm:SetWidth(mn*2)elseif dx=="half"then nm:SetWidth(mn/2)elseif type(dx)=="number"then nm:SetWidth(mn*dx)elseif dx=="full"then nm.width="fill"else nm:SetWidth(mn)end end;if nm.SetDisabled then local gf=ne(ae,l2,hj,l6)nm:SetDisabled(gf)end;nl(nm,l2,ae,hj,mY,l6)ns:AddChild(nm)end end end;Q(hj)end;ns:ResumeLayout()ns:DoLayout()gw(mH)gw(mI)end;local function nD(hj,...)for M=1,select("#",...)do tinsert(hj,(select(M,...)))end end;local function nE(dt,F,gL,gD)local mM=dt:GetUserDataTable()if not mM then return end;local l2=mM.options;local mv=mM.option;local hj=mM.path;local l6=mM.appName;local gV=mk.tooltip;local nF=aH()for M=1,#hj do nF[M]=hj[M]end;nD(nF,("\001"):split(gL))local eW=l2;for M=1,#nF do if not eW then return end;eW=mp(eW,nF[M])end;local aa=mt("name",eW,l2,nF,l6)local i6=mt("desc",eW,l2,nF,l6)gV:SetOwner(gD,"ANCHOR_NONE")gV:ClearAllPoints()if dt.type=="TabGroup"then gV:SetPoint("BOTTOM",gD,"TOP")else gV:SetPoint("LEFT",gD,"RIGHT")end;gV:SetText(aa,1,.82,0,true)if type(i6)=="string"then gV:AddLine(i6,1,1,1,true)end;gV:Show()end;local function nG(dt,F,by,gD)mk.tooltip:Hide()end;local function nH(l6,l2,hj,gL)if not gL then return false end;local nF=aH()local nI=aH()for M=1,#hj do nF[M]=hj[M]end;nD(nF,("\001"):split(gL))local eW=l2;for M=1,#nF do local ae=nF[M]nI[M]=ae;eW=mp(eW,ae)if not eW or eW.type~="group"or nd(eW,l2,nI,l6)then gw(nF)gw(nI)return false end end;gw(nF)gw(nI)return true end;local function nJ(dt,F,gL)local mM=dt:GetUserDataTable()local l2=mM.options;local mv=mM.option;local hj=mM.path;local mY=mM.rootframe;local nF=aH()for M=1,#hj do nF[M]=hj[M]end;nD(nF,("\001"):split(gL))dt:ReleaseChildren()mk:FeedGroup(mM.appName,l2,dt,mY,nF)gw(nF)end;function mk:FeedGroup(l6,l2,ns,mY,hj,nK)local eW=l2;local ng;local nL,nM=l2.childGroups,"none"for M=1,#hj do local ae=hj[M]eW=mp(eW,ae)ng=ng or ln(ae.dialogInline,ae.guiInline,ae.inline,false)nM=nL;nL=eW.childGroups end;if not nM then nM="tree"end;local nN;for ad,ae in pairs(eW.args)do if ae.type=="group"and not ln(ae.dialogInline,ae.guiInline,ae.inline,false)and not nd(ae,l2,hj,l6)then nN=true end end;if eW.plugins then for l5,aU in pairs(eW.plugins)do for ad,ae in pairs(aU)do if ae.type=="group"and not ln(ae.dialogInline,ae.guiInline,ae.inline,false)and not nd(ae,l2,hj,l6)then nN=true end end end end;ns:SetLayout("flow")local nO;if not(nN and not ng)or nL~="tab"and nL~="select"and(nM=="tree"and not nK)then if ns.type~="InlineGroup"and ns.type~="SimpleGroup"then nO=mi:Create("ScrollFrame")nO:SetLayout("flow")nO.width="fill"nO.height="fill"ns:SetLayout("fill")ns:AddChild(nO)ns=nO end end;nr(l6,l2,ns,mY,hj,eW,nil)if nO then ns:PerformLayout()local eX=self:GetStatusTable(l6,hj)if not eX.scroll then eX.scroll={}end;nO:SetStatusTable(eX.scroll)end;if nN and not ng then local aa=mt("name",eW,l2,hj,l6)if nL=="tab"then local fO=mi:Create("TabGroup")nl(fO,l2,eW,hj,mY,l6)fO:SetCallback("OnGroupSelected",nJ)fO:SetCallback("OnTabEnter",nE)fO:SetCallback("OnTabLeave",nG)local eX=mk:GetStatusTable(l6,hj)if not eX.groups then eX.groups={}end;fO:SetStatusTable(eX.groups)fO.width="fill"fO.height="fill"local gn=nj(eW,l2,hj,l6)fO:SetTabs(gn)fO:SetUserData("tablist",gn)for M=1,#gn do local ni=gn[M]if not ni.disabled then fO:SelectTab(nH(l6,l2,hj,eX.groups.selected)and eX.groups.selected or ni.value)break end end;ns:AddChild(fO)elseif nL=="select"then local nP=mi:Create("DropdownGroup")nP:SetTitle(aa)nl(nP,l2,eW,hj,mY,l6)nP:SetCallback("OnGroupSelected",nJ)local eX=mk:GetStatusTable(l6,hj)if not eX.groups then eX.groups={}end;nP:SetStatusTable(eX.groups)local nQ,nR=nf(eW,l2,hj,l6)nP:SetGroupList(nQ,nR)nP:SetUserData("grouplist",nQ)nP:SetUserData("orderlist",nR)local nS=nR[1]if nS then nP:SetGroup(nH(l6,l2,hj,eX.groups.selected)and eX.groups.selected or nS)end;nP.width="fill"nP.height="fill"ns:AddChild(nP)elseif nM~="tree"or nK then local gN=mi:Create("TreeGroup")nl(gN,l2,eW,hj,mY,l6)gN:EnableButtonTooltips(false)gN.width="fill"gN.height="fill"gN:SetCallback("OnGroupSelected",nJ)gN:SetCallback("OnButtonEnter",nE)gN:SetCallback("OnButtonLeave",nG)local eX=mk:GetStatusTable(l6,hj)if not eX.groups then eX.groups={}end;local nT=nj(eW,l2,hj,l6,true)gN:SetStatusTable(eX.groups)gN:SetTree(nT)gN:SetUserData("tree",nT)for M=1,#nT do local ni=nT[M]if not ni.disabled then gN:SelectByValue(nH(l6,l2,hj,eX.groups.selected)and eX.groups.selected or ni.value)break end end;ns:AddChild(gN)end end end;local nU;local function nV(ay)for l6 in pairs(ay.closing)do if mk.OpenFrames[l6]then mk.OpenFrames[l6]:Hide()end;if mk.BlizOptions and mk.BlizOptions[l6]then for o,dt in pairs(mk.BlizOptions[l6])do if not dt:IsVisible()then dt:ReleaseChildren()end end end;ay.closing[l6]=nil end;if ay.closeAll then for ad,ae in pairs(mk.OpenFrames)do if not ay.closeAllOverride[ad]then ae:Hide()end end;ay.closeAll=nil;dg(ay.closeAllOverride)end;for l6 in pairs(ay.apps)do if mk.OpenFrames[l6]then local mM=mk.OpenFrames[l6]:GetUserDataTable()mk:Open(l6,unpack(mM.basepath or mm))end;if mk.BlizOptions and mk.BlizOptions[l6]then for o,dt in pairs(mk.BlizOptions[l6])do local mM=dt:GetUserDataTable()if dt:IsVisible()then mk:Open(dt:GetUserData("appName"),dt,unpack(mM.basepath or mm))end end end;ay.apps[l6]=nil end;ay:SetScript("OnUpdate",nil)end;if mk.frame:GetScript("OnUpdate")then mk.frame:SetScript("OnUpdate",nV)end;function mk:CloseAll()mk.frame.closeAll=true;mk.frame:SetScript("OnUpdate",nV)if next(self.OpenFrames)then return true end end;function mk:Close(l6)if self.OpenFrames[l6]then mk.frame.closing[l6]=true;mk.frame:SetScript("OnUpdate",nV)return true end end;function mk:ConfigTableChanged(F,l6)mk.frame.apps[l6]=true;mk.frame:SetScript("OnUpdate",nV)end;mj.RegisterCallback(mk,"ConfigTableChange","ConfigTableChanged")function mk:SetDefaultSize(l6,dx,dy)local eX=mk:GetStatusTable(l6)if type(dx)=="number"and type(dy)=="number"then eX.width=dx;eX.height=dy end end;function mk:Open(l6,ns,...)if not nU then nU=CloseSpecialWindows;CloseSpecialWindows=function()local gm=nU()return self:CloseAll()or gm end end;local cT=mj:GetOptionsTable(l6)if not cT then error(("%s isn't registed with AceConfigRegistry, unable to open config"):format(l6),2)end;local l2=cT("dialog",i)local ev;local hj=aH()local aa=mt("name",l2,l2,hj,l6)if type(ns)=="string"then tinsert(hj,ns)ns=nil end;for d0=1,select("#",...)do tinsert(hj,(select(d0,...)))end;local mv=l2;if type(ns)=="table"and ns.type=="BlizOptionsGroup"and#hj>0 then for M=1,#hj do mv=l2.args[hj[M]]end;aa=bg("%s - %s",aa,mt("name",mv,l2,hj,l6))end;if ns then ev=ns;ev:ReleaseChildren()ev:SetUserData("appName",l6)ev:SetUserData("iscustom",true)if#hj>0 then ev:SetUserData("basepath",mo(hj))end;local eX=mk:GetStatusTable(l6)if not eX.width then eX.width=700 end;if not eX.height then eX.height=500 end;if ev.SetStatusTable then ev:SetStatusTable(eX)end;if ev.SetTitle then ev:SetTitle(aa or"")end else if not self.OpenFrames[l6]then ev=mi:Create("Frame")self.OpenFrames[l6]=ev else ev=self.OpenFrames[l6]end;ev:ReleaseChildren()ev:SetCallback("OnClose",nc)ev:SetUserData("appName",l6)if#hj>0 then ev:SetUserData("basepath",mo(hj))end;ev:SetTitle(aa or"")local eX=mk:GetStatusTable(l6)ev:SetStatusTable(eX)end;self:FeedGroup(l6,l2,ev,ev,hj,true)if ev.Show then ev:Show()end;gw(hj)if mk.frame.closeAll then mk.frame.closeAllOverride[l6]=true end end;if f and f<39 and mk.BlizOptions then local lB=mk.BlizOptions;local nW={}for o,dt in pairs(lB)do local l6=dt:GetUserData("appName")if not nW[l6]then nW[l6]={}end;nW[l6][o]=dt end;mk.BlizOptions=nW else mk.BlizOptions=mk.BlizOptions or{}end;local function nX(dt,F)local hj=dt:GetUserData("path")mk:Open(dt:GetUserData("appName"),dt,unpack(hj or mm))end;local function nY(dt,F)local l6=dt:GetUserData("appName")mk.frame.closing[l6]=true;mk.frame:SetScript("OnUpdate",nV)end;function mk:AddToBlizOptions(l6,aa,cd,...)local nZ=mk.BlizOptions;local o=l6;for d0=1,select("#",...)do o=o.."\001"..select(d0,...)end;if not nZ[l6]then nZ[l6]={}end;if not nZ[l6][o]then local eW=mi:Create("BlizOptionsGroup")nZ[l6][o]=eW;eW:SetTitle(aa or l6)eW:SetUserData("appName",l6)if select("#",...)>0 then local hj={}for d0=1,select("#",...)do tinsert(hj,(select(d0,...)))end;eW:SetUserData("path",hj)end;eW:SetCallback("OnShow",nX)eW:SetCallback("OnHide",nY)if Settings and Settings.RegisterCanvasLayoutCategory then local n_=aa or l6;if cd then local o0=Settings.GetCategory(cd)if not o0 then error(("The parent category '%s' was not found"):format(cd),2)end;local o1=Settings.RegisterCanvasLayoutSubcategory(o0,eW.frame,n_)eW:SetName(o1.ID,cd)else local o0=Settings.RegisterCanvasLayoutCategory(eW.frame,n_)o0.ID=n_;eW:SetName(n_,cd)Settings.RegisterAddOnCategory(o0)end else eW:SetName(aa or l6,cd)InterfaceOptions_AddCategory(eW.frame)end;return eW.frame,eW.frame.name else error(("%s has already been added to the Blizzard Options Window with the given path"):format(l6),2)end end end;local function o2(...)local lc=LibStub("AceConfigRegistry-3.0")local o3=LibStub("AceConfigCmd-3.0")local i,k="AceConfig-3.0",3;local o4=LibStub:NewLibrary(i,k)if not o4 then return end;local pcall,error,type,pairs=pcall,error,type,pairs;function o4:RegisterOptionsTable(l6,l2,mf)local ma,jX=pcall(lc.RegisterOptionsTable,self,l6,l2)if not ma then error(jX,2)end;if mf then if type(mf)=="table"then for aV,o5 in pairs(mf)do o3:CreateChatCommand(o5,l6)end else o3:CreateChatCommand(mf,l6)end end end end;local function o6(...)local o7=24;local _G=_G;if _G.ChatThrottleLib then if _G.ChatThrottleLib.version>=o7 then return elseif not _G.ChatThrottleLib.securelyHooked then print("ChatThrottleLib: Warning: There's an ANCIENT ChatThrottleLib.lua (pre-wow 2.0, <v16) in an addon somewhere. Get the addon updated or copy in a newer ChatThrottleLib.lua (>=v16) in it!")_G.SendChatMessage=_G.ChatThrottleLib.ORIG_SendChatMessage;if _G.ChatThrottleLib.ORIG_SendAddonMessage then _G.SendAddonMessage=_G.ChatThrottleLib.ORIG_SendAddonMessage end end;_G.ChatThrottleLib.ORIG_SendChatMessage=nil;_G.ChatThrottleLib.ORIG_SendAddonMessage=nil end;if not _G.ChatThrottleLib then _G.ChatThrottleLib={}end;ChatThrottleLib=_G.ChatThrottleLib;local ChatThrottleLib=_G.ChatThrottleLib;ChatThrottleLib.version=o7;ChatThrottleLib.MAX_CPS=800;ChatThrottleLib.MSG_OVERHEAD=40;ChatThrottleLib.BURST=4000;ChatThrottleLib.MIN_FPS=20;local setmetatable=setmetatable;local o8=table.remove;local tostring=tostring;local GetTime=GetTime;local di=math.min;local dh=math.max;local next=next;local o9=string.len;local GetFramerate=GetFramerate;local lh=string.lower;local unpack,type,pairs,dg=unpack,type,pairs,table.wipe;local UnitInRaid,UnitInParty=UnitInRaid,UnitInParty;local oa={}local ob={__index=oa}function oa:New()local dw={}setmetatable(dw,ob)return dw end;function oa:Add(bq)if self.pos then bq.prev=self.pos.prev;bq.prev.next=bq;bq.next=self.pos;bq.next.prev=bq else bq.next=bq;bq.prev=bq;self.pos=bq end end;function oa:Remove(bq)bq.next.prev=bq.prev;bq.prev.next=bq.next;if self.pos==bq then self.pos=bq.next;if self.pos==bq then self.pos=nil end end end;ChatThrottleLib.PipeBin=nil;local oc=setmetatable({},{__mode="k"})local function od(oe)oc[oe]=true end;local function of()local oe=next(oc)if oe then dg(oe)oc[oe]=nil;return oe end;return{}end;ChatThrottleLib.MsgBin=nil;local og=setmetatable({},{__mode="k"})local function oh(jX)jX[1]=nil;og[jX]=true end;local function oi()local jX=next(og)if jX then og[jX]=nil;return jX end;return{}end;function ChatThrottleLib:Init()if not self.Prio then self.Prio={}self.Prio["ALERT"]={ByName={},Ring=oa:New(),avail=0}self.Prio["NORMAL"]={ByName={},Ring=oa:New(),avail=0}self.Prio["BULK"]={ByName={},Ring=oa:New(),avail=0}end;for aV,oj in pairs(self.Prio)do oj.nTotalSent=oj.nTotalSent or 0 end;if not self.avail then self.avail=0 end;if not self.nTotalSent then self.nTotalSent=0 end;if not self.Frame then self.Frame=CreateFrame("Frame")self.Frame:Hide()end;self.Frame:SetScript("OnUpdate",self.OnUpdate)self.Frame:SetScript("OnEvent",self.OnEvent)self.Frame:RegisterEvent("PLAYER_ENTERING_WORLD")self.OnUpdateDelay=0;self.LastAvailUpdate=GetTime()self.HardThrottlingBeginTime=GetTime()if not self.securelyHooked then self.securelyHooked=true;hooksecurefunc("SendChatMessage",function(...)return ChatThrottleLib.Hook_SendChatMessage(...)end)if _G.C_ChatInfo then hooksecurefunc(_G.C_ChatInfo,"SendAddonMessage",function(...)return ChatThrottleLib.Hook_SendAddonMessage(...)end)else hooksecurefunc("SendAddonMessage",function(...)return ChatThrottleLib.Hook_SendAddonMessage(...)end)end end;self.nBypass=0 end;local ok=false;function ChatThrottleLib.Hook_SendChatMessage(fg,ol,om,on,...)if ok then return end;local self=ChatThrottleLib;local i5=o9(tostring(fg or""))+o9(tostring(on or""))+self.MSG_OVERHEAD;self.avail=self.avail-i5;self.nBypass=self.nBypass+i5 end;function ChatThrottleLib.Hook_SendAddonMessage(oo,fg,ol,on,...)if ok then return end;local self=ChatThrottleLib;local i5=tostring(fg or""):len()+tostring(oo or""):len()i5=i5+tostring(on or""):len()+self.MSG_OVERHEAD;self.avail=self.avail-i5;self.nBypass=self.nBypass+i5 end;function ChatThrottleLib:UpdateAvail()local op=GetTime()local oq=self.MAX_CPS;local os=oq*(op-self.LastAvailUpdate)local ot=self.avail;if op-self.HardThrottlingBeginTime<5 then ot=di(ot+os*0.1,oq*0.5)self.bChoking=true elseif GetFramerate()<self.MIN_FPS then ot=di(oq,ot+os*0.5)self.bChoking=true else ot=di(self.BURST,ot+os)self.bChoking=false end;ot=dh(ot,0-oq*2)self.avail=ot;self.LastAvailUpdate=op;return ot end;function ChatThrottleLib:Despool(oj)local ou=oj.Ring;while ou.pos and oj.avail>ou.pos[1].nSize do local jX=o8(ou.pos,1)if not ou.pos[1]then local oe=oj.Ring.pos;oj.Ring:Remove(oe)oj.ByName[oe.name]=nil;od(oe)else oj.Ring.pos=oj.Ring.pos.next end;local ov=false;local ow=lh(jX[3]or"")if ow=="raid"and not UnitInRaid("player")then elseif ow=="party"and not UnitInParty("player")then else oj.avail=oj.avail-jX.nSize;ok=true;jX.f(unpack(jX,1,jX.n))ok=false;oj.nTotalSent=oj.nTotalSent+jX.nSize;oh(jX)ov=true end;if jX.callbackFn then jX.callbackFn(jX.callbackArg,ov)end end end;function ChatThrottleLib.OnEvent(ay,F)local self=ChatThrottleLib;if F=="PLAYER_ENTERING_WORLD"then self.HardThrottlingBeginTime=GetTime()self.avail=0 end end;function ChatThrottleLib.OnUpdate(ay,aJ)local self=ChatThrottleLib;self.OnUpdateDelay=self.OnUpdateDelay+aJ;if self.OnUpdateDelay<0.08 then return end;self.OnUpdateDelay=0;self:UpdateAvail()if self.avail<0 then return end;local d0=0;for ox,oj in pairs(self.Prio)do if oj.Ring.pos or oj.avail<0 then d0=d0+1 end end;if d0<1 then for ox,oj in pairs(self.Prio)do self.avail=self.avail+oj.avail;oj.avail=0 end;self.bQueueing=false;self.Frame:Hide()return end;local ot=self.avail/d0;self.avail=0;for ox,oj in pairs(self.Prio)do if oj.Ring.pos or oj.avail<0 then oj.avail=oj.avail+ot;if oj.Ring.pos and oj.avail>oj.Ring.pos[1].nSize then self:Despool(oj)end end end end;function ChatThrottleLib:Enqueue(ox,oy,jX)local oj=self.Prio[ox]local oe=oj.ByName[oy]if not oe then self.Frame:Show()oe=of()oe.name=oy;oj.ByName[oy]=oe;oj.Ring:Add(oe)end;oe[#oe+1]=jX;self.bQueueing=true end;function ChatThrottleLib:SendChatMessage(oz,oo,fg,ol,om,on,oA,oB,oC)if not self or not oz or not oo or not fg or not self.Prio[oz]then error('Usage: ChatThrottleLib:SendChatMessage("{BULK||NORMAL||ALERT}", "prefix", "text"[, "chattype"[, "language"[, "destination"]]]',2)end;if oB and type(oB)~="function"then error('ChatThrottleLib:ChatMessage(): callbackFn: expected function, got '..type(oB),2)end;local oD=fg:len()if oD>255 then error("ChatThrottleLib:SendChatMessage(): message length cannot exceed 255 bytes",2)end;oD=oD+self.MSG_OVERHEAD;if not self.bQueueing and oD<self:UpdateAvail()then self.avail=self.avail-oD;ok=true;_G.SendChatMessage(fg,ol,om,on)ok=false;self.Prio[oz].nTotalSent=self.Prio[oz].nTotalSent+oD;if oB then oB(oC,true)end;return end;local jX=oi()jX.f=_G.SendChatMessage;jX[1]=fg;jX[2]=ol or"SAY"jX[3]=om;jX[4]=on;jX.n=4;jX.nSize=oD;jX.callbackFn=oB;jX.callbackArg=oC;self:Enqueue(oz,oA or oo..(ol or"SAY")..(on or""),jX)end;function ChatThrottleLib:SendAddonMessage(oz,oo,fg,ol,u,oA,oB,oC)if not self or not oz or not oo or not fg or not ol or not self.Prio[oz]then error('Usage: ChatThrottleLib:SendAddonMessage("{BULK||NORMAL||ALERT}", "prefix", "text", "chattype"[, "target"])',2)end;if oB and type(oB)~="function"then error('ChatThrottleLib:SendAddonMessage(): callbackFn: expected function, got '..type(oB),2)end;local oD=fg:len()if C_ChatInfo or RegisterAddonMessagePrefix then if oD>255 then error("ChatThrottleLib:SendAddonMessage(): message length cannot exceed 255 bytes",2)end else oD=oD+oo:len()+1;if oD>255 then error("ChatThrottleLib:SendAddonMessage(): prefix + message length cannot exceed 254 bytes",2)end end;oD=oD+self.MSG_OVERHEAD;if not self.bQueueing and oD<self:UpdateAvail()then self.avail=self.avail-oD;ok=true;if _G.C_ChatInfo then _G.C_ChatInfo.SendAddonMessage(oo,fg,ol,u)else _G.SendAddonMessage(oo,fg,ol,u)end;ok=false;self.Prio[oz].nTotalSent=self.Prio[oz].nTotalSent+oD;if oB then oB(oC,true)end;return end;local jX=oi()jX.f=_G.C_ChatInfo and _G.C_ChatInfo.SendAddonMessage or _G.SendAddonMessage;jX[1]=oo;jX[2]=fg;jX[3]=ol;jX[4]=u;jX.n=u~=nil and 4 or 3;jX.nSize=oD;jX.callbackFn=oB;jX.callbackArg=oC;self:Enqueue(oz,oA or oo..ol..(u or""),jX)end;ChatThrottleLib:Init()end;local function oE(...)local l=LibStub("CallbackHandler-1.0")local oF=assert(ChatThrottleLib,"AceComm-3.0 requires ChatThrottleLib")local i,k="AceComm-3.0",12;local oG,f=LibStub:NewLibrary(i,k)if not oG then return end;local type,next,pairs,tostring=type,next,pairs,tostring;local cX,cW=string.sub,string.find;local oH=string.match;local tinsert,P=table.insert,table.concat;local error,assert=error,assert;local Ambiguate=Ambiguate;oG.embeds=oG.embeds or{}local oI="\001"local oJ="\002"local oK="\003"local oL="\004"oG.multipart_origprefixes=nil;oG.multipart_reassemblers=nil;oG.multipart_spool=oG.multipart_spool or{}function oG:RegisterComm(oo,s)if s==nil then s="OnCommReceived"end;if#oo>16 then error("AceComm:RegisterComm(prefix,method): prefix length is limited to 16 characters")end;if C_ChatInfo then C_ChatInfo.RegisterAddonMessagePrefix(oo)else RegisterAddonMessagePrefix(oo)end;return oG._RegisterComm(self,oo,s)end;local oM=false;function oG:SendCommMessage(oo,fg,oN,u,oz,oB,oC)oz=oz or"NORMAL"if not(type(oo)=="string"and type(fg)=="string"and type(oN)=="string"and(u==nil or type(u)=="string"or type(u)=="number")and(oz=="BULK"or oz=="NORMAL"or oz=="ALERT"))then error('Usage: SendCommMessage(addon, "prefix", "text", "distribution"[, "target"[, "prio"[, callbackFn, callbackarg]]])',2)end;local oO=#fg;local oP=255;local oA=oo..oN..(u or"")local oQ=nil;if oB then oQ=function(oR)return oB(oC,oR,oO)end end;local oS;if oH(fg,"^[\001-\009]")then if oO+1>oP then oS=true else fg="\004"..fg end end;if not oS and oO<=oP then oF:SendAddonMessage(oz,oo,fg,oN,u,oA,oQ,oO)else oP=oP-1;local oT=cX(fg,1,oP)oF:SendAddonMessage(oz,oo,oI..oT,oN,u,oA,oQ,oP)local d9=1+oP;while d9+oP<=oO do oT=cX(fg,d9,d9+oP-1)oF:SendAddonMessage(oz,oo,oJ..oT,oN,u,oA,oQ,d9+oP-1)d9=d9+oP end;oT=cX(fg,d9)oF:SendAddonMessage(oz,oo,oK..oT,oN,u,oA,oQ,oO)end end;do local oU=setmetatable({},{__mode="k"})local function aH()local aU=next(oU)if aU then oU[aU]=nil;for M=#aU,3,-1 do aU[M]=nil end;return aU end;return{}end;local function oV(oo,oW,oX)DEFAULT_CHAT_FRAME:AddMessage(i..": Warning: lost network data regarding '"..tostring(oo).."' from '"..tostring(oW).."' (in "..oX..")")end;function oG:OnReceiveMultipartFirst(oo,b8,oN,oW)local o=oo.."\t"..oN.."\t"..oW;local oY=oG.multipart_spool;oY[o]=b8 end;function oG:OnReceiveMultipartNext(oo,b8,oN,oW)local o=oo.."\t"..oN.."\t"..oW;local oY=oG.multipart_spool;local oZ=oY[o]if not oZ then return end;if type(oZ)~="table"then local aU=aH()aU[1]=oZ;aU[2]=b8;oY[o]=aU else tinsert(oZ,b8)end end;function oG:OnReceiveMultipartLast(oo,b8,oN,oW)local o=oo.."\t"..oN.."\t"..oW;local oY=oG.multipart_spool;local oZ=oY[o]if not oZ then return end;oY[o]=nil;if type(oZ)=="table"then tinsert(oZ,b8)oG.callbacks:Fire(oo,P(oZ,""),oN,oW)oU[oZ]=true else oG.callbacks:Fire(oo,oZ..b8,oN,oW)end end end;if not oG.callbacks then oG.callbacks=l:New(oG,"_RegisterComm","UnregisterComm","UnregisterAllComm")end;oG.callbacks.OnUsed=nil;oG.callbacks.OnUnused=nil;local function o_(self,F,oo,b8,oN,oW)if F=="CHAT_MSG_ADDON"then oW=Ambiguate(oW,"none")local nm,p0=oH(b8,"^([\001-\009])(.*)")if nm then if nm==oI then oG:OnReceiveMultipartFirst(oo,p0,oN,oW)elseif nm==oJ then oG:OnReceiveMultipartNext(oo,p0,oN,oW)elseif nm==oK then oG:OnReceiveMultipartLast(oo,p0,oN,oW)elseif nm==oL then oG.callbacks:Fire(oo,p0,oN,oW)else end else oG.callbacks:Fire(oo,b8,oN,oW)end else assert(false,"Received "..tostring(F).." event?!")end end;oG.frame=oG.frame or CreateFrame("Frame","AceComm30Frame")oG.frame:SetScript("OnEvent",o_)oG.frame:UnregisterAllEvents()oG.frame:RegisterEvent("CHAT_MSG_ADDON")local aq={"RegisterComm","UnregisterComm","UnregisterAllComm","SendCommMessage"}function oG:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;function oG:OnEmbedDisable(u)u:UnregisterAllComm()end;for u,ae in pairs(oG.embeds)do oG:Embed(u)end end;local function p1(...)local p2,p3='AceTab-3.0',9;local p4,f=LibStub:NewLibrary(p2,p3)if not p4 then return end;p4.registry=p4.registry or{}local _G=_G;local pairs=pairs;local ipairs=ipairs;local type=type;local C=p4.registry;local cW=string.find;local cX=string.sub;local lh=string.lower;local p5=string.format;local kE=string.match;local function p6(...)DEFAULT_CHAT_FRAME:AddMessage(p5(...))end;local function p7(ay,p8)return cX(ay:GetText(),p8 or 1,ay:GetCursorPosition())end;local function p9(ev)if ev.hookedByAceTab3 then return end;ev.hookedByAceTab3=true;if ev==ChatEdit_GetActiveWindow()then local pa=ChatEdit_CustomTabPressed;function ChatEdit_CustomTabPressed(...)if p4:OnTabPressed(ev)then return pa(...)else return true end end else local pb=ev:GetScript('OnTabPressed')if type(pb)~='function'then pb=function()end end;ev:SetScript('OnTabPressed',function(...)if p4:OnTabPressed(ev)then return pb(...)end end)end;ev.at3curMatch=0;ev.at3matches={}end;local pc,pd={},{}local pe={}function p4:RegisterTabCompletion(pf,pg,ph,pi,pj,pk,pl)if type(pf)~='string'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'descriptor' - string expected.",3)end;if pg and type(pg)~='string'and type(pg)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'prematches' - string, table, or nil expected.",3)end;if type(ph)~='function'and type(ph)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'wordlist' - function or table expected.",3)end;if pi and type(pi)~='function'and type(pi)~='boolean'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'usagefunc' - function or boolean expected.",3)end;if pj and type(pj)~='string'and type(pj)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'listenframes' - string or table expected.",3)end;if pk and type(pk)~='function'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'postfunc' - function expected.",3)end;if pl and type(pl)~='boolean'and type(pl)~='number'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'pmoverwrite' - boolean or number expected.",3)end;local pm;if type(pg)=='table'then pm=pg;pd[pf]=true else pm={}if not pg then pm[1]=""pc[pf]=true elseif type(pg)=='string'then pm[1]=pg;if pg==""then pc[pf]=true else pd[pf]=true end end end;if not pj then pj={}for M=1,NUM_CHAT_WINDOWS do pj[M]=_G["ChatFrame"..M.."EditBox"]end elseif type(pj)~='table'or type(pj[0])=='userdata'and type(pj.IsObjectType)=='function'then pj={pj}end;for aV,ev in pairs(pj)do if type(ev)=='string'then ev=_G[ev]end;if type(ev)~='table'or type(ev[0])~='userdata'or type(ev.IsObjectType)~='function'then error(p5(p2 ..": Cannot register frame %q; it does not exist",ev:GetName()))end;if ev then if ev:GetObjectType()~='EditBox'then error(p5(p2 ..": Cannot register frame %q; it is not an EditBox",ev:GetName()))else p9(ev)end end end;if not C[pf]then C[pf]={prematches=pm,wordlist=ph,usagefunc=pi,listenframes=pj,postfunc=pk,pmoverwrite=pl}end end;function p4:IsTabCompletionRegistered(pf)return C and C[pf]end;function p4:UnregisterTabCompletion(pf)C[pf]=nil;pe[pf]=nil;pc[pf]=nil;pd[pf]=nil end;local function pn(po,pp)if not po and not pp then return end;if not po then po=pp end;if not pp then pp=po end;if#pp<#po then po,pp=pp,po end;if cW(lh(pp),"^"..lh(po))then return po else return pn(cX(po,1,-2),pp)end end;local pq;local pr,ps,pt,pu;local function pv(ay)ps=0;pt=false;for i6,pw in pairs(ay.at3matches)do for px,py in pairs(pw)do ps=ps+1;if ps==ay.at3curMatch then ay.at3lastMatch=px;ay.at3lastWord=py;ay.at3curMatch=ps+1;pt=true;break end end;if pt then break end end;if not pt then ay.at3lastMatch=ay.at3origMatch;ay.at3lastWord=ay.at3origWord;ay.at3curMatch=1 end;ay:HighlightText(ay.at3matchStart-1,pq)ay:Insert(ay.at3lastWord or'')ay.at3_last_precursor=p7(ay)or''end;local IsSecureCmd=IsSecureCmd;local pz={}local pA=0;local pB,pC,pD,pE,bu;local pF,pG,pH;local pI,pJ,pK,pL,pM,pN,ni;local function pO(ay,i6,pP)ni=C[i6]for aV,ev in ipairs(ni.listenframes)do if ev==ay then for aV,pQ in ipairs(ni.prematches)do if pP then pQ="%s"end;pI,pJ,pK=nil,1,''pN,pM,pL=nil,nil,nil;while true do pI,pJ,pK=cW(pF,"("..pQ..")",pJ)if pI then pL,pM,pN=pI,pJ,pK;pJ=pJ+1 else break end end;if not pL and pP then pL,pM,pN=0,0,''end;if pL then pH=cX(pF,pM+1)pe[i6]=ni.pmoverwrite==true and#pN or ni.pmoverwrite or 0;ay.at3matchStart=pM+1-(pe[i6]or 0)local ph=ni.wordlist;local pR=type(ph)=='table'and ph or{}if type(ph)=='function'then ph(pR,pG,pM+1,pH)end;if pR~=false then local pS=ay.at3matches[i6]or{}for M in pairs(pS)do pS[M]=nil end;for aV,px in ipairs(pR)do if cW(lh(px),lh(pH),1,1)==1 then pC=pC or not pP;pS[px]=ni.postfunc and ni.postfunc(px,pM+1,pG)or px;pA=pA+1;if pA==1 then pB=pS[px]end end end;ay.at3matches[i6]=pA>0 and pS or nil end end end end end end;function p4:OnTabPressed(ay)if ay:GetText()==''then return true end;if ay==ChatEdit_GetActiveWindow()then local d1=ay:GetText()if cW(d1,"^/[%a%d_]+$")then return true end;local o5=kE(d1,"^/[%a%d_]+")if o5 and IsSecureCmd(o5)then return true end end;pq=ay:GetCursorPosition()pG=ay:GetText()pF=p7(ay)or''ay.at3lastMatch=ay.at3curMatch>0 and(ay.at3lastMatch or ay.at3origWord)if pF==ay.at3_last_precursor then return pv(ay)else for M in pairs(ay.at3matches)do ay.at3matches[M]=nil end;ay.at3curMatch=0;ay.at3origWord=nil;ay.at3origMatch=nil;ay.at3lastWord=nil;ay.at3lastMatch=nil;ay.at3_last_precursor=pF end;pA=0;pB=nil;pC=false;for M in pairs(pe)do pe[M]=nil end;for i6 in pairs(pd)do pO(ay,i6)end;if not pC then for i6 in pairs(pc)do pO(ay,i6,true)end end;if not pB then ay.at3_last_precursor="\0"return true end;if pA==1 then ay:HighlightText(ay.at3matchStart-1,pq)ay:Insert(pB)ay:Insert(" ")else pD=nil;for i6,pS in pairs(ay.at3matches)do if pC and pc[i6]then break end;DEFAULT_CHAT_FRAME:AddMessage(i6 ..":")local pi=C[i6].usagefunc;if not pi then for px,pT in pairs(pS)do DEFAULT_CHAT_FRAME:AddMessage(pT)pD=pn(pD,px)end else if type(pi)=='function'then for M in pairs(pz)do pz[M]=nil end;pE=nil;for px in pairs(pS)do pE=pn(pE,px)end;pD=pn(pD,pE)bu=pi(pz,pS,pE,cX(pF,1,pM))if type(bu)=='string'then DEFAULT_CHAT_FRAME:AddMessage(bu)elseif next(pz)and pA>0 then for px,pT in pairs(pS)do if pz[px]then DEFAULT_CHAT_FRAME:AddMessage(p5("%s - %s",pT,pz[px]))end end end end end;if next(pS)then ay.at3curMatch=1;ay.at3origWord=cX(pF,ay.at3matchStart,ay.at3matchStart+pe[i6]-1)..pD or""ay.at3origMatch=pD or""ay.at3lastWord=ay.at3origWord;ay.at3lastMatch=ay.at3origMatch;ay:HighlightText(ay.at3matchStart-1,pq)ay:Insert(ay.at3origWord)ay.at3_last_precursor=p7(ay)or''end end end end end;local function pU(...)local i,k="AceSerializer-3.0",5;local pV,f=LibStub:NewLibrary(i,k)if not pV then return end;local pW,pX,pY,pZ,bg=string.byte,string.char,string.gsub,string.gmatch,string.format;local assert,error,pcall=assert,error,pcall;local type,tostring,tonumber=type,tostring,tonumber;local pairs,select,p_=pairs,select,math.frexp;local P=table.concat;local q0=math.huge;local q1;local q2,q3="1.#INF","inf"local q4,q5="-1.#INF","-inf"local function q6(db)local d0=pW(db)if d0==30 then return"\126\122"elseif d0<=32 then return"\126"..pX(d0+64)elseif d0==94 then return"\126\125"elseif d0==126 then return"\126\124"elseif d0==127 then return"\126\123"else assert(false)end end;local function q7(ae,lv,q8)local aU=type(ae)if aU=="string"then lv[q8+1]="^S"lv[q8+2]=pY(ae,"[%c \94\126\127]",q6)q8=q8+2 elseif aU=="number"then local d6=tostring(ae)if tonumber(d6)==ae then lv[q8+1]="^N"lv[q8+2]=d6;q8=q8+2 elseif ae==q0 or ae==-q0 then lv[q8+1]="^N"lv[q8+2]=ae==q0 and q2 or q4;q8=q8+2 else local px,b7=p_(ae)lv[q8+1]="^F"lv[q8+2]=bg("%.0f",px*2^53)lv[q8+3]="^f"lv[q8+4]=tostring(b7-53)q8=q8+4 end elseif aU=="table"then q8=q8+1;lv[q8]="^T"for o,by in pairs(ae)do q8=q7(o,lv,q8)q8=q7(by,lv,q8)end;q8=q8+1;lv[q8]="^t"elseif aU=="boolean"then q8=q8+1;if ae then lv[q8]="^B"else lv[q8]="^b"end elseif aU=="nil"then q8=q8+1;lv[q8]="^Z"else error(i..": Cannot serialize a value of type '"..aU.."'")end;return q8 end;local q9={"^1"}function pV:Serialize(...)local q8=1;for M=1,select("#",...)do local ae=select(M,...)q8=q7(ae,q9,q8)end;q9[q8+1]="^^"return P(q9,"",1,q8+1)end;local function qa(qb)if qb<"~\122"then return pX(pW(qb,2,2)-64)elseif qb=="~\122"then return"\030"elseif qb=="~\123"then return"\127"elseif qb=="~\124"then return"\126"elseif qb=="~\125"then return"\94"end;error("DeserializeStringHelper got called for '"..qb.."'?!?")end;local function qc(qd)if qd==q4 or qd==q5 then return-q0 elseif qd==q2 or qd==q3 then return q0 else return tonumber(qd)end end;local function qe(qf,qg,qh,qi)if not qg then qh,qi=qf()end;if not qh then error("Supplied data misses AceSerializer terminator ('^^')")end;if qh=="^^"then return end;local lv;if qh=="^S"then lv=pY(qi,"~.",qa)elseif qh=="^N"then lv=qc(qi)if not lv then error("Invalid serialized number: '"..tostring(qi).."'")end elseif qh=="^F"then local qj,b7=qf()if qj~="^f"then error("Invalid serialized floating-point number, expected '^f', not '"..tostring(qj).."'")end;local px=tonumber(qi)b7=tonumber(b7)if not(px and b7)then error("Invalid serialized floating-point number, expected mantissa and exponent, got '"..tostring(px).."' and '"..tostring(b7).."'")end;lv=px*2^b7 elseif qh=="^B"then lv=true elseif qh=="^b"then lv=false elseif qh=="^Z"then lv=nil elseif qh=="^T"then lv={}local ad,ae;while true do qh,qi=qf()if qh=="^t"then break end;ad=qe(qf,true,qh,qi)if ad==nil then error("Invalid AceSerializer table format (no table end marker)")end;qh,qi=qf()ae=qe(qf,true,qh,qi)if ae==nil then error("Invalid AceSerializer table format (no table end marker)")end;lv[ad]=ae end else error("Invalid AceSerializer control code '"..qh.."'")end;if not qg then return lv,qe(qf)else return lv end end;function pV:Deserialize(d6)d6=pY(d6,"[%c ]","")local qf=pZ(d6,"(^.)([^^]*)")local qh,qi=qf()if not qh or qh~="^1"then return false,"Supplied data is not AceSerializer data (rev 1)"end;return pcall(qe,qf)end;pV.internals={SerializeValue=q7,SerializeStringHelper=q6}local aq={"Serialize","Deserialize"}pV.embeds=pV.embeds or{}function pV:Embed(u)for ad,ae in pairs(aq)do u[ae]=self[ae]end;self.embeds[u]=true;return u end;for u,ae in pairs(pV.embeds)do pV:Embed(u)end end;local function qk(...)BINDING_HEADER_ACE3="Ace3"BINDING_NAME_RELOADUI="ReloadUI"local mi=LibStub("AceGUI-3.0")local mj=LibStub("AceConfigRegistry-3.0")local ql=LibStub("AceConfigDialog-3.0")Ace3=LibStub("AceAddon-3.0"):NewAddon("Ace3","AceConsole-3.0")local Ace3=Ace3;local qm;local bx;local select;local eX={}local qn={}local function hr()mi:Release(bx)bx=nil end;local function qo()for aa in mj:IterateOptionsTables()do qn[aa]=aa end end;local function qp(dt,F,by)qm=by;ql:Open(by,dt)end;local nU;function Ace3:Open()if not nU then nU=CloseSpecialWindows;CloseSpecialWindows=function()local gm=nU()if bx then bx:Hide()return true end;return gm end end;qo()if next(qn)==nil then self:Print("No Configs are Registered")return end;if not bx then bx=mi:Create("Frame")bx:ReleaseChildren()bx:SetTitle("Ace3 Options")bx:SetLayout("FILL")bx:SetCallback("OnClose",hr)select=mi:Create("DropdownGroup")select:SetGroupList(qn)select:SetCallback("OnGroupSelected",qp)bx:AddChild(select)end;if not qm then qm=next(qn)end;select:SetGroup(qm)bx:Show()end;local function nV(ay)select:SetGroup(qm)ay:SetScript("OnUpdate",nil)end;function Ace3:ConfigTableChanged(F,l6)if qm==l6 and bx then bx.frame:SetScript("OnUpdate",nV)end end;mj.RegisterCallback(Ace3,"ConfigTableChange","ConfigTableChanged")function Ace3:PrintCmd(d3)d3=d3:trim():match("^(.-);*$")local J,T=loadstring("LibStub(\"AceConsole-3.0\"):Print("..d3 ..")")if not J then LibStub("AceConsole-3.0"):Print("Error: "..T)else J()end end;function Ace3:OnInitialize()self:RegisterChatCommand("ace3",function()self:Open()end)self:RegisterChatCommand("rl",function()ReloadUI()end)self:RegisterChatCommand("print","PrintCmd")end end;local function qq(...)function __DUMPMACRO(qr)end;local i,k="ScrollingTable",tonumber("@project-timestamp@")or 40300;local ah,f=LibStub:NewLibrary(i,k)if not ah then return end;do ah.SORT_ASC=1;ah.SORT_DSC=2;local qs={["r"]=1.0,["g"]=1.0,["b"]=1.0,["a"]=1.0}local qt={["r"]=1.0,["g"]=0.9,["b"]=0.0,["a"]=0.5}local qu={["r"]=0.0,["g"]=0.0,["b"]=0.0,["a"]=0.0}local qv=2.5;local qw={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local qx=function(self)self.frame:SetHeight(self.displayRows*self.rowHeight+10)self:Refresh()end;local qy=function(self)local dx=13;for fE,col in pairs(self.cols)do dx=dx+(col.width and col.width or 10)end;self.frame:SetWidth(dx+20)self:Refresh()end;local function qz(self,bx,qA)if not bx.highlight then bx.highlight=bx:CreateTexture(nil,"OVERLAY")bx.highlight:SetAllPoints(bx)end;bx.highlight:SetColorTexture(qA.r,qA.g,qA.b,qA.a)end;local qB=function(self,bx,F,bl,...)if not bl(...)then if self.DefaultEvents[F]then self.DefaultEvents[F](...)end end end;local function qC(self,B,qD)local table=self;for M,row in ipairs(self.rows)do for j,col in ipairs(row.cols)do if qD and self.events then for F,bl in pairs(self.events)do col:SetScript(F,nil)end end;for F,bl in pairs(B)do col:SetScript(F,function(qE,...)local qF=table.filtered[M+table.offset]table:FireUserEvent(col,F,bl,row,qE,table.data,table.cols,M,qF,j,table,...)end)end end end;for j,col in ipairs(self.head.cols)do if qD and self.events then for F,bl in pairs(self.events)do col:SetScript(F,nil)end end;for F,bl in pairs(B)do col:SetScript(F,function(qE,...)table:FireUserEvent(col,F,bl,self.head,qE,table.data,table.cols,nil,nil,j,table,...)end)end end;self.events=B end;local function qG(self,fE,qH)local table=self;self.displayRows=fE;self.rowHeight=qH;if not self.rows then self.rows={}end;for M=1,fE do local row=self.rows[M]if not row then row=CreateFrame("Button",self.frame:GetName().."Row"..M,self.frame)self.rows[M]=row;if M>1 then row:SetPoint("TOPLEFT",self.rows[M-1],"BOTTOMLEFT",0,0)row:SetPoint("TOPRIGHT",self.rows[M-1],"BOTTOMRIGHT",0,0)else row:SetPoint("TOPLEFT",self.frame,"TOPLEFT",4,-5)row:SetPoint("TOPRIGHT",self.frame,"TOPRIGHT",-4,-5)end;row:SetHeight(qH)end;if not row.cols then row.cols={}end;for j=1,#self.cols do local col=row.cols[j]if not col then col=CreateFrame("Button",row:GetName().."col"..j,row)col.text=row:CreateFontString(col:GetName().."text","OVERLAY","GameFontHighlightSmall")row.cols[j]=col;local eC=self.cols[j].align or"LEFT"col.text:SetJustifyH(eC)col:EnableMouse(true)col:RegisterForClicks("AnyUp")if self.events then for F,bl in pairs(self.events)do col:SetScript(F,function(qE,...)if table.offset then local qF=table.filtered[M+table.offset]table:FireUserEvent(col,F,bl,row,qE,table.data,table.cols,M,qF,j,table,...)end end)end end end;if j>1 then col:SetPoint("LEFT",row.cols[j-1],"RIGHT",0,0)else col:SetPoint("LEFT",row,"LEFT",2,0)end;col:SetHeight(qH)col:SetWidth(self.cols[j].width)col.text:SetPoint("TOP",col,"TOP",0,0)col.text:SetPoint("BOTTOM",col,"BOTTOM",0,0)col.text:SetWidth(self.cols[j].width-2*qv)end;j=#self.cols+1;col=row.cols[j]while col do col:Hide()j=j+1;col=row.cols[j]end end;for M=fE+1,#self.rows do self.rows[M]:Hide()end;self:SetHeight()end;local function qI(self,ef)local table=self;self.cols=ef;local row=self.head;if not row then row=CreateFrame("Frame",self.frame:GetName().."Head",self.frame)row:SetPoint("BOTTOMLEFT",self.frame,"TOPLEFT",4,0)row:SetPoint("BOTTOMRIGHT",self.frame,"TOPRIGHT",-4,0)row:SetHeight(self.rowHeight)row.cols={}self.head=row end;for M=1,#ef do if type(ef[M].defaultsort)=="string"then if ef[M].defaultsort:lower()=="asc"then ef[M].defaultsort=ah.SORT_DSC elseif ef[M].defaultsort:lower()=="dsc"then ef[M].defaultsort=ah.SORT_ASC else ef[M].defaultsort=nil end end;if type(ef[M].sort)=="string"then if ef[M].sort:lower()=="asc"then ef[M].sort=ah.SORT_DSC elseif ef[M].sort:lower()=="dsc"then ef[M].sort=ah.SORT_ASC else ef[M].sort=nil end end;local qJ=row:GetName().."Col"..M;local col=getglobal(qJ)if not col then col=CreateFrame("Button",qJ,row)col:RegisterForClicks("AnyUp")if self.events then for F,bl in pairs(self.events)do col:SetScript(F,function(qE,...)table:FireUserEvent(col,F,bl,row,qE,table.data,table.cols,nil,nil,M,table,...)end)end end end;row.cols[M]=col;local qK=col:GetFontString()or col:CreateFontString(col:GetName().."fs","OVERLAY","GameFontHighlightSmall")qK:SetAllPoints(col)qK:SetPoint("LEFT",col,"LEFT",qv,0)qK:SetPoint("RIGHT",col,"RIGHT",-qv,0)local eC=ef[M].align or"LEFT"qK:SetJustifyH(eC)col:SetFontString(qK)qK:SetText(ef[M].name)qK:SetTextColor(0,1.0,1.0,1.0)col:SetPushedTextOffset(0,0)if M>1 then col:SetPoint("LEFT",row.cols[M-1],"RIGHT",0,0)else col:SetPoint("LEFT",row,"LEFT",2,0)end;col:SetHeight(self.rowHeight)col:SetWidth(ef[M].width)local qA=ef[M].bgcolor;if qA then local qL="col"..M.."bg"local qM=self.frame[qL]if not qM then qM=self.frame:CreateTexture(nil,"OVERLAY")self.frame[qL]=qM end;qM:SetPoint("BOTTOM",self.frame,"BOTTOM",0,4)qM:SetPoint("TOPLEFT",col,"BOTTOMLEFT",0,-4)qM:SetPoint("TOPRIGHT",col,"BOTTOMRIGHT",0,-4)qM:SetColorTexture(qA.r,qA.g,qA.b,qA.a)end end;self:SetDisplayRows(self.displayRows,self.rowHeight)self:SetWidth()end;local function hD(self)self.frame:Show()self.scrollframe:Show()self.showing=true end;local function hC(self)self.frame:Hide()self.showing=false end;local function qN(self)if not self.sorttable or#self.sorttable~=#self.data then self.sorttable={}end;if#self.sorttable~=#self.data then for M=1,#self.data do self.sorttable[M]=M end end;local M,qO=1,nil;while M<=#self.cols and not qO do if self.cols[M].sort then qO=M end;M=M+1 end;if qO then table.sort(self.sorttable,function(qP,qQ)local qR=self.cols[qO]if qR.comparesort then return qR.comparesort(self,qP,qQ,qO)else return self:CompareSort(qP,qQ,qO)end end)end;self.filtered=self:DoFilter()self:Refresh()end;local qS=function(d6)if d6==""then return 0 else return tonumber(d6)end end;local function qT(self,qP,qQ,qU)local qV,qW=self:GetCell(qP,qU),self:GetCell(qQ,qU)local qX,qY=qV,qW;if type(qX)=='table'then qX=qX.value end;if type(qY)=='table'then qY=qY.value end;local qR=self.cols[qU]if type(qX)=="function"then if qV.args then qX=qX(unpack(qV.args))else qX=qX(self.data,self.cols,qP,qU,self)end end;if type(qY)=="function"then if qW.args then qY=qY(unpack(qW.args))else qY=qY(self.data,self.cols,qQ,qU,self)end end;if type(qX)~=type(qY)then local qZ,q_=type(qX),type(qY)if qZ=="number"and q_=="string"then if tonumber(qY)then qY=qS(qY)else qX=tostring(qX)end elseif qZ=="string"and q_=="number"then if tonumber(qX)then qX=qS(qX)else qY=tostring(qY)end end end;if qX==qY then if qR.sortnext then local r0=self.cols[qR.sortnext]if not r0.sort then if r0.comparesort then return r0.comparesort(self,qP,qQ,qR.sortnext)else return self:CompareSort(qP,qQ,qR.sortnext)end else return false end else return false end else local jT=qR.sort or qR.defaultsort or ah.SORT_DSC;if jT==ah.SORT_ASC then return qX<qY else return qX>qY end end end;local r1=function(self,r2)return true end;local function r3(self,r1)self.Filter=r1;self:SortData()end;local r4=function(self)local gO={}for row=1,#self.data do local r5=self.sorttable[row]local r6=self:GetRow(r5)if self:Filter(r6)then table.insert(gO,r5)end end;return gO end;function GetDefaultHighlightBlank(self)return self.defaulthighlightblank end;function SetDefaultHighlightBlank(self,r7,r8,r9,ra)if not self.defaulthighlightblank then self.defaulthighlightblank=qu end;if r7 then self.defaulthighlightblank["r"]=r7 end;if r8 then self.defaulthighlightblank["g"]=r8 end;if r9 then self.defaulthighlightblank["b"]=r9 end;if ra then self.defaulthighlightblank["a"]=ra end end;function GetDefaultHighlight(self)return self.defaulthighlight end;function SetDefaultHighlight(self,r7,r8,r9,ra)if not self.defaulthighlight then self.defaulthighlight=qt end;if r7 then self.defaulthighlight["r"]=r7 end;if r8 then self.defaulthighlight["g"]=r8 end;if r9 then self.defaulthighlight["b"]=r9 end;if ra then self.defaulthighlight["a"]=ra end end;local function rb(self,rc)self.fSelect=rc end;local function rd(self)self:SetSelection(nil)end;local function re(self,r5)self.selected=r5;self:Refresh()end;local function rf(self)return self.selected end;local function rg(rh,qE,qi,ef,row,r5,qR,ri,table,...)if ri then local r2=table:GetRow(r5)local rj=table:GetCell(r2,qR)local rk=rj;if type(rj)=="table"then rk=rj.value end;if type(rk)=="function"then if rj.args then qE.text:SetText(rk(unpack(rj.args)))else qE.text:SetText(rk(qi,ef,r5,qR,table))end else qE.text:SetText(rk)end;local qA=nil;if type(rj)=="table"then qA=rj.color end;local rl=nil;if not qA then qA=ef[qR].color;if not qA then qA=r2.color;if not qA then qA=qs else rl=r2.colorargs end else rl=ef[qR].colorargs end else rl=rj.colorargs end;if type(qA)=="function"then if rl then qA=qA(unpack(rl))else qA=qA(qi,ef,r5,qR,table)end end;qE.text:SetTextColor(qA.r,qA.g,qA.b,qA.a)local i4=nil;if type(rj)=="table"then i4=rj.highlight end;if table.fSelect then if table.selected==r5 then table:SetHighLightColor(rh,i4 or ef[qR].highlight or r2.highlight or table:GetDefaultHighlight())else table:SetHighLightColor(rh,table:GetDefaultHighlightBlank())end end else qE.text:SetText("")end end;local function rm(self,qi,rn)self.isMinimalDataformat=rn;self.data=qi;self:SortData()end;local function ro(self,r5)return self.data[r5]end;local function rp(self,row,col)local r2=row;if type(row)=="number"then r2=self:GetRow(row)end;if self.isMinimalDataformat then return r2[col]else return r2.cols[col]end end;local function rq(self,r5)local rr=1+(self.offset or 0)local rs=rr+self.displayRows-1;for M=rr,rs do if self.filtered[M]==r5 and r5~=nil then return true end end;return false end;function ah:CreateST(ef,rt,qH,i4,cd)local ru={}self.framecount=self.framecount or 1;local ev=CreateFrame("Frame","ScrollTable"..self.framecount,cd or UIParent,BackdropTemplateMixin and"BackdropTemplate")self.framecount=self.framecount+1;ru.showing=true;ru.frame=ev;ru.Show=hD;ru.Hide=hC;ru.SetDisplayRows=qG;ru.SetRowHeight=SetRowHeight;ru.SetHeight=qx;ru.SetWidth=qy;ru.SetDisplayCols=qI;ru.SetData=rm;ru.SortData=qN;ru.CompareSort=qT;ru.RegisterEvents=qC;ru.FireUserEvent=qB;ru.SetDefaultHighlightBlank=SetDefaultHighlightBlank;ru.SetDefaultHighlight=SetDefaultHighlight;ru.GetDefaultHighlightBlank=GetDefaultHighlightBlank;ru.GetDefaultHighlight=GetDefaultHighlight;ru.EnableSelection=rb;ru.SetHighLightColor=qz;ru.ClearSelection=rd;ru.SetSelection=re;ru.GetSelection=rf;ru.GetCell=rp;ru.GetRow=ro;ru.DoCellUpdate=rg;ru.IsRowVisible=rq;ru.RowIsVisible=rq;ru.SetFilter=r3;ru.DoFilter=r4;i4=i4 or{}ru:SetDefaultHighlight(i4["r"],i4["g"],i4["b"],i4["a"])ru:SetDefaultHighlightBlank()ru.displayRows=rt or 12;ru.rowHeight=qH or 15;ru.cols=ef;ru.DefaultEvents={["OnEnter"]=function(rh,qE,qi,ef,row,r5,qR,table,...)if row and r5 then local r2=table:GetRow(r5)local rj=table:GetCell(r2,qR)local i4=nil;if type(rj)=="table"then i4=rj.highlight end;table:SetHighLightColor(rh,i4 or ef[qR].highlight or r2.highlight or table:GetDefaultHighlight())end;return true end,["OnLeave"]=function(rh,qE,qi,ef,row,r5,qR,table,...)if row and r5 then local r2=table:GetRow(r5)local rj=table:GetCell(r2,qR)if r5~=table.selected or not table.fSelect then table:SetHighLightColor(rh,table:GetDefaultHighlightBlank())end end;return true end,["OnClick"]=function(rh,qE,qi,ef,row,r5,qR,table,gD,...)if gD=="LeftButton"then if not(row or r5)then for M,col in ipairs(ru.cols)do if M~=qR then ef[M].sort=nil end end;local rv=ah.SORT_DSC;if not ef[qR].sort and ef[qR].defaultsort then rv=ef[qR].defaultsort elseif ef[qR].sort and ef[qR].sort==ah.SORT_DSC then rv=ah.SORT_ASC end;ef[qR].sort=rv;table:SortData()else if table:GetSelection()==r5 then table:ClearSelection()else table:SetSelection(r5)end end;return true end end}ru.data={}ev:SetBackdrop(qw)ev:SetBackdropColor(0.1,0.1,0.1)ev:SetPoint("CENTER",cd or UIParent,"CENTER",0,0)local fF=CreateFrame("ScrollFrame",ev:GetName().."ScrollFrame",ev,"FauxScrollFrameTemplate")ru.scrollframe=fF;fF:Show()fF:SetScript("OnHide",function(self,...)self:Show()end)fF:SetPoint("TOPLEFT",ev,"TOPLEFT",0,-4)fF:SetPoint("BOTTOMRIGHT",ev,"BOTTOMRIGHT",-26,3)local rw=CreateFrame("Frame",ev:GetName().."ScrollTrough",fF)rw:SetWidth(17)rw:SetPoint("TOPRIGHT",ev,"TOPRIGHT",-4,-3)rw:SetPoint("BOTTOMRIGHT",ev,"BOTTOMRIGHT",-4,4)rw.background=rw:CreateTexture(nil,"BACKGROUND")rw.background:SetAllPoints(rw)rw.background:SetColorTexture(0.05,0.05,0.05,1.0)local rx=CreateFrame("Frame",ev:GetName().."ScrollTroughBorder",fF)rx:SetWidth(1)rx:SetPoint("TOPRIGHT",rw,"TOPLEFT")rx:SetPoint("BOTTOMRIGHT",rw,"BOTTOMLEFT")rx.background=rw:CreateTexture(nil,"BACKGROUND")rx.background:SetAllPoints(rx)rx.background:SetColorTexture(0.5,0.5,0.5,1.0)ru.Refresh=function(self)FauxScrollFrame_Update(fF,#ru.filtered,ru.displayRows,ru.rowHeight)local ry=FauxScrollFrame_GetOffset(fF)ru.offset=ry;for M=1,ru.displayRows do local row=M+ry;if ru.rows then local rh=ru.rows[M]local r5=ru.filtered[row]local r6=ru:GetRow(r5)local ri=true;for col=1,#ru.cols do local qE=rh.cols[col]local rz=ru.DoCellUpdate;if r6 then ru.rows[M]:Show()local rA=ru:GetCell(r6,col)if type(rA)=="table"and rA.DoCellUpdate then rz=rA.DoCellUpdate elseif ru.cols[col].DoCellUpdate then rz=ru.cols[col].DoCellUpdate elseif r6.DoCellUpdate then rz=r6.DoCellUpdate end else ru.rows[M]:Hide()ri=false end;rz(rh,qE,ru.data,ru.cols,row,ru.filtered[row],col,ri,ru)end end end end;fF:SetScript("OnVerticalScroll",function(self,ag)FauxScrollFrame_OnVerticalScroll(self,ag,ru.rowHeight,function()ru:Refresh()end)end)ru:SetFilter(r1)ru:SetDisplayCols(ru.cols)ru:RegisterEvents(ru.DefaultEvents)return ru end end end;local function rB(...)function _iter_props(bq)for ad,ae in pairs(bq)do print("k: "..ad.." v: "..type(ae))end end;local eI,dL="SearchTable",28;local df=LibStub and LibStub("AceGUI-3.0",true)local rC=LibStub("ScrollingTable")if not df or(df:GetWidgetVersion(eI)or 0)>=dL then return end;local tostring,pairs=tostring,pairs;local PlaySound=PlaySound;local GetCursorInfo,ClearCursor,GetSpellInfo=GetCursorInfo,ClearCursor,GetSpellInfo;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIEditBoxInsertLink(...)end)end;function _G.AceGUIEditBoxInsertLink(fg)for M=1,df:GetWidgetCount(eI)do local jy=_G["AceGUI-3.0EditBox"..M]if jy and jy:IsVisible()and jy:HasFocus()then jy:Insert(fg)return true end end end;local function jz(self)if not self.disablebutton then self.button:Show()self.editbox:SetTextInsets(0,20,3,3)end end;local function jA(self)self.button:Hide()self.editbox:SetTextInsets(0,0,3,3)end;local function hU(bx)bx.obj:Fire("OnEnter")end;local function hV(bx)bx.obj:Fire("OnLeave")end;local function jB(bx)bx.obj.editbox:SetFocus()bx:SetScript("OnShow",nil)end;local function jC(bx)df:ClearFocus()end;local function jD(bx)local self=bx.obj;local by=bx:GetText()local eM=self:Fire("OnEnterPressed",by)if not eM then PlaySound(856)jA(self)end end;local function jE(bx)local self=bx.obj;local type,aN,cB=GetCursorInfo()local aa;if type=="item"then aa=cB elseif type=="spell"then aa=GetSpellInfo(aN,cB)elseif type=="macro"then aa=GetMacroInfo(aN)end;if aa then self:SetText(aa)self:Fire("OnEnterPressed",aa)ClearCursor()jA(self)df:ClearFocus()end end;local function jF(bx)local self=bx.obj;local by=bx:GetText()if tostring(by)~=tostring(self.lasttext)then self:Fire("OnTextChanged",by)self.lasttext=by;jz(self)end end;local function jG(bx)df:SetFocus(bx.obj)end;local function f4(bx)local jy=bx.obj.editbox;jy:ClearFocus()jD(jy)end;local eP={["OnAcquire"]=function(self)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.editbox:EnableMouse(false)self.editbox:ClearFocus()self.editbox:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)else self.editbox:EnableMouse(true)self.editbox:SetTextColor(1,1,1)self.label:SetTextColor(1,.82,0)end end,["SetText"]=function(self,fg)self.lasttext=fg or""self.editbox:SetText(fg or"")self.editbox:SetCursorPosition(0)jA(self)end,["GetText"]=function(self,fg)return self.editbox:GetText()end,["SetLabel"]=function(self,fg)if fg and fg~=""then self.label:SetText(fg)self.label:Show()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,-18)self:SetHeight(44)self.alignoffset=30 else self.label:SetText("")self.label:Hide()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,0)self:SetHeight(26)self.alignoffset=12 end end,["DisableButton"]=function(self,gf)self.disablebutton=gf;if gf then jA(self)end end,["SetMaxLetters"]=function(self,fE)self.editbox:SetMaxLetters(fE or 0)end,["ClearFocus"]=function(self)self.editbox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editbox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",jB)end end,["HighlightText"]=function(self,eb,ec)self.editbox:HighlightText(eb,ec)end,["SetColumns"]=function(self,ef)self.cols=ef;self:SortData()end}local function dK(rD)local fE=df:GetNextWidgetNum(eI)local bx=CreateFrame("Frame",nil,UIParent)bx:Hide()local ev=CreateFrame("Frame","ScrollTableHolder"..fE,bx,BackdropTemplateMixin and"BackdropTemplate")ScrollTableInstance=rC:CreateST(rD,nil,nil,nil,bx)local dt={alignoffset=30,frame=ScrollTableInstance.frame,type=eI,scrollInstance=ScrollTableInstance}for s,J in pairs(eP)do dt[s]=J end;return df:RegisterAsWidget(dt)end;df:RegisterWidgetType(eI,dK,dL)end;local function rE(...)Class={}function Class:init(...)end;function Class:extend(bq,rF)local bq=bq or{}bq.__class__=rF and rF or"class"local function bF(table,on)local table=table or{}local gO=on or{}for ad,ae in pairs(table)do if not gO[ad]then if type(ae)=="table"and ad~="__index"and ad~="__newindex"then gO[ad]=bF(ae)else gO[ad]=ae end end end;return gO end;bF(self,bq)bq._=bq._ or{}local al={}al.__call=function(self,...)return self:new(...)end;al.__index=function(table,o)local e8=rawget(table._,o)if e8 and type(e8)=="table"and(e8.get~=nil or e8.value~=nil)then if e8.get then if type(e8.get)=="function"then return e8.get(table,e8.value)else return e8.get end elseif e8.value then return e8.value end else return e8 end end;al.__newindex=function(table,o,by)local e8=rawget(table._,o)if e8 and type(e8)=="table"and(e8.set~=nil and e8._==nil or e8.value~=nil)then local ae=by;if e8.set then if type(e8.set)=="function"then ae=e8.set(table,by,e8.value)else ae=e8.set end end;e8.value=ae;if e8 and e8.afterSet then e8.afterSet(table,ae)end else table._[o]=by end end;setmetatable(bq,al)return bq end;function Class:set(rG,by)if not by and type(rG)=="table"then for ad,ae in pairs(rG)do rawset(self._,ad,ae)end else rawset(self._,rG,by)end end;function Class:new(...)local bq=self:extend({})if bq.init then bq:init(...)end;return bq end;function class(rH,rF)rH=rH and rH or{}rH.__class__=rF and rF or"class"return Class:extend(rH)end;function typeof(bq)if bq==nil then return"nil"end;if bq.__class__ then return bq.__class__ else return type(bq)end end;function settype(bq,class)bq.__class__=class end end;local function rI(...)tt={}tt.rotations={}tt.botbases={}tt.Classes={}tt.LocalPlayer=nil;tt.time=GetTime()tt.mountID=nil;tt.running=false;tt.doDebugging=true;local rJ=0;tt.draw=nil;tt.scoredraw=nil;tt.bgdraw=nil;tt.areatriggerdraw=nil;tt.combatrange=25;tt.pullrange=35;local rK=0;local rL=false;setfenv(1,localenv)tt.AceGUI=LibStub and LibStub("AceGUI-3.0",true)tt.chatcom=LibStub("AceAddon-3.0"):NewAddon("tt","AceConsole-3.0")tt.frame=CreateFrame("Frame","bro",UIParent)tt.frame:SetScript("OnUpdate",function(self,aT)if not rL then tt:Init()end;if GetTime()-rK>30 then rK=GetTime()dmc.ResetAfk()end;if tt.draw==nil then tt.draw=Draw:New()end;if tt.scoredraw==nil then tt.scoredraw=Draw:New()end;if tt.areatriggerdraw==nil then tt.areatriggerdraw=Draw:New()end;if not tt.running then return end;tt.time=tt.time+aT;if tt.time>rJ+.1 then if tt.mountID==nil then for M=1,C_MountJournal.GetNumMounts(),1 do local rM,rN,gI,rO,rP,rQ,rR,rS,rT,rU,rV=C_MountJournal.GetMountInfoByID(M)if rP and rV then tt.mountID=M;break end end end;tt.scoredraw:ClearCanvas()rJ=tt.time;tt:UpdateOM()tt:updateObjectViewer()end;if tt.botbase then if tt.doDebugging then tt.botbases[tt.botbase]:Debug()else tt.draw:ClearCanvas()tt.scoredraw:ClearCanvas()end;tt.rotations[tt.rotation]:SetRange()tt.rotations[tt.rotation]:OOC()tt.botbases[tt.botbase]:Pulse()end end)function tt:Init()if dmc then tt.Log:Add(tt.version)for ad,ae in pairs(tt.changelog)do tt.Log:Add("-"..ae)end;rL=true end end;function tt:tcount(aU)local jL=0;for ad,ae in pairs(aU)do jL=jL+1 end;return jL end;tt.frame:SetScript("OnKeyDown",function(self,o)if o=="`"then print("Hotkey toggling bot")tt.running=not tt.running;tt:UpdateHUD()end;tt.frame:SetPropagateKeyboardInput(true)end)function tt:Cast(aa,rW)if rW==nil then return false end;local rX=IsSpellInRange(aa,rW.pointer)local rY=IsUsableSpell(aa)local p8,aS=GetSpellCooldown(aa)if rX==nil then rX=1 end;if rX==1 and rY and p8==0 then print("Casting "..aa)localenv["CastSpellByName"](aa,rW)return true end;return false end;function tt:MakeTabs(ns,eS,gn)local rZ=tt.AceGUI:Create("TabGroup")rZ:SetLayout("Flow")rZ:SetTabs(gn)rZ:SetTitle(eS)ns:AddChild(rZ)end end;local function r_(...)local tt=tt;function tt:RegisterBotBase(aa,s0)tt.botbases[aa]=s0 end;function tt:RegisterRotation(aa,s1)tt.rotations[aa]=s1 end;function tt:getBotBaseIndex(aa)local M=1;for ad,ae in pairs(tt.botbases)do if ad==aa then return M end;M=M+1 end end;function tt:getRotationIndex(aa)local M=1;for ad,ae in pairs(tt.rotations)do if ad==aa then return M end;M=M+1 end end end;local function s2(...)local tt=tt;tt.players,tt.units,tt.gameobjects,tt.areatriggers={},{},{},{}local s3,s4,s5=tt.players,tt.units,tt.gameobjects;function tt:FlushOM()self:UpdateOM()end;function tt:UpdateOM()local s6={}for M=1,dmc.GetObjectCount(),1 do local I=dmc.GetObjectWithIndex(M)if I then table.insert(s6,I)end end;if#s6>0 then tt.areatriggerdraw:ClearCanvas()for aV,ae in pairs(s6)do if dmc.ObjectType(ae)==11 then if tt.areatriggers[ae]then tt.areatriggers[ae]:Update(ae)else tt.areatriggers[ae]=tt.Classes.AreaTrigger(ae)end end;if dmc.ObjectType(ae)==7 then if tt.LocalPlayer==nil then tt.LocalPlayer=tt.Classes.LocalPlayer(ae)else tt.LocalPlayer:Update(ae)end end;if dmc.ObjectType(ae)==8 then if tt.gameobjects[ae]then tt.gameobjects[ae]:Update(ae)else tt.gameobjects[ae]=tt.Classes.GameObject(ae)end end;if dmc.ObjectType(ae)==5 then if tt.units[ae]then tt.units[ae]:Update(ae)else tt.units[ae]=tt.Classes.Unit(ae)end end;if dmc.ObjectType(ae)==6 then if tt.players[ae]then tt.players[ae]:Update(ae)else tt.players[ae]=tt.Classes.Player(ae)end end end end;tt:ClearOldObjects()end;function tt:GetObjectByGUID(s7)for ad,ae in pairs(tt.gameobjects)do if ae.pointer==s7 then return ae end end;for ad,ae in pairs(tt.units)do if ae.pointer==s7 then return ae end end;for ad,ae in pairs(tt.players)do if ae.pointer==s7 then return ae end end end;function tt:ClearOldObjects()for ad,ae in pairs(tt.areatriggers)do if not dmc.ObjectExists(ae.pointer)then tt.areatriggers[ad]:Destroy()tt.areatriggers[ad]=nil end;if not dmc.ObjectExists(ae.pointer)then tt.gameobjects[ad]=nil end end;for ad,ae in pairs(tt.units)do if not dmc.ObjectExists(ae.pointer)then tt.units[ad]=nil end end;for ad,ae in pairs(tt.players)do if not dmc.ObjectExists(ae.pointer)then tt.players[ad]=nil end end end end;local function s8(...)local tt=tt;local s9=0;function tt:NavTo(x,y,z,sa)sa=sa or false;if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then localenv["MoveForwardStop"]()s9=GetTime()return end;local sb,sc,sd=dmc.GetUnitPosition("player")if dmc.GetDistance3D(tt.LocalPlayer.x,tt.LocalPlayer.y,tt.LocalPlayer.z,x,y,z)>100 and not IsMounted()and not UnitCastingInfo("player")~=nil and not IsIndoors()and GetTime()-s9>.5 then local se=UnitClass("player")=="Druid"and GetShapeshiftForm()~=3;if se then localenv["CastSpellByName"]("Travel Form")return else if tt.mountID~=nil then localenv["MoveForwardStop"]()if GetUnitSpeed("player")<=0 then C_MountJournal.SummonByID(tt.mountID)C_Timer.After(0.5,function()end)return end;C_MountJournal.SummonByID(tt.mountID)localenv["MoveForwardStop"]()s9=GetTime()return end end end;local sf=dmc.GetMapID()local sg=dmc.FindPath(sf,sb,sc,sd,x,y,z)if sg==0 then return end;local sh,si,sj=dmc.GetPathNode(2)if sh==nil then return end;local sk=dmc.GetDistance3D(sb,sc,sd,sh,si,sj)local sl=dmc.GetDistance3D(PathX,PathY,PathZ,sh,si,sj)if sh then local sm,sn,so=sb-sh,sc-si,sd-sj;local sp=math.atan2(-sn,-sm)if sp<0 then sp=sp+math.pi*2 end;dmc.FaceDirection(sp,false)if sk>.1 then localenv["MoveForwardStart"]()end end end end;local function sq(...)local tt=tt;tt.Classes.AreaTrigger=class()local sr=tt.Classes.AreaTrigger;local ss=nil;function sr:init(st)self.pointer=st;self.name=dmc.ObjectName(st)self.gotype=dmc.GameObjectType(st)self.x,self.y,self.z=dmc.GetUnitPosition(st)self.radius=dmc.ObjectField(st,0xD7A4,10)self.createdBy=dmc.UnitCreatedBy(st)self.duration=7.2;self.initTime=tt.time end;function sr:Update()self.x,self.y,self.z=dmc.GetUnitPosition(self.pointer)self.name=dmc.ObjectName(self.pointer)self.gotype=dmc.GameObjectType(self.pointer)self.x,self.y,self.z=dmc.GetUnitPosition(self.pointer)self.radius=7;self.flags=dmc.UnitDynamicFlags(self.pointer)self.timeleft=self.initTime+self.duration-tt.time;self.Distance=dmc.GetDistance3D(self.x,self.y,self.z,tt.LocalPlayer.x,tt.LocalPlayer.y,tt.LocalPlayer.z)self:Debug()end;function sr:Debug()if ss==nil then ss=dmc.Draw:New()end;ss:ClearCanvas()ss:Circle(self.x,self.y,self.z,self.radius,0,0,1,1)end;function sr:Destroy()ss:ClearCanvas()end end;local function su(...)local tt=tt;tt.Classes.GameObject=class()local sv=tt.Classes.GameObject;function sv:init(point)self.pointer=point;self.Name=dmc.ObjectName(point)self.NextUpdate=tt.time+1;self.x,self.y,self.z=dmc.GetUnitPosition(point)self.Distance=dmc.GetDistance3D(x,y,z,self.x,self.y,self.z)self.score=0;self.radius=dmc.UnitBoundingRadius(point)self.NextUpdate=0 end;function sv:Update(point)if GetTime()<self.NextUpdate then return end;self.Name=dmc.ObjectName(self.pointer)local x,y,z=dmc.GetUnitPosition("player")self.x,self.y,self.z=dmc.GetUnitPosition(self.pointer)self.Distance=dmc.GetDistance3D(x,y,z,self.x,self.y,self.z)self.radius=dmc.ObjectField(self.pointer,0xD7A4,10)self.NextUpdate=GetTime()+self:getUpdateRate()end;function sv:ToTable()local table={self.Name,string.format("%0d",self.Distance),self.score,string.format("%2d",self.NextUpdate)}return table end;function sv:getUpdateRate()if self.Distance==nil then return 0 end;if self.Distance<50 then return 0.2 end;if self.Distance<150 then return 1 end;return 2.5 end;function sv:HasPath()local x,y,z=dmc.GetUnitPosition("player")local sf=dmc.GetMapID()local sg=dmc.FindPath(sf,self.x,self.y,self.z,x,y,z,true)if sg==0 then return false else return true end end;function sv:LOS()local x,y,z=dmc.GetUnitPosition("player")local sw=dmc.TraceLine(x,y,z,self.x,self.y,self.z,0x10)if sw==0 then return true end;return false end;function sv:GetEnemiesAround(sx)local iR=0;for ad,ae in pairs(tt.players)do if dmc.GetDistance3D(self.x,self.y,self.z,ae.x,ae.y,ae.z)<sx and ae.Reaction<=3 and not ae.Dead then iR=iR+1 end end;return iR end;function sv:GetFriendsAround(sx)local iR=0;for ad,ae in pairs(tt.players)do if dmc.GetDistance3D(self.x,self.y,self.z,ae.x,ae.y,ae.z)<sx and ae.Reaction>4 and not ae.Dead then iR=iR+1 end end;return iR end;function sv:DistanceFrom(I)return dmc.GetDistance3D(self.x,self.y,self.z,I.x,I.y,I.z)end end;local function sy(...)local tt=tt;tt.Classes.Unit=tt.Classes.GameObject:extend()local sz=tt.Classes.Unit;function sz:init(point)tt.Classes.GameObject.init(self,point)self.Reaction=localenv["UnitReaction"]("player",point)self.HP=localenv["UnitHealth"](point)/localenv["UnitHealthMax"](point)*100;self.Health=localenv["UnitHealth"](point)self.HealthMax=localenv["UnitHealthMax"](point)self.lastupdate=0;self.EnemiesAround=0;self.FriendsAround=0;self.Dead=localenv["UnitIsDead"](self.pointer)self.targetScore=0;self.attackable=localenv["UnitCanAttack"]("player",point)end;function sz:Update()tt.Classes.GameObject.Update(self,self.pointer)self.Dead=localenv["UnitIsDead"](self.pointer)self.Health=localenv["UnitHealth"](self.pointer)self.HealthMax=localenv["UnitHealthMax"](self.pointer)self.HP=self.Health/self.HealthMax*100;self.attackable=localenv["UnitCanAttack"]("player",self.pointer)self.los=self:LOS()end;function sz:IsCasting()local aa,fg,ij,sA,sB,sC,sD,sE,sF=localenv["UnitCastingInfo"](self.pointer)local aa,fg,ij,sA,sB,sC,sD,sE,sF=localenv["UnitChannelInfo"](self.pointer)if aa~=nil then return true end;if name2~=nil then return true end;return false end;function sz:HasBuff(sG,sH)sH=sH or false;for M=1,40 do local aa,aV,iR,sI,aS,sJ,sK,aV,aV,sF,aV,aV,aV,aV,sL=localenv["UnitAura"](self.pointer,M,"HELPFUL")if sH then if sK=="player"and aa==sG then return true end else if aa==sG then return true end end end;return false end;function sz:HasDebuff(sG,sH)for M=1,40 do local aa,aV,iR,sI,aS,sJ,sK,aV,aV,sF,aV,aV,aV,aV,sL=localenv["UnitAura"](self.pointer,M,"HARMFUL")if sH then if sK=="player"and aa==sG then return true end else if aa==sG then return true end end end;return false end;function sz:TargetingMe()local u=dmc.UnitTarget(self.pointer)if u==tt.LocalPlayer.pointer then return true end;return false end end;local function sM(...)local tt=tt;tt.Classes.Player=tt.Classes.Unit:extend()local sN=tt.Classes.Player;function sN:init(point)tt.Classes.Unit.init(self,point)self.power=localenv["UnitPower"](self.pointer)self.combo=localenv["UnitPower"](self.pointer,4)end;function sN:Update()tt.Classes.Unit.Update(self,point)self.power=localenv["UnitPower"](self.pointer)self.combo=localenv["UnitPower"](self.pointer,4)self:Debug()end;function sN:ToTable()local table={self.Name,self.Distance,self.score,self.NextUpdate}return table end;function sN:Debug()if tt.scoredraw==nil then tt.scoredraw=Draw:New()end;if self.score~=nil and self.score>0 then tt.scoredraw:SetColor(0,255,0,255)tt.scoredraw:Text(self.Name.." "..string.format("%0d",self.HP),"GameFontNormal",self.x,self.y,self.z+5)end;if self.targetScore~=nil and self.targetScore>0 then tt.scoredraw:SetColor(255,0,0,255)tt.scoredraw:Text(self.Name.." "..string.format("%0d",self.targetScore),"GameFontNormal",self.x,self.y,self.z+5)end end end;local function sO(...)local tt=tt;tt.Classes.LocalPlayer=tt.Classes.Player:extend()local sP=tt.Classes.LocalPlayer;function sP:init(point)tt.Classes.Player.init(self,point)end;function sP:Update()tt.Classes.Player.Update(self,point)self.arcane=localenv["UnitPower"]("player",16)self.pet=UnitIsVisible("pet")end;function sP:Debug()end;function sP:HasItem(aa)end end;local function sQ(...)local tt=tt;tt.Classes.Spot=class()local sR=tt.Classes.Spot;function sR:init(x,y,z,sS,sT,sU,sV)self.x=x;self.y=y;self.z=z;self.mapID=sS;self.facex=sT;self.facey=sU;self.facez=sV end end;local function sW(...)local tt=tt;tt.botbases.BGBot=class()local sX=tt.botbases.BGBot;sX.name="BGBot"sX.allowMovement=true;function sX:init()self.allowMovement=true end;local sY=0;local sZ=0;local s_=0;tt.movespot={}tt.badspot={}tt.bestmove=nil;tt.besttarget=nil;local t0=nil;local t1=nil;local t2=0;tt.bgdraw=dmc.Draw:New()tt.PVPMoveScores={}tt.PVPTargetScores={}local t3=tt.Classes.Spot(628.09710693359,230.25869750977,328.99182128906,727,675.06805419922,222.31399536133,319.90646362305)local t4=tt.Classes.Spot(1816.8699951172,160.08299255371,1.8064399957657,726,1812.6453857422,200.64604187012,-20.939380645752)local t5=tt.Classes.Spot(1061.9154052734,1378.19140625,328.5080871582,726,1090.0329589844,1397.9826660156,319.44784545898)tinsert(tt.movespot,t3)tinsert(tt.movespot,t4)tinsert(tt.movespot,t5)function sX:HandleOutsideBG()if GetTime()-t2<4 then return end;if HonorFrameQueueButton==nil or not HonorFrameQueueButton:IsVisible()and GetBattlefieldStatus(1)~="queued"then TogglePVPUI()end;if GetBattlefieldStatus(1)~="queued"and GetBattlefieldStatus(1)~="confirm"then localenv["RunMacroText"]("/click HonorFrameQueueButton")tt:SetStatusText("Queueing for BG")end;if GetBattlefieldStatus(1)=="queued"then tt:SetStatusText("Waiting for BG to pop currently waited "..tt:ConvertToMS(GetBattlefieldTimeWaited(1)))if PVPQueueFrame~=nil and PVPQueueFrame:IsVisible()then TogglePVPUI()end end;if GetBattlefieldStatus(1)=="confirm"then localenv["AcceptBattlefieldPort"](1,true)tt:SetStatusText("Accepting BG")end end;function sX:Pulse()self:BuildMoveScores()self:BuildTargetScores()tt.LocalPlayer:HasBuff("Regrowth")if not UnitInBattleground("player")then self:HandleOutsideBG()else local t6=UnitGroupRolesAssigned("player")if PVPQueueFrame~=nil and PVPQueueFrame:IsVisible()then TogglePVPUI()end;self:BuildMoveScores()self:BuildTargetScores()if t6=="HEALER"then self:BuildHealScore()end;if GetBattlefieldWinner()then LeaveBattlefield()return end;if UnitIsDeadOrGhost("player")then localenv["MoveForwardStop"]()RepopMe()tt:SetStatusText("Releasing and waiting to be alive")return end;if TimerTrackerTimer1~=nil and TimerTrackerTimer1.barShowing then tt:SetStatusText("Waiting for BG to start")return end;local point=dmc.ObjectMover('player')if point~=nil then tt:SetStatusText("Moving off boat")localenv["MoveForwardStart"]()local x,y,z=dmc.GetUnitPosition("player")local sb,sc,sd=5,31,34;local sm,sn,so=x-sb,y-sc,z-sd;local sp=math.atan2(-sn,-sm)if dmc.GetDistance3D(x,y,z,sb,sc,sd)<10 then return end;dmc.FaceDirection(sp,false)return end;if self:InMoveSpot()then return end;if GetTime()-t2<0.5 then return end;for ad,ae in pairs(tt.PVPMoveScores)do if ae.player:HasPath()and ae.player.Distance~=nil then t0=ae.player;break end end;for ad,ae in pairs(tt.PVPTargetScores)do if ae.player:HasPath()and ae.player.Distance~=nil and ae.player.Reaction<=3 and ae.player.Distance<70 and not ae.player:LOS()then t1=ae.player end end;t1=self:ClosestTarget()local t7=tt.CombatHelpers:GetClosestHeal(101,40)tt.besttarget=t1;if t1~=nil then if t1.Distance<tt.pullrange then tt:SetStatusText("Targeting best target "..t1.Name.." "..t1.Distance)localenv["TargetUnit"](t1.pointer)local x,y,z=dmc.GetUnitPosition("player")local sb,sc,sd=dmc.GetUnitPosition(t1.pointer)if sb==nil then return end;local sm,sn,so=x-sb,y-sc,z-sd;local sp=math.atan2(-sn,-sm)dmc.FaceDirection(sp,false)tt.rotations[tt.rotation]:Pulse(t1)else tt:SetStatusText("Moving to best target "..t1.Name.." "..t1.Distance)tt:NavTo(t1.x,t1.y,t1.z)return end;return end;if t0~=nil and t0.Distance>tt.pullrange then tt:SetStatusText("Moving to best move spot "..t0.Name.." "..t0.Distance)tt:NavTo(t0.x,t0.y,t0.z)return end end end;function sX:BuildMoveScores()if GetTime()-sZ<3 then return end;for ad,ae in pairs(tt.PVPMoveScores)do tt.PVPMoveScores[ad]=nil end;local t8=4;local t9=2;local t6=UnitGroupRolesAssigned("player")if t6=="HEALER"then t8=5;t9=2 else t9=5;t8=2 end;for ad,ae in pairs(tt.players)do if ae.pointer~=tt.LocalPlayer.pointer and not ae.Dead and dmc.ObjectExists(ae.pointer)and ae.Reaction>=5 then local ta=ae:GetFriendsAround(30)local tb=ae:GetEnemiesAround(30)local tc=(1000+ta*t8+tb*t9)*15;if ae.Distance==nil then tc=tc-100000 else tc=tc-ae.Distance*.5 end;if tb/ta>2 then tc=tc-5000 end;if localenv["UnitAffectingCombat"](ae.pointer)then tc=tc+500 end;ae.score=tc;tinsert(tt.PVPMoveScores,{score=tc,player=ae})end end;table.sort(tt.PVPMoveScores,function(x,y)return x.score>y.score end)sZ=GetTime()end;function sX:BuildTargetScores()if GetTime()-s_<2.5 then return end;for ad,ae in pairs(tt.PVPTargetScores)do tt.PVPTargetScores[ad]=nil end;for ad,ae in pairs(tt.players)do if not ae.Dead and ae.Reaction<=3 and ae.Distance~=nil and ae.Distance<60 and not ae:LOS()then local tc=1000;if ae.Distance==nil then tc=tc-100000 else tc=tc-dmc.GetDistance3D("player",ae.pointer)end;if ae:TargetingMe()then tc=tc+100 end;if ae.Distance~=nil and ae.Distance<15 then tc=tc+100000 end;ae.targetScore=tc;tinsert(tt.PVPTargetScores,{score=tc,player=ae})end end;table.sort(tt.PVPTargetScores,function(x,y)return x.score>y.score end)s_=GetTime()end;function sX:BuildHealScore()if GetTime()-s_<2.5 then return end;for ad,ae in pairs(tt.PVPTargetScores)do tt.PVPTargetScores[ad]=nil end;for ad,ae in pairs(tt.players)do if not ae.Dead and ae.Reaction>=5 and ae.Distance~=nil and ae.Distance<100 and not ae:LOS()then local tc=50000;if ae.Distance==nil then tc=tc-100000 else tc=tc-ae.Distance end;if ae.Distance~=nil and ae.Distance<15 then tc=tc+100000 end;tc=tc+ae.maxHealth-ae.Health;ae.targetScore=tc;tinsert(tt.PVPTargetScores,{score=tc,player=ae})end end;table.sort(tt.PVPTargetScores,function(x,y)return x.score>y.score end)s_=GetTime()end;function sX:InMoveSpot()local x,y,z=dmc.GetUnitPosition("player")for ad,ae in pairs(tt.movespot)do if dmc.GetDistance3D(x,y,z,ae.x,ae.y,ae.z)<35 then local sb,sc,sd=ae.facex,ae.facey,ae.facez;local sm,sn,so=x-sb,y-sc,z-sd;local sp=math.atan2(-sn,-sm)dmc.FaceDirection(sp,false)localenv["MoveForwardStart"]()return true end end;return false end;function sX:IsInSpawn(x,y,z)for ad,ae in pairs(tt.badspot)do if dmc.GetDistance3D(x,y,z,ae.x,ae.y,ae.z)<35 then print("in bad spot not going here")return true end end;return false end;function tt:ConvertToMS(td)local te=td/1000;local tf=math.floor(te/60)local tg=te-tf*60;return string.format("%02d:%02d",tf,tg)end;function sX:ClosestTarget()local th=nil;local ti=999999;for ad,ae in pairs(tt.players)do if ae.pointer~="player"then if ae.Distance~=nil and ae.Distance<150 and ae.Distance<ti and ae.Reaction<=3 and not ae.Dead then ti=ae.Distance;th=ae end end end;return th end;function sX:Debug()tt.draw:ClearCanvas()tt.draw:SetColor(0,255,0)local x,y,z=dmc.GetUnitPosition("player")if t1~=nil then tt.draw:SetColor(255,0,0)tt.draw:Line(t1.x,t1.y,t1.z,x,y,z,true)end;if t0~=nil then tt.draw:SetColor(0,255,0)tt.draw:Line(t0.x,t0.y,t0.z,x,y,z,true)end end;tt:RegisterBotBase(sX.name,sX)end;local function tj(...)local tt=tt;tt.botbases.RotationBot=class()local tk=tt.botbases.RotationBot;tk.name="RotationBot"tk.allowMovement=false;function tk:init()end;function tk:Pulse()if localenv["UnitAffectingCombat"]("player")then tt.rotations[tt.rotation]:Pulse(dmc.UnitTarget("player"))end end;function tk:Debug()end;tt:RegisterBotBase(tk.name,tk)end;local function tl(...)local tt=tt;tt.botbases.DungeonBot=class()local tm=tt.botbases.DungeonBot;tm.name="DungeonBot"function tm:init()end;function tm:Pulse()if IsInInstance()then local tn=self:GetNearestEnemy()if tn then local x,y,z=dmc.GetUnitPosition("player")if dmc.GetDistance3D(tn.x,tn.y,tn.z,x,y,z)>tt.combatrange then tt:NavTo(tn.x,tn.y,tn.z)tt.rotations[tt.rotation]:Pulse()else localenv["MoveForwardStop"]()localenv["TargetUnit"](tn.pointer)tt.rotations[tt.rotation]:Pulse()end end end end;function tm:GetNearestEnemy()local to=nil;local tp=999999;for ad,ae in pairs(tt.units)do if ae.attackable and not ae.Dead then local x,y,z=dmc.GetUnitPosition("player")local tq=dmc.GetDistance3D(ae.x,ae.y,ae.z,x,y,z)if tq<tp then to=ae;tp=tq end end end;return to end;function tm:Debug()end;tt:RegisterBotBase(tm.name,tm)end;local function tr(...)local tt=tt;tt.rotations.BaseRotation=class()local ts=tt.rotations.BaseRotation;ts.skip=true;ts.name="skip"function ts:init()end;function ts:OOC()end;function ts:Pulse(u)if not tt.botbases[tt.botbase].allowMovement then return end;local tu=tt:GetObjectByGUID(u)local x,y,z=dmc.GetUnitPosition("player")local sb,sc,sd=dmc.GetUnitPosition(u.pointer)if sb==nil then return end;local sm,sn,so=x-sb,y-sc,z-sd;local sp=math.atan2(-sn,-sm)if tt.botbases[tt.botbase].allowMovement then dmc.FaceDirection(sp,false)end;if u.Distance>tt.combatrange then tt:SetStatusText("Moving to target")tt:NavTo(u.x,u.y,u.z,true)else C_Timer.After(0.5,function()localenv["MoveForwardStop"]()end)end end;function ts:NormalizeTarget(u)if type(u)=="string"then u=tt:GetObjectByGUID(u)end;return u end end;local function tv(...)local tt=tt;tt.rotations.External=class()local tw=tt.rotations.External;tw.name="External"tw.class="all"function tw:init()end;function tw:Pulse()return end;tt:RegisterRotation(tw.name,tw)end;local function tx(...)local tt=tt;tt.rotations.Druid=tt.rotations.BaseRotation:extend()local ty=tt.rotations.Druid;ty.name="Druid"ty.class="druid"local tz;local tA=0;local tB=0;local tC=0;function ty:init()end;function ty:OOC()if not tt.LocalPlayer:HasBuff("Mark of the Wild")then tt:Cast("Mark of the Wild","player")end end;function ty:SetRange()tt.combatrange=5;tt.pullrange=25;if GetSpecialization()==1 then tt.combatrange=35;tt.pullrange=35 end;if GetSpecialization()==4 then tt.combatrange=35;tt.pullrange=35 end end;function ty:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=self:NormalizeTarget(u)if tD==1 then tt.combatrange=30;local tE=tt.CombatHelpers:GetClosestCaster(40)if tE~=nil then localenv["CastSpellByName"]("Solar Beam")end;if GetShapeshiftForm()~=4 then tt:Cast("Moonkin Form","player")end;if tt.LocalPlayer.HP<50 then tt:Cast("Barkskin","player")end;if tt.LocalPlayer.HP<40 then tt:Cast("Renewal","player")end;if not u:HasDebuff("Moonfire",u.pointer)then tt:Cast("Moonfire",u.pointer)end;if not u:HasDebuff("Sunfire",u.pointer)then tt:Cast("Sunfire",u.pointer)end;tt:Cast("Celestial Alignment","player")tt:Cast("Convoke the Spirits",u.pointer)tt:Cast("Starsurge",u.pointer)if tt.LocalPlayer:HasBuff("Ownkin Frenzy")then tt:Cast("Starfire",u.pointer)end;tt:Cast("Wrath",u.pointer)end;if tD==2 then local tE=tt.CombatHelpers:GetClosestCaster(8)if GetShapeshiftForm()~=2 then tt:Cast("Cat Form","player")end;if tE~=nil then tt:Cast("Skull Bash",tE.pointer)end;if not localenv["UnitAffectingCombat"]("player")and not tt.LocalPlayer:HasBuff("Prowl")then tt:Cast("Prowl","player")end;if tt.LocalPlayer:HasBuff("Predatory Swiftness")then tt:Cast("Regrowth","player")end;if tt.botbases[tt.botbase].allowMovement and u.Distance>8 then tt:Cast("Wild Charge",u.pointer)end;if tt.LocalPlayer:HasBuff("Prowl")then tt:Cast("Rake",u.pointer)end;if tt.LocalPlayer.power<40 then tt:Cast("Tiger's Fury","player")end;if tt.LocalPlayer:HasBuff("Tiger's Fury")then tt:Cast("Berserk",u.pointer)end;if not u:HasDebuff("Adaptive Swarm")then tt:Cast("Adaptive Swarm",u.pointer)end;tt:Cast("Feral Frenzy",u.pointer)if tt.LocalPlayer:HasBuff("Apex Predator's Craving")then tt:Cast("Ferocious Bite",u.pointer)end;if tt.LocalPlayer.combo==3 then tt:Cast("Brutal Slash",u.pointer)end;if not u:HasDebuff("Rip")and tt.LocalPlayer.combo>=5 then tt:Cast("Rip",u.pointer)end;if tt.LocalPlayer.combo>=5 then tt:Cast("Ferocious Bite",u.pointer)end;if not u:HasDebuff("Rake")then tt:Cast("Rake",u.pointer)end;tt:Cast("Shred",u)end;if tD==3 then if GetShapeshiftForm()~=1 then tt:Cast("Bear Form","player")end;if tt.LocalPlayer.HP<50 then tt:Cast("Barkskin","player")end;if tt.LocalPlayer.HP<40 then tt:Cast("Renewal","player")end;if tt.LocalPlayer.HP<30 then tt:Cast("Survival Instincts","player")end;if tt.LocalPlayer.HP<60 then tt:Cast("Frenzied Regeneration","player")end;if tt.LocalPlayer.power>50 then tt:Cast("Iron Fur")end;tt:Cast("Ironfur","player")tt:Cast("Wild Charge",u.pointer)tt:Cast("Mangle",u.pointer)if not u:HasDebuff("Moonfire",u.pointer)then tt:Cast("Moonfire",u.pointer)end;tt:Cast("Thrash",u.pointer)end;if tD==4 then local tF=tt.CombatHelpers:LowestFriend()local tG=tt.CombatHelpers:GetBuffCount("Lifebloom")if tF~=nil and tF.HP>0 then tt:Cast("Wild Growth",tF.pointer)if tF.HP<95 and tG<1 then tt:Cast("Lifebloom",tF.pointer)end;if tF.HP<50 and tF:HasBuff("Regrowth")then tt:Cast("Swiftmend",tF.pointer)end;if tF.HP<65 then tt:Cast("Regrowth",tF.pointer)end;if tF.HP<80 and not tF:HasBuff("Rejuvenation")then tt:Cast("Rejuvenation",tF.pointer)end end;if not u:HasDebuff("Moonfire",u.pointer)then tt:Cast("Moonfire",u.pointer)end;tt:Cast("Wrath",u.pointer)end end end;function ty:PVPTarget()end;function ty:BuildConfig()if tz==nil then tz=tt.AceGUI:Create("Frame")tz:SetTitle("Druid Config")tz:SetStatusText("Druid Config")tz:SetWidth(800)tz:SetHeight(800)tz:SetLayout("Flow")local rZ=tt:MakeTabs(tz,"Druid Config",{{value="Resto",text="Resto"},{value="Feral",text="Feral"},{value="Balance",text="Balance"},{value="Guardian",text="Guardian"}})end end;function ty:OpenConfig()if tz==nil then ty:BuildConfig()end;print("Opening Druid Config")tz:Show()end;tt:RegisterRotation(ty.name,ty)end;local function tH(...)local tt=tt;tt.rotations.Warrior=class()local tI=tt.rotations.Warrior;tI.name="Warrior"tI.class="Warrior"function tI:init()end;local tJ=0;function tI:SetRange()tt.combatrange=5;tt.pullrange=25 end;function tI:OOC()end;function tI:Pulse(u)local tD=GetSpecialization()self:SetRange()tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;local tE=tt.CombatHelpers:GetClosestCaster(8)if u~=nil then if tD==2 then tt:Cast("Charge",u.pointer)if tE~=nil then tt:Cast("Pummel",tE.pointer)end;if not tt.LocalPlayer:HasBuff("Battle Shout")then tt:Cast("Battle Shout","player")end;if not u:HasDebuff("Hamstring")then tt:Cast("Hamstring",u.pointer)end;if not u:HasDebuff("Rend")then tt:Cast("Rend",u.pointer)end;tt:Cast("Rampage",u.pointer)tt:Cast("Execute",u.pointer)tt:Cast("Bloodthirst",u.pointer)tt:Cast("Raging Blow",u.pointer)end;if tD==3 then if not IsCurrentSpell(6603)then localenv["StartAttack"]()end;if not tt.LocalPlayer:HasBuff("Defensive Stance")then tt:Cast("Defensive Stance","player")end;tt:Cast("Charge",u.pointer)if tE~=nil then tt:Cast("Pummel",tE.pointer)end;if not tt.LocalPlayer:HasBuff("Battle Shout")then tt:Cast("Battle Shout","player")end;if not tt.LocalPlayer:HasBuff("Shield Block")then tt:Cast("Shield Block","player")end;if not tt.LocalPlayer:HasBuff("Ignore Pain")then tt:Cast("Ignore Pain","player")end;tt:Cast("Impending Victory",u.pointer)tt:Cast("Shield Slam",u.pointer)if tt.LocalPlayer:HasBuff("Ignore Pain")then tt:Cast("Revenge",u.pointer)end;tt:Cast("Thunder Clap",u.pointer)end;if tD==1 then if not IsCurrentSpell(6603)then localenv["StartAttack"]()end;if tE~=nil then if tt:Cast("Pummel",tE.pointer)then return end end;if tt:Cast("Charge",u.pointer)then return end;if u.Distance>20 then localenv["CastSpellByName"]("Heroic Leap")print("leaping")if dmc.IsSpellPending()then dmc.ClickPosition(u.x,u.y,u.z)end end;if not tt.LocalPlayer:HasBuff("Battle Shout")then tt:Cast("Battle Shout","player")end;if not tt.LocalPlayer:HasBuff("Enrage")then tt:Cast("Enrage","player")end;if not u:HasDebuff("Hamstring")then tt:Cast("Hamstring",u.pointer)end;if not u:HasDebuff("Rend")then tt:Cast("Rend",u.pointer)end;if tt:Cast("Warbreaker",u.pointer)then return end;if tt:Cast("Execute",u.pointer)then return end;if tt:Cast("Overpower",u.pointer)then return end;if tt:Cast("Mortal Strike",u.pointer)then return end;if tt:Cast("Slam",u.pointer)then return end end end end;tt:RegisterRotation(tI.name,tI)end;local function tK(...)local tt=tt;tt.rotations.Mage=tt.rotations.BaseRotation:extend()local tL=tt.rotations.Mage;tL.name="Mage"tL.class="mage"function tL:init()end;function tL:SetRange()tt.combatrange=35;tt.pullrange=35 end;function tL:OOC()if not tt.LocalPlayer:HasBuff("Arcane Intellect")then tt:Cast("Arcane Intellect","player")end end;function tL:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)local tE=tt.CombatHelpers:GetClosestCaster(30)if tE~=nil then tt:Cast("Counterspell",tE.pointer)end;if tD==1 then if not tt.LocalPlayer:HasBuff("Arcane Power")then tt:Cast("Arcane Power","player")end;if not tt.LocalPlayer:HasBuff("Rune of Power")then tt:Cast("Rune of Power","player")end;if not tt.LocalPlayer:HasBuff("Arcane Familiar")then tt:Cast("Arcane Familiar","player")end;if not tt.LocalPlayer:HasBuff("Arcane Intellect")then tt:Cast("Arcane Intellect","player")end;if tt.LocalPlayer:HasBuff("Clearcasting")then tt:Cast("Arcane Missiles",u.pointer)end;if tt.LocalPlayer.arcane~=nil and tt.LocalPlayer.arcane<4 then tt:Cast("Arcane Blast",u.pointer)end;if tt.LocalPlayer.arcane==4 then tt:Cast("Arcane Barrage",u.pointer)end end;if tD==3 then if not tt.LocalPlayer:HasBuff("Icy Veins")then tt:Cast("Icy Veins","player")end;if not tt.LocalPlayer:HasBuff("Rune of Power")then tt:Cast("Rune of Power","player")end;if not tt.LocalPlayer:HasBuff("Arcane Intellect")then tt:Cast("Arcane Intellect","player")end;if tt.LocalPlayer:HasBuff("Brain Freeze")then tt:Cast("Flurry",u.pointer)end;if tt.LocalPlayer:HasBuff("Fingers of Frost")then tt:Cast("Ice Lance",u.pointer)end;tt:Cast("Frozen Orb",u.pointer)tt:Cast("Ice Nova",u.pointer)tt:Cast("Frostbolt",u.pointer)end;if tD==2 then if not tt.LocalPlayer:HasBuff("Blazing Barrier")then tt:Cast("Blazing Barrier","player")end;tt:Cast("Combustion","player")if tt.LocalPlayer:HasBuff("Hot Streak!")then tt:Cast("Pyroblast",u.pointer)end;if tt.LocalPlayer:HasBuff("Heating Up")then tt:Cast("Fire Blast",u.pointer)end;tt:Cast("Fireball",u.pointer)end end end;tt:RegisterRotation(tL.name,tL)end;local function tM(...)local tt=tt;tt.rotations.Paladin=class()local tN=tt.rotations.Paladin;tN.name="Paladin"tN.class="paladin"function tN:init()end;function tN:OOC()end;function tN:SetRange()tt.combatrange=5;tt.pullrange=25;if GetSpecialization()==1 then tt.combatrange=35;tt.pullrange=35 end end;function tN:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)if u~=nil then tt.rotations.BaseRotation:Pulse(u)if tD==3 then tt:Cast("Blade of Justice",u.pointer)tt:Cast("Judgment",u.pointer)tt:Cast("Avenge Wrath","player")tt:Cast("Hammer of Wrath",u.pointer)tt:Cast("Templar's Verdict",u.pointer)tt:Cast("Crusader Strike",u.pointer)end;if tD==2 then tt:Cast("Avenger's Shield",u.pointer)tt:Cast("Judgment",u.pointer)tt:Cast("Hammer of Wrath",u.pointer)tt:Cast("Consecration",u.pointer)tt:Cast("Holy Wrath",u.pointer)tt:Cast("Shield of the Righteous",u.pointer)tt:Cast("Hammer of the Righteous",u.pointer)end;if tD==1 then local tF=tt.CombatHelpers:LowestFriend()if tF~=nil then if tF.HP<50 then localenv["CastSpellByName"]("Flash of Light",tF.pointer)end;if tF.HP<20 then tt:Cast("Lay on Hands",tF.pointer)end;if tF.HP<80 then localenv["CastSpellByName"]("Holy Light",tF.pointer)end end end end end;tt:RegisterRotation(tN.name,tN)end;local function tO(...)local tt=tt;tt.rotations.Monk=tt.rotations.BaseRotation:extend()local tP=tt.rotations.Monk;tP.name="Monk"tP.class="Monk"function tP:init()end;function tP:SetRange()tt.combatrange=5;tt.pullrange=25 end;function tP:Pull()if localenv["UnitAffectingCombat"]("player")then return self:Pulse()end end;function tP:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)if tD==1 then if not tt.LocalPlayer:HasBuff("Ironskin Brew")then tt:Cast("Ironskin Brew","player")end;if not tt.LocalPlayer:HasBuff("Stagger")then tt:Cast("Stagger","player")end;if not tt.LocalPlayer:HasBuff("Fortifying Brew")then tt:Cast("Fortifying Brew","player")end;if not tt.LocalPlayer:HasBuff("Keg Smash")then tt:Cast("Keg Smash",u.pointer)end;if not tt.LocalPlayer:HasBuff("Breath of Fire")then tt:Cast("Breath of Fire",u.pointer)end;if not tt.LocalPlayer:HasBuff("Blackout Strike")then tt:Cast("Blackout Strike",u.pointer)end;if not tt.LocalPlayer:HasBuff("Tiger Palm")then tt:Cast("Tiger Palm",u.pointer)end;if not tt.LocalPlayer:HasBuff("Rushing Jade Wind")then tt:Cast("Rushing Jade Wind","player")end;if not tt.LocalPlayer:HasBuff("Black Ox Brew")then tt:Cast("Black Ox Brew","player")end;tt:Cast("Rising Sun Kick",u.pointer)end;if tD==2 then local tF=tt.CombatHelpers:LowestFriend()if tF~=nil then if tF.HealthPercent<50 then tt:Cast("Life Cocoon",tF.pointer)end;if tF.HealthPercent<20 then tt:Cast("Revival",tF.pointer)end;if tF.HealthPercent<80 then tt:Cast("Vivify",tF.pointer)end end end;if tD==3 then localenv["CastSpellByName"]("Rising Sun Kick",u.pointer)localenv["CastSpellByName"]("Fists of Fury",u.pointer)localenv["CastSpellByName"]("Blackout Kick",u.pointer)localenv["CastSpellByName"]("Whirling Dragon Punch",u.pointer)localenv["CastSpellByName"]("Tiger Palm",u.pointer)end end end;tt:RegisterRotation(tP.name,tP)end;local function tQ(...)local tt=tt;tt.rotations.Hunter=tt.rotations.BaseRotation:extend()local tR=tt.rotations.Hunter;tR.name="Hunter"tR.class="Hunter"tR.skip=false;function tR:init()end;function tR:SetRange()tt.combatrange=35;tt.pullrange=35 end;function tR:Pull()if localenv["UnitAffectingCombat"]("player")then return self:Pulse()end end;function tR:OOC()if tt.LocalPlayer.pet==false then localenv["CastSpellByName"]("Call Pet 1")end end;function tR:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)if u~=nil then local tE=tt.CombatHelpers:GetClosestCaster(30)if tE~=nil then tt:Cast("Counter Shot",tE.pointer)end;if tD==1 then localenv["CastSpellByName"]("Kill Command")localenv["CastSpellByName"]("Bestial Wrath")localenv["CastSpellByName"]("Cobra Shot")localenv["CastSpellByName"]("Barbed Shot")end;if tD==3 then tt:Cast("Harpoon",u.pointer)tt:Cast("Kill Command",u.pointer)tt:Cast("Wildfire Bomb",u.pointer)tt:Cast("Raptor Strike",u.pointer)end;if tD==2 then local tE=tt.CombatHelpers:GetClosestCaster(30)if tE~=nil then tt:Cast("Counter Shot",tE.pointer)end;if not u:HasDebuff("Hunter's Mark")then localenv["CastSpellByName"]("Hunter's Mark",u.pointer)end;if tt.LocalPlayer.HP<50 then localenv["CastSpellByName"]("Exhilaration")end;localenv["CastSpellByName"]("Kill Shot")localenv["CastSpellByName"]("Rapid Fire")if tt.LocalPlayer:HasBuff("Precise Shots")then localenv["CastSpellByName"]("Multi-Shot",u.pointer)end;localenv["CastSpellByName"]("Aimed Shot",u.pointer)localenv["CastSpellByName"]("Steady Shot",u.pointer)end end end;tt:RegisterRotation(tR.name,tR)end;local function tS(...)local tt=tt;tt.rotations.Priest=class()local tT=tt.rotations.Priest;tT.name="Priest"tT.class="Priest"function tT:init()end;function tT:SetRange()tt.combatrange=35;tt.pullrange=35 end;function tT:OOC()if not tt.LocalPlayer:HasBuff("Power Word: Fortitude")then tt:Cast("Power Word: Fortitude","player")end end;function tT:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)local tE=tt.CombatHelpers:GetClosestCaster(30)if tD==1 then local tF=tt.CombatHelpers:LowestFriend()if tF~=nil then if tF.HP<90 and not tF:HasBuff("Power Word: Shield")then tt:Cast("Power Word: Shield",tF.pointer)end;if tF.HP<85 and not tF:HasBuff("Atonement")then tt:Cast("Power Word: Radiance",tF.pointer)end;if tF.HP<80 and not tF:HasBuff("Renew")then tt:Cast("Renew",tF.pointer)end end;tt:Cast("Mind Blast",u.pointer)tt:Cast("Penance",u.pointer)tt:Cast("Smite",u.pointer)end;if tD==3 then if tE~=nil then tt:Cast("Silence",tE.pointer)end;if not tt.LocalPlayer:HasBuff("Shadowform")then localenv["CastSpellByName"]("Shadowform")end;if not tt.LocalPlayer:HasBuff("Vampiric Embrace")then localenv["CastSpellByName"]("Vampiric Embrace")end;if not u:HasDebuff("Vampiric Touch")then localenv["CastSpellByName"]("Vampiric Touch",u.pointer)end;if not u:HasDebuff("Shadow Word: Pain")then localenv["CastSpellByName"]("Shadow Word: Pain",u.pointer)end;if not u:HasDebuff("Devouring Plague")then localenv["CastSpellByName"]("Devouring Plague",u.pointer)end;localenv["CastSpellByName"]("Mind Blast",u.pointer)localenv["CastSpellByName"]("Mind Flay",u.pointer)end;if tD==2 then local tF=tt.CombatHelpers:LowestFriend()if tF~=nil then if tF.HP<90 then tt:Cast("Prayer of Mending",tF.pointer)end;if tF.HP<80 and not tF:HasBuff("Renew")then tt:Cast("Renew",tF.pointer)end;if tF.HP<60 then tt:Cast("Flash Heal",tF.pointer)end end;tt:Cast("Holy Fire",u.pointer)tt:Cast("Smite",u.pointer)end end end;tt:RegisterRotation(tT.name,tT)end;local function tU(...)local tt=tt;tt.rotations.DemonHunter=tt.rotations.BaseRotation:extend()local tV=tt.rotations.DemonHunter;tV.name="DemonHunter"tV.class="Demon Hunter"function tV:init()end;function tV:SetRange()tt.combatrange=5;tt.pullrange=25 end;function tV:OOC()end;function tV:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)local tE=tt.CombatHelpers:GetClosestCaster(8)if tE~=nil then tt:Cast("Counterspell",tE.pointer)end;if tD==1 then tt:Cast("Blade Dance",u.pointer)tt:Cast("Eye Beam",u.pointer)tt:Cast("Demon's Bite",u.pointer)tt:Cast("Chaos Strike",u.pointer)end;if tD==2 then if not tt.LocalPlayer:HasBuff("Demon Spikes")then tt:Cast("Demon Spikes","player")end;tt:Cast("Metamorphosis","player")tt:Cast("Immolation Aura",u.pointer)tt:Cast("Soul Cleave",u.pointer)tt:Cast("Fracture",u.pointer)tt:Cast("Shear",u.pointer)end end end;tt:RegisterRotation(tV.name,tV)end;local function tW(...)local tt=tt;tt.rotations.Rogue=tt.rotations.BaseRotation:extend()local tX=tt.rotations.Rogue;tX.name="Rogue"tX.class="Rogue"function tX:init()end;function tX:SetRange()tt.combatrange=5;tt.pullrange=25 end;function tX:OOC()if not tt.LocalPlayer:HasBuff("Deadly Poison")then tt:Cast("Deadly Poison","player")end end;function tX:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)local tE=tt.CombatHelpers:GetClosestCaster(8)if tE~=nil then tt:Cast("Kick",tE.pointer)end;local tY=tt.LocalPlayer.combo;if tD==1 then if not tt.LocalPlayer:HasBuff("Slice and Dice")then tt:Cast("Slice and Dice","player")end;if tY==5 and not u:HasDebuff("Crimson Tempest")then tt:Cast("Crimson Tempest",u.pointer)end;if tY==5 and u:HasDebuff("Crimson Tempest")then tt:Cast("Envenom",u.pointer)end;if tY<5 then tt:Cast("Mutilate",u.pointer)end end;if tD==3 then if not tt.LocalPlayer:HasBuff("Slice and Dice")then tt:Cast("Slice and Dice","player")end;if not u:HasDebuff("Rupture")then tt:Cast("Rupture",u.pointer)end;if tY>=5 then tt:Cast("Eviscerate",u.pointer)end;tt:Cast("Gloomblade",u.pointer)end;if tD==2 then if not tt.LocalPlayer:HasBuff("Slice and Dice")then tt:Cast("Slice and Dice","player")end;if tY==5 then tt:Cast("Between the Eyes",u.pointer)tt:Cast("Dispatch",u.pointer)end;if tY<5 then tt:Cast("Pistol Shot",u.pointer)end end end end;tt:RegisterRotation(tX.name,tX)end;local function tZ(...)local tt=tt;tt.rotations.Warlock=tt.rotations.BaseRotation:extend()local t_=tt.rotations.Warlock;t_.name="Warlock"t_.class="Warlock"function t_:init()end;function t_:SetRange()tt.combatrange=35;tt.pullrange=35 end;function t_:OOC()if not tt.LocalPlayer.pet then tt:Cast("Summon Felhunter","player")end end;function t_:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)local tE=tt.CombatHelpers:GetClosestCaster(30)if tE~=nil then end;if tD==1 then if not u:HasDebuff("Agony")then tt:Cast("Agony",u.pointer)end;if not u:HasDebuff("Corruption")then tt:Cast("Corruption",u.pointer)end;if not u:HasDebuff("Unstable Affliction")then tt:Cast("Unstable Affliction",u.pointer)end;tt:Cast("Drain Life",u.pointer)end;if tD==3 then if not u:HasDebuff("Immolate")then tt:Cast("Immolate",u.pointer)end;tt:Cast("Chaos Bolt",u.pointer)tt:Cast("Conflagrate",u.pointer)tt:Cast("Incinerate",u.pointer)end;if tD==2 then if not u:HasDebuff("Corruption")then tt:Cast("Corruption",u.pointer)end;tt:Cast("Hand of Gul'dan",u.pointer)tt:Cast("Demonbolt",u.pointer)end end end;tt:RegisterRotation(t_.name,t_)end;local function u0(...)local tt=tt;tt.rotations.DeathKnight=tt.rotations.BaseRotation:extend()local u1=tt.rotations.DeathKnight;u1.name="DeathKnight"u1.class="Death Knight"function u1:init()end;function u1:SetRange()tt.combatrange=5;tt.pullrange=25 end;function u1:OOC()end;function u1:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)local tE=tt.CombatHelpers:GetClosestCaster(8)if tE~=nil then end;if tD==1 then if tE~=nil then tt:Cast("Asphyxiate",tE.pointer)tt:Cast("Mind Freeze",tE.pointer)end;if not tt.LocalPlayer:HasBuff("Bone Shield")then tt:Cast("Marrowrend",u.pointer)end;if tt.LocalPlayer.HP<40 then tt:Cast("Unbound Fortitude","player")end;if tt.LocalPlayer.HP<60 then tt:Cast("Dancing Rune Weapon","player")end;if tt.LocalPlayer.HP<80 then tt:Cast("Vampiric Blood","player")end;if tt.LocalPlayer.HP<85 then tt:Cast("Death Strike","player")end;tt:Cast("Blood Boil",u.pointer)end;if tD==3 then if not u:HasDebuff("Virulent Plague")then tt:Cast("Outbreak",u.pointer)end;if tt.LocalPlayer.HP<40 then tt:Cast("Unbound Fortitude","player")end;if tt.LocalPlayer.HP<60 then tt:Cast("Dancing Rune Weapon","player")end;if tt.LocalPlayer.HP<80 then tt:Cast("Vampiric Blood","player")end;if tt.LocalPlayer.HP<85 then tt:Cast("Death Strike","player")end;if tt.LocalPlayer:HasBuff("Sudden Doom")then tt:Cast("Death Coil",u.pointer)end;if tt.LocalPlayer:HasBuff("Dark Succor")then tt:Cast("Death Strike",u.pointer)end;tt:Cast("Scourge Strike",u.pointer)end;if tD==2 then if tt.LocalPlayer:HasBuff("Rime")then tt:Cast("Howling Blast",u.pointer)end;if IsUsableSpell("Frost Strike")and tt.LocalPlayer.power>90 then tt:Cast("Frost Strike",u.pointer)end;if IsUsableSpell("Obliterate")and tt.LocalPlayer:HasBuff("Killing Machine")then tt:Cast("Obliterate",u.pointer)end;if IsUsableSpell("Frost Strike")and tt.LocalPlayer.power>70 then tt:Cast("Frost Strike",u.pointer)end;if IsUsableSpell("Obliterate")then tt:Cast("Obliterate",u.pointer)end;if IsUsableSpell("Frost Strike")then tt:Cast("Frost Strike",u.pointer)end end end end;tt:RegisterRotation(u1.name,u1)end;local function u2(...)local tt=tt;tt.rotations.Shaman=tt.rotations.BaseRotation:extend()local u3=tt.rotations.Shaman;u3.name="Shaman"u3.class="Shaman"function u3:init()end;function u3:SetRange()tt.combatrange=35;tt.pullrange=35 end;function u3:OOC()end;function u3:Pulse(u)local tD=GetSpecialization()if UnitCastingInfo("player")~=nil or UnitChannelInfo("player")~=nil then return end;if u~=nil then tt.rotations.BaseRotation:Pulse(u)u=tt.rotations.BaseRotation:NormalizeTarget(u)local tE=tt.CombatHelpers:GetClosestCaster(8)if tE~=nil then end;if tD==1 then tt:Cast("Flame Shock",u.pointer)tt:Cast("Lightning Bolt",u.pointer)end;if tD==3 then end;if tD==2 then end end end;tt:RegisterRotation(u3.name,u3)end;local function u4(...)local tt=tt;tt.CombatHelpers={}local u5=tt.CombatHelpers;function u5:GetClosestCaster(sx)local th=nil;local u6=9999;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<u6 and ae.Distance<sx and ae.Reaction<=3 and ae:IsCasting()then th=ae;u6=ae.Distance end end;return th end;function u5:GetDebuffCount(u7)local iR=0;for ad,ae in pairs(tt.players)do if ae:HasDebuff(u7)then iR=iR+1 end end;return iR end;function u5:GetBuffCount(u7)local iR=0;for ad,ae in pairs(tt.players)do if ae:HasBuff(u7)then iR=iR+1 end end;return iR end;function u5:BelowHealthCount(u8)local iR=0;for ad,ae in pairs(tt.players)do if ae.HealthPercent<u8 then iR=iR+1 end end;return iR end;function u5:ClosestWithOutBuff(u7)local th=nil;local u6=9999;for ad,ae in pairs(tt.players)do if ae.Distance<u6 and ae.Distance<40 and not ae:HasBuff(u7)then th=ae;u6=ae.Distance end end;return th end;function u5:ClosestWithBuff(u7)local th=nil;local u6=9999;for ad,ae in pairs(tt.players)do if ae.Distance<u6 and ae.Distance<40 and ae:HasBuff(u7)then th=ae;u6=ae.Distance end end;return th end;function u5:ClosestWithDebuff(u7)local th=nil;local u6=9999;for ad,ae in pairs(tt.players)do if ae.Distance<u6 and ae.Distance<40 and ae:HasDebuff(u7)then th=ae;u6=ae.Distance end end;return th end;function u5:ClosestWithoutDebuff(u7)local th=nil;local u6=9999;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<u6 and ae.Distance<40 and not ae:HasDebuff(u7)then th=ae;u6=ae.Distance end end;return th end;function u5:LowestFriend()local tF=nil;local u9=101;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<40 and ae.Reaction>4 and ae.HP<u9 and not ae.Dead and ae.HP>0 then tF=ae;u9=ae.HP end end;return tF end;function u5:CountUnderHealth(u8)local iR=0;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<40 and ae.Reaction>4 and ae.HP<u8 and not ae.Dead then iR=iR+1 end end;return iR end;function u5:GetClosestHeal(ua,sx)local th=nil;local u6=9999;for ad,ae in pairs(tt.players)do if ae.Distance~=nil and ae.Distance<u6 and ae.Distance<sx and ae.Reaction>4 and ae.HP<ua and not ae.Dead then th=ae;u6=ae.Distance end end;return th end end;local function ub(...)local tt=tt;local df=LibStub and LibStub("AceGUI-3.0",true)local uc=LibStub("ScrollingTable")tt.ObjectViewer=class()local ud=tt.ObjectViewer;local ue=nil;local uf=nil;local nO=nil;local ug=nil;local r8="|cFF00FF00"local r7="|cffff0000"local uh=""ud.mode="objects"local ef={}function tt:ToggleObjectViewer()if ue:IsShown()then ue:Hide()else ue:Show()end end;function tt:SelectGroup(eW)if eW=="objects"then ud.mode="objects"end;if eW=="players"then ud.mode="players"end;if eW=="units"then ud.mode="units"end;if eW=="areatriggers"then ud.mode="areatriggers"end;local d6=string.gsub(" "..ud.mode,"%W%l",string.upper):sub(2)ue:SetTitle("Object Manager - "..d6)end;function tt:AddColumn(aa)local qR={["name"]=aa,["width"]=100,["align"]="LEFT",["color"]={["r"]=1.0,["g"]=1.0,["b"]=1.0,["a"]=1.0},["colorargs"]=nil,["bgcolor"]={["r"]=0.0,["g"]=0.0,["b"]=0.0,["a"]=1.0}}table.insert(ef,qR)end;function tt:updateObjectViewer()local qi={}local gd=ug:GetSelection()if gd~=nil then row=ug:GetRow(gd)print(row[1])end;if ud.mode=="areatriggers"then for ad,ae in pairs(tt.areatriggers)do local gN={"",ae.name,string.format("%0d",ae.Distance),0,0,0,0,0,ae.radius}table.insert(qi,gN)end end;if ud.mode=="objects"then for ad,ae in pairs(tt.gameobjects)do local gN=ae:ToTable()table.insert(qi,gN)end end;if ud.mode=="players"then for ad,ae in pairs(tt.players)do local gN=ae:ToTable()table.insert(qi,gN)end end;if ud.mode=="units"then for ad,ae in pairs(tt.units)do local gN=ae:ToTable()table.insert(qi,gN)end end;ug:SetData(qi,true)ug:SetWidth(950)ug:EnableSelection()end;if not ue then ue=df:Create("Window","ObjectViewerFrame",UIParent)local d6=string.gsub(" "..ud.mode,"%W%l",string.upper):sub(2)ue:SetTitle("Object Manager - "..d6)ue:SetLayout("Flow")ue:SetWidth(1024)local ui=df:Create("Button")ui:SetText("Objects")ui:SetWidth(100)ui:SetCallback("OnClick",function()tt:SelectGroup("objects")end)ue:AddChild(ui)local uj=df:Create("Button")uj:SetText("Players")uj:SetWidth(100)uj:SetCallback("OnClick",function()tt:SelectGroup("players")end)ue:AddChild(uj)local uk=df:Create("Button")uk:SetText("Units")uk:SetWidth(100)uk:SetCallback("OnClick",function()tt:SelectGroup("units")end)ue:AddChild(uk)local ul=df:Create("Button")ul:SetText("Areatriggers")ul:SetWidth(100)ul:SetCallback("OnClick",function()tt:SelectGroup("areatriggers")end)ue:AddChild(ul)tt:AddColumn("Name")tt:AddColumn("Distance")tt:AddColumn("Score")tt:AddColumn("Next Update")if ug==nil then ug=uc:CreateST(ef,nil,nil,nil,ue.frame)ug:SetFilter(function(self,row)if uh==""then return true else for ad,ae in pairs(row)do if string.find(tostring(ae):lower(),uh:lower(),1,true)then return true end end;return false end end)end;tt:updateObjectViewer()local um=tt.AceGUI:Create("EditBox")um:SetLabel("Search")um:SetWidth(500)um:SetText("Search Here")um:SetCallback("OnTextChanged",function(self,F,fg)uh=fg end)ue:AddChild(um)ue:Hide()end end;local function un(...)local tt=tt;tt.HUD={}local uo=tt.HUD;local up=uo.Frames;local r8="|cFF00FF00"local r7="|cffff0000"local uq="|cffffffff"local ur=1;local us={}local ut=1;local uu={}function uo:CreateHUDFrame(aa,dx,ag,uv,uw)uw=uw and uw or 10;local ev=CreateFrame("Button",aa,up)ev:SetNormalFontObject(GameFontNormalSmall)ev:SetHighlightFontObject(GameFontHighlightSmall)ev:SetWidth(dx)ev:SetHeight(20)ev:SetPoint("TOP",up,uv,ag,uw)return ev end;up=CreateFrame("Frame",nil,UIParent)up:SetWidth(UIParent:GetWidth())up:SetHeight(20)up:SetPoint("TOP",UIParent,"TOP",0,0)up.tex=up:CreateTexture()up.tex:SetAllPoints(up)up.tex:SetColorTexture(0,0,0,0.4)up.Running=uo:CreateHUDFrame("Running",50,550,"LEFT")if tt.running then up.Running:SetText(r8 .."Running")else up.Running:SetText(r7 .."Stopped")end;up.Running:SetScript("OnClick",function(self,gD,ux)if tt.running then tt.running=false;self:SetText(r7 .."Stopped")else tt.running=true;self:SetText(r8 .."Running")end end)for ad,ae in pairs(tt.botbases)do table.insert(us,ad)end;for ad,ae in pairs(tt.rotations)do if string.lower(ae.name)~="skip"and string.lower(ae.class)==string.lower(UnitClass("player"))or ae.class=="all"then table.insert(uu,ad)end end;up.Botbase=uo:CreateHUDFrame("Botbase",50,100,"LEFT")up.Botbase:SetText(uq..us[ur])up.Botbase:SetScript("OnClick",function()ur=ur+1;if ur>#us then ur=1 end;tt.botbase=us[ur]up:Update()end)up.Botbase:Show()up.Rotation=uo:CreateHUDFrame("Rotation",50,200,"LEFT")up.Rotation:SetText(uq..uu[ut])up.Rotation:SetScript("OnClick",function()ut=ut+1;if ut>#uu then ut=1 end;tt.rotation=uu[ut]up:Update()end)up.Botbase:Show()up.RotationConfig=uo:CreateHUDFrame("Rotation",50,250,"LEFT")up.RotationConfig:SetText(uq.."Config")up.RotationConfig:SetScript("OnClick",function()tt.rotations[tt.rotation]:OpenConfig()up:Update()end)up.Botbase:Show()up.ToggleObjectViewer=uo:CreateHUDFrame("ObjectManager",150,350,"LEFT")up.ToggleObjectViewer:SetText("Toggle OM")up.ToggleObjectViewer:SetScript("OnClick",function()tt:ToggleObjectViewer()end)up.ToggleObjectViewer:Show()up.ToggleDebug=uo:CreateHUDFrame("ToggleDebug",150,450,"LEFT")up.ToggleDebug:SetText("Toggle Debug")up.ToggleDebug:SetScript("OnClick",function()if tt.doDebugging then tt.doDebugging=false else tt.doDebugging=true end;print("Debugging is now",tt.doDebugging)end)up.StatusBarText=uo:CreateHUDFrame("StatusText",50,0,"CENTER")up.StatusBarText:SetText("|c0000ff00Current Status")function up:Update()up.Botbase:SetText(uq..us[ur])up.Rotation:SetText(uq..uu[ut])if tt.running then up.Running:SetText(r8 .."Running")else up.Running:SetText(r7 .."Stopped")end end;function tt:UpdateHUD()up:Update()end;function tt:SetStatusText(fg)up.StatusBarText:SetText("|c0000ff00 Status: "..fg)end end;local function uy(...)local tt=tt;tt.ShowSpots={}local uz=tt.ShowSpots;local uA=nil;if not uA then uA=tt.AceGUI:Create("Frame")uA:SetTitle("Spots")uA:SetStatusText("Spots")uA:SetLayout("Flow")uA:SetWidth(600)uA:SetHeight(650)uA:EnableResize(false)local uB=tt.AceGUI:Create("MultiLineEditBox")uB:SetLabel("Bad Spots")uB:SetWidth(600)uB:SetHeight(300)uA:AddChild(uB)local uC=tt.AceGUI:Create("MultiLineEditBox")uC:SetLabel("Move Spots")uC:SetWidth(600)uC:SetHeight(300)uA:AddChild(uC)end;uA:Hide()end;local function uD(...)local tt=tt;tt.Log={}local uE=tt.Log;local bx;if not bx then bx=tt.AceGUI:Create("Frame")bx:SetTitle("Log")bx:SetLayout("Fill")bx:SetWidth(500)bx:SetHeight(500)bx:EnableResize(false)bx.editbox=tt.AceGUI:Create("MultiLineEditBox")bx.editbox:SetLabel("Log")bx.editbox:SetFullWidth(true)bx.editbox:SetFullHeight(true)bx.editbox:SetDisabled(false)bx:AddChild(bx.editbox)end;function uE:Add(b8)local uF=bx.editbox:GetText()bx.editbox:SetText(uF.."\n"..b8)end;local uG;local uH=print;print=function(...)if uG~=...then uG=...uH(...)tt.Log:Add(...)end end end;local function uI(...)local tt=tt;tt.changelog={"Initial release","Fixed studder stepping","Added range cooldown checks for spell","More classes added","Fixed mounting"}tt.version="1.0.1"end;a(...)h(...)N(...)aB(...)aD(...)aW(...)b9(...)bz(...)cn(...)cG(...)cU(...)dc(...)eH(...)eU(...)f3(...)ft(...)fu(...)fI(...)fJ(...)gv(...)hp(...)hT(...)hX(...)i8(...)il(...)jn(...)jx(...)jH(...)jI(...)jJ(...)jM(...)jY(...)k4(...)kn(...)kC(...)lb(...)mh(...)o2(...)o6(...)oE(...)p1(...)pU(...)qk(...)qq(...)rB(...)rE(...)rI(...)r_(...)s2(...)s8(...)sq(...)su(...)sy(...)sM(...)sO(...)sQ(...)sW(...)tj(...)tl(...)tr(...)tv(...)tx(...)tH(...)tK(...)tM(...)tO(...)tQ(...)tS(...)tU(...)tW(...)tZ(...)u0(...)u2(...)u4(...)ub(...)un(...)uy(...)uD(...)uI(...)
