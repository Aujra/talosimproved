local function a(...)local b,c="LibStub",2;local LibStub=_G[b]if not LibStub or LibStub.minor<c then LibStub=LibStub or{libs={},minors={}}_G[b]=LibStub;LibStub.minor=c;function LibStub:NewLibrary(d,e)assert(type(d)=="string","Bad argument #2 to `NewLibrary' (string expected)")e=assert(tonumber(string.match(e,"%d+")),"Minor version must either be a number or contain a number.")local f=self.minors[d]if f and f>=e then return nil end;self.minors[d],self.libs[d]=e,self.libs[d]or{}return self.libs[d],f end;function LibStub:GetLibrary(d,g)if not self.libs[d]and not g then error(("Cannot find a library instance of %q."):format(tostring(d)),2)end;return self.libs[d],self.minors[d]end;function LibStub:IterateLibraries()return pairs(self.libs)end;setmetatable(LibStub,{__call=LibStub.GetLibrary})end end;local function h(...)local i,k="CallbackHandler-1.0",8;local l=LibStub:NewLibrary(i,k)if not l then return end;local m={__index=function(n,o)n[o]={}return n[o]end}local securecallfunction,error=securecallfunction,error;local setmetatable,rawget=setmetatable,rawget;local next,select,pairs,type,tostring=next,select,pairs,type,tostring;local function p(q,...)local r,s=next(q)if not s then return end;repeat securecallfunction(s,...)r,s=next(q,r)until not s end;function l.New(t,u,v,w,x)v=v or"RegisterCallback"w=w or"UnregisterCallback"if x==nil then x="UnregisterAllCallbacks"end;local y=setmetatable({},m)local z={recurse=0,events=y}function z:Fire(A,...)if not rawget(y,A)or not next(y[A])then return end;local B=z.recurse;z.recurse=B+1;p(y[A],A,...)z.recurse=B;if z.insertQueue and B==0 then for C,D in pairs(z.insertQueue)do local E=not rawget(y,C)or not next(y[C])for F,G in pairs(D)do y[C][F]=G;if E and z.OnUsed then z.OnUsed(z,u,C)E=nil end end end;z.insertQueue=nil end end;u[v]=function(self,A,s,...)if type(A)~="string"then error("Usage: "..v.."(eventname, method[, arg]): 'eventname' - string expected.",2)end;s=s or A;local E=not rawget(y,A)or not next(y[A])if type(s)~="string"and type(s)~="function"then error("Usage: "..v.."(\"eventname\", \"methodname\"): 'methodname' - string or function expected.",2)end;local H;if type(s)=="string"then if type(self)~="table"then error("Usage: "..v.."(\"eventname\", \"methodname\"): self was not a table?",2)elseif self==u then error("Usage: "..v.."(\"eventname\", \"methodname\"): do not use Library:"..v.."(), use your own 'self'",2)elseif type(self[s])~="function"then error("Usage: "..v.."(\"eventname\", \"methodname\"): 'methodname' - method '"..tostring(s).."' not found on self.",2)end;if select("#",...)>=1 then local I=select(1,...)H=function(...)self[s](self,I,...)end else H=function(...)self[s](self,...)end end else if type(self)~="table"and type(self)~="string"and type(self)~="thread"then error("Usage: "..v.."(self or \"addonId\", eventname, method): 'self or addonId': table or string or thread expected.",2)end;if select("#",...)>=1 then local I=select(1,...)H=function(...)s(I,...)end else H=s end end;if y[A][self]or z.recurse<1 then y[A][self]=H;if z.OnUsed and E then z.OnUsed(z,u,A)end else z.insertQueue=z.insertQueue or setmetatable({},m)z.insertQueue[A][self]=H end end;u[w]=function(self,A)if not self or self==u then error("Usage: "..w.."(eventname): bad 'self'",2)end;if type(A)~="string"then error("Usage: "..w.."(eventname): 'eventname' - string expected.",2)end;if rawget(y,A)and y[A][self]then y[A][self]=nil;if z.OnUnused and not next(y[A])then z.OnUnused(z,u,A)end end;if z.insertQueue and rawget(z.insertQueue,A)and z.insertQueue[A][self]then z.insertQueue[A][self]=nil end end;if x then u[x]=function(...)if select("#",...)<1 then error("Usage: "..x.."([whatFor]): missing 'self' or \"addonId\" to unregister events for.",2)end;if select("#",...)==1 and...==u then error("Usage: "..x.."([whatFor]): supply a meaningful 'self' or \"addonId\"",2)end;for J=1,select("#",...)do local self=select(J,...)if z.insertQueue then for A,D in pairs(z.insertQueue)do if D[self]then D[self]=nil end end end;for A,D in pairs(y)do if D[self]then D[self]=nil;if z.OnUnused and not next(D)then z.OnUnused(z,u,A)end end end end end end;return z end end;local function K(...)local i,k="AceAddon-3.0",13;local L,f=LibStub:NewLibrary(i,k)if not L then return end;L.frame=L.frame or CreateFrame("Frame","AceAddon30Frame")L.addons=L.addons or{}L.statuses=L.statuses or{}L.initializequeue=L.initializequeue or{}L.enablequeue=L.enablequeue or{}L.embeds=L.embeds or setmetatable({},{__index=function(n,o)n[o]={}return n[o]end})local M,N,O=table.insert,table.concat,table.remove;local P,tostring=string.format,tostring;local select,pairs,next,type,unpack=select,pairs,next,type,unpack;local loadstring,assert,error=loadstring,assert,error;local setmetatable,getmetatable,rawset,rawget=setmetatable,getmetatable,rawset,rawget;local xpcall=xpcall;local function Q(R)return geterrorhandler()(R)end;local function S(G,...)if type(G)=="function"then return xpcall(G,Q,...)end end;local T,U,V,W,X,Y,Z,_,a0,a1,a2,a3;local function a4(self)return self.name end;local function a5(a6)for J=1,#L.initializequeue do if L.initializequeue[J]==a6 then return true end end;return false end;function L:NewAddon(a7,...)local F,a8;local J=1;if type(a7)=="table"then F=a7;a8=...J=2 else a8=a7 end;if type(a8)~="string"then error(("Usage: NewAddon([object,] name, [lib, lib, lib, ...]): 'name' - string expected got '%s'."):format(type(a8)),2)end;if self.addons[a8]then error(("Usage: NewAddon([object,] name, [lib, lib, lib, ...]): 'name' - Addon '%s' already exists."):format(a8),2)end;F=F or{}F.name=a8;local a9={}local aa=getmetatable(F)if aa then for ab,ac in pairs(aa)do a9[ab]=ac end end;a9.__tostring=a4;setmetatable(F,a9)self.addons[a8]=F;F.modules={}F.orderedModules={}F.defaultModuleLibraries={}X(F)self:EmbedLibraries(F,select(J,...))M(self.initializequeue,F)return F end;function L:GetAddon(a8,g)if not g and not self.addons[a8]then error(("Usage: GetAddon(name): 'name' - Cannot find an AceAddon '%s'."):format(tostring(a8)),2)end;return self.addons[a8]end;function L:EmbedLibraries(a6,...)for J=1,select("#",...)do local ad=select(J,...)self:EmbedLibrary(a6,ad,false,4)end end;function L:EmbedLibrary(a6,ad,g,ae)local af=LibStub:GetLibrary(ad,true)if not af and not g then error(("Usage: EmbedLibrary(addon, libname, silent, offset): 'libname' - Cannot find a library instance of %q."):format(tostring(ad)),ae or 2)elseif af and type(af.Embed)=="function"then af:Embed(a6)M(self.embeds[a6],ad)return true elseif af then error(("Usage: EmbedLibrary(addon, libname, silent, offset): 'libname' - Library '%s' is not Embed capable"):format(ad),ae or 2)end end;function Z(self,a8,g)if not self.modules[a8]and not g then error(("Usage: GetModule(name, silent): 'name' - Cannot find module '%s'."):format(tostring(a8)),2)end;return self.modules[a8]end;local function ag(self)return true end;function Y(self,a8,ah,...)if type(a8)~="string"then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'name' - string expected got '%s'."):format(type(a8)),2)end;if type(ah)~="string"and type(ah)~="table"and type(ah)~="nil"then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'prototype' - table (prototype), string (lib) or nil expected got '%s'."):format(type(ah)),2)end;if self.modules[a8]then error(("Usage: NewModule(name, [prototype, [lib, lib, lib, ...]): 'name' - Module '%s' already exists."):format(a8),2)end;local ai=L:NewAddon(P("%s_%s",self.name or tostring(self),a8))ai.IsModule=ag;ai:SetEnabledState(self.defaultModuleState)ai.moduleName=a8;if type(ah)=="string"then L:EmbedLibraries(ai,ah,...)else L:EmbedLibraries(ai,...)end;L:EmbedLibraries(ai,unpack(self.defaultModuleLibraries))if not ah or type(ah)=="string"then ah=self.defaultModulePrototype or nil end;if type(ah)=="table"then local aj=getmetatable(ai)aj.__index=ah;setmetatable(ai,aj)end;S(self.OnModuleCreated,self,ai)self.modules[a8]=ai;M(self.orderedModules,ai)return ai end;function _(self)return self.moduleName or self.name end;function T(self)self:SetEnabledState(true)if not a5(self)then return L:EnableAddon(self)end end;function U(self)self:SetEnabledState(false)return L:DisableAddon(self)end;function V(self,a8)local ai=self:GetModule(a8)return ai:Enable()end;function W(self,a8)local ai=self:GetModule(a8)return ai:Disable()end;function a1(self,...)if next(self.modules)then error("Usage: SetDefaultModuleLibraries(...): cannot change the module defaults after a module has been registered.",2)end;self.defaultModuleLibraries={...}end;function a0(self,ak)if next(self.modules)then error("Usage: SetDefaultModuleState(state): cannot change the module defaults after a module has been registered.",2)end;self.defaultModuleState=ak end;function a3(self,ah)if next(self.modules)then error("Usage: SetDefaultModulePrototype(prototype): cannot change the module defaults after a module has been registered.",2)end;if type(ah)~="table"then error(("Usage: SetDefaultModulePrototype(prototype): 'prototype' - table expected got '%s'."):format(type(ah)),2)end;self.defaultModulePrototype=ah end;function a2(self,ak)self.enabledState=ak end;local function al(self)return pairs(self.modules)end;local function am(self)return pairs(L.embeds[self])end;local function an(self)return self.enabledState end;local ao={NewModule=Y,GetModule=Z,Enable=T,Disable=U,EnableModule=V,DisableModule=W,IsEnabled=an,SetDefaultModuleLibraries=a1,SetDefaultModuleState=a0,SetDefaultModulePrototype=a3,SetEnabledState=a2,IterateModules=al,IterateEmbeds=am,GetName=_}local function ap(self)return false end;local aq={defaultModuleState=true,enabledState=true,IsModule=ap}function X(u,ar)for ab,ac in pairs(ao)do u[ab]=ac end;if not ar then for ab,ac in pairs(aq)do u[ab]=u[ab]or ac end end end;function L:InitializeAddon(a6)S(a6.OnInitialize,a6)local as=self.embeds[a6]for J=1,#as do local af=LibStub:GetLibrary(as[J],true)if af then S(af.OnEmbedInitialize,af,a6)end end end;function L:EnableAddon(a6)if type(a6)=="string"then a6=L:GetAddon(a6)end;if self.statuses[a6.name]or not a6.enabledState then return false end;self.statuses[a6.name]=true;S(a6.OnEnable,a6)if self.statuses[a6.name]then local as=self.embeds[a6]for J=1,#as do local af=LibStub:GetLibrary(as[J],true)if af then S(af.OnEmbedEnable,af,a6)end end;local at=a6.orderedModules;for J=1,#at do self:EnableAddon(at[J])end end;return self.statuses[a6.name]end;function L:DisableAddon(a6)if type(a6)=="string"then a6=L:GetAddon(a6)end;if not self.statuses[a6.name]then return false end;self.statuses[a6.name]=false;S(a6.OnDisable,a6)if not self.statuses[a6.name]then local as=self.embeds[a6]for J=1,#as do local af=LibStub:GetLibrary(as[J],true)if af then S(af.OnEmbedDisable,af,a6)end end;local at=a6.orderedModules;for J=1,#at do self:DisableAddon(at[J])end end;return not self.statuses[a6.name]end;function L:IterateAddons()return pairs(self.addons)end;function L:IterateAddonStatus()return pairs(self.statuses)end;function L:IterateEmbedsOnAddon(a6)return pairs(self.embeds[a6])end;function L:IterateModulesOfAddon(a6)return pairs(a6.modules)end;local au={Blizzard_DebugTools=true,Blizzard_TimeManager=true,Blizzard_BattlefieldMap=true,Blizzard_MapCanvas=true,Blizzard_SharedMapDataProviders=true,Blizzard_CombatLog=true}local function av(aw,C,ax)if C=="ADDON_LOADED"and(ax==nil or not au[ax])or C=="PLAYER_LOGIN"then while#L.initializequeue>0 do local a6=O(L.initializequeue,1)if C=="ADDON_LOADED"then a6.baseName=ax end;L:InitializeAddon(a6)M(L.enablequeue,a6)end;if IsLoggedIn()then while#L.enablequeue>0 do local a6=O(L.enablequeue,1)L:EnableAddon(a6)end end end end;L.frame:RegisterEvent("ADDON_LOADED")L.frame:RegisterEvent("PLAYER_LOGIN")L.frame:SetScript("OnEvent",av)for a8,a6 in pairs(L.addons)do X(a6,true)end;if f and f<10 then for a8,a6 in pairs(L.addons)do a6.orderedModules={}for ay,ai in pairs(a6.modules)do M(a6.orderedModules,ai)end end end end;local function az(...)local l=LibStub("CallbackHandler-1.0")local i,k="AceEvent-3.0",4;local aA=LibStub:NewLibrary(i,k)if not aA then return end;local pairs=pairs;aA.frame=aA.frame or CreateFrame("Frame","AceEvent30Frame")aA.embeds=aA.embeds or{}if not aA.events then aA.events=l:New(aA,"RegisterEvent","UnregisterEvent","UnregisterAllEvents")end;function aA.events:OnUsed(u,A)aA.frame:RegisterEvent(A)end;function aA.events:OnUnused(u,A)aA.frame:UnregisterEvent(A)end;if not aA.messages then aA.messages=l:New(aA,"RegisterMessage","UnregisterMessage","UnregisterAllMessages")aA.SendMessage=aA.messages.Fire end;local ao={"RegisterEvent","UnregisterEvent","RegisterMessage","UnregisterMessage","SendMessage","UnregisterAllEvents","UnregisterAllMessages"}function aA:Embed(u)for ab,ac in pairs(ao)do u[ac]=self[ac]end;self.embeds[u]=true;return u end;function aA:OnEmbedDisable(u)u:UnregisterAllEvents()u:UnregisterAllMessages()end;local y=aA.events;aA.frame:SetScript("OnEvent",function(aw,C,...)y:Fire(C,...)end)for u,ac in pairs(aA.embeds)do aA:Embed(u)end end;local function aB(...)local i,k="AceTimer-3.0",17;local aC,f=LibStub:NewLibrary(i,k)if not aC then return end;aC.activeTimers=aC.activeTimers or{}local aD=aC.activeTimers;local type,unpack,next,error,select=type,unpack,next,error,select;local GetTime,aE=GetTime,C_Timer.After;local function aF(self,aG,G,aH,...)if aH<0.01 then aH=0.01 end;local aI={object=self,func=G,looping=aG,argsCount=select("#",...),delay=aH,ends=GetTime()+aH,...}aD[aI]=aI;aI.callback=function()if not aI.cancelled then if type(aI.func)=="string"then aI.object[aI.func](aI.object,unpack(aI,1,aI.argsCount))else aI.func(unpack(aI,1,aI.argsCount))end;if aI.looping and not aI.cancelled then local aJ=GetTime()local aK=aI.delay-(aJ-aI.ends)if aK<0.01 then aK=0.01 end;aE(aK,aI.callback)aI.ends=aJ+aK else aD[aI.handle or aI]=nil end end end;aE(aH,aI.callback)return aI end;function aC:ScheduleTimer(G,aH,...)if not G or not aH then error(i..": ScheduleTimer(callback, delay, args...): 'callback' and 'delay' must have set values.",2)end;if type(G)=="string"then if type(self)~="table"then error(i..": ScheduleTimer(callback, delay, args...): 'self' - must be a table.",2)elseif not self[G]then error(i..": ScheduleTimer(callback, delay, args...): Tried to register '"..G.."' as the callback, but it doesn't exist in the module.",2)end end;return aF(self,nil,G,aH,...)end;function aC:ScheduleRepeatingTimer(G,aH,...)if not G or not aH then error(i..": ScheduleRepeatingTimer(callback, delay, args...): 'callback' and 'delay' must have set values.",2)end;if type(G)=="string"then if type(self)~="table"then error(i..": ScheduleRepeatingTimer(callback, delay, args...): 'self' - must be a table.",2)elseif not self[G]then error(i..": ScheduleRepeatingTimer(callback, delay, args...): Tried to register '"..G.."' as the callback, but it doesn't exist in the module.",2)end end;return aF(self,true,G,aH,...)end;function aC:CancelTimer(aL)local aI=aD[aL]if not aI then return false else aI.cancelled=true;aD[aL]=nil;return true end end;function aC:CancelAllTimers()for ab,ac in next,aD do if ac.object==self then aC.CancelTimer(self,ab)end end end;function aC:TimeLeft(aL)local aI=aD[aL]if not aI then return 0 else return aI.ends-GetTime()end end;if f and f<10 then aC.frame:SetScript("OnUpdate",nil)aC.frame:SetScript("OnEvent",nil)aC.frame:UnregisterAllEvents()for F,aM in next,aC.selfs do for aN,aI in next,aM do if type(aI)=="table"and aI.callback then local aO;if aI.delay then aO=aC.ScheduleRepeatingTimer(aI.object,aI.callback,aI.delay,aI.arg)else aO=aC.ScheduleTimer(aI.object,aI.callback,aI.when-GetTime(),aI.arg)end;aD[aO]=nil;aD[aN]=aO;aO.handle=aN end end end;aC.selfs=nil;aC.hash=nil;aC.debug=nil elseif f and f<17 then aC.inactiveTimers=nil;aC.frame=nil;local aP=aC.activeTimers;aC.activeTimers={}aD=aC.activeTimers;for aN,aI in next,aP do local aO;local aQ,aR=aI:GetDuration(),aI:GetElapsed()aI:GetParent():Stop()if aI.looping then aO=aC.ScheduleRepeatingTimer(aI.object,aI.func,aQ,unpack(aI.args,1,aI.argsCount))else aO=aC.ScheduleTimer(aI.object,aI.func,aQ-aR,unpack(aI.args,1,aI.argsCount))end;aD[aO]=nil;aD[aN]=aO;aO.handle=aN end;if f<13 and aC.hashCompatTable then for aN,aL in next,aC.hashCompatTable do local aS=aD[aL]if aS then aD[aL]=nil;aD[aN]=aS;aS.handle=aN end end;aC.hashCompatTable=nil end end;aC.embeds=aC.embeds or{}local ao={"ScheduleTimer","ScheduleRepeatingTimer","CancelTimer","CancelAllTimers","TimeLeft"}function aC:Embed(u)aC.embeds[u]=true;for aT,ac in next,ao do u[ac]=aC[ac]end;return u end;function aC:OnEmbedDisable(u)u:CancelAllTimers()end;for a6 in next,aC.embeds do aC:Embed(a6)end end;local function aU(...)local i,k="AceBucket-3.0",4;local aV,f=LibStub:NewLibrary(i,k)if not aV then return end;aV.buckets=aV.buckets or{}aV.embeds=aV.embeds or{}local aA,aC;local N=table.concat;local type,next,pairs,select=type,next,pairs,select;local tonumber,tostring,rawset=tonumber,tostring,rawset;local assert,loadstring,error=assert,loadstring,error;local aW=setmetatable({},{__mode='k'})local xpcall=xpcall;local function Q(R)return geterrorhandler()(R)end;local function S(G,...)if G then return xpcall(G,Q,...)end end;local function aX(aY)local aZ=aY.received;if next(aZ)~=nil then local a_=aY.callback;if type(a_)=="string"then S(aY.object[a_],aY.object,aZ)else S(a_,aZ)end;for ab in pairs(aZ)do aZ[ab]=nil end;aY.timer=aC.ScheduleTimer(aY,aX,aY.interval,aY)else aY.timer=nil end end;local function b0(self,C,ax)if ax==nil then ax="nil"end;self.received[ax]=(self.received[ax]or 0)+1;if not self.timer then self.timer=aC.ScheduleTimer(self,aX,self.interval,self)end end;local function b1(self,C,b2,a_,b3)if not aA or not aC then aA=LibStub:GetLibrary("AceEvent-3.0",true)aC=LibStub:GetLibrary("AceTimer-3.0",true)if not aA or not aC then error(i.." requires AceEvent-3.0 and AceTimer-3.0",3)end end;if type(C)~="string"and type(C)~="table"then error("Usage: RegisterBucket(event, interval, callback): 'event' - string or table expected.",3)end;if not a_ then if type(C)=="string"then a_=C else error("Usage: RegisterBucket(event, interval, callback): cannot omit callback when event is not a string.",3)end end;if not tonumber(b2)then error("Usage: RegisterBucket(event, interval, callback): 'interval' - number expected.",3)end;if type(a_)~="string"and type(a_)~="function"then error("Usage: RegisterBucket(event, interval, callback): 'callback' - string or function or nil expected.",3)end;if type(a_)=="string"and type(self[a_])~="function"then error("Usage: RegisterBucket(event, interval, callback): 'callback' - method not found on target object.",3)end;local aY=next(aW)if aY then aW[aY]=nil else aY={handler=b0,received={}}end;aY.object,aY.callback,aY.interval=self,a_,tonumber(b2)local b4=b3 and aA.RegisterMessage or aA.RegisterEvent;if type(C)=="table"then for aT,b5 in pairs(C)do b4(aY,b5,"handler")end else b4(aY,C,"handler")end;local aN=tostring(aY)aV.buckets[aN]=aY;return aN end;function aV:RegisterBucketEvent(C,b2,a_)return b1(self,C,b2,a_,false)end;function aV:RegisterBucketMessage(b6,b2,a_)return b1(self,b6,b2,a_,true)end;function aV:UnregisterBucket(aN)local aY=aV.buckets[aN]if aY then aA.UnregisterAllEvents(aY)aA.UnregisterAllMessages(aY)for ab in pairs(aY.received)do aY.received[ab]=nil end;if aY.timer then aC.CancelTimer(aY,aY.timer)aY.timer=nil end;aV.buckets[aN]=nil;aW[aY]=true end end;function aV:UnregisterAllBuckets()for aN,aY in pairs(aV.buckets)do if aY.object==self then aV.UnregisterBucket(self,aN)end end end;local ao={"RegisterBucketEvent","RegisterBucketMessage","UnregisterBucket","UnregisterAllBuckets"}function aV:Embed(u)for aT,ac in pairs(ao)do u[ac]=self[ac]end;self.embeds[u]=true;return u end;function aV:OnEmbedDisable(u)u:UnregisterAllBuckets()end;for a6 in pairs(aV.embeds)do aV:Embed(a6)end end;local function b7(...)local b8,b9="AceHook-3.0",9;local ba,f=LibStub:NewLibrary(b8,b9)if not ba then return end;ba.embeded=ba.embeded or{}ba.registry=ba.registry or setmetatable({},{__index=function(n,o)n[o]={}return n[o]end})ba.handlers=ba.handlers or{}ba.actives=ba.actives or{}ba.scripts=ba.scripts or{}ba.onceSecure=ba.onceSecure or{}ba.hooks=ba.hooks or{}local z=ba.registry;local q=ba.handlers;local bb=ba.actives;local bc=ba.scripts;local bd=ba.onceSecure;local pairs,next,type=pairs,next,type;local be=string.format;local assert,error=assert,error;local issecurevariable,hooksecurefunc=issecurevariable,hooksecurefunc;local _G=_G;local bf,bg,bh;local bi={OnClick=true}local ao={"Hook","SecureHook","HookScript","SecureHookScript","Unhook","UnhookAll","IsHooked","RawHook","RawHookScript"}function ba:Embed(u)for ab,ac in pairs(ao)do u[ac]=self[ac]end;self.embeded[u]=true;u.hooks=u.hooks or{}return u end;function ba:OnEmbedDisable(u)u:UnhookAll()end;function bg(self,bj,bk,bl,bm)local bn;local s=type(bj)=="string"if bm and not bl then bn=function(...)if bb[bn]then if s then self[bj](self,...)else bj(...)end end;return bk(...)end else bn=function(...)if bb[bn]then if s then return self[bj](self,...)else return bj(...)end elseif not bl then return bk(...)end end end;return bn end;function bf()end;function bh(self,bo,s,bj,bp,bl,bq,br,bs)if not bj then bj=s end;assert(not bp or type(bp)=="boolean")assert(not bl or type(bl)=="boolean")assert(not bq or type(bq)=="boolean")assert(not br or type(br)=="boolean")assert(bs)if bo and type(bo)~="table"then error(be("%s: 'object' - nil or table expected got %s",bs,type(bo)),3)end;if type(s)~="string"then error(be("%s: 'method' - string expected got %s",bs,type(s)),3)end;if type(bj)~="string"and type(bj)~="function"then error(be("%s: 'handler' - nil, string, or function expected got %s",bs,type(bj)),3)end;if type(bj)=="string"and type(self[bj])~="function"then error(be("%s: 'handler' - Handler specified does not exist at self[handler]",bs),3)end;if bp then if not bo or not bo.GetScript or not bo:HasScript(s)then error(be("%s: You can only hook a script on a frame object",bs),3)end;if not bl and bo.IsProtected and bo:IsProtected()and bi[s]then error(be("Cannot hook secure script %q; Use SecureHookScript(obj, method, [handler]) instead.",s),3)end else local bt;if bo then bt=bd[bo]and bd[bo][s]or issecurevariable(bo,s)else bt=bd[s]or issecurevariable(s)end;if bt then if br then if bo then bd[bo]=bd[bo]or{}bd[bo][s]=true else bd[s]=true end elseif not bl then error(be("%s: Attempt to hook secure function %s. Use `SecureHook' or add `true' to the argument list to override.",bs,s),3)end end end;local bn;if bo then bn=z[self][bo]and z[self][bo][s]else bn=z[self][s]end;if bn then if bb[bn]then error(be("Attempting to rehook already active hook %s.",s))end;if q[bn]==bj then bb[bn]=true;return elseif bo then if self.hooks and self.hooks[bo]then self.hooks[bo][s]=nil end;z[self][bo][s]=nil else if self.hooks then self.hooks[s]=nil end;z[self][s]=nil end;q[bn],bb[bn],bc[bn]=nil,nil,nil end;local bk;if bp then bk=bo:GetScript(s)or bf elseif bo then bk=bo[s]else bk=_G[s]end;if not bk then error(be("%s: Attempting to hook a non existing target",bs),3)end;bn=bg(self,bj,bk,bl,not(bq or bl))if bo then self.hooks[bo]=self.hooks[bo]or{}z[self][bo]=z[self][bo]or{}z[self][bo][s]=bn;if not bl then self.hooks[bo][s]=bk end;if bp then if not bl then bo:SetScript(s,bn)else bo:HookScript(s,bn)end else if not bl then bo[s]=bn else hooksecurefunc(bo,s,bn)end end else z[self][s]=bn;if not bl then _G[s]=bn;self.hooks[s]=bk else hooksecurefunc(s,bn)end end;bb[bn],q[bn],bc[bn]=true,bj,bp and true or nil end;function ba:Hook(F,s,bj,bu)if type(F)=="string"then s,bj,bu,F=F,s,bj,nil end;if bj==true then bj,bu=nil,true end;bh(self,F,s,bj,false,false,false,bu or false,"Usage: Hook([object], method, [handler], [hookSecure])")end;function ba:RawHook(F,s,bj,bu)if type(F)=="string"then s,bj,bu,F=F,s,bj,nil end;if bj==true then bj,bu=nil,true end;bh(self,F,s,bj,false,false,true,bu or false,"Usage: RawHook([object], method, [handler], [hookSecure])")end;function ba:SecureHook(F,s,bj)if type(F)=="string"then s,bj,F=F,s,nil end;bh(self,F,s,bj,false,true,false,false,"Usage: SecureHook([object], method, [handler])")end;function ba:HookScript(bv,bp,bj)bh(self,bv,bp,bj,true,false,false,false,"Usage: HookScript(object, method, [handler])")end;function ba:RawHookScript(bv,bp,bj)bh(self,bv,bp,bj,true,false,true,false,"Usage: RawHookScript(object, method, [handler])")end;function ba:SecureHookScript(bv,bp,bj)bh(self,bv,bp,bj,true,true,false,false,"Usage: SecureHookScript(object, method, [handler])")end;function ba:Unhook(bo,s)local bs="Usage: Unhook([obj], method)"if type(bo)=="string"then s,bo=bo,nil end;if bo and type(bo)~="table"then error(be("%s: 'obj' - expecting nil or table got %s",bs,type(bo)),2)end;if type(s)~="string"then error(be("%s: 'method' - expeting string got %s",bs,type(s)),2)end;local bn;if bo then bn=z[self][bo]and z[self][bo][s]else bn=z[self][s]end;if not bn or not bb[bn]then return false end;bb[bn],q[bn]=nil,nil;if bo then z[self][bo][s]=nil;z[self][bo]=next(z[self][bo])and z[self][bo]or nil;if not self.hooks[bo]or not self.hooks[bo][s]then return true end;if bc[bn]and bo:GetScript(s)==bn then bo:SetScript(s,self.hooks[bo][s]~=bf and self.hooks[bo][s]or nil)bc[bn]=nil elseif bo and self.hooks[bo]and self.hooks[bo][s]and bo[s]==bn then bo[s]=self.hooks[bo][s]end;self.hooks[bo][s]=nil;self.hooks[bo]=next(self.hooks[bo])and self.hooks[bo]or nil else z[self][s]=nil;if not self.hooks[s]then return true end;if self.hooks[s]and _G[s]==bn then _G[s]=self.hooks[s]end;self.hooks[s]=nil end;return true end;function ba:UnhookAll()for o,bw in pairs(z[self])do if type(o)=="table"then for s in pairs(bw)do ba.Unhook(self,o,s)end else ba.Unhook(self,o)end end end;function ba:IsHooked(bo,s)if type(bo)=="string"then if z[self][bo]and bb[z[self][bo]]then return true,q[z[self][bo]]end else if z[self][bo]and z[self][bo][s]and bb[z[self][bo][s]]then return true,q[z[self][bo][s]]end end;return false,nil end;for u,ac in pairs(ba.embeded)do ba:Embed(u)end end;local function bx(...)local by,bz="AceDB-3.0",28;local bA=LibStub:NewLibrary(by,bz)if not bA then return end;local type,pairs,next,error=type,pairs,next,error;local setmetatable,rawset,rawget=setmetatable,rawset,rawget;local _G=_G;bA.db_registry=bA.db_registry or{}bA.frame=bA.frame or CreateFrame("Frame")local l;local bB={Fire=function()end}local bC={}local function bD(bE,bF)if type(bF)~="table"then bF={}end;if type(bE)=="table"then for ab,ac in pairs(bE)do if type(ac)=="table"then ac=bD(ac,bF[ab])end;bF[ab]=ac end end;return bF end;local function bG(bF,bE)for ab,ac in pairs(bE)do if ab=="*"or ab=="**"then if type(ac)=="table"then local aj={__index=function(aS,bH)if bH==nil then return nil end;local n={}bG(n,ac)rawset(aS,bH,n)return n end}setmetatable(bF,aj)for bI,bJ in pairs(bF)do if not rawget(bE,bI)and type(bJ)=="table"then bG(bJ,ac)end end else local aj={__index=function(aS,bH)return bH~=nil and ac or nil end}setmetatable(bF,aj)end elseif type(ac)=="table"then if not rawget(bF,ab)then rawset(bF,ab,{})end;if type(bF[ab])=="table"then bG(bF[ab],ac)if bE['**']then bG(bF[ab],bE['**'])end end else if rawget(bF,ab)==nil then rawset(bF,ab,ac)end end end end;local function bK(bL,bM,bN)setmetatable(bL,nil)for ab,ac in pairs(bM)do if ab=="*"or ab=="**"then if type(ac)=="table"then for o,bw in pairs(bL)do if type(bw)=="table"then if bM[o]==nil and(not bN or bN[o]==nil)then bK(bw,ac)if next(bw)==nil then bL[o]=nil end elseif ab=="**"then bK(bw,ac,bM[o])end end end elseif ab=="*"then for o,bw in pairs(bL)do if bM[o]==nil and ac==bw then bL[o]=nil end end end elseif type(ac)=="table"and type(bL[ab])=="table"then bK(bL[ab],ac,bN and bN[ab])if next(bL[ab])==nil then bL[ab]=nil end else if bL[ab]==bM[ab]and(not bN or bN[ab]==nil)then bL[ab]=nil end end end end;local function bO(bL,bP,bQ,o,bM)local bR=rawget(bL,"sv")local bS;if not bR[bQ]then bR[bQ]={}end;if not bR[bQ][o]then bR[bQ][o]={}bS=true end;local n=bR[bQ][o]if bM then bG(n,bM)end;rawset(bL,bP,n)return bS,n end;local bT={__index=function(aS,bP)local bU=rawget(aS,"keys")local o=bU[bP]if o then local bV=rawget(aS,"defaults")local bM=bV and bV[bP]if bP=="profile"then local aF=bO(aS,bP,"profiles",o,bM)if aF then aS.callbacks:Fire("OnNewProfile",aS,o)end elseif bP=="profiles"then local bR=rawget(aS,"sv")if not bR.profiles then bR.profiles={}end;rawset(aS,"profiles",bR.profiles)elseif bP=="global"then local bR=rawget(aS,"sv")if not bR.global then bR.global={}end;if bM then bG(bR.global,bM)end;rawset(aS,bP,bR.global)else bO(aS,bP,bP,o,bM)end end;return rawget(aS,bP)end}local function bW(bM,bX,ae)if not bM then return end;ae=ae or 0;for ab in pairs(bM)do if not bX[ab]or ab=="profiles"then error(("Usage: AceDBObject:RegisterDefaults(defaults): '%s' is not a valid datatype."):format(ab),3+ae)end end end;local bY={["callbacks"]=true,["RegisterCallback"]=true,["UnregisterCallback"]=true,["UnregisterAllCallbacks"]=true,["children"]=true}local bZ=GetRealmName()local b_=UnitName("player").." - "..bZ;local aT,c0=UnitClass("player")local aT,c1=UnitRace("player")local c2=UnitFactionGroup("player")local c3=c2 .." - "..bZ;local c4=GetLocale():lower()local c5={"US","KR","EU","TW","CN"}local c6=c5[GetCurrentRegion()]or GetCurrentRegionName()or"TR"local c7=c3 .." - "..c6;local function c8(bR,bM,c9,ca,cb)if c9==true then c9="Default"end;local cc;if not cb then if not bR.profileKeys then bR.profileKeys={}end;cc=bR.profileKeys[b_]or c9 or b_;bR.profileKeys[b_]=cc else cc=cb.keys.profile or c9 or b_;bR.profileKeys=nil end;local bX={["char"]=b_,["realm"]=bZ,["class"]=c0,["race"]=c1,["faction"]=c2,["factionrealm"]=c3,["factionrealmregion"]=c7,["profile"]=cc,["locale"]=c4,["global"]=true,["profiles"]=true}bW(bM,bX,1)if ca then for ab,ac in pairs(ca)do if not bY[ab]then ca[ab]=nil end end end;local bL=setmetatable(ca or{},bT)if not rawget(bL,"callbacks")then if not l then l=LibStub:GetLibrary("CallbackHandler-1.0",true)end;bL.callbacks=l and l:New(bL)or bB end;if not cb then for a8,G in pairs(bC)do bL[a8]=G end else bL.RegisterDefaults=bC.RegisterDefaults;bL.ResetProfile=bC.ResetProfile end;bL.profiles=bR.profiles;bL.keys=bX;bL.sv=bR;bL.defaults=bM;bL.parent=cb;bA.db_registry[bL]=true;return bL end;local function cd(bv,C)if C=="PLAYER_LOGOUT"then for bL in pairs(bA.db_registry)do bL.callbacks:Fire("OnDatabaseShutdown",bL)bL:RegisterDefaults(nil)local bR=rawget(bL,"sv")for bP in pairs(bL.keys)do if rawget(bR,bP)then if bP~="global"and(bP~="profiles"or rawget(bL,"parent"))then for o in pairs(bR[bP])do if not next(bR[bP][o])then bR[bP][o]=nil end end end;if not next(bR[bP])then bR[bP]=nil end end end end end end;bA.frame:RegisterEvent("PLAYER_LOGOUT")bA.frame:SetScript("OnEvent",cd)function bC:RegisterDefaults(bM)if bM and type(bM)~="table"then error(("Usage: AceDBObject:RegisterDefaults(defaults): 'defaults' - table or nil expected, got %q."):format(type(bM)),2)end;bW(bM,self.keys)if self.defaults then for bP,o in pairs(self.keys)do if self.defaults[bP]and rawget(self,bP)then bK(self[bP],self.defaults[bP])end end end;self.defaults=bM;if bM then for bP,o in pairs(self.keys)do if bM[bP]and rawget(self,bP)then bG(self[bP],bM[bP])end end end end;function bC:SetProfile(a8)if type(a8)~="string"then error(("Usage: AceDBObject:SetProfile(name): 'name' - string expected, got %q."):format(type(a8)),2)end;if a8==self.keys.profile then return end;local ce=self.profile;local bM=self.defaults and self.defaults.profile;self.callbacks:Fire("OnProfileShutdown",self)if ce and bM then bK(ce,bM)end;self.profile=nil;self.keys["profile"]=a8;if self.sv.profileKeys then self.sv.profileKeys[b_]=a8 end;if self.children then for aT,bL in pairs(self.children)do bC.SetProfile(bL,a8)end end;self.callbacks:Fire("OnProfileChanged",self,a8)end;function bC:GetProfiles(n)if n and type(n)~="table"then error(("Usage: AceDBObject:GetProfiles(tbl): 'tbl' - table or nil expected, got %q."):format(type(n)),2)end;if n then for ab,ac in pairs(n)do n[ab]=nil end else n={}end;local cf=self.keys.profile;local J=0;for cc in pairs(self.profiles)do J=J+1;n[J]=cc;if cf and cc==cf then cf=nil end end;if cf then J=J+1;n[J]=cf end;return n,J end;function bC:GetCurrentProfile()return self.keys.profile end;function bC:DeleteProfile(a8,g)if type(a8)~="string"then error(("Usage: AceDBObject:DeleteProfile(name): 'name' - string expected, got %q."):format(type(a8)),2)end;if self.keys.profile==a8 then error(("Cannot delete the active profile (%q) in an AceDBObject."):format(a8),2)end;if not rawget(self.profiles,a8)and not g then error(("Cannot delete profile %q as it does not exist."):format(a8),2)end;self.profiles[a8]=nil;if self.children then for aT,bL in pairs(self.children)do bC.DeleteProfile(bL,a8,true)end end;if self.sv.profileKeys then for o,cg in pairs(self.sv.profileKeys)do if cg==a8 then self.sv.profileKeys[o]=nil end end end;self.callbacks:Fire("OnProfileDeleted",self,a8)end;function bC:CopyProfile(a8,g)if type(a8)~="string"then error(("Usage: AceDBObject:CopyProfile(name): 'name' - string expected, got %q."):format(type(a8)),2)end;if a8==self.keys.profile then error(("Cannot have the same source and destination profiles (%q)."):format(a8),2)end;if not rawget(self.profiles,a8)and not g then error(("Cannot copy profile %q as it does not exist."):format(a8),2)end;bC.ResetProfile(self,nil,true)local cg=self.profile;local ch=self.profiles[a8]bD(ch,cg)if self.children then for aT,bL in pairs(self.children)do bC.CopyProfile(bL,a8,true)end end;self.callbacks:Fire("OnProfileCopied",self,a8)end;function bC:ResetProfile(ci,cj)local cg=self.profile;for ab,ac in pairs(cg)do cg[ab]=nil end;local bM=self.defaults and self.defaults.profile;if bM then bG(cg,bM)end;if self.children and not ci then for aT,bL in pairs(self.children)do bC.ResetProfile(bL,nil,cj)end end;if not cj then self.callbacks:Fire("OnProfileReset",self)end end;function bC:ResetDB(c9)if c9 and type(c9)~="string"then error(("Usage: AceDBObject:ResetDB(defaultProfile): 'defaultProfile' - string or nil expected, got %q."):format(type(c9)),2)end;local bR=self.sv;for ab,ac in pairs(bR)do bR[ab]=nil end;c8(bR,self.defaults,c9,self)if self.children then if not bR.namespaces then bR.namespaces={}end;for a8,bL in pairs(self.children)do if not bR.namespaces[a8]then bR.namespaces[a8]={}end;c8(bR.namespaces[a8],bL.defaults,self.keys.profile,bL,self)end end;self.callbacks:Fire("OnDatabaseReset",self)self.callbacks:Fire("OnProfileChanged",self,self.keys["profile"])return self end;function bC:RegisterNamespace(a8,bM)if type(a8)~="string"then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'name' - string expected, got %q."):format(type(a8)),2)end;if bM and type(bM)~="table"then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'defaults' - table or nil expected, got %q."):format(type(bM)),2)end;if self.children and self.children[a8]then error(("Usage: AceDBObject:RegisterNamespace(name, defaults): 'name' - a namespace called %q already exists."):format(a8),2)end;local bR=self.sv;if not bR.namespaces then bR.namespaces={}end;if not bR.namespaces[a8]then bR.namespaces[a8]={}end;local ck=c8(bR.namespaces[a8],bM,self.keys.profile,nil,self)if not self.children then self.children={}end;self.children[a8]=ck;return ck end;function bC:GetNamespace(a8,g)if type(a8)~="string"then error(("Usage: AceDBObject:GetNamespace(name): 'name' - string expected, got %q."):format(type(a8)),2)end;if not g and not(self.children and self.children[a8])then error(("Usage: AceDBObject:GetNamespace(name): 'name' - namespace %q does not exist."):format(a8),2)end;if not self.children then self.children={}end;return self.children[a8]end;function bA:New(n,bM,c9)if type(n)=="string"then local a8=n;n=_G[a8]if not n then n={}_G[a8]=n end end;if type(n)~="table"then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'tbl' - table expected, got %q."):format(type(n)),2)end;if bM and type(bM)~="table"then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'defaults' - table expected, got %q."):format(type(bM)),2)end;if c9 and type(c9)~="string"and c9~=true then error(("Usage: AceDB:New(tbl, defaults, defaultProfile): 'defaultProfile' - string or true expected, got %q."):format(type(c9)),2)end;return c8(n,bM,c9)end;for bL in pairs(bA.db_registry)do if not bL.parent then for a8,G in pairs(bC)do bL[a8]=G end else bL.RegisterDefaults=bC.RegisterDefaults;bL.ResetProfile=bC.ResetProfile end end end;local function cl(...)local cm,cn="AceDBOptions-3.0",15;local co=LibStub:NewLibrary(cm,cn)if not co then return end;local pairs,next=pairs,next;local UnitClass=UnitClass;co.optionTables=co.optionTables or{}co.handlers=co.handlers or{}local cp={choose="Existing Profiles",choose_desc="You can either create a new profile by entering a name in the editbox, or choose one of the already existing profiles.",choose_sub="Select one of your currently available profiles.",copy="Copy From",copy_desc="Copy the settings from one existing profile into the currently active profile.",current="Current Profile:",default="Default",delete="Delete a Profile",delete_confirm="Are you sure you want to delete the selected profile?",delete_desc="Delete existing and unused profiles from the database to save space, and cleanup the SavedVariables file.",delete_sub="Deletes a profile from the database.",intro="You can change the active database profile, so you can have different settings for every character.",new="New",new_sub="Create a new empty profile.",profiles="Profiles",profiles_sub="Manage Profiles",reset="Reset Profile",reset_desc="Reset the current profile back to its default values, in case your configuration is broken, or you simply want to start over.",reset_sub="Reset the current profile to the default"}local cq=GetLocale()if cq=="deDE"then cp["choose"]="Vorhandene Profile"cp["choose_desc"]="Du kannst ein neues Profil erstellen, indem du einen neuen Namen in der Eingabebox 'Neu' eingibst, oder wähle eines der vorhandenen Profile aus."cp["choose_sub"]="Wählt ein bereits vorhandenes Profil aus."cp["copy"]="Kopieren von..."cp["copy_desc"]="Kopiere die Einstellungen von einem vorhandenen Profil in das aktive Profil."cp["current"]="Aktuelles Profil:"cp["default"]="Standard"cp["delete"]="Profil löschen"cp["delete_confirm"]="Willst du das ausgewählte Profil wirklich löschen?"cp["delete_desc"]="Lösche vorhandene oder unbenutzte Profile aus der Datenbank, um Platz zu sparen und die SavedVariables-Datei 'sauber' zu halten."cp["delete_sub"]="Löscht ein Profil aus der Datenbank."cp["intro"]="Hier kannst du das aktive Datenbankprofil ändern, damit du verschiedene Einstellungen für jeden Charakter erstellen kannst, wodurch eine sehr flexible Konfiguration möglich wird."cp["new"]="Neu"cp["new_sub"]="Ein neues Profil erstellen."cp["profiles"]="Profile"cp["profiles_sub"]="Profile verwalten"cp["reset"]="Profil zurücksetzen"cp["reset_desc"]="Setzt das momentane Profil auf Standardwerte zurück, für den Fall, dass mit der Konfiguration etwas schief lief oder weil du einfach neu starten willst."cp["reset_sub"]="Das aktuelle Profil auf Standard zurücksetzen."elseif cq=="frFR"then cp["choose"]="Profils existants"cp["choose_desc"]="Vous pouvez créer un nouveau profil en entrant un nouveau nom dans la boîte de saisie, ou en choississant un des profils déjà existants."cp["choose_sub"]="Permet de choisir un des profils déjà disponibles."cp["copy"]="Copier à partir de"cp["copy_desc"]="Copie les paramètres d'un profil déjà existant dans le profil actuellement actif."cp["current"]="Profil actuel :"cp["default"]="Défaut"cp["delete"]="Supprimer un profil"cp["delete_confirm"]="Etes-vous sûr de vouloir supprimer le profil sélectionné ?"cp["delete_desc"]="Supprime les profils existants inutilisés de la base de données afin de gagner de la place et de nettoyer le fichier SavedVariables."cp["delete_sub"]="Supprime un profil de la base de données."cp["intro"]="Vous pouvez changer le profil actuel afin d'avoir des paramètres différents pour chaque personnage, permettant ainsi d'avoir une configuration très flexible."cp["new"]="Nouveau"cp["new_sub"]="Créée un nouveau profil vierge."cp["profiles"]="Profils"cp["profiles_sub"]="Gestion des profils"cp["reset"]="Réinitialiser le profil"cp["reset_desc"]="Réinitialise le profil actuel au cas où votre configuration est corrompue ou si vous voulez tout simplement faire table rase."cp["reset_sub"]="Réinitialise le profil actuel avec les paramètres par défaut."elseif cq=="koKR"then cp["choose"]="기존 프로필"cp["choose_desc"]="편집 상자에 이름을 입력하여 새로운 프로필을 만들거나 이미 존재하는 프로필 중 하나를 선택할 수 있습니다."cp["choose_sub"]="현재 이용할 수 있는 프로필 중 하나를 선택합니다."cp["copy"]="복사해 올 프로필"cp["copy_desc"]="기존 프로필의 설정을 현재 활성화된 프로필로 복사합니다."cp["current"]="현재 프로필:"cp["default"]="기본값"cp["delete"]="프로필 삭제"cp["delete_confirm"]="선택한 프로필을 삭제하시겠습니까?"cp["delete_desc"]="데이터베이스에서 기존 프로필과 사용하지 않는 프로필을 삭제하여 공간을 절약하고 SavedVariables 파일을 정리합니다."cp["delete_sub"]="데이터베이스에서 프로필을 삭제합니다."cp["intro"]="활성 데이터베이스 프로필을 변경할 수 있으며, 모든 캐릭터마다 서로 다른 설정을 지정할 수 있습니다."cp["new"]="새로운 프로필"cp["new_sub"]="비어 있는 프로필을 새로 만듭니다."cp["profiles"]="프로필"cp["profiles_sub"]="프로필 관리"cp["reset"]="프로필 재설정"cp["reset_desc"]="구성이 손상되었거나 처음부터 다시 시작하고 싶은 경우 현재 프로필을 기본값으로 재설정하세요."cp["reset_sub"]="현재 프로필을 기본값으로 재설정합니다"elseif cq=="esES"or cq=="esMX"then cp["choose"]="Perfiles existentes"cp["choose_desc"]="Puedes crear un nuevo perfil introduciendo un nombre en el recuadro o puedes seleccionar un perfil de los ya existentes."cp["choose_sub"]="Selecciona uno de los perfiles disponibles."cp["copy"]="Copiar de"cp["copy_desc"]="Copia los ajustes de un perfil existente al perfil actual."cp["current"]="Perfil actual:"cp["default"]="Por defecto"cp["delete"]="Borrar un Perfil"cp["delete_confirm"]="¿Estas seguro que quieres borrar el perfil seleccionado?"cp["delete_desc"]="Borra los perfiles existentes y sin uso de la base de datos para ganar espacio y limpiar el archivo SavedVariables."cp["delete_sub"]="Borra un perfil de la base de datos."cp["intro"]="Puedes cambiar el perfil activo de tal manera que cada personaje tenga diferentes configuraciones."cp["new"]="Nuevo"cp["new_sub"]="Crear un nuevo perfil vacio."cp["profiles"]="Perfiles"cp["profiles_sub"]="Manejar Perfiles"cp["reset"]="Reiniciar Perfil"cp["reset_desc"]="Reinicia el perfil actual a los valores por defectos, en caso de que se haya estropeado la configuración o quieras volver a empezar de nuevo."cp["reset_sub"]="Reinicar el perfil actual al de por defecto"elseif cq=="zhTW"then cp["choose"]="現有的設定檔"cp["choose_desc"]="您可以在文字方塊內輸入名字以建立新的設定檔，或是選擇一個現有的設定檔使用。"cp["choose_sub"]="從當前可用的設定檔裡面選擇一個。"cp["copy"]="複製自"cp["copy_desc"]="從一個現有的設定檔，將設定複製到現在使用中的設定檔。"cp["current"]="目前設定檔："cp["default"]="預設"cp["delete"]="刪除一個設定檔"cp["delete_confirm"]="確定要刪除所選擇的設定檔嗎？"cp["delete_desc"]="從資料庫裡刪除不再使用的設定檔，以節省空間，並且清理 SavedVariables 檔案。"cp["delete_sub"]="從資料庫裡刪除一個設定檔。"cp["intro"]="您可以從資料庫中選擇一個設定檔來使用，如此就可以讓每個角色使用不同的設定。"cp["new"]="新建"cp["new_sub"]="新建一個空的設定檔。"cp["profiles"]="設定檔"cp["profiles_sub"]="管理設定檔"cp["reset"]="重置設定檔"cp["reset_desc"]="將現用的設定檔重置為預設值；用於設定檔損壞，或者單純想要重來的情況。"cp["reset_sub"]="將目前的設定檔重置為預設值"elseif cq=="zhCN"then cp["choose"]="现有的配置文件"cp["choose_desc"]="你可以通过在文本框内输入一个名字创立一个新的配置文件，也可以选择一个已经存在的配置文件。"cp["choose_sub"]="从当前可用的配置文件里面选择一个。"cp["copy"]="复制自"cp["copy_desc"]="从当前某个已保存的配置文件复制到当前正使用的配置文件。"cp["current"]="当前配置文件："cp["default"]="默认"cp["delete"]="删除一个配置文件"cp["delete_confirm"]="你确定要删除所选择的配置文件么？"cp["delete_desc"]="从数据库里删除不再使用的配置文件，以节省空间，并且清理SavedVariables文件。"cp["delete_sub"]="从数据库里删除一个配置文件。"cp["intro"]="你可以选择一个活动的数据配置文件，这样你的每个角色就可以拥有不同的设置值，可以给你的插件配置带来极大的灵活性。"cp["new"]="新建"cp["new_sub"]="新建一个空的配置文件。"cp["profiles"]="配置文件"cp["profiles_sub"]="管理配置文件"cp["reset"]="重置配置文件"cp["reset_desc"]="将当前的配置文件恢复到它的默认值，用于你的配置文件损坏，或者你只是想重来的情况。"cp["reset_sub"]="将当前的配置文件恢复为默认值"elseif cq=="ruRU"then cp["choose"]="Существующие профили"cp["choose_desc"]="Вы можете создать новый профиль, введя название в поле ввода, или выбрать один из уже существующих профилей."cp["choose_sub"]="Выбор одного из уже доступных профилей."cp["copy"]="Скопировать из"cp["copy_desc"]="Копирование настроек из выбранного профиля в активный."cp["current"]="Текущий профиль:"cp["default"]="По умолчанию"cp["delete"]="Удалить профиль"cp["delete_confirm"]="Вы уверены, что хотите удалить выбранный профиль?"cp["delete_desc"]="Удаление существующего и неиспользуемого профиля из базы данных для сохранения места, и очистка файла SavedVariables."cp["delete_sub"]="Удаление профиля из базы данных."cp["intro"]="Изменяя активный профиль, Вы можете задать разные настройки для каждого персонажа."cp["new"]="Новый"cp["new_sub"]="Создание нового чистого профиля."cp["profiles"]="Профили"cp["profiles_sub"]="Управление профилями"cp["reset"]="Сбросить профиль"cp["reset_desc"]="Сброс текущего профиля к стандартным настройкам, если Ваша конфигурация испорчена или Вы хотите настроить все заново."cp["reset_sub"]="Сброс текущего профиля на стандартный"elseif cq=="itIT"then cp["choose"]="Profili Esistenti"cp["choose_desc"]="Puoi creare un nuovo profilo digitando il nome della casella di testo, oppure scegliendone uno tra i profili già esistenti."cp["choose_sub"]="Seleziona uno dei profili attualmente disponibili."cp["copy"]="Copia Da"cp["copy_desc"]="Copia le impostazioni da un profilo esistente nel profilo attivo in questo momento."cp["current"]="Profilo Attivo:"cp["default"]="Predefinito"cp["delete"]="Cancella un Profilo"cp["delete_confirm"]="Sei sicuro di voler cancellare il profilo selezionato?"cp["delete_desc"]="Cancella i profili non utilizzati dal database per risparmiare spazio e mantenere puliti i file di configurazione SavedVariables."cp["delete_sub"]="Cancella un profilo dal Database."cp["intro"]="Puoi cambiare il profilo attivo, in modo da usare impostazioni diverse per ogni personaggio."cp["new"]="Nuovo"cp["new_sub"]="Crea un nuovo profilo vuoto."cp["profiles"]="Profili"cp["profiles_sub"]="Gestisci Profili"cp["reset"]="Reimposta Profilo"cp["reset_desc"]="Riporta il tuo profilo attivo alle sue impostazioni predefinite, nel caso in cui la tua configurazione si sia corrotta, o semplicemente tu voglia re-inizializzarla."cp["reset_sub"]="Reimposta il profilo ai suoi valori predefiniti."elseif cq=="ptBR"then cp["choose"]="Perfis Existentes"cp["choose_desc"]="Você pode tanto criar um perfil novo tanto digitando um nome na caixa de texto, quanto escolher um dos perfis já existentes."cp["choose_sub"]="Selecione um de seus perfis atualmente disponíveis."cp["copy"]="Copiar De"cp["copy_desc"]="Copia as definições de um perfil existente no perfil atualmente ativo."cp["current"]="Perfil Autal:"cp["default"]="Padrão"cp["delete"]="Remover um Perfil"cp["delete_confirm"]="Tem certeza que deseja remover o perfil selecionado?"cp["delete_desc"]="Remove perfis existentes e inutilizados do banco de dados para economizar espaço, e limpar o arquivo SavedVariables."cp["delete_sub"]="Remove um perfil do banco de dados."cp["intro"]="Você pode alterar o perfil do banco de dados ativo, para que possa ter definições diferentes para cada personagem."cp["new"]="Novo"cp["new_sub"]="Cria um novo perfil vazio."cp["profiles"]="Perfis"cp["profiles_sub"]="Gerenciar Perfis"cp["reset"]="Resetar Perfil"cp["reset_desc"]="Reseta o perfil atual para os valores padrões, no caso de sua configuração estar quebrada, ou simplesmente se deseja começar novamente."cp["reset_sub"]="Resetar o perfil atual ao padrão"end;local cr;local cs={}local function ct(bL,cu,cv)local cw={}local cx=bL:GetCurrentProfile()for J,ac in pairs(bL:GetProfiles(cs))do if not(cv and ac==cx)then cw[ac]=ac end end;for ab,ac in pairs(cr)do if(cu or cw[ab])and not(cv and ab==cx)then cw[ab]=ac end end;return cw end;local cy={}function cy:Reset()self.db:ResetProfile()end;function cy:SetProfile(cz,bw)self.db:SetProfile(bw)end;function cy:GetCurrentProfile()return self.db:GetCurrentProfile()end;function cy:ListProfiles(cz)local I=cz.arg;local cw;if I=="common"and not self.noDefaultProfiles then cw=ct(self.db,true,nil)elseif I=="nocurrent"then cw=ct(self.db,nil,true)elseif I=="both"then cw=ct(self.db,not self.noDefaultProfiles and true,true)else cw=ct(self.db)end;return cw end;function cy:HasNoProfiles(cz)local cw=self:ListProfiles(cz)return not next(cw)and true or false end;function cy:CopyProfile(cz,bw)self.db:CopyProfile(bw)end;function cy:DeleteProfile(cz,bw)self.db:DeleteProfile(bw)end;local function cA(bL)cr={["Default"]=cp["default"],[bL.keys.char]=bL.keys.char,[bL.keys.realm]=bL.keys.realm,[bL.keys.class]=UnitClass("player")}end;local function cB(bL,cC)if not cr then cA(bL)end;local bj=co.handlers[bL]or{db=bL,noDefaultProfiles=cC}for ab,ac in pairs(cy)do bj[ab]=ac end;co.handlers[bL]=bj;return bj end;local cD={desc={order=1,type="description",name=cp["intro"].."\n"},descreset={order=9,type="description",name=cp["reset_desc"]},reset={order=10,type="execute",name=cp["reset"],desc=cp["reset_sub"],func="Reset"},current={order=11,type="description",name=function(cz)return cp["current"].." "..NORMAL_FONT_COLOR_CODE..cz.handler:GetCurrentProfile()..FONT_COLOR_CODE_CLOSE end,width="default"},choosedesc={order=20,type="description",name="\n"..cp["choose_desc"]},new={name=cp["new"],desc=cp["new_sub"],type="input",order=30,get=false,set="SetProfile"},choose={name=cp["choose"],desc=cp["choose_sub"],type="select",order=40,get="GetCurrentProfile",set="SetProfile",values="ListProfiles",arg="common"},copydesc={order=50,type="description",name="\n"..cp["copy_desc"]},copyfrom={order=60,type="select",name=cp["copy"],desc=cp["copy_desc"],get=false,set="CopyProfile",values="ListProfiles",disabled="HasNoProfiles",arg="nocurrent"},deldesc={order=70,type="description",name="\n"..cp["delete_desc"]},delete={order=80,type="select",name=cp["delete"],desc=cp["delete_sub"],get=false,set="DeleteProfile",values="ListProfiles",disabled="HasNoProfiles",arg="nocurrent",confirm=true,confirmText=cp["delete_confirm"]}}function co:GetOptionsTable(bL,cC)local n=co.optionTables[bL]or{type="group",name=cp["profiles"],desc=cp["profiles_sub"]}n.handler=cB(bL,cC)n.args=cD;co.optionTables[bL]=n;return n end;for bL,n in pairs(co.optionTables)do n.handler=cB(bL)n.args=cD end end;local function cE(...)local i,k="AceLocale-3.0",6;local cF,f=LibStub:NewLibrary(i,k)if not cF then return end;local assert,tostring,error=assert,tostring,error;local getmetatable,setmetatable,rawset,rawget=getmetatable,setmetatable,rawset,rawget;local cG=GetLocale()if cG=="enGB"then cG="enUS"end;cF.apps=cF.apps or{}cF.appnames=cF.appnames or{}local cH={__index=function(self,o)rawset(self,o,o)geterrorhandler()(i..": "..tostring(cF.appnames[self])..": Missing entry for '"..tostring(o).."'")return o end}local cI={__index=function(self,o)rawset(self,o,o)return o end}local cJ;local cK=function()assert(false)end;local cL=setmetatable({},{__newindex=function(self,o,bw)rawset(cJ,o,bw==true and o or bw)end,__index=cK})local cM=setmetatable({},{__newindex=function(self,o,bw)if not rawget(cJ,o)then rawset(cJ,o,bw==true and o or bw)end end,__index=cK})function cF:NewLocale(cN,cO,cP,g)local cQ=GAME_LOCALE or cG;local cR=cF.apps[cN]if g and cR and getmetatable(cR)~=cI then geterrorhandler()("Usage: NewLocale(application, locale[, isDefault[, silent]]): 'silent' must be specified for the first locale registered")end;if not cR then if g=="raw"then cR={}else cR=setmetatable({},g and cI or cH)end;cF.apps[cN]=cR;cF.appnames[cR]=cN end;if cO~=cQ and not cP then return end;cJ=cR;if cP then return cM end;return cL end;function cF:GetLocale(cN,g)if not g and not cF.apps[cN]then error("Usage: GetLocale(application[, silent]): 'application' - No locales registered for '"..tostring(cN).."'",2)end;return cF.apps[cN]end end;local function cS(...)local i,k="AceConsole-3.0",7;local cT,f=LibStub:NewLibrary(i,k)if not cT then return end;cT.embeds=cT.embeds or{}cT.commands=cT.commands or{}cT.weakcommands=cT.weakcommands or{}local N,tostring,select=table.concat,tostring,select;local type,pairs,error=type,pairs,error;local be,cU,cV=string.format,string.find,string.sub;local cW=math.max;local _G=_G;local cX={}local function cY(self,bv,...)local cZ=0;if self~=cT then cZ=cZ+1;cX[cZ]="|cff33ff99"..tostring(self).."|r:"end;for J=1,select("#",...)do cZ=cZ+1;cX[cZ]=tostring(select(J,...))end;bv:AddMessage(N(cX," ",1,cZ))end;function cT:Print(...)local bv=...if type(bv)=="table"and bv.AddMessage then return cY(self,bv,select(2,...))else return cY(self,DEFAULT_CHAT_FRAME,...)end end;function cT:Printf(...)local bv=...if type(bv)=="table"and bv.AddMessage then return cY(self,bv,be(select(2,...)))else return cY(self,DEFAULT_CHAT_FRAME,be(...))end end;function cT:RegisterChatCommand(c_,G,d0)if type(c_)~="string"then error([[Usage: AceConsole:RegisterChatCommand( "command", func[, persist ]): 'command' - expected a string]],2)end;if d0==nil then d0=true end;local a8="ACECONSOLE_"..c_:upper()if type(G)=="string"then SlashCmdList[a8]=function(d1,d2)self[G](self,d1,d2)end else SlashCmdList[a8]=G end;_G["SLASH_"..a8 .."1"]="/"..c_:lower()cT.commands[c_]=a8;if not d0 then if not cT.weakcommands[self]then cT.weakcommands[self]={}end;cT.weakcommands[self][c_]=G end;return true end;function cT:UnregisterChatCommand(c_)local a8=cT.commands[c_]if a8 then SlashCmdList[a8]=nil;_G["SLASH_"..a8 .."1"]=nil;hash_SlashCmdList["/"..c_:upper()]=nil;cT.commands[c_]=nil end end;function cT:IterateChatCommands()return pairs(cT.commands)end;local function d3(cZ,...)if cZ>1 then return nil,d3(cZ-1,...)elseif cZ==1 then return nil,...else return...end end;function cT:GetArgs(d4,d5,d6)d5=d5 or 1;d6=cW(d6 or 1,1)local d7=d6;d7=cU(d4,"[^ ]",d7)if not d7 then return d3(d5,1e9)end;if d5<1 then return d7 end;local d8;local d9=cV(d4,d7,d7)if d9=='"'then d7=d7+1;d8='([|"])'elseif d9=="'"then d7=d7+1;d8="([|'])"else d8="([| ])"end;d6=d7;while true do local aT;d7,aT,d9=cU(d4,d8,d7)if not d7 then break end;if d9=="|"then if cV(d4,d7,d7+1)=="|H"then d7=cU(d4,"|h",d7+2)if not d7 then break end;d7=cU(d4,"|h",d7+2)if not d7 then break end elseif cV(d4,d7,d7+1)=="|T"then d7=cU(d4,"|t",d7+2)if not d7 then break end end;d7=d7+2 else return cV(d4,d6,d7-1),cT:GetArgs(d4,d5-1,d7+1)end end;return cV(d4,d6),d3(d5-1,1e9)end;local ao={"Print","Printf","RegisterChatCommand","UnregisterChatCommand","GetArgs"}function cT:Embed(u)for ab,ac in pairs(ao)do u[ac]=self[ac]end;self.embeds[u]=true;return u end;function cT:OnEmbedEnable(u)if cT.weakcommands[u]then for c_,G in pairs(cT.weakcommands[u])do u:RegisterChatCommand(c_,G,false,true)end end end;function cT:OnEmbedDisable(u)if cT.weakcommands[u]then for c_,G in pairs(cT.weakcommands[u])do u:UnregisterChatCommand(c_)end end end;for a6 in pairs(cT.embeds)do cT:Embed(a6)end end;local function da(...)local db,dc="AceGUI-3.0",41;local dd,f=LibStub:NewLibrary(db,dc)if not dd then return end;local M,de=table.insert,table.wipe;local select,pairs,next,type=select,pairs,next,type;local error,assert=error,assert;local setmetatable,rawget=setmetatable,rawget;local df,dg,dh=math.max,math.min,math.ceil;local UIParent=UIParent;dd.WidgetRegistry=dd.WidgetRegistry or{}dd.LayoutRegistry=dd.LayoutRegistry or{}dd.WidgetBase=dd.WidgetBase or{}dd.WidgetContainerBase=dd.WidgetContainerBase or{}dd.WidgetVersions=dd.WidgetVersions or{}dd.tooltip=dd.tooltip or CreateFrame("GameTooltip","AceGUITooltip",UIParent,"GameTooltipTemplate")local di=dd.WidgetRegistry;local dj=dd.LayoutRegistry;local dk=dd.WidgetVersions;local xpcall=xpcall;local function Q(R)return geterrorhandler()(R)end;local function S(G,...)if G then return xpcall(G,Q,...)end end;local dl,dm;do if f and f<29 and dd.objPools then dd.objPools=nil end;dd.objPools=dd.objPools or{}local dn=dd.objPools;function dl(dp)if not di[dp]then error("Attempt to instantiate unknown widget type",2)end;if not dn[dp]then dn[dp]={}end;local dq=next(dn[dp])if not dq then dq=di[dp]()dq.AceGUIWidgetVersion=dk[dp]else dn[dp][dq]=nil;if not dq.AceGUIWidgetVersion or dq.AceGUIWidgetVersion<dk[dp]then return dl(dp)end end;return dq end;function dm(bo,dp)if not dn[dp]then dn[dp]={}end;if dn[dp][bo]then error("Attempt to Release Widget that is already released",2)end;dn[dp][bo]=true end end;function dd:Create(dp)if di[dp]then local dr=dl(dp)if rawget(dr,"Acquire")then dr.OnAcquire=dr.Acquire;dr.Acquire=nil elseif rawget(dr,"Aquire")then dr.OnAcquire=dr.Aquire;dr.Aquire=nil end;if rawget(dr,"Release")then dr.OnRelease=rawget(dr,"Release")dr.Release=nil end;if dr.OnAcquire then dr:OnAcquire()else error(("Widget type %s doesn't supply an OnAcquire Function"):format(dp))end;S(dr.SetLayout,dr,"List")S(dr.ResumeLayout,dr)return dr end end;function dd:Release(dr)if dr.isQueuedForRelease then return end;dr.isQueuedForRelease=true;S(dr.PauseLayout,dr)dr.frame:Hide()dr:Fire("OnRelease")S(dr.ReleaseChildren,dr)if dr.OnRelease then dr:OnRelease()end;for ab in pairs(dr.userdata)do dr.userdata[ab]=nil end;for ab in pairs(dr.events)do dr.events[ab]=nil end;dr.width=nil;dr.relWidth=nil;dr.height=nil;dr.relHeight=nil;dr.noAutoHeight=nil;dr.frame:ClearAllPoints()dr.frame:Hide()dr.frame:SetParent(UIParent)dr.frame.width=nil;dr.frame.height=nil;if dr.content then dr.content.width=nil;dr.content.height=nil end;dr.isQueuedForRelease=nil;dm(dr,dr.type)end;function dd:IsReleasing(dr)if dr.isQueuedForRelease then return true end;if dr.parent and dr.parent.AceGUIWidgetVersion then return dd:IsReleasing(dr.parent)end;return false end;function dd:SetFocus(dr)if self.FocusedWidget and self.FocusedWidget~=dr then S(self.FocusedWidget.ClearFocus,self.FocusedWidget)end;self.FocusedWidget=dr end;function dd:ClearFocus()if self.FocusedWidget then S(self.FocusedWidget.ClearFocus,self.FocusedWidget)self.FocusedWidget=nil end end;do local ds=dd.WidgetBase;ds.SetParent=function(self,cb)local bv=self.frame;bv:SetParent(nil)bv:SetParent(cb.content)self.parent=cb end;ds.SetCallback=function(self,a8,G)if type(G)=="function"then self.events[a8]=G end end;ds.Fire=function(self,a8,...)if self.events[a8]then local dt,du=S(self.events[a8],self,a8,...)if dt then return du end end end;ds.SetWidth=function(self,dv)self.frame:SetWidth(dv)self.frame.width=dv;if self.OnWidthSet then self:OnWidthSet(dv)end end;ds.SetRelativeWidth=function(self,dv)if dv<=0 or dv>1 then error(":SetRelativeWidth(width): Invalid relative width.",2)end;self.relWidth=dv;self.width="relative"end;ds.SetHeight=function(self,dw)self.frame:SetHeight(dw)self.frame.height=dw;if self.OnHeightSet then self:OnHeightSet(dw)end end;ds.IsVisible=function(self)return self.frame:IsVisible()end;ds.IsShown=function(self)return self.frame:IsShown()end;ds.Release=function(self)dd:Release(self)end;ds.IsReleasing=function(self)return dd:IsReleasing(self)end;ds.SetPoint=function(self,...)return self.frame:SetPoint(...)end;ds.ClearAllPoints=function(self)return self.frame:ClearAllPoints()end;ds.GetNumPoints=function(self)return self.frame:GetNumPoints()end;ds.GetPoint=function(self,...)return self.frame:GetPoint(...)end;ds.GetUserDataTable=function(self)return self.userdata end;ds.SetUserData=function(self,o,bw)self.userdata[o]=bw end;ds.GetUserData=function(self,o)return self.userdata[o]end;ds.IsFullHeight=function(self)return self.height=="fill"end;ds.SetFullHeight=function(self,dx)if dx then self.height="fill"else self.height=nil end end;ds.IsFullWidth=function(self)return self.width=="fill"end;ds.SetFullWidth=function(self,dx)if dx then self.width="fill"else self.width=nil end end;local dy=dd.WidgetContainerBase;dy.PauseLayout=function(self)self.LayoutPaused=true end;dy.ResumeLayout=function(self)self.LayoutPaused=nil end;dy.PerformLayout=function(self)if self.LayoutPaused then return end;S(self.LayoutFunc,self.content,self.children)end;dy.DoLayout=function(self)self:PerformLayout()end;dy.AddChild=function(self,dz,dA)if dA then local dB=1;for aT,dr in pairs(self.children)do if dr==dA then break end;dB=dB+1 end;M(self.children,dB,dz)else M(self.children,dz)end;dz:SetParent(self)dz.frame:Show()self:DoLayout()end;dy.AddChildren=function(self,...)for J=1,select("#",...)do local dz=select(J,...)M(self.children,dz)dz:SetParent(self)dz.frame:Show()end;self:DoLayout()end;dy.ReleaseChildren=function(self)local dC=self.children;for J=1,#dC do dd:Release(dC[J])dC[J]=nil end end;dy.SetLayout=function(self,dD)self.LayoutFunc=dd:GetLayout(dD)end;dy.SetAutoAdjustHeight=function(self,dE)if dE then self.noAutoHeight=nil else self.noAutoHeight=true end end;local function dF(aw)local self=aw.obj;if aw:GetWidth()and aw:GetHeight()then if self.OnWidthSet then self:OnWidthSet(aw:GetWidth())end;if self.OnHeightSet then self:OnHeightSet(aw:GetHeight())end end end;local function dG(aw)if aw:GetWidth()and aw:GetHeight()then aw.width=aw:GetWidth()aw.height=aw:GetHeight()aw.obj:DoLayout()end end;setmetatable(dy,{__index=ds})function dd:RegisterAsContainer(dr)dr.children={}dr.userdata={}dr.events={}dr.base=dy;dr.content.obj=dr;dr.frame.obj=dr;dr.content:SetScript("OnSizeChanged",dG)dr.frame:SetScript("OnSizeChanged",dF)setmetatable(dr,{__index=dy})dr:SetLayout("List")return dr end;function dd:RegisterAsWidget(dr)dr.userdata={}dr.events={}dr.base=ds;dr.frame.obj=dr;dr.frame:SetScript("OnSizeChanged",dF)setmetatable(dr,{__index=ds})return dr end end;function dd:RegisterWidgetType(dH,dI,dJ)assert(type(dI)=="function")assert(type(dJ)=="number")local dK=dk[dH]if dK and dK>=dJ then return end;dk[dH]=dJ;di[dH]=dI end;function dd:RegisterLayout(dH,dL)assert(type(dL)=="function")if type(dH)=="string"then dH=dH:upper()end;dj[dH]=dL end;function dd:GetLayout(dH)if type(dH)=="string"then dH=dH:upper()end;return dj[dH]end;dd.counts=dd.counts or{}function dd:GetNextWidgetNum(dp)if not self.counts[dp]then self.counts[dp]=0 end;self.counts[dp]=self.counts[dp]+1;return self.counts[dp]end;function dd:GetWidgetCount(dp)return self.counts[dp]or 0 end;function dd:GetWidgetVersion(dp)return dk[dp]end;dd:RegisterLayout("List",function(dM,dC)local dw=0;local dv=dM.width or dM:GetWidth()or 0;for J=1,#dC do local dz=dC[J]local bv=dz.frame;bv:ClearAllPoints()bv:Show()if J==1 then bv:SetPoint("TOPLEFT",dM)else bv:SetPoint("TOPLEFT",dC[J-1].frame,"BOTTOMLEFT")end;if dz.width=="fill"then dz:SetWidth(dv)bv:SetPoint("RIGHT",dM)if dz.DoLayout then dz:DoLayout()end elseif dz.width=="relative"then dz:SetWidth(dv*dz.relWidth)if dz.DoLayout then dz:DoLayout()end end;dw=dw+(bv.height or bv:GetHeight()or 0)end;S(dM.obj.LayoutFinished,dM.obj,nil,dw)end)dd:RegisterLayout("Fill",function(dM,dC)if dC[1]then dC[1]:SetWidth(dM:GetWidth()or 0)dC[1]:SetHeight(dM:GetHeight()or 0)dC[1].frame:ClearAllPoints()dC[1].frame:SetAllPoints(dM)dC[1].frame:Show()S(dM.obj.LayoutFinished,dM.obj,nil,dC[1].frame:GetHeight())end end)local dN=nil;local function dO(F,G,...)dN=true;F[G](F,...)dN=nil end;dd:RegisterLayout("Flow",function(dM,dC)if dN then return end;local dw=0;local dP=0;local dQ=0;local dR=0;local dv=dM.width or dM:GetWidth()or 0;local dS;local dT;local dU;local dV;local dW;local dX;for J=1,#dC do local dz=dC[J]dX=nil;local bv=dz.frame;local dY=bv.height or bv:GetHeight()or 0;local dZ=bv.width or bv:GetWidth()or 0;dW=dV;dV=dz.alignoffset or dY/2;if dz.width=="relative"then dZ=dv*dz.relWidth end;bv:Show()bv:ClearAllPoints()if J==1 then bv:SetPoint("TOPLEFT",dM)dQ=dY;dR=dV;dS=bv;dT=dV;dP=dZ;if dP>dv then dX=true end else if dP==0 or dZ+dP>dv or dz.width=="fill"then if dU then break end;dS:SetPoint("TOPLEFT",dM,"TOPLEFT",0,-(dw+dR-dT+3))dw=dw+dQ+3;dS=bv;dT=dV;dQ=dY;dR=dV;dP=dZ;if dP>dv then dX=true end else dR=df(dR,dV)dQ=df(dQ,dR+dY/2)bv:SetPoint("TOPLEFT",dC[J-1].frame,"TOPRIGHT",0,dV-dW)dP=dZ+dP end end;if dz.width=="fill"then dO(dz,"SetWidth",dv)bv:SetPoint("RIGHT",dM)dP=0;dS=bv;if dz.DoLayout then dz:DoLayout()end;dQ=bv.height or bv:GetHeight()or 0;dR=dz.alignoffset or dQ/2;dT=dR elseif dz.width=="relative"then dO(dz,"SetWidth",dv*dz.relWidth)if dz.DoLayout then dz:DoLayout()end elseif dX then if dv>1 then bv:SetPoint("RIGHT",dM)end end;if dz.height=="fill"then bv:SetPoint("BOTTOM",dM)dU=true end end;if dU then dS:SetPoint("TOPLEFT",dM,"TOPLEFT",0,-dw)elseif dS then dS:SetPoint("TOPLEFT",dM,"TOPLEFT",0,-(dw+dR-dT+3))end;dw=dw+dQ+3;S(dM.obj.LayoutFinished,dM.obj,nil,dw)end)local d_=function(e0,e1,e2,e3,e4,dz)local e5=e3 and(e3["align"..e0]or e3.align)or e2 and(e2["align"..e0]or e2.align)or e1["align"..e0]or e1.align or"CENTERLEFT"local e6;dz,e4=dz or 0,e4 or 0;if type(e5)=="string"then e5=e5:lower()e5=e0=="V"and(e5:sub(1,3)=="top"and"start"or e5:sub(1,6)=="bottom"and"end"or e5:sub(1,6)=="center"and"middle")or e0=="H"and(e5:sub(-4)=="left"and"start"or e5:sub(-5)=="right"and"end"or e5:sub(-6)=="center"and"middle")or e5;e6=(e5=="start"or e5=="fill")and 0 or e5=="end"and e4-dz or(e4-dz)/2 elseif type(e5)=="function"then e6=e5(dz or 0,e4,e0)else e6=e5 end;return e5,df(0,dg(e6,e4))end;local e7=function(e0,e8,e9,ea,eb)local ec=0;for e4=e9,ea do ec=ec+(e8[e4]or 0)end;return ec+df(0,ea-e9)*(eb or 0)end;dd:RegisterLayout("Table",function(dM,dC)local bo=dM.obj;bo:PauseLayout()local e1=bo:GetUserData("table")local ed=e1.columns;local ee=e1.spaceH or e1.space or 0;local ef=e1.spaceV or e1.space or 0;local eg=(dM:GetWidth()or dM.width or 0)-ee*(#ed-1)local eh=bo:GetUserData("layoutCache")if not eh then eh={{},{},{},{},{},{}}bo:SetUserData("layoutCache",eh)end;local aS,ei,ej,ek,el,em=unpack(eh)local cZ,en=0;for J,dz in ipairs(dC)do if dz:IsShown()then repeat cZ=cZ+1;local col=(cZ-1)%#ed+1;local eo=dh(cZ/#ed)local ep=ek[col]local e4=ep and ep.child or dz;local e3=e4:GetUserData("cell")en=not ep;if not ep and e3 and e3.rowspan then ep={child=dz,from=eo,to=eo+e3.rowspan-1}ek[col]=ep end;if ep and J==#dC then ep.to=eo end;local eq=df(0,dg((e3 and e3.colspan or 1)-1,#ed-col))cZ=cZ+eq;if not ep or ep.to==eo then aS[cZ]=e4;el[e4]=ep and ep.from or eo;em[e4]=col;if ep then ek[col]=nil end end until en end end;local er=dh(cZ/#ed)local es,et=eg,0;for col,e2 in ipairs(ed)do ei[col]=0;if type(e2)=="number"then e2={[e2>=1 and e2<10 and"weight"or"width"]=e2}ed[col]=e2 end;if e2.weight then et=et+(e2.weight or 1)else if not e2.width or e2.width<=0 then for eo=1,er do local dz=aS[(eo-1)*#ed+col]if dz then local eu=dz.frame;eu:ClearAllPoints()local ev=eu:GetWidth()or 0;ei[col]=df(ei[col],ev-e7("H",ei,em[dz],col-1,ee))end end;ei[col]=df(e2.min or e2[1]or 0,dg(ei[col],e2.max or e2[2]or ei[col]))else ei[col]=e2.width<1 and e2.width*eg or e2.width end;es=df(0,es-ei[col])end end;local ew=et>0 and es/et or 0;for col,e2 in pairs(ed)do if e2.weight then ei[col]=ew*e2.weight end end;for eo=1,er do local ex=0;for col=1,#ed do local dz=aS[(eo-1)*#ed+col]if dz then local e2=ed[em[dz]]local e3=dz:GetUserData("cell")local ey=e7("H",ei,1,em[dz]-1,ee)+(em[dz]==1 and 0 or ee)local ez=e7("H",ei,em[dz],col,ee)local eu=dz.frame;eu:ClearAllPoints()local ev=eu:GetWidth()or 0;local eA,eB=d_("H",e1,e2,e3,ez,ev)eu:SetPoint("LEFT",dM,ey+eB,0)if dz:IsFullWidth()or eA=="fill"or ev>ez then eu:SetPoint("RIGHT",dM,"LEFT",ey+eB+ez,0)end;if dz.DoLayout then dz:DoLayout()end;ex=df(ex,(eu:GetHeight()or 0)-e7("V",ej,el[dz],eo-1,ef))end end;ej[eo]=ex;for col=1,#ed do local dz=aS[(eo-1)*#ed+col]if dz then local e2=ed[em[dz]]local e3=dz:GetUserData("cell")local eC=e7("V",ej,1,el[dz]-1,ef)+(el[dz]==1 and 0 or ef)local eD=e7("V",ej,el[dz],eo,ef)local eu=dz.frame;local eE=eu:GetHeight()or 0;local eA,eB=d_("V",e1,e2,e3,eD,eE)if dz:IsFullHeight()or eA=="fill"then eu:SetHeight(eD)end;eu:SetPoint("TOP",dM,0,-(eC+eB))end end end;local eF=e7("V",ej,1,#ej,ef)for aT,ac in pairs(eh)do de(ac)end;S(bo.LayoutFinished,bo,nil,eF)bo:ResumeLayout()end)end;local function eG(...)local eH,dJ="BlizOptionsGroup",26;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs=pairs;local CreateFrame=CreateFrame;local function eI(bv)bv.obj:Fire("OnShow")end;local function eJ(bv)bv.obj:Fire("OnHide")end;local function eK(bv)bv.obj:Fire("okay")end;local function eL(bv)bv.obj:Fire("cancel")end;local function eM(bv)bv.obj:Fire("default")end;local function eN(bv)bv.obj:Fire("refresh")end;local eO={["OnAcquire"]=function(self)self:SetName()self:SetTitle()end,["OnWidthSet"]=function(self,dv)local dM=self.content;local eP=dv-63;if eP<0 then eP=0 end;dM:SetWidth(eP)dM.width=eP end,["OnHeightSet"]=function(self,dw)local dM=self.content;local eQ=dw-26;if eQ<0 then eQ=0 end;dM:SetHeight(eQ)dM.height=eQ end,["SetName"]=function(self,a8,cb)self.frame.name=a8;self.frame.parent=cb end,["SetTitle"]=function(self,eR)local dM=self.content;dM:ClearAllPoints()if not eR or eR==""then dM:SetPoint("TOPLEFT",10,-10)self.label:SetText("")else dM:SetPoint("TOPLEFT",10,-40)self.label:SetText(eR)end;dM:SetPoint("BOTTOMRIGHT",-10,10)end}local function dI()local bv=CreateFrame("Frame",nil,InterfaceOptionsFramePanelContainer)bv:Hide()bv.okay=eK;bv.cancel=eL;bv.default=eM;bv.refresh=eN;bv.OnCommit=eK;bv.OnDefault=eM;bv.OnRefresh=eN;bv:SetScript("OnHide",eJ)bv:SetScript("OnShow",eI)local eS=bv:CreateFontString(nil,"OVERLAY","GameFontNormalLarge")eS:SetPoint("TOPLEFT",10,-15)eS:SetPoint("BOTTOMRIGHT",bv,"TOPRIGHT",10,-45)eS:SetJustifyH("LEFT")eS:SetJustifyV("TOP")local dM=CreateFrame("Frame",nil,bv)dM:SetPoint("TOPLEFT",10,-10)dM:SetPoint("BOTTOMRIGHT",-10,10)local dr={label=eS,frame=bv,content=dM,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsContainer(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function eT(...)local eH,dJ="DropdownGroup",22;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local assert,pairs,type=assert,pairs,type;local CreateFrame=CreateFrame;local function eU(self,C,bw)local eV=self.parentgroup;local eW=eV.status or eV.localstatus;eW.selected=bw;self.parentgroup:Fire("OnGroupSelected",bw)end;local eO={["OnAcquire"]=function(self)self.dropdown:SetText("")self:SetDropdownWidth(200)self:SetTitle("")end,["OnRelease"]=function(self)self.dropdown.list=nil;self.status=nil;for ab in pairs(self.localstatus)do self.localstatus[ab]=nil end end,["SetTitle"]=function(self,eR)self.titletext:SetText(eR)self.dropdown.frame:ClearAllPoints()if eR and eR~=""then self.dropdown.frame:SetPoint("TOPRIGHT",-2,0)else self.dropdown.frame:SetPoint("TOPLEFT",-1,0)end end,["SetGroupList"]=function(self,eX,eY)self.dropdown:SetList(eX,eY)end,["SetStatusTable"]=function(self,eW)assert(type(eW)=="table")self.status=eW end,["SetGroup"]=function(self,eV)self.dropdown:SetValue(eV)local eW=self.status or self.localstatus;eW.selected=eV;self:Fire("OnGroupSelected",eV)end,["OnWidthSet"]=function(self,dv)local dM=self.content;local eP=dv-26;if eP<0 then eP=0 end;dM:SetWidth(eP)dM.width=eP end,["OnHeightSet"]=function(self,dw)local dM=self.content;local eQ=dw-63;if eQ<0 then eQ=0 end;dM:SetHeight(eQ)dM.height=eQ end,["LayoutFinished"]=function(self,dv,dw)self:SetHeight((dw or 0)+63)end,["SetDropdownWidth"]=function(self,dv)self.dropdown:SetWidth(dv)end}local eZ={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dI()local bv=CreateFrame("Frame")bv:SetHeight(100)bv:SetWidth(100)bv:SetFrameStrata("FULLSCREEN_DIALOG")local e_=bv:CreateFontString(nil,"OVERLAY","GameFontNormal")e_:SetPoint("TOPLEFT",4,-5)e_:SetPoint("TOPRIGHT",-4,-5)e_:SetJustifyH("LEFT")e_:SetHeight(18)local f0=dd:Create("Dropdown")f0.frame:SetParent(bv)f0.frame:SetFrameLevel(f0.frame:GetFrameLevel()+2)f0:SetCallback("OnValueChanged",eU)f0.frame:SetPoint("TOPLEFT",-1,0)f0.frame:Show()f0:SetLabel("")local f1=CreateFrame("Frame",nil,bv,"BackdropTemplate")f1:SetPoint("TOPLEFT",0,-26)f1:SetPoint("BOTTOMRIGHT",0,3)f1:SetBackdrop(eZ)f1:SetBackdropColor(0.1,0.1,0.1,0.5)f1:SetBackdropBorderColor(0.4,0.4,0.4)local dM=CreateFrame("Frame",nil,f1)dM:SetPoint("TOPLEFT",10,-10)dM:SetPoint("BOTTOMRIGHT",-10,10)local dr={frame=bv,localstatus={},titletext=e_,dropdown=f0,border=f1,content=dM,type=eH}for s,G in pairs(eO)do dr[s]=G end;f0.parentgroup=dr;return dd:RegisterAsContainer(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function f2(...)local eH,dJ="Frame",30;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs,assert,type=pairs,assert,type;local de=table.wipe;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function f3(bv)PlaySound(799)bv.obj:Hide()end;local function f4(bv)bv.obj:Fire("OnShow")end;local function f5(bv)bv.obj:Fire("OnClose")end;local function f6(bv)dd:ClearFocus()end;local function f7(bv)bv:GetParent():StartMoving()dd:ClearFocus()end;local function f8(f9)local bv=f9:GetParent()bv:StopMovingOrSizing()local self=bv.obj;local eW=self.status or self.localstatus;eW.width=bv:GetWidth()eW.height=bv:GetHeight()eW.top=bv:GetTop()eW.left=bv:GetLeft()end;local function fa(bv)bv:GetParent():StartSizing("BOTTOMRIGHT")dd:ClearFocus()end;local function fb(bv)bv:GetParent():StartSizing("BOTTOM")dd:ClearFocus()end;local function fc(bv)bv:GetParent():StartSizing("RIGHT")dd:ClearFocus()end;local function fd(bv)bv.obj:Fire("OnEnterStatusBar")end;local function fe(bv)bv.obj:Fire("OnLeaveStatusBar")end;local eO={["OnAcquire"]=function(self)self.frame:SetParent(UIParent)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")self.frame:SetFrameLevel(100)self:SetTitle()self:SetStatusText()self:ApplyStatus()self:Show()self:EnableResize(true)end,["OnRelease"]=function(self)self.status=nil;de(self.localstatus)end,["OnWidthSet"]=function(self,dv)local dM=self.content;local eP=dv-34;if eP<0 then eP=0 end;dM:SetWidth(eP)dM.width=eP end,["OnHeightSet"]=function(self,dw)local dM=self.content;local eQ=dw-57;if eQ<0 then eQ=0 end;dM:SetHeight(eQ)dM.height=eQ end,["SetTitle"]=function(self,eR)self.titletext:SetText(eR)self.titlebg:SetWidth((self.titletext:GetWidth()or 0)+10)end,["SetStatusText"]=function(self,ff)self.statustext:SetText(ff)end,["Hide"]=function(self)self.frame:Hide()end,["Show"]=function(self)self.frame:Show()end,["EnableResize"]=function(self,ak)local G=ak and"Show"or"Hide"self.sizer_se[G](self.sizer_se)self.sizer_s[G](self.sizer_s)self.sizer_e[G](self.sizer_e)end,["SetStatusTable"]=function(self,eW)assert(type(eW)=="table")self.status=eW;self:ApplyStatus()end,["ApplyStatus"]=function(self)local eW=self.status or self.localstatus;local bv=self.frame;self:SetWidth(eW.width or 700)self:SetHeight(eW.height or 500)bv:ClearAllPoints()if eW.top and eW.left then bv:SetPoint("TOP",UIParent,"BOTTOM",0,eW.top)bv:SetPoint("LEFT",UIParent,"LEFT",eW.left,0)else bv:SetPoint("CENTER")end end}local fg={bgFile="Interface\\DialogFrame\\UI-DialogBox-Background",edgeFile="Interface\\DialogFrame\\UI-DialogBox-Border",tile=true,tileSize=32,edgeSize=32,insets={left=8,right=8,top=8,bottom=8}}local eZ={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dI()local bv=CreateFrame("Frame",nil,UIParent,"BackdropTemplate")bv:Hide()bv:EnableMouse(true)bv:SetMovable(true)bv:SetResizable(true)bv:SetFrameStrata("FULLSCREEN_DIALOG")bv:SetFrameLevel(100)bv:SetBackdrop(fg)bv:SetBackdropColor(0,0,0,1)if bv.SetResizeBounds then bv:SetResizeBounds(400,200)else bv:SetMinResize(400,200)end;bv:SetToplevel(true)bv:SetScript("OnShow",f4)bv:SetScript("OnHide",f5)bv:SetScript("OnMouseDown",f6)local fh=CreateFrame("Button",nil,bv,"UIPanelButtonTemplate")fh:SetScript("OnClick",f3)fh:SetPoint("BOTTOMRIGHT",-27,17)fh:SetHeight(20)fh:SetWidth(100)fh:SetText(CLOSE)local fi=CreateFrame("Button",nil,bv,"BackdropTemplate")fi:SetPoint("BOTTOMLEFT",15,15)fi:SetPoint("BOTTOMRIGHT",-132,15)fi:SetHeight(24)fi:SetBackdrop(eZ)fi:SetBackdropColor(0.1,0.1,0.1)fi:SetBackdropBorderColor(0.4,0.4,0.4)fi:SetScript("OnEnter",fd)fi:SetScript("OnLeave",fe)local fj=fi:CreateFontString(nil,"OVERLAY","GameFontNormal")fj:SetPoint("TOPLEFT",7,-2)fj:SetPoint("BOTTOMRIGHT",-7,2)fj:SetHeight(20)fj:SetJustifyH("LEFT")fj:SetText("")local fk=bv:CreateTexture(nil,"OVERLAY")fk:SetTexture(131080)fk:SetTexCoord(0.31,0.67,0,0.63)fk:SetPoint("TOP",0,12)fk:SetWidth(100)fk:SetHeight(40)local eR=CreateFrame("Frame",nil,bv)eR:EnableMouse(true)eR:SetScript("OnMouseDown",f7)eR:SetScript("OnMouseUp",f8)eR:SetAllPoints(fk)local e_=eR:CreateFontString(nil,"OVERLAY","GameFontNormal")e_:SetPoint("TOP",fk,"TOP",0,-14)local fl=bv:CreateTexture(nil,"OVERLAY")fl:SetTexture(131080)fl:SetTexCoord(0.21,0.31,0,0.63)fl:SetPoint("RIGHT",fk,"LEFT")fl:SetWidth(30)fl:SetHeight(40)local fm=bv:CreateTexture(nil,"OVERLAY")fm:SetTexture(131080)fm:SetTexCoord(0.67,0.77,0,0.63)fm:SetPoint("LEFT",fk,"RIGHT")fm:SetWidth(30)fm:SetHeight(40)local fn=CreateFrame("Frame",nil,bv)fn:SetPoint("BOTTOMRIGHT")fn:SetWidth(25)fn:SetHeight(25)fn:EnableMouse()fn:SetScript("OnMouseDown",fa)fn:SetScript("OnMouseUp",f8)local fo=fn:CreateTexture(nil,"BACKGROUND")fo:SetWidth(14)fo:SetHeight(14)fo:SetPoint("BOTTOMRIGHT",-8,8)fo:SetTexture(137057)local fp=0.1*14/17;fo:SetTexCoord(0.05-fp,0.5,0.05,0.5+fp,0.05,0.5-fp,0.5+fp,0.5)local fq=fn:CreateTexture(nil,"BACKGROUND")fq:SetWidth(8)fq:SetHeight(8)fq:SetPoint("BOTTOMRIGHT",-8,8)fq:SetTexture(137057)fp=0.1*8/17;fq:SetTexCoord(0.05-fp,0.5,0.05,0.5+fp,0.05,0.5-fp,0.5+fp,0.5)local fr=CreateFrame("Frame",nil,bv)fr:SetPoint("BOTTOMRIGHT",-25,0)fr:SetPoint("BOTTOMLEFT")fr:SetHeight(25)fr:EnableMouse(true)fr:SetScript("OnMouseDown",fb)fr:SetScript("OnMouseUp",f8)local fs=CreateFrame("Frame",nil,bv)fs:SetPoint("BOTTOMRIGHT",0,25)fs:SetPoint("TOPRIGHT")fs:SetWidth(25)fs:EnableMouse(true)fs:SetScript("OnMouseDown",fc)fs:SetScript("OnMouseUp",f8)local dM=CreateFrame("Frame",nil,bv)dM:SetPoint("TOPLEFT",17,-27)dM:SetPoint("BOTTOMRIGHT",-17,40)local dr={localstatus={},titletext=e_,statustext=fj,titlebg=fk,sizer_se=fn,sizer_s=fr,sizer_e=fs,content=dM,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;fh.obj,fi.obj=dr,dr;return dd:RegisterAsContainer(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function ft(...)local eH,dJ="InlineGroup",22;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eO={["OnAcquire"]=function(self)self:SetWidth(300)self:SetHeight(100)self:SetTitle("")end,["SetTitle"]=function(self,eR)self.titletext:SetText(eR)end,["LayoutFinished"]=function(self,dv,dw)if self.noAutoHeight then return end;self:SetHeight((dw or 0)+40)end,["OnWidthSet"]=function(self,dv)local dM=self.content;local eP=dv-20;if eP<0 then eP=0 end;dM:SetWidth(eP)dM.width=eP end,["OnHeightSet"]=function(self,dw)local dM=self.content;local eQ=dw-20;if eQ<0 then eQ=0 end;dM:SetHeight(eQ)dM.height=eQ end}local eZ={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dI()local bv=CreateFrame("Frame",nil,UIParent)bv:SetFrameStrata("FULLSCREEN_DIALOG")local e_=bv:CreateFontString(nil,"OVERLAY","GameFontNormal")e_:SetPoint("TOPLEFT",14,0)e_:SetPoint("TOPRIGHT",-14,0)e_:SetJustifyH("LEFT")e_:SetHeight(18)local f1=CreateFrame("Frame",nil,bv,"BackdropTemplate")f1:SetPoint("TOPLEFT",0,-17)f1:SetPoint("BOTTOMRIGHT",-1,3)f1:SetBackdrop(eZ)f1:SetBackdropColor(0.1,0.1,0.1,0.5)f1:SetBackdropBorderColor(0.4,0.4,0.4)local dM=CreateFrame("Frame",nil,f1)dM:SetPoint("TOPLEFT",10,-10)dM:SetPoint("BOTTOMRIGHT",-10,10)local dr={frame=bv,content=dM,titletext=e_,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsContainer(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function fu(...)local eH,dJ="ScrollFrame",26;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs,assert,type=pairs,assert,type;local fv,cW,fw=math.min,math.max,math.floor;local CreateFrame,UIParent=CreateFrame,UIParent;local function fx(bv)bv:SetScript("OnUpdate",nil)bv.obj:FixScroll()end;local function fy(bv,bw)bv.obj:MoveScroll(bw)end;local function fz(bv)bv:SetScript("OnUpdate",fx)end;local function fA(bv,bw)bv.obj:SetScroll(bw)end;local eO={["OnAcquire"]=function(self)self:SetScroll(0)self.scrollframe:SetScript("OnUpdate",fx)end,["OnRelease"]=function(self)self.status=nil;for ab in pairs(self.localstatus)do self.localstatus[ab]=nil end;self.scrollframe:SetPoint("BOTTOMRIGHT")self.scrollbar:Hide()self.scrollBarShown=nil;self.content.height,self.content.width,self.content.original_width=nil,nil,nil end,["SetScroll"]=function(self,bw)local eW=self.status or self.localstatus;local fB=self.scrollframe:GetHeight()local dw=self.content:GetHeight()local ae;if fB>dw then ae=0 else ae=fw((dw-fB)/1000.0*bw)end;self.content:ClearAllPoints()self.content:SetPoint("TOPLEFT",0,ae)self.content:SetPoint("TOPRIGHT",0,ae)eW.offset=ae;eW.scrollvalue=bw end,["MoveScroll"]=function(self,bw)local eW=self.status or self.localstatus;local dw,fB=self.scrollframe:GetHeight(),self.content:GetHeight()if self.scrollBarShown then local fC=dw-fB;local fD=1;if bw<0 then fD=-1 end;self.scrollbar:SetValue(fv(cW(eW.scrollvalue+fD*1000/(fC/45),0),1000))end end,["FixScroll"]=function(self)if self.updateLock then return end;self.updateLock=true;local eW=self.status or self.localstatus;local dw,fB=self.scrollframe:GetHeight(),self.content:GetHeight()local ae=eW.offset or 0;if fB<dw+2 then if self.scrollBarShown then self.scrollBarShown=nil;self.scrollbar:Hide()self.scrollbar:SetValue(0)self.scrollframe:SetPoint("BOTTOMRIGHT")if self.content.original_width then self.content.width=self.content.original_width end;self:DoLayout()end else if not self.scrollBarShown then self.scrollBarShown=true;self.scrollbar:Show()self.scrollframe:SetPoint("BOTTOMRIGHT",-20,0)if self.content.original_width then self.content.width=self.content.original_width-20 end;self:DoLayout()end;local bw=ae/(fB-dw)*1000;if bw>1000 then bw=1000 end;self.scrollbar:SetValue(bw)self:SetScroll(bw)if bw<1000 then self.content:ClearAllPoints()self.content:SetPoint("TOPLEFT",0,ae)self.content:SetPoint("TOPRIGHT",0,ae)eW.offset=ae end end;self.updateLock=nil end,["LayoutFinished"]=function(self,dv,dw)self.content:SetHeight(dw or 0+20)self:FixScroll()self.scrollframe:SetScript("OnUpdate",fx)end,["SetStatusTable"]=function(self,eW)assert(type(eW)=="table")self.status=eW;if not eW.scrollvalue then eW.scrollvalue=0 end end,["OnWidthSet"]=function(self,dv)local dM=self.content;dM.width=dv-(self.scrollBarShown and 20 or 0)dM.original_width=dv end,["OnHeightSet"]=function(self,dw)local dM=self.content;dM.height=dw end}local function dI()local bv=CreateFrame("Frame",nil,UIParent)local fE=dd:GetNextWidgetNum(eH)local fF=CreateFrame("ScrollFrame",nil,bv)fF:SetPoint("TOPLEFT")fF:SetPoint("BOTTOMRIGHT")fF:EnableMouseWheel(true)fF:SetScript("OnMouseWheel",fy)fF:SetScript("OnSizeChanged",fz)local fG=CreateFrame("Slider",("AceConfigDialogScrollFrame%dScrollBar"):format(fE),fF,"UIPanelScrollBarTemplate")fG:SetPoint("TOPLEFT",fF,"TOPRIGHT",4,-16)fG:SetPoint("BOTTOMLEFT",fF,"BOTTOMRIGHT",4,16)fG:SetMinMaxValues(0,1000)fG:SetValueStep(1)fG:SetValue(0)fG:SetWidth(16)fG:Hide()fG:SetScript("OnValueChanged",fA)local fH=fG:CreateTexture(nil,"BACKGROUND")fH:SetAllPoints(fG)fH:SetColorTexture(0,0,0,0.4)local dM=CreateFrame("Frame",nil,fF)dM:SetPoint("TOPLEFT")dM:SetPoint("TOPRIGHT")dM:SetHeight(400)fF:SetScrollChild(dM)local dr={localstatus={scrollvalue=0},scrollframe=fF,scrollbar=fG,content=dM,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;fF.obj,fG.obj=dr,dr;return dd:RegisterAsContainer(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function fI(...)local eH,dJ="SimpleGroup",20;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eO={["OnAcquire"]=function(self)self:SetWidth(300)self:SetHeight(100)end,["LayoutFinished"]=function(self,dv,dw)if self.noAutoHeight then return end;self:SetHeight(dw or 0)end,["OnWidthSet"]=function(self,dv)local dM=self.content;dM:SetWidth(dv)dM.width=dv end,["OnHeightSet"]=function(self,dw)local dM=self.content;dM:SetHeight(dw)dM.height=dw end}local function dI()local bv=CreateFrame("Frame",nil,UIParent)bv:SetFrameStrata("FULLSCREEN_DIALOG")local dM=CreateFrame("Frame",nil,bv)dM:SetPoint("TOPLEFT")dM:SetPoint("BOTTOMRIGHT")local dr={frame=bv,content=dM,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsContainer(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function fJ(...)local eH,dJ="TabGroup",38;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs,ipairs,assert,type,de=pairs,ipairs,assert,type,table.wipe;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;local fK={}local fL={}local fM={}local function fN(fO,fP,fQ,fR,fS,fT)local fU=fO:GetName()local fV=fO.Middle or fO.middleTexture or _G[fU.."Middle"]local fW=fO.MiddleDisabled or fU and _G[fU.."MiddleDisabled"]local fX=fO.Left or fO.leftTexture or _G[fU.."Left"]local fY=2*fX:GetWidth()local fZ=fO.Text or _G[fO:GetName().."Text"]local f_=fO.HighlightTexture or fU and _G[fU.."HighlightTexture"]local dv,g0;local g1;if fT then g1=fT else fZ:SetWidth(0)g1=fZ:GetWidth()end;if fQ then if fQ<fY then dv=1;g0=fY else dv=fQ-fY;g0=fQ end;fZ:SetWidth(dv)else if fP then dv=g1+fP else dv=g1+24 end;if fS and dv>fS then if fP then dv=fS+fP else dv=fS+24 end;fZ:SetWidth(dv)else fZ:SetWidth(0)end;if fR and dv<fR then dv=fR end;g0=dv+fY end;if fV then fV:SetWidth(dv)end;if fW then fW:SetWidth(dv)end;fO:SetWidth(g0)if f_ then f_:SetWidth(g0)end end;local function g2(fO)local a8=fO:GetName()local fX=fO.Left or _G[a8 .."Left"]local g3=fO.Middle or _G[a8 .."Middle"]local g4=fO.Right or _G[a8 .."Right"]fX:Show()g3:Show()g4:Show()fO:Enable()local ff=fO.Text or _G[a8 .."Text"]ff:SetPoint("CENTER",fO,"CENTER",fO.deselectedTextX or 0,fO.deselectedTextY or 2)local g5=fO.LeftDisabled or _G[a8 .."LeftDisabled"]local g6=fO.MiddleDisabled or _G[a8 .."MiddleDisabled"]local g7=fO.RightDisabled or _G[a8 .."RightDisabled"]g5:Hide()g6:Hide()g7:Hide()end;local function g8(fO)local a8=fO:GetName()local fX=fO.Left or _G[a8 .."Left"]local g3=fO.Middle or _G[a8 .."Middle"]local g4=fO.Right or _G[a8 .."Right"]fX:Hide()g3:Hide()g4:Hide()fO:Disable()fO:SetDisabledFontObject(GameFontHighlightSmall)local ff=fO.Text or _G[a8 .."Text"]ff:SetPoint("CENTER",fO,"CENTER",fO.selectedTextX or 0,fO.selectedTextY or-3)local g5=fO.LeftDisabled or _G[a8 .."LeftDisabled"]local g6=fO.MiddleDisabled or _G[a8 .."MiddleDisabled"]local g7=fO.RightDisabled or _G[a8 .."RightDisabled"]g5:Show()g6:Show()g7:Show()if GameTooltip:IsOwned(fO)then GameTooltip:Hide()end end;local function g9(fO)local a8=fO:GetName()local fX=fO.Left or _G[a8 .."Left"]local g3=fO.Middle or _G[a8 .."Middle"]local g4=fO.Right or _G[a8 .."Right"]fX:Show()g3:Show()g4:Show()fO:Disable()fO.text=fO:GetText()fO:SetDisabledFontObject(GameFontDisableSmall)local g5=fO.LeftDisabled or _G[a8 .."LeftDisabled"]local g6=fO.MiddleDisabled or _G[a8 .."MiddleDisabled"]local g7=fO.RightDisabled or _G[a8 .."RightDisabled"]g5:Hide()g6:Hide()g7:Hide()end;local function ga(bv)if bv.disabled then g9(bv)elseif bv.selected then g8(bv)else g2(bv)end end;local function gb(bv,ff)bv:_SetText(ff)local dv=bv.obj.frame.width or bv.obj.frame:GetWidth()or 0;fN(bv,0,nil,nil,dv,bv:GetFontString():GetStringWidth())end;local function gc(bv,gd)bv.selected=gd;ga(bv)end;local function ge(bv,gf)bv.disabled=gf;ga(bv)end;local function gg(bv)local self=bv.obj;self:BuildTabs()bv:SetScript("OnUpdate",nil)end;local function gh(bv)if not(bv.selected or bv.disabled)then PlaySound(841)bv.obj:SelectTab(bv.value)end end;local function gi(bv)local self=bv.obj;self:Fire("OnTabEnter",self.tabs[bv.id].value,bv)end;local function gj(bv)local self=bv.obj;self:Fire("OnTabLeave",self.tabs[bv.id].value,bv)end;local function gk(bv)_G[bv:GetName().."HighlightTexture"]:SetWidth(bv:GetTextWidth()+30)end;local eO={["OnAcquire"]=function(self)self:SetTitle()end,["OnRelease"]=function(self)self.status=nil;for ab in pairs(self.localstatus)do self.localstatus[ab]=nil end;self.tablist=nil;for aT,fO in pairs(self.tabs)do fO:Hide()end end,["CreateTab"]=function(self,aL)local gl=("AceGUITabGroup%dTab%d"):format(self.num,aL)local fO=CreateFrame("Button",gl,self.border)fO:SetSize(115,24)fO.deselectedTextY=-3;fO.selectedTextY=-2;fO.LeftDisabled=fO:CreateTexture(gl.."LeftDisabled","BORDER")fO.LeftDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fO.LeftDisabled:SetSize(20,24)fO.LeftDisabled:SetPoint("BOTTOMLEFT",0,-3)fO.LeftDisabled:SetTexCoord(0,0.15625,0,1.0)fO.MiddleDisabled=fO:CreateTexture(gl.."MiddleDisabled","BORDER")fO.MiddleDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fO.MiddleDisabled:SetSize(88,24)fO.MiddleDisabled:SetPoint("LEFT",fO.LeftDisabled,"RIGHT")fO.MiddleDisabled:SetTexCoord(0.15625,0.84375,0,1.0)fO.RightDisabled=fO:CreateTexture(gl.."RightDisabled","BORDER")fO.RightDisabled:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-ActiveTab")fO.RightDisabled:SetSize(20,24)fO.RightDisabled:SetPoint("LEFT",fO.MiddleDisabled,"RIGHT")fO.RightDisabled:SetTexCoord(0.84375,1.0,0,1.0)fO.Left=fO:CreateTexture(gl.."Left","BORDER")fO.Left:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fO.Left:SetSize(20,24)fO.Left:SetPoint("TOPLEFT")fO.Left:SetTexCoord(0,0.15625,0,1.0)fO.Middle=fO:CreateTexture(gl.."Middle","BORDER")fO.Middle:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fO.Middle:SetSize(88,24)fO.Middle:SetPoint("LEFT",fO.Left,"RIGHT")fO.Middle:SetTexCoord(0.15625,0.84375,0,1.0)fO.Right=fO:CreateTexture(gl.."Right","BORDER")fO.Right:SetTexture("Interface\\OptionsFrame\\UI-OptionsFrame-InActiveTab")fO.Right:SetSize(20,24)fO.Right:SetPoint("LEFT",fO.Middle,"RIGHT")fO.Right:SetTexCoord(0.84375,1.0,0,1.0)fO.Text=fO:CreateFontString(gl.."Text")fO:SetFontString(fO.Text)fO:SetNormalFontObject(GameFontNormalSmall)fO:SetHighlightFontObject(GameFontHighlightSmall)fO:SetDisabledFontObject(GameFontHighlightSmall)fO:SetHighlightTexture("Interface\\PaperDollInfoFrame\\UI-Character-Tab-Highlight","ADD")fO.HighlightTexture=fO:GetHighlightTexture()fO.HighlightTexture:ClearAllPoints()fO.HighlightTexture:SetPoint("LEFT",fO,"LEFT",10,-4)fO.HighlightTexture:SetPoint("RIGHT",fO,"RIGHT",-10,-4)_G[gl.."HighlightTexture"]=fO.HighlightTexture;fO.obj=self;fO.id=aL;fO.text=fO.Text;fO.text:ClearAllPoints()fO.text:SetPoint("LEFT",14,-3)fO.text:SetPoint("RIGHT",-12,-3)fO:SetScript("OnClick",gh)fO:SetScript("OnEnter",gi)fO:SetScript("OnLeave",gj)fO:SetScript("OnShow",gk)fO._SetText=fO.SetText;fO.SetText=gb;fO.SetSelected=gc;fO.SetDisabled=ge;return fO end,["SetTitle"]=function(self,ff)self.titletext:SetText(ff or"")if ff and ff~=""then self.alignoffset=25 else self.alignoffset=18 end;self:BuildTabs()end,["SetStatusTable"]=function(self,eW)assert(type(eW)=="table")self.status=eW end,["SelectTab"]=function(self,bw)local eW=self.status or self.localstatus;local gm;for J,ac in ipairs(self.tabs)do if ac.value==bw then ac:SetSelected(true)gm=true else ac:SetSelected(false)end end;eW.selected=bw;if gm then self:Fire("OnGroupSelected",bw)end end,["SetTabs"]=function(self,gn)self.tablist=gn;self:BuildTabs()end,["BuildTabs"]=function(self)local go=self.titletext:GetText()and self.titletext:GetText()~=""local gp=self.tablist;local gn=self.tabs;if not gp then return end;local dv=self.frame.width or self.frame:GetWidth()or 0;de(fK)de(fL)de(fM)for J,ac in ipairs(gp)do local fO=gn[J]if not fO then fO=self:CreateTab(J)gn[J]=fO end;fO:Show()fO:SetText(ac.text)fO:SetDisabled(ac.disabled)fO.value=ac.value;fK[J]=fO:GetWidth()-6 end;for J=#gp+1,#gn,1 do gn[J]:Hide()end;local gq=#gp;local gr=1;local dP=0;for J=1,#gp do if dP~=0 and dv-dP-fK[J]<0 then fL[gr]=dP+10;fM[gr]=J-1;gr=gr+1;dP=0 end;dP=dP+fK[J]end;fL[gr]=dP+10;fM[gr]=#gp;if gr>1 then if fM[gr-1]==gq-1 then if gr==2 and fM[gr-1]>2 or fM[gr]-fM[gr-1]>2 then if fL[gr]+fK[gq-1]<=dv then fM[gr-1]=fM[gr-1]-1;fL[gr]=fL[gr]+fK[gq-1]fL[gr-1]=fL[gr-1]-fK[gq-1]end end end end;local gs=1;for eo,gt in ipairs(fM)do local E=true;for gu=gs,gt do local fO=gn[gu]fO:ClearAllPoints()if E then fO:SetPoint("TOPLEFT",self.frame,"TOPLEFT",0,-(go and 14 or 7)-(eo-1)*20)E=false else fO:SetPoint("LEFT",gn[gu-1],"RIGHT",-10,0)end end;local fP=0;if not(gr==1 and fL[1]<dv*0.75-18)then fP=(dv-fL[eo])/(gt-gs+1)end;for J=gs,gt do fN(gn[J],fP+4,nil,nil,dv,gn[J]:GetFontString():GetStringWidth())end;gs=gt+1 end;self.borderoffset=(go and 17 or 10)+gr*20;self.border:SetPoint("TOPLEFT",1,-self.borderoffset)end,["OnWidthSet"]=function(self,dv)local dM=self.content;local eP=dv-60;if eP<0 then eP=0 end;dM:SetWidth(eP)dM.width=eP;self:BuildTabs(self)self.frame:SetScript("OnUpdate",gg)end,["OnHeightSet"]=function(self,dw)local dM=self.content;local eQ=dw-(self.borderoffset+23)if eQ<0 then eQ=0 end;dM:SetHeight(eQ)dM.height=eQ end,["LayoutFinished"]=function(self,dv,dw)if self.noAutoHeight then return end;self:SetHeight((dw or 0)+self.borderoffset+23)end}local eZ={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local function dI()local fE=dd:GetNextWidgetNum(eH)local bv=CreateFrame("Frame",nil,UIParent)bv:SetHeight(100)bv:SetWidth(100)bv:SetFrameStrata("FULLSCREEN_DIALOG")local e_=bv:CreateFontString(nil,"OVERLAY","GameFontNormal")e_:SetPoint("TOPLEFT",14,0)e_:SetPoint("TOPRIGHT",-14,0)e_:SetJustifyH("LEFT")e_:SetHeight(18)e_:SetText("")local f1=CreateFrame("Frame",nil,bv,"BackdropTemplate")f1:SetPoint("TOPLEFT",1,-27)f1:SetPoint("BOTTOMRIGHT",-1,3)f1:SetBackdrop(eZ)f1:SetBackdropColor(0.1,0.1,0.1,0.5)f1:SetBackdropBorderColor(0.4,0.4,0.4)local dM=CreateFrame("Frame",nil,f1)dM:SetPoint("TOPLEFT",10,-7)dM:SetPoint("BOTTOMRIGHT",-10,7)local dr={num=fE,frame=bv,localstatus={},alignoffset=18,titletext=e_,border=f1,borderoffset=27,tabs={},content=dM,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsContainer(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function gv(...)local eH,dJ="TreeGroup",47;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local next,pairs,ipairs,assert,type=next,pairs,ipairs,assert,type;local dg,df,fw=math.min,math.max,math.floor;local select,O,unpack,N=select,table.remove,unpack,table.concat;local CreateFrame,UIParent=CreateFrame,UIParent;local aF,gw;do local gx=setmetatable({},{__mode='k'})function aF()local aS=next(gx)if aS then gx[aS]=nil;return aS else return{}end end;function gw(aS)for ab in pairs(aS)do aS[ab]=nil end;gx[aS]=true end end;local gy=175;local gz=true;local function gA(gB)local cb=gB.parent;if cb and cb.value then return gA(cb).."\001"..gB.value else return gB.value end end;local function gC(gD,gE,gd,gF,gG)local self=gD.obj;local gH=gD.toggle;local ff=gE.text or""local gI=gE.icon;local gJ=gE.iconCoords;local gK=gE.level;local bw=gE.value;local gL=gE.uniquevalue;local gf=gE.disabled;gD.treeline=gE;gD.value=bw;gD.uniquevalue=gL;if gd then gD:LockHighlight()gD.selected=true else gD:UnlockHighlight()gD.selected=false end;gD.level=gK;if gK==1 then gD:SetNormalFontObject("GameFontNormal")gD:SetHighlightFontObject("GameFontHighlight")gD.text:SetPoint("LEFT",(gI and 16 or 0)+8,2)else gD:SetNormalFontObject("GameFontHighlightSmall")gD:SetHighlightFontObject("GameFontHighlightSmall")gD.text:SetPoint("LEFT",(gI and 16 or 0)+8*gK,2)end;if gf then gD:EnableMouse(false)gD.text:SetText("|cff808080"..ff..FONT_COLOR_CODE_CLOSE)else gD.text:SetText(ff)gD:EnableMouse(true)end;if gI then gD.icon:SetTexture(gI)gD.icon:SetPoint("LEFT",8*gK,gK==1 and 0 or 1)else gD.icon:SetTexture(nil)end;if gJ then gD.icon:SetTexCoord(unpack(gJ))else gD.icon:SetTexCoord(0,1,0,1)end;if gF then if not gG then gH:SetNormalTexture(130838)gH:SetPushedTexture(130836)else gH:SetNormalTexture(130821)gH:SetPushedTexture(130820)end;gH:Show()else gH:Hide()end end;local function gM(gN)local gO=false;for ab,ac in ipairs(gN)do if ac.children==nil and ac.visible~=false then gO=true elseif ac.children then gO=gO or gM(ac.children)end;if gO then return gO end end;return false end;local function gP(self,ac,gN,gK,cb)local gB=aF()gB.value=ac.value;gB.text=ac.text;gB.icon=ac.icon;gB.iconCoords=ac.iconCoords;gB.disabled=ac.disabled;gB.tree=gN;gB.level=gK;gB.parent=cb;gB.visible=ac.visible;gB.uniquevalue=gA(gB)if ac.children then gB.hasChildren=true else gB.hasChildren=nil end;self.lines[#self.lines+1]=gB;return gB end;local function gQ(bv)local self=bv.obj;bv:SetScript("OnUpdate",nil)self:RefreshTree(nil,true)end;local function gR(...)local cZ=select('#',...)if cZ==1 then return...else return....."\001"..gR(select(2,...))end end;local function gS(bv)local gD=bv.button;local self=gD.obj;local eW=(self.status or self.localstatus).groups;eW[gD.uniquevalue]=not eW[gD.uniquevalue]self:RefreshTree()end;local function f3(bv)local self=bv.obj;self:Fire("OnClick",bv.uniquevalue,bv.selected)if not bv.selected then self:SetSelected(bv.uniquevalue)bv.selected=true;bv:LockHighlight()self:RefreshTree()end;dd:ClearFocus()end;local function gT(gD)local self=gD.obj;local eW=(self.status or self.localstatus).groups;eW[gD.uniquevalue]=not eW[gD.uniquevalue]self:RefreshTree()end;local function gU(bv)local self=bv.obj;self:Fire("OnButtonEnter",bv.uniquevalue,bv)if self.enabletooltips then local gV=dd.tooltip;gV:SetOwner(bv,"ANCHOR_NONE")gV:ClearAllPoints()gV:SetPoint("LEFT",bv,"RIGHT")gV:SetText(bv.text:GetText()or"",1,.82,0,true)gV:Show()end end;local function gW(bv)local self=bv.obj;self:Fire("OnButtonLeave",bv.uniquevalue,bv)if self.enabletooltips then dd.tooltip:Hide()end end;local function gX(bv,bw)if bv.obj.noupdate then return end;local self=bv.obj;local eW=self.status or self.localstatus;eW.scrollvalue=fw(bw+0.5)self:RefreshTree()dd:ClearFocus()end;local function gY(bv)bv.obj:RefreshTree()end;local function gZ(bv,fD)local self=bv.obj;if self.showscroll then local fG=self.scrollbar;local fv,cW=fG:GetMinMaxValues()local bw=fG:GetValue()local g_=dg(cW,df(fv,bw-fD))if bw~=g_ then fG:SetValue(g_)end end end;local function h0(bv)bv:SetBackdropColor(1,1,1,0)end;local function h1(bv)bv:SetBackdropColor(1,1,1,0.8)end;local function h2(bv)local h3=bv:GetParent()h3:StartSizing("RIGHT")end;local function h4(bv)local h3=bv:GetParent()local self=h3.obj;local h5=h3:GetParent()h3:StopMovingOrSizing()h3:SetUserPlaced(false)h3:SetHeight(0)h3:ClearAllPoints()h3:SetPoint("TOPLEFT",h5,"TOPLEFT",0,0)h3:SetPoint("BOTTOMLEFT",h5,"BOTTOMLEFT",0,0)local eW=self.status or self.localstatus;eW.treewidth=h3:GetWidth()h3.obj:Fire("OnTreeResize",h3:GetWidth())h3.obj:OnWidthSet(eW.fullwidth)h3.obj:DoLayout()end;local eO={["OnAcquire"]=function(self)self:SetTreeWidth(gy,gz)self:EnableButtonTooltips(true)self.frame:SetScript("OnUpdate",gQ)end,["OnRelease"]=function(self)self.status=nil;self.tree=nil;self.frame:SetScript("OnUpdate",nil)for ab,ac in pairs(self.localstatus)do if ab=="groups"then for bH in pairs(ac)do ac[bH]=nil end else self.localstatus[ab]=nil end end;self.localstatus.scrollvalue=0;self.localstatus.treewidth=gy;self.localstatus.treesizable=gz end,["EnableButtonTooltips"]=function(self,h6)self.enabletooltips=h6 end,["CreateButton"]=function(self)local fE=dd:GetNextWidgetNum("TreeGroupButton")local gD=CreateFrame("Button",("AceGUI30TreeButton%d"):format(fE),self.treeframe,"OptionsListButtonTemplate")gD.obj=self;local gI=gD:CreateTexture(nil,"OVERLAY")gI:SetWidth(14)gI:SetHeight(14)gD.icon=gI;gD:SetScript("OnClick",f3)gD:SetScript("OnDoubleClick",gT)gD:SetScript("OnEnter",gU)gD:SetScript("OnLeave",gW)gD.toggle.button=gD;gD.toggle:SetScript("OnClick",gS)gD.text:SetHeight(14)return gD end,["SetStatusTable"]=function(self,eW)assert(type(eW)=="table")self.status=eW;if not eW.groups then eW.groups={}end;if not eW.scrollvalue then eW.scrollvalue=0 end;if not eW.treewidth then eW.treewidth=gy end;if eW.treesizable==nil then eW.treesizable=gz end;self:SetTreeWidth(eW.treewidth,eW.treesizable)self:RefreshTree()end,["SetTree"]=function(self,gN,h7)self.filter=h7;if gN then assert(type(gN)=="table")end;self.tree=gN;self:RefreshTree()end,["BuildLevel"]=function(self,gN,gK,cb)local h8=(self.status or self.localstatus).groups;for J,ac in ipairs(gN)do if ac.children then if not self.filter or gM(ac.children)then local gB=gP(self,ac,gN,gK,cb)if h8[gB.uniquevalue]then self:BuildLevel(ac.children,gK+1,gB)end end elseif ac.visible~=false or not self.filter then gP(self,ac,gN,gK,cb)end end end,["RefreshTree"]=function(self,h9,ha)local hb=self.buttons;local hc=self.lines;for J,ac in ipairs(hb)do ac:Hide()end;while hc[1]do local aS=O(hc)for ab in pairs(aS)do aS[ab]=nil end;gw(aS)end;if not self.tree then return end;local eW=self.status or self.localstatus;local hd=eW.groups;local gN=self.tree;local h3=self.treeframe;eW.scrollToSelection=eW.scrollToSelection or h9;self:BuildLevel(gN,1)local he=#hc;local hf=fw(((self.treeframe:GetHeight()or 0)-20)/18)if hf<=0 then return end;if self.frame:GetParent()==UIParent and not ha then self.frame:SetScript("OnUpdate",gQ)return end;local E,hg;h9=eW.scrollToSelection;eW.scrollToSelection=nil;if he<=hf then eW.scrollvalue=0;self:ShowScroll(false)E,hg=1,he else self:ShowScroll(true)self.noupdate=true;self.scrollbar:SetMinMaxValues(0,he-hf)if he-eW.scrollvalue<hf then eW.scrollvalue=he-hf end;self.noupdate=nil;E,hg=eW.scrollvalue+1,eW.scrollvalue+hf;if h9 and eW.selected then local hh;for J,gB in ipairs(hc)do if gB.uniquevalue==eW.selected then hh=J end end;if not hh then elseif hh>=E and hh<=hg then else if hh<E then eW.scrollvalue=hh-1 else eW.scrollvalue=hh-hf end;E,hg=eW.scrollvalue+1,eW.scrollvalue+hf end end;if self.scrollbar:GetValue()~=eW.scrollvalue then self.scrollbar:SetValue(eW.scrollvalue)end end;local hi=1;for J=E,hg do local gB=hc[J]local gD=hb[hi]if not gD then gD=self:CreateButton()hb[hi]=gD;gD:SetParent(h3)gD:SetFrameLevel(h3:GetFrameLevel()+1)gD:ClearAllPoints()if hi==1 then if self.showscroll then gD:SetPoint("TOPRIGHT",-22,-10)gD:SetPoint("TOPLEFT",0,-10)else gD:SetPoint("TOPRIGHT",0,-10)gD:SetPoint("TOPLEFT",0,-10)end else gD:SetPoint("TOPRIGHT",hb[hi-1],"BOTTOMRIGHT",0,0)gD:SetPoint("TOPLEFT",hb[hi-1],"BOTTOMLEFT",0,0)end end;gC(gD,gB,eW.selected==gB.uniquevalue,gB.hasChildren,hd[gB.uniquevalue])gD:Show()hi=hi+1 end end,["SetSelected"]=function(self,bw)local eW=self.status or self.localstatus;if eW.selected~=bw then eW.selected=bw;self:Fire("OnGroupSelected",bw)end end,["Select"]=function(self,gL,...)self.filter=false;local eW=self.status or self.localstatus;local h8=eW.groups;local hj={...}for J=1,#hj do h8[N(hj,"\001",1,J)]=true end;eW.selected=gL;self:RefreshTree(true)self:Fire("OnGroupSelected",gL)end,["SelectByPath"]=function(self,...)self:Select(gR(...),...)end,["SelectByValue"]=function(self,gL)self:Select(gL,("\001"):split(gL))end,["ShowScroll"]=function(self,hh)self.showscroll=hh;if hh then self.scrollbar:Show()if self.buttons[1]then self.buttons[1]:SetPoint("TOPRIGHT",self.treeframe,"TOPRIGHT",-22,-10)end else self.scrollbar:Hide()if self.buttons[1]then self.buttons[1]:SetPoint("TOPRIGHT",self.treeframe,"TOPRIGHT",0,-10)end end end,["OnWidthSet"]=function(self,dv)local dM=self.content;local h3=self.treeframe;local eW=self.status or self.localstatus;eW.fullwidth=dv;local eP=dv-eW.treewidth-20;if eP<0 then eP=0 end;dM:SetWidth(eP)dM.width=eP;local hk=dg(400,dv-50)if hk>100 and eW.treewidth>hk then self:SetTreeWidth(hk,eW.treesizable)end;if h3.SetResizeBounds then h3:SetResizeBounds(100,1,hk,1600)else h3:SetMaxResize(hk,1600)end end,["OnHeightSet"]=function(self,dw)local dM=self.content;local eQ=dw-20;if eQ<0 then eQ=0 end;dM:SetHeight(eQ)dM.height=eQ end,["SetTreeWidth"]=function(self,hl,hm)if not hm then if type(hl)=='number'then hm=false elseif type(hl)=='boolean'then hm=hl;hl=gy else hm=false;hl=gy end end;self.treeframe:SetWidth(hl)self.dragger:EnableMouse(hm)local eW=self.status or self.localstatus;eW.treewidth=hl;eW.treesizable=hm;if eW.fullwidth then self:OnWidthSet(eW.fullwidth)end end,["GetTreeWidth"]=function(self)local eW=self.status or self.localstatus;return eW.treewidth or gy end,["LayoutFinished"]=function(self,dv,dw)if self.noAutoHeight then return end;self:SetHeight((dw or 0)+20)end}local eZ={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local hn={bgFile="Interface\\Tooltips\\UI-Tooltip-Background",edgeFile=nil,tile=true,tileSize=16,edgeSize=1,insets={left=3,right=3,top=7,bottom=7}}local function dI()local fE=dd:GetNextWidgetNum(eH)local bv=CreateFrame("Frame",nil,UIParent)local h3=CreateFrame("Frame",nil,bv,"BackdropTemplate")h3:SetPoint("TOPLEFT")h3:SetPoint("BOTTOMLEFT")h3:SetWidth(gy)h3:EnableMouseWheel(true)h3:SetBackdrop(eZ)h3:SetBackdropColor(0.1,0.1,0.1,0.5)h3:SetBackdropBorderColor(0.4,0.4,0.4)h3:SetResizable(true)if h3.SetResizeBounds then h3:SetResizeBounds(100,1,400,1600)else h3:SetMinResize(100,1)h3:SetMaxResize(400,1600)end;h3:SetScript("OnUpdate",gQ)h3:SetScript("OnSizeChanged",gY)h3:SetScript("OnMouseWheel",gZ)local ho=CreateFrame("Frame",nil,h3,"BackdropTemplate")ho:SetWidth(8)ho:SetPoint("TOP",h3,"TOPRIGHT")ho:SetPoint("BOTTOM",h3,"BOTTOMRIGHT")ho:SetBackdrop(hn)ho:SetBackdropColor(1,1,1,0)ho:SetScript("OnEnter",h1)ho:SetScript("OnLeave",h0)ho:SetScript("OnMouseDown",h2)ho:SetScript("OnMouseUp",h4)local fG=CreateFrame("Slider",("AceConfigDialogTreeGroup%dScrollBar"):format(fE),h3,"UIPanelScrollBarTemplate")fG:SetScript("OnValueChanged",nil)fG:SetPoint("TOPRIGHT",-10,-26)fG:SetPoint("BOTTOMRIGHT",-10,26)fG:SetMinMaxValues(0,0)fG:SetValueStep(1)fG:SetValue(0)fG:SetWidth(16)fG:SetScript("OnValueChanged",gX)local fH=fG:CreateTexture(nil,"BACKGROUND")fH:SetAllPoints(fG)fH:SetColorTexture(0,0,0,0.4)local f1=CreateFrame("Frame",nil,bv,"BackdropTemplate")f1:SetPoint("TOPLEFT",h3,"TOPRIGHT")f1:SetPoint("BOTTOMRIGHT")f1:SetBackdrop(eZ)f1:SetBackdropColor(0.1,0.1,0.1,0.5)f1:SetBackdropBorderColor(0.4,0.4,0.4)local dM=CreateFrame("Frame",nil,f1)dM:SetPoint("TOPLEFT",10,-10)dM:SetPoint("BOTTOMRIGHT",-10,10)local dr={frame=bv,lines={},levels={},buttons={},hasChildren={},localstatus={groups={},scrollvalue=0},filter=false,treeframe=h3,dragger=ho,scrollbar=fG,border=f1,content=dM,type=eH}for s,G in pairs(eO)do dr[s]=G end;h3.obj,ho.obj,fG.obj=dr,dr,dr;return dd:RegisterAsContainer(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function hp(...)local dd=LibStub("AceGUI-3.0")local pairs,assert,type=pairs,assert,type;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;do local eH="Window"local dJ=8;local function hq(aw)aw.obj:Fire("OnShow")end;local function hr(aw)aw.obj:Fire("OnClose")end;local function hs(aw)PlaySound(799)aw.obj:Hide()end;local function ht(aw)dd:ClearFocus()end;local function hu(aw)aw:GetParent():StartMoving()dd:ClearFocus()end;local function hv(aw)local bv=aw:GetParent()bv:StopMovingOrSizing()local self=bv.obj;local eW=self.status or self.localstatus;eW.width=bv:GetWidth()eW.height=bv:GetHeight()eW.top=bv:GetTop()eW.left=bv:GetLeft()end;local function hw(aw)aw:GetParent():StartSizing("BOTTOMRIGHT")dd:ClearFocus()end;local function hx(aw)aw:GetParent():StartSizing("BOTTOM")dd:ClearFocus()end;local function hy(aw)aw:GetParent():StartSizing("RIGHT")dd:ClearFocus()end;local function hz(aw)aw:GetParent():StopMovingOrSizing()end;local function hA(self,eR)self.titletext:SetText(eR)end;local function hB(self,ff)end;local function hC(self)self.frame:Hide()end;local function hD(self)self.frame:Show()end;local function hE(self)self.frame:SetParent(UIParent)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")self:ApplyStatus()self:EnableResize(true)self:Show()end;local function hF(self)self.status=nil;for ab in pairs(self.localstatus)do self.localstatus[ab]=nil end end;local function hG(self,eW)assert(type(eW)=="table")self.status=eW;self:ApplyStatus()end;local function hH(self)local eW=self.status or self.localstatus;local bv=self.frame;self:SetWidth(eW.width or 700)self:SetHeight(eW.height or 500)if eW.top and eW.left then bv:SetPoint("TOP",UIParent,"BOTTOM",0,eW.top)bv:SetPoint("LEFT",UIParent,"LEFT",eW.left,0)else bv:SetPoint("CENTER",UIParent,"CENTER")end end;local function hI(self,dv)local dM=self.content;local eP=dv-34;if eP<0 then eP=0 end;dM:SetWidth(eP)dM.width=eP end;local function hJ(self,dw)local dM=self.content;local eQ=dw-57;if eQ<0 then eQ=0 end;dM:SetHeight(eQ)dM.height=eQ end;local function hK(self,ak)local G=ak and"Show"or"Hide"self.sizer_se[G](self.sizer_se)self.sizer_s[G](self.sizer_s)self.sizer_e[G](self.sizer_e)end;local function dI()local bv=CreateFrame("Frame",nil,UIParent)local self={}self.type="Window"self.Hide=hC;self.Show=hD;self.SetTitle=hA;self.OnRelease=hF;self.OnAcquire=hE;self.SetStatusText=hB;self.SetStatusTable=hG;self.ApplyStatus=hH;self.OnWidthSet=hI;self.OnHeightSet=hJ;self.EnableResize=hK;self.localstatus={}self.frame=bv;bv.obj=self;bv:SetWidth(700)bv:SetHeight(500)bv:SetPoint("CENTER",UIParent,"CENTER",0,0)bv:EnableMouse()bv:SetMovable(true)bv:SetResizable(true)bv:SetFrameStrata("FULLSCREEN_DIALOG")bv:SetScript("OnMouseDown",ht)bv:SetScript("OnShow",hq)bv:SetScript("OnHide",hr)if bv.SetResizeBounds then bv:SetResizeBounds(240,240)else bv:SetMinResize(240,240)end;bv:SetToplevel(true)local fk=bv:CreateTexture(nil,"BACKGROUND")fk:SetTexture(251966)fk:SetPoint("TOPLEFT",9,-6)fk:SetPoint("BOTTOMRIGHT",bv,"TOPRIGHT",-28,-24)local hL=bv:CreateTexture(nil,"BACKGROUND")hL:SetTexture(137056)hL:SetPoint("TOPLEFT",8,-24)hL:SetPoint("BOTTOMRIGHT",-6,8)hL:SetVertexColor(0,0,0,.75)local hM=bv:CreateTexture(nil,"BORDER")hM:SetTexture(251963)hM:SetWidth(64)hM:SetHeight(64)hM:SetPoint("TOPLEFT")hM:SetTexCoord(0.501953125,0.625,0,1)local hN=bv:CreateTexture(nil,"BORDER")hN:SetTexture(251963)hN:SetWidth(64)hN:SetHeight(64)hN:SetPoint("TOPRIGHT")hN:SetTexCoord(0.625,0.75,0,1)local hO=bv:CreateTexture(nil,"BORDER")hO:SetTexture(251963)hO:SetHeight(64)hO:SetPoint("TOPLEFT",hM,"TOPRIGHT")hO:SetPoint("TOPRIGHT",hN,"TOPLEFT")hO:SetTexCoord(0.25,0.369140625,0,1)local hP=bv:CreateTexture(nil,"BORDER")hP:SetTexture(251963)hP:SetWidth(64)hP:SetHeight(64)hP:SetPoint("BOTTOMLEFT")hP:SetTexCoord(0.751953125,0.875,0,1)local hQ=bv:CreateTexture(nil,"BORDER")hQ:SetTexture(251963)hQ:SetWidth(64)hQ:SetHeight(64)hQ:SetPoint("BOTTOMRIGHT")hQ:SetTexCoord(0.875,1,0,1)local hR=bv:CreateTexture(nil,"BORDER")hR:SetTexture(251963)hR:SetHeight(64)hR:SetPoint("BOTTOMLEFT",hP,"BOTTOMRIGHT")hR:SetPoint("BOTTOMRIGHT",hQ,"BOTTOMLEFT")hR:SetTexCoord(0.376953125,0.498046875,0,1)local fX=bv:CreateTexture(nil,"BORDER")fX:SetTexture(251963)fX:SetWidth(64)fX:SetPoint("TOPLEFT",hM,"BOTTOMLEFT")fX:SetPoint("BOTTOMLEFT",hP,"TOPLEFT")fX:SetTexCoord(0.001953125,0.125,0,1)local g4=bv:CreateTexture(nil,"BORDER")g4:SetTexture(251963)g4:SetWidth(64)g4:SetPoint("TOPRIGHT",hN,"BOTTOMRIGHT")g4:SetPoint("BOTTOMRIGHT",hQ,"TOPRIGHT")g4:SetTexCoord(0.1171875,0.2421875,0,1)local hS=CreateFrame("Button",nil,bv,"UIPanelCloseButton")hS:SetPoint("TOPRIGHT",2,1)hS:SetScript("OnClick",hs)self.closebutton=hS;hS.obj=self;local e_=bv:CreateFontString(nil,"ARTWORK")e_:SetFontObject(GameFontNormal)e_:SetPoint("TOPLEFT",12,-8)e_:SetPoint("TOPRIGHT",-32,-8)self.titletext=e_;local eR=CreateFrame("Button",nil,bv)eR:SetPoint("TOPLEFT",fk)eR:SetPoint("BOTTOMRIGHT",fk)eR:EnableMouse()eR:SetScript("OnMouseDown",hu)eR:SetScript("OnMouseUp",hv)self.title=eR;local fn=CreateFrame("Frame",nil,bv)fn:SetPoint("BOTTOMRIGHT",bv,"BOTTOMRIGHT",0,0)fn:SetWidth(25)fn:SetHeight(25)fn:EnableMouse()fn:SetScript("OnMouseDown",hw)fn:SetScript("OnMouseUp",hz)self.sizer_se=fn;local fo=fn:CreateTexture(nil,"BACKGROUND")self.line1=fo;fo:SetWidth(14)fo:SetHeight(14)fo:SetPoint("BOTTOMRIGHT",-8,8)fo:SetTexture(137057)local fp=0.1*14/17;fo:SetTexCoord(0.05-fp,0.5,0.05,0.5+fp,0.05,0.5-fp,0.5+fp,0.5)local fq=fn:CreateTexture(nil,"BACKGROUND")self.line2=fq;fq:SetWidth(8)fq:SetHeight(8)fq:SetPoint("BOTTOMRIGHT",-8,8)fq:SetTexture(137057)fp=0.1*8/17;fq:SetTexCoord(0.05-fp,0.5,0.05,0.5+fp,0.05,0.5-fp,0.5+fp,0.5)local fr=CreateFrame("Frame",nil,bv)fr:SetPoint("BOTTOMRIGHT",bv,"BOTTOMRIGHT",-25,0)fr:SetPoint("BOTTOMLEFT",bv,"BOTTOMLEFT",0,0)fr:SetHeight(25)fr:EnableMouse()fr:SetScript("OnMouseDown",hx)fr:SetScript("OnMouseUp",hz)self.sizer_s=fr;local fs=CreateFrame("Frame",nil,bv)fs:SetPoint("BOTTOMRIGHT",bv,"BOTTOMRIGHT",0,25)fs:SetPoint("TOPRIGHT",bv,"TOPRIGHT",0,0)fs:SetWidth(25)fs:EnableMouse()fs:SetScript("OnMouseDown",hy)fs:SetScript("OnMouseUp",hz)self.sizer_e=fs;local dM=CreateFrame("Frame",nil,bv)self.content=dM;dM.obj=self;dM:SetPoint("TOPLEFT",bv,"TOPLEFT",12,-32)dM:SetPoint("BOTTOMRIGHT",bv,"BOTTOMRIGHT",-12,13)dd:RegisterAsContainer(self)return self end;dd:RegisterWidgetType(eH,dI,dJ)end end;local function hT(...)local eH,dJ="Button",24;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs=pairs;local _G=_G;local PlaySound,CreateFrame,UIParent=PlaySound,CreateFrame,UIParent;local function f3(bv,...)dd:ClearFocus()PlaySound(852)bv.obj:Fire("OnClick",...)end;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local eO={["OnAcquire"]=function(self)self:SetHeight(24)self:SetWidth(200)self:SetDisabled(false)self:SetAutoWidth(false)self:SetText()end,["SetText"]=function(self,ff)self.text:SetText(ff)if self.autoWidth then self:SetWidth(self.text:GetStringWidth()+30)end end,["SetAutoWidth"]=function(self,hW)self.autoWidth=hW;if self.autoWidth then self:SetWidth(self.text:GetStringWidth()+30)end end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.frame:Disable()else self.frame:Enable()end end}local function dI()local a8="AceGUI30Button"..dd:GetNextWidgetNum(eH)local bv=CreateFrame("Button",a8,UIParent,"UIPanelButtonTemplate")bv:Hide()bv:EnableMouse(true)bv:SetScript("OnClick",f3)bv:SetScript("OnEnter",hU)bv:SetScript("OnLeave",hV)local ff=bv:GetFontString()ff:ClearAllPoints()ff:SetPoint("TOPLEFT",15,-1)ff:SetPoint("BOTTOMRIGHT",-15,1)ff:SetJustifyV("MIDDLE")local dr={text=ff,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function hX(...)local eH,dJ="CheckBox",26;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local select,pairs=select,pairs;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function hY(self)local hZ=self.image:GetTexture()self.text:ClearAllPoints()if not hZ then self.text:SetPoint("LEFT",self.checkbg,"RIGHT")self.text:SetPoint("RIGHT")else self.text:SetPoint("LEFT",self.image,"RIGHT",1,0)self.text:SetPoint("RIGHT")end end;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local function h_(bv)local self=bv.obj;if not self.disabled then if self.image:GetTexture()then self.text:SetPoint("LEFT",self.image,"RIGHT",2,-1)else self.text:SetPoint("LEFT",self.checkbg,"RIGHT",1,-1)end end;dd:ClearFocus()end;local function i0(bv)local self=bv.obj;if not self.disabled then self:ToggleChecked()if self.checked then PlaySound(856)else PlaySound(857)end;self:Fire("OnValueChanged",self.checked)hY(self)end end;local eO={["OnAcquire"]=function(self)self:SetType()self:SetValue(false)self:SetTriState(nil)self:SetWidth(200)self:SetImage()self:SetDisabled(nil)self:SetDescription(nil)end,["OnWidthSet"]=function(self,dv)if self.desc then self.desc:SetWidth(dv-30)if self.desc:GetText()and self.desc:GetText()~=""then self:SetHeight(28+self.desc:GetStringHeight())end end end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.frame:Disable()self.text:SetTextColor(0.5,0.5,0.5)SetDesaturation(self.check,true)if self.desc then self.desc:SetTextColor(0.5,0.5,0.5)end else self.frame:Enable()self.text:SetTextColor(1,1,1)if self.tristate and self.checked==nil then SetDesaturation(self.check,true)else SetDesaturation(self.check,false)end;if self.desc then self.desc:SetTextColor(1,1,1)end end end,["SetValue"]=function(self,bw)local i1=self.check;self.checked=bw;if bw then SetDesaturation(i1,false)i1:Show()else if self.tristate and bw==nil then SetDesaturation(i1,true)i1:Show()else SetDesaturation(i1,false)i1:Hide()end end;self:SetDisabled(self.disabled)end,["GetValue"]=function(self)return self.checked end,["SetTriState"]=function(self,i2)self.tristate=i2;self:SetValue(self:GetValue())end,["SetType"]=function(self,type)local i3=self.checkbg;local i1=self.check;local i4=self.highlight;local i5;if type=="radio"then i5=16;i3:SetTexture(130843)i3:SetTexCoord(0,0.25,0,1)i1:SetTexture(130843)i1:SetTexCoord(0.25,0.5,0,1)i1:SetBlendMode("ADD")i4:SetTexture(130843)i4:SetTexCoord(0.5,0.75,0,1)else i5=24;i3:SetTexture(130755)i3:SetTexCoord(0,1,0,1)i1:SetTexture(130751)i1:SetTexCoord(0,1,0,1)i1:SetBlendMode("BLEND")i4:SetTexture(130753)i4:SetTexCoord(0,1,0,1)end;i3:SetHeight(i5)i3:SetWidth(i5)end,["ToggleChecked"]=function(self)local bw=self:GetValue()if self.tristate then if bw then self:SetValue(nil)elseif bw==nil then self:SetValue(false)else self:SetValue(true)end else self:SetValue(not self:GetValue())end end,["SetLabel"]=function(self,eS)self.text:SetText(eS)end,["SetDescription"]=function(self,i6)if i6 then if not self.desc then local eu=self.frame:CreateFontString(nil,"OVERLAY","GameFontHighlightSmall")eu:ClearAllPoints()eu:SetPoint("TOPLEFT",self.checkbg,"TOPRIGHT",5,-21)eu:SetWidth(self.frame.width-30)eu:SetPoint("RIGHT",self.frame,"RIGHT",-30,0)eu:SetJustifyH("LEFT")eu:SetJustifyV("TOP")self.desc=eu end;self.desc:Show()self.desc:SetText(i6)self:SetHeight(28+self.desc:GetStringHeight())else if self.desc then self.desc:SetText("")self.desc:Hide()end;self:SetHeight(24)end end,["SetImage"]=function(self,hj,...)local i7=self.image;i7:SetTexture(hj)if i7:GetTexture()then local cZ=select("#",...)if cZ==4 or cZ==8 then i7:SetTexCoord(...)else i7:SetTexCoord(0,1,0,1)end end;hY(self)end}local function dI()local bv=CreateFrame("Button",nil,UIParent)bv:Hide()bv:EnableMouse(true)bv:SetScript("OnEnter",hU)bv:SetScript("OnLeave",hV)bv:SetScript("OnMouseDown",h_)bv:SetScript("OnMouseUp",i0)local i3=bv:CreateTexture(nil,"ARTWORK")i3:SetWidth(24)i3:SetHeight(24)i3:SetPoint("TOPLEFT")i3:SetTexture(130755)local i1=bv:CreateTexture(nil,"OVERLAY")i1:SetAllPoints(i3)i1:SetTexture(130751)local ff=bv:CreateFontString(nil,"OVERLAY","GameFontHighlight")ff:SetJustifyH("LEFT")ff:SetHeight(18)ff:SetPoint("LEFT",i3,"RIGHT")ff:SetPoint("RIGHT")local i4=bv:CreateTexture(nil,"HIGHLIGHT")i4:SetTexture(130753)i4:SetBlendMode("ADD")i4:SetAllPoints(i3)local i7=bv:CreateTexture(nil,"OVERLAY")i7:SetHeight(16)i7:SetWidth(16)i7:SetPoint("LEFT",i3,"RIGHT",1,0)local dr={checkbg=i3,check=i1,text=ff,highlight=i4,image=i7,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function i8(...)local eH,dJ="ColorPicker",25;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local function i9(self,ia,ib,ic,id,ie)if not self.HasAlpha then id=1 end;self:SetColor(ia,ib,ic,id)if ColorPickerFrame:IsVisible()then self:Fire("OnValueChanged",ia,ib,ic,id)else if ie then self:Fire("OnValueConfirmed",ia,ib,ic,id)end end end;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local function ig(bv)ColorPickerFrame:Hide()local self=bv.obj;if not self.disabled then ColorPickerFrame:SetFrameStrata("FULLSCREEN_DIALOG")ColorPickerFrame:SetFrameLevel(bv:GetFrameLevel()+10)ColorPickerFrame:SetClampedToScreen(true)ColorPickerFrame.func=function()local ia,ib,ic=ColorPickerFrame:GetColorRGB()local id=1-OpacitySliderFrame:GetValue()i9(self,ia,ib,ic,id)end;ColorPickerFrame.hasOpacity=self.HasAlpha;ColorPickerFrame.opacityFunc=function()local ia,ib,ic=ColorPickerFrame:GetColorRGB()local id=1-OpacitySliderFrame:GetValue()i9(self,ia,ib,ic,id,true)end;local ia,ib,ic,id=self.r,self.g,self.b,self.a;if self.HasAlpha then ColorPickerFrame.opacity=1-(id or 0)end;ColorPickerFrame:SetColorRGB(ia,ib,ic)ColorPickerFrame.cancelFunc=function()i9(self,ia,ib,ic,id,true)end;ColorPickerFrame:Show()end;dd:ClearFocus()end;local eO={["OnAcquire"]=function(self)self:SetHeight(24)self:SetWidth(200)self:SetHasAlpha(false)self:SetColor(0,0,0,1)self:SetDisabled(nil)self:SetLabel(nil)end,["SetLabel"]=function(self,ff)self.text:SetText(ff)end,["SetColor"]=function(self,ia,ib,ic,id)self.r=ia;self.g=ib;self.b=ic;self.a=id or 1;self.colorSwatch:SetVertexColor(ia,ib,ic,id)end,["SetHasAlpha"]=function(self,ih)self.HasAlpha=ih end,["SetDisabled"]=function(self,gf)self.disabled=gf;if self.disabled then self.frame:Disable()self.text:SetTextColor(0.5,0.5,0.5)else self.frame:Enable()self.text:SetTextColor(1,1,1)end end}local function dI()local bv=CreateFrame("Button",nil,UIParent)bv:Hide()bv:EnableMouse(true)bv:SetScript("OnEnter",hU)bv:SetScript("OnLeave",hV)bv:SetScript("OnClick",ig)local ii=bv:CreateTexture(nil,"OVERLAY")ii:SetWidth(19)ii:SetHeight(19)ii:SetTexture(130939)ii:SetPoint("LEFT")local ij=bv:CreateTexture(nil,"BACKGROUND")ii.background=ij;ij:SetWidth(16)ij:SetHeight(16)ij:SetColorTexture(1,1,1)ij:SetPoint("CENTER",ii)ij:Show()local ik=bv:CreateTexture(nil,"BACKGROUND")ii.checkers=ik;ik:SetWidth(14)ik:SetHeight(14)ik:SetTexture(188523)ik:SetTexCoord(.25,0,0.5,.25)ik:SetDesaturated(true)ik:SetVertexColor(1,1,1,0.75)ik:SetPoint("CENTER",ii)ik:Show()local ff=bv:CreateFontString(nil,"OVERLAY","GameFontHighlight")ff:SetHeight(24)ff:SetJustifyH("LEFT")ff:SetTextColor(1,1,1)ff:SetPoint("LEFT",ii,"RIGHT",2,0)ff:SetPoint("RIGHT")local dr={colorSwatch=ii,text=ff,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function il(...)local dd=LibStub("AceGUI-3.0")local fv,cW,fw=math.min,math.max,math.floor;local select,pairs,ipairs,type,tostring=select,pairs,ipairs,type,tostring;local im=table.sort;local PlaySound=PlaySound;local UIParent,CreateFrame=UIParent,CreateFrame;local _G=_G;local function io(cb,...)local J=1;local dz=select(J,...)while dz do dz:SetFrameLevel(cb:GetFrameLevel()+1)io(dz,dz:GetChildren())J=J+1;dz=select(J,...)end end;local function ip(iq,cb,...)local J=1;local dz=select(J,...)cb:SetFrameStrata(iq)while dz do ip(iq,dz,dz:GetChildren())J=J+1;dz=select(J,...)end end;do local dp="Dropdown-Pullout"local ir=5;local is={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\DialogFrame\\UI-DialogBox-Border",edgeSize=32,tileSize=32,tile=true,insets={left=11,right=12,top=12,bottom=11}}local it={bgFile="Interface\\Buttons\\UI-SliderBar-Background",edgeFile="Interface\\Buttons\\UI-SliderBar-Border",tile=true,tileSize=8,edgeSize=8,insets={left=3,right=3,top=3,bottom=3}}local iu=200;local iv=600;local function iw(ix)local self=ix.pullout;for ab,ac in ipairs(self.items)do if ac.CloseMenu and ac~=ix then ac:CloseMenu()end end end;local function iy(aw,bw)aw.obj:MoveScroll(bw)end;local function gX(aw,bw)aw.obj:SetScroll(bw)end;local function iz(aw)aw.obj:FixScroll()end;local function iA(self,bw)local eW=self.scrollStatus;local bv,dz=self.scrollFrame,self.itemFrame;local dw,fB=bv:GetHeight(),dz:GetHeight()local ae;if dw>fB then ae=0 else ae=fw((fB-dw)/1000*bw)end;dz:ClearAllPoints()dz:SetPoint("TOPLEFT",bv,"TOPLEFT",0,ae)dz:SetPoint("TOPRIGHT",bv,"TOPRIGHT",self.slider:IsShown()and-12 or 0,ae)eW.offset=ae;eW.scrollvalue=bw end;local function iB(self,bw)local eW=self.scrollStatus;local bv,dz=self.scrollFrame,self.itemFrame;local dw,fB=bv:GetHeight(),dz:GetHeight()if dw>fB then self.slider:Hide()else self.slider:Show()local fC=dw-fB;local fD=1;if bw<0 then fD=-1 end;self.slider:SetValue(fv(cW(eW.scrollvalue+fD*1000/(fC/45),0),1000))end end;local function iC(self)local eW=self.scrollStatus;local bv,dz=self.scrollFrame,self.itemFrame;local dw,fB=bv:GetHeight(),dz:GetHeight()local ae=eW.offset or 0;if fB<dw then self.slider:Hide()dz:SetPoint("TOPRIGHT",bv,"TOPRIGHT",0,ae)self.slider:SetValue(0)else self.slider:Show()local bw=ae/(fB-dw)*1000;if bw>1000 then bw=1000 end;self.slider:SetValue(bw)self:SetScroll(bw)if bw<1000 then dz:ClearAllPoints()dz:SetPoint("TOPLEFT",bv,"TOPLEFT",0,ae)dz:SetPoint("TOPRIGHT",bv,"TOPRIGHT",-12,ae)eW.offset=ae end end end;local function hE(self)self.frame:SetParent(UIParent)end;local function hF(self)self:Clear()self.frame:ClearAllPoints()self.frame:Hide()end;local function iD(self,ix)self.items[#self.items+1]=ix;local iE=#self.items*16;self.itemFrame:SetHeight(iE)self.frame:SetHeight(fv(iE+34,self.maxHeight))ix.frame:SetPoint("LEFT",self.itemFrame,"LEFT")ix.frame:SetPoint("RIGHT",self.itemFrame,"RIGHT")ix:SetPullout(self)ix:SetOnEnter(iw)end;local function iF(self,iG,iH,iI,fp,iJ)local iK=self.items;local bv=self.frame;local iL=self.itemFrame;bv:SetPoint(iG,iH,iI,fp,iJ)local dw=8;for J,ix in pairs(iK)do ix:SetPoint("TOP",iL,"TOP",0,-2+(J-1)*-16)ix:Show()dw=dw+16 end;iL:SetHeight(dw)ip("TOOLTIP",bv,bv:GetChildren())bv:Show()self:Fire("OnOpen")end;local function iM(self)self.frame:Hide()self:Fire("OnClose")end;local function iN(self)local iK=self.items;for J,ix in pairs(iK)do dd:Release(ix)iK[J]=nil end end;local function iO(self)return ipairs(self.items)end;local function iP(self,e6)self.hideOnLeave=e6 end;local function iQ(self,dw)self.maxHeight=dw or iv;if self.frame:GetHeight()>dw then self.frame:SetHeight(dw)elseif self.itemFrame:GetHeight()+34<dw then self.frame:SetHeight(self.itemFrame:GetHeight()+34)end end;local function iR(self)return 6+(self.slider:IsShown()and 12 or 0)end;local function iS(self)return 6 end;local function dI()local iT=dd:GetNextWidgetNum(dp)local bv=CreateFrame("Frame","AceGUI30Pullout"..iT,UIParent,"BackdropTemplate")local self={}self.count=iT;self.type=dp;self.frame=bv;bv.obj=self;self.OnAcquire=hE;self.OnRelease=hF;self.AddItem=iD;self.Open=iF;self.Close=iM;self.Clear=iN;self.IterateItems=iO;self.SetHideOnLeave=iP;self.SetScroll=iA;self.MoveScroll=iB;self.FixScroll=iC;self.SetMaxHeight=iQ;self.GetRightBorderWidth=iR;self.GetLeftBorderWidth=iS;self.items={}self.scrollStatus={scrollvalue=0}self.maxHeight=iv;bv:SetBackdrop(is)bv:SetBackdropColor(0,0,0)bv:SetFrameStrata("FULLSCREEN_DIALOG")bv:SetClampedToScreen(true)bv:SetWidth(iu)bv:SetHeight(self.maxHeight)local iU=CreateFrame("ScrollFrame",nil,bv)local iL=CreateFrame("Frame",nil,iU)self.scrollFrame=iU;self.itemFrame=iL;iU.obj=self;iL.obj=self;local iV=CreateFrame("Slider","AceGUI30PulloutScrollbar"..iT,iU,"BackdropTemplate")iV:SetOrientation("VERTICAL")iV:SetHitRectInsets(0,0,-10,0)iV:SetBackdrop(it)iV:SetWidth(8)iV:SetThumbTexture("Interface\\Buttons\\UI-SliderBar-Button-Vertical")iV:SetFrameStrata("FULLSCREEN_DIALOG")self.slider=iV;iV.obj=self;iU:SetScrollChild(iL)iU:SetPoint("TOPLEFT",bv,"TOPLEFT",6,-12)iU:SetPoint("BOTTOMRIGHT",bv,"BOTTOMRIGHT",-6,12)iU:EnableMouseWheel(true)iU:SetScript("OnMouseWheel",iy)iU:SetScript("OnSizeChanged",iz)iU:SetToplevel(true)iU:SetFrameStrata("FULLSCREEN_DIALOG")iL:SetPoint("TOPLEFT",iU,"TOPLEFT",0,0)iL:SetPoint("TOPRIGHT",iU,"TOPRIGHT",-12,0)iL:SetHeight(400)iL:SetToplevel(true)iL:SetFrameStrata("FULLSCREEN_DIALOG")iV:SetPoint("TOPLEFT",iU,"TOPRIGHT",-16,0)iV:SetPoint("BOTTOMLEFT",iU,"BOTTOMRIGHT",-16,0)iV:SetScript("OnValueChanged",gX)iV:SetMinMaxValues(0,1000)iV:SetValueStep(1)iV:SetValue(0)iU:Show()iL:Show()iV:Hide()self:FixScroll()dd:RegisterAsWidget(self)return self end;dd:RegisterWidgetType(dp,dI,ir)end;do local dp="Dropdown"local ir=36;local function hU(aw)aw.obj.button:LockHighlight()aw.obj:Fire("OnEnter")end;local function hV(aw)aw.obj.button:UnlockHighlight()aw.obj:Fire("OnLeave")end;local function iW(aw)local self=aw.obj;if self.open then self.pullout:Close()end end;local function iX(aw)local self=aw.obj;if self.open then self.open=nil;self.pullout:Close()dd:ClearFocus()else self.open=true;self.pullout:SetWidth(self.pulloutWidth or self.frame:GetWidth())self.pullout:Open("TOPLEFT",self.frame,"BOTTOMLEFT",0,self.label:IsShown()and-2 or 0)dd:SetFocus(self)end end;local function iY(aw)local self=aw.userdata.obj;local bw=self.value;if not self.multiselect then for J,ix in aw:IterateItems()do ix:SetValue(ix.userdata.value==bw)end end;self.open=true;self:Fire("OnOpened")end;local function iZ(aw)local self=aw.userdata.obj;self.open=nil;self:Fire("OnClosed")end;local function i_(self)local ff;for J,dr in self.pullout:IterateItems()do if dr.type=="Dropdown-Item-Toggle"then if dr:GetValue()then if ff then ff=ff..", "..dr:GetText()else ff=dr:GetText()end end end end;self:SetText(ff)end;local function j0(aw,C,j1)local self=aw.userdata.obj;if self.multiselect then self:Fire("OnValueChanged",aw.userdata.value,j1)i_(self)else if j1 then self:SetValue(aw.userdata.value)self:Fire("OnValueChanged",aw.userdata.value)else aw:SetValue(true)end;if self.open then self.pullout:Close()end end end;local function hE(self)local j2=dd:Create("Dropdown-Pullout")self.pullout=j2;j2.userdata.obj=self;j2:SetCallback("OnClose",iZ)j2:SetCallback("OnOpen",iY)self.pullout.frame:SetFrameLevel(self.frame:GetFrameLevel()+1)io(self.pullout.frame,self.pullout.frame:GetChildren())self:SetHeight(44)self:SetWidth(200)self:SetLabel()self:SetPulloutWidth(nil)self.list={}end;local function hF(self)if self.open then self.pullout:Close()end;dd:Release(self.pullout)self.pullout=nil;self:SetText("")self:SetDisabled(false)self:SetMultiselect(false)self.value=nil;self.list=nil;self.open=nil;self.hasClose=nil;self.frame:ClearAllPoints()self.frame:Hide()end;local function j3(self,gf)self.disabled=gf;if gf then self.text:SetTextColor(0.5,0.5,0.5)self.button:Disable()self.button_cover:Disable()self.label:SetTextColor(0.5,0.5,0.5)else self.button:Enable()self.button_cover:Enable()self.label:SetTextColor(1,.82,0)self.text:SetTextColor(1,1,1)end end;local function j4(self)if self.open then self.pullout:Close()end end;local function j5(self,ff)self.text:SetText(ff or"")end;local function j6(self,ff)if ff and ff~=""then self.label:SetText(ff)self.label:Show()self.dropdown:SetPoint("TOPLEFT",self.frame,"TOPLEFT",-15,-14)self:SetHeight(40)self.alignoffset=26 else self.label:SetText("")self.label:Hide()self.dropdown:SetPoint("TOPLEFT",self.frame,"TOPLEFT",-15,0)self:SetHeight(26)self.alignoffset=12 end end;local function j7(self,bw)self:SetText(self.list[bw]or"")self.value=bw end;local function j8(self)return self.value end;local function j9(self,ix,bw)if not self.multiselect then return end;for J,dr in self.pullout:IterateItems()do if dr.userdata.value==ix then if dr.SetValue then dr:SetValue(bw)end end end;i_(self)end;local function ja(self,ix,gf)for J,dr in self.pullout:IterateItems()do if dr.userdata.value==ix then dr:SetDisabled(gf)end end end;local function jb(self,bw,ff,jc)if not jc then jc="Dropdown-Item-Toggle"end;local jd=dd:GetWidgetVersion(jc)if not jd then error(("The given item type, %q, does not exist within AceGUI-3.0"):format(tostring(jc)),2)end;local ix=dd:Create(jc)ix:SetText(ff)ix.userdata.obj=self;ix.userdata.value=bw;ix:SetCallback("OnValueChanged",j0)self.pullout:AddItem(ix)end;local function je(self)if not self.hasClose then local hS=dd:Create("Dropdown-Item-Execute")hS:SetText(CLOSE)self.pullout:AddItem(hS)self.hasClose=true end end;local jf={}local function jg(fp,iJ)local jh,ji=tonumber(fp),tonumber(iJ)if jh and ji then return jh<ji else return tostring(fp)<tostring(iJ)end end;local function jj(self,eX,eY,jc)self.list=eX or{}self.pullout:Clear()self.hasClose=nil;if not eX then return end;if type(eY)~="table"then for ac in pairs(eX)do jf[#jf+1]=ac end;im(jf,jg)for J,o in ipairs(jf)do jb(self,o,eX[o],jc)jf[J]=nil end else for J,o in ipairs(eY)do jb(self,o,eX[o],jc)end end;if self.multiselect then i_(self)je(self)end end;local function iD(self,bw,ff,jc)self.list[bw]=ff;jb(self,bw,ff,jc)end;local function jk(self,jl)self.multiselect=jl;if jl then i_(self)je(self)end end;local function jm(self)return self.multiselect end;local function jn(self,dv)self.pulloutWidth=dv end;local function dI()local iT=dd:GetNextWidgetNum(dp)local bv=CreateFrame("Frame",nil,UIParent)local f0=CreateFrame("Frame","AceGUI30DropDown"..iT,bv,"UIDropDownMenuTemplate")local self={}self.type=dp;self.frame=bv;self.dropdown=f0;self.count=iT;bv.obj=self;f0.obj=self;self.OnRelease=hF;self.OnAcquire=hE;self.ClearFocus=j4;self.SetText=j5;self.SetValue=j7;self.GetValue=j8;self.SetList=jj;self.SetLabel=j6;self.SetDisabled=j3;self.AddItem=iD;self.SetMultiselect=jk;self.GetMultiselect=jm;self.SetItemValue=j9;self.SetItemDisabled=ja;self.SetPulloutWidth=jn;self.alignoffset=26;bv:SetScript("OnHide",iW)f0:ClearAllPoints()f0:SetPoint("TOPLEFT",bv,"TOPLEFT",-15,0)f0:SetPoint("BOTTOMRIGHT",bv,"BOTTOMRIGHT",17,0)f0:SetScript("OnHide",nil)local fX=_G[f0:GetName().."Left"]local g3=_G[f0:GetName().."Middle"]local g4=_G[f0:GetName().."Right"]g3:ClearAllPoints()g4:ClearAllPoints()g3:SetPoint("LEFT",fX,"RIGHT",0,0)g3:SetPoint("RIGHT",g4,"LEFT",0,0)g4:SetPoint("TOPRIGHT",f0,"TOPRIGHT",0,17)local gD=_G[f0:GetName().."Button"]self.button=gD;gD.obj=self;gD:SetScript("OnEnter",hU)gD:SetScript("OnLeave",hV)gD:SetScript("OnClick",iX)local jo=CreateFrame("BUTTON",nil,self.frame)self.button_cover=jo;jo.obj=self;jo:SetPoint("TOPLEFT",self.frame,"BOTTOMLEFT",0,25)jo:SetPoint("BOTTOMRIGHT",self.frame,"BOTTOMRIGHT")jo:SetScript("OnEnter",hU)jo:SetScript("OnLeave",hV)jo:SetScript("OnClick",iX)local ff=_G[f0:GetName().."Text"]self.text=ff;ff.obj=self;ff:ClearAllPoints()ff:SetPoint("RIGHT",g4,"RIGHT",-43,2)ff:SetPoint("LEFT",fX,"LEFT",25,2)local eS=bv:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eS:SetPoint("TOPLEFT",bv,"TOPLEFT",0,0)eS:SetPoint("TOPRIGHT",bv,"TOPRIGHT",0,0)eS:SetJustifyH("LEFT")eS:SetHeight(18)eS:Hide()self.label=eS;dd:RegisterAsWidget(self)return self end;dd:RegisterWidgetType(dp,dI,ir)end end;local function jp(...)local dd=LibStub("AceGUI-3.0")local select,assert=select,assert;local PlaySound=PlaySound;local CreateFrame=CreateFrame;local function io(cb,...)local J=1;local dz=select(J,...)while dz do dz:SetFrameLevel(cb:GetFrameLevel()+1)io(dz,dz:GetChildren())J=J+1;dz=select(J,...)end end;local function ip(iq,cb,...)local J=1;local dz=select(J,...)cb:SetFrameStrata(iq)while dz do ip(iq,dz,dz:GetChildren())J=J+1;dz=select(J,...)end end;local jq={version=2000,counter=0}function jq.Frame_OnEnter(aw)local self=aw.obj;if self.useHighlight then self.highlight:Show()end;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end end;function jq.Frame_OnLeave(aw)local self=aw.obj;self.highlight:Hide()self:Fire("OnLeave")if self.specialOnLeave then self.specialOnLeave(self)end end;function jq.OnAcquire(self)self.frame:SetToplevel(true)self.frame:SetFrameStrata("FULLSCREEN_DIALOG")end;function jq.OnRelease(self)self:SetDisabled(false)self.pullout=nil;self.frame:SetParent(nil)self.frame:ClearAllPoints()self.frame:Hide()end;function jq.SetPullout(self,j2)self.pullout=j2;self.frame:SetParent(nil)self.frame:SetParent(j2.itemFrame)self.parent=j2.itemFrame;io(j2.itemFrame,j2.itemFrame:GetChildren())end;function jq.SetText(self,ff)self.text:SetText(ff or"")end;function jq.GetText(self)return self.text:GetText()end;function jq.SetPoint(self,...)self.frame:SetPoint(...)end;function jq.Show(self)self.frame:Show()end;function jq.Hide(self)self.frame:Hide()end;function jq.SetDisabled(self,gf)self.disabled=gf;if gf then self.useHighlight=false;self.text:SetTextColor(.5,.5,.5)else self.useHighlight=true;self.text:SetTextColor(1,1,1)end end;function jq.SetOnLeave(self,G)self.specialOnLeave=G end;function jq.SetOnEnter(self,G)self.specialOnEnter=G end;function jq.Create(type)local iT=dd:GetNextWidgetNum(type)local bv=CreateFrame("Button","AceGUI30DropDownItem"..iT)local self={}self.frame=bv;bv.obj=self;self.type=type;self.useHighlight=true;bv:SetHeight(17)bv:SetFrameStrata("FULLSCREEN_DIALOG")local ff=bv:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")ff:SetTextColor(1,1,1)ff:SetJustifyH("LEFT")ff:SetPoint("TOPLEFT",bv,"TOPLEFT",18,0)ff:SetPoint("BOTTOMRIGHT",bv,"BOTTOMRIGHT",-8,0)self.text=ff;local i4=bv:CreateTexture(nil,"OVERLAY")i4:SetTexture(136810)i4:SetBlendMode("ADD")i4:SetHeight(14)i4:ClearAllPoints()i4:SetPoint("RIGHT",bv,"RIGHT",-3,0)i4:SetPoint("LEFT",bv,"LEFT",5,0)i4:Hide()self.highlight=i4;local i1=bv:CreateTexture(nil,"OVERLAY")i1:SetWidth(16)i1:SetHeight(16)i1:SetPoint("LEFT",bv,"LEFT",3,-1)i1:SetTexture(130751)i1:Hide()self.check=i1;local jr=bv:CreateTexture(nil,"OVERLAY")jr:SetWidth(16)jr:SetHeight(16)jr:SetPoint("RIGHT",bv,"RIGHT",-3,-1)jr:SetTexture(130940)jr:Hide()self.sub=jr;bv:SetScript("OnEnter",jq.Frame_OnEnter)bv:SetScript("OnLeave",jq.Frame_OnLeave)self.OnAcquire=jq.OnAcquire;self.OnRelease=jq.OnRelease;self.SetPullout=jq.SetPullout;self.GetText=jq.GetText;self.SetText=jq.SetText;self.SetDisabled=jq.SetDisabled;self.SetPoint=jq.SetPoint;self.Show=jq.Show;self.Hide=jq.Hide;self.SetOnLeave=jq.SetOnLeave;self.SetOnEnter=jq.SetOnEnter;return self end;local js=LibStub:NewLibrary("AceGUI-3.0-DropDown-ItemBase",jq.version)if js then js.GetItemBase=function()return jq end end;do local dp="Dropdown-Item-Header"local ir=1;local function iw(aw)local self=aw.obj;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end end;local function jt(aw)local self=aw.obj;self:Fire("OnLeave")if self.specialOnLeave then self.specialOnLeave(self)end end;local function j3(self,gf)jq.SetDisabled(self,gf)if not gf then self.text:SetTextColor(1,1,0)end end;local function dI()local self=jq.Create(dp)self.SetDisabled=j3;self.frame:SetScript("OnEnter",iw)self.frame:SetScript("OnLeave",jt)self.text:SetTextColor(1,1,0)dd:RegisterAsWidget(self)return self end;dd:RegisterWidgetType(dp,dI,ir+jq.version)end;do local dp="Dropdown-Item-Execute"local ir=1;local function ju(aw,gD)local self=aw.obj;if self.disabled then return end;self:Fire("OnClick")if self.pullout then self.pullout:Close()end end;local function dI()local self=jq.Create(dp)self.frame:SetScript("OnClick",ju)dd:RegisterAsWidget(self)return self end;dd:RegisterWidgetType(dp,dI,ir+jq.version)end;do local dp="Dropdown-Item-Toggle"local ir=4;local function jv(self)if self.value then self.check:Show()else self.check:Hide()end end;local function hF(self)jq.OnRelease(self)self:SetValue(nil)end;local function ju(aw,gD)local self=aw.obj;if self.disabled then return end;self.value=not self.value;if self.value then PlaySound(856)else PlaySound(857)end;jv(self)self:Fire("OnValueChanged",self.value)end;local function j7(self,bw)self.value=bw;jv(self)end;local function j8(self)return self.value end;local function dI()local self=jq.Create(dp)self.frame:SetScript("OnClick",ju)self.SetValue=j7;self.GetValue=j8;self.OnRelease=hF;dd:RegisterAsWidget(self)return self end;dd:RegisterWidgetType(dp,dI,ir+jq.version)end;do local dp="Dropdown-Item-Menu"local ir=2;local function iw(aw)local self=aw.obj;self:Fire("OnEnter")if self.specialOnEnter then self.specialOnEnter(self)end;self.highlight:Show()if not self.disabled and self.submenu then self.submenu:Open("TOPLEFT",self.frame,"TOPRIGHT",self.pullout:GetRightBorderWidth(),0,self.frame:GetFrameLevel()+100)end end;local function eJ(aw)local self=aw.obj;if self.submenu then self.submenu:Close()end end;local function jw(self,jx)assert(jx.type=="Dropdown-Pullout")self.submenu=jx end;local function jy(self)self.submenu:Close()end;local function dI()local self=jq.Create(dp)self.sub:Show()self.frame:SetScript("OnEnter",iw)self.frame:SetScript("OnHide",eJ)self.SetMenu=jw;self.CloseMenu=jy;dd:RegisterAsWidget(self)return self end;dd:RegisterWidgetType(dp,dI,ir+jq.version)end;do local dp="Dropdown-Item-Separator"local ir=2;local function j3(self,gf)jq.SetDisabled(self,gf)self.useHighlight=false end;local function dI()local self=jq.Create(dp)self.SetDisabled=j3;local gB=self.frame:CreateTexture(nil,"OVERLAY")gB:SetHeight(1)gB:SetColorTexture(.5,.5,.5)gB:SetPoint("LEFT",self.frame,"LEFT",10,0)gB:SetPoint("RIGHT",self.frame,"RIGHT",-10,0)self.text:Hide()self.useHighlight=false;dd:RegisterAsWidget(self)return self end;dd:RegisterWidgetType(dp,dI,ir+jq.version)end end;local function jz(...)local eH,dJ="EditBox",28;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local tostring,pairs=tostring,pairs;local PlaySound=PlaySound;local GetCursorInfo,ClearCursor,GetSpellInfo=GetCursorInfo,ClearCursor,GetSpellInfo;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIEditBoxInsertLink(...)end)end;function _G.AceGUIEditBoxInsertLink(ff)for J=1,dd:GetWidgetCount(eH)do local jA=_G["AceGUI-3.0EditBox"..J]if jA and jA:IsVisible()and jA:HasFocus()then jA:Insert(ff)return true end end end;local function jB(self)if not self.disablebutton then self.button:Show()self.editbox:SetTextInsets(0,20,3,3)end end;local function jC(self)self.button:Hide()self.editbox:SetTextInsets(0,0,3,3)end;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local function jD(bv)bv.obj.editbox:SetFocus()bv:SetScript("OnShow",nil)end;local function jE(bv)dd:ClearFocus()end;local function jF(bv)local self=bv.obj;local bw=bv:GetText()local eL=self:Fire("OnEnterPressed",bw)if not eL then PlaySound(856)jC(self)end end;local function jG(bv)local self=bv.obj;local type,aL,cz=GetCursorInfo()local a8;if type=="item"then a8=cz elseif type=="spell"then a8=GetSpellInfo(aL,cz)elseif type=="macro"then a8=GetMacroInfo(aL)end;if a8 then self:SetText(a8)self:Fire("OnEnterPressed",a8)ClearCursor()jC(self)dd:ClearFocus()end end;local function jH(bv)local self=bv.obj;local bw=bv:GetText()if tostring(bw)~=tostring(self.lasttext)then self:Fire("OnTextChanged",bw)self.lasttext=bw;jB(self)end end;local function jI(bv)dd:SetFocus(bv.obj)end;local function f3(bv)local jA=bv.obj.editbox;jA:ClearFocus()jF(jA)end;local eO={["OnAcquire"]=function(self)self:SetWidth(200)self:SetDisabled(false)self:SetLabel()self:SetText()self:DisableButton(false)self:SetMaxLetters(0)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.editbox:EnableMouse(false)self.editbox:ClearFocus()self.editbox:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)else self.editbox:EnableMouse(true)self.editbox:SetTextColor(1,1,1)self.label:SetTextColor(1,.82,0)end end,["SetText"]=function(self,ff)self.lasttext=ff or""self.editbox:SetText(ff or"")self.editbox:SetCursorPosition(0)jC(self)end,["GetText"]=function(self,ff)return self.editbox:GetText()end,["SetLabel"]=function(self,ff)if ff and ff~=""then self.label:SetText(ff)self.label:Show()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,-18)self:SetHeight(44)self.alignoffset=30 else self.label:SetText("")self.label:Hide()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,0)self:SetHeight(26)self.alignoffset=12 end end,["DisableButton"]=function(self,gf)self.disablebutton=gf;if gf then jC(self)end end,["SetMaxLetters"]=function(self,fE)self.editbox:SetMaxLetters(fE or 0)end,["ClearFocus"]=function(self)self.editbox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editbox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",jD)end end,["HighlightText"]=function(self,e9,ea)self.editbox:HighlightText(e9,ea)end}local function dI()local fE=dd:GetNextWidgetNum(eH)local bv=CreateFrame("Frame",nil,UIParent)bv:Hide()local jA=CreateFrame("EditBox","AceGUI-3.0EditBox"..fE,bv,"InputBoxTemplate")jA:SetAutoFocus(false)jA:SetFontObject(ChatFontNormal)jA:SetScript("OnEnter",hU)jA:SetScript("OnLeave",hV)jA:SetScript("OnEscapePressed",jE)jA:SetScript("OnEnterPressed",jF)jA:SetScript("OnTextChanged",jH)jA:SetScript("OnReceiveDrag",jG)jA:SetScript("OnMouseDown",jG)jA:SetScript("OnEditFocusGained",jI)jA:SetTextInsets(0,0,3,3)jA:SetMaxLetters(256)jA:SetPoint("BOTTOMLEFT",6,0)jA:SetPoint("BOTTOMRIGHT")jA:SetHeight(19)local eS=bv:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eS:SetPoint("TOPLEFT",0,-2)eS:SetPoint("TOPRIGHT",0,-2)eS:SetJustifyH("LEFT")eS:SetHeight(18)local gD=CreateFrame("Button",nil,jA,"UIPanelButtonTemplate")gD:SetWidth(40)gD:SetHeight(20)gD:SetPoint("RIGHT",-2,0)gD:SetText(OKAY)gD:SetScript("OnClick",f3)gD:Hide()local dr={alignoffset=30,editbox=jA,label=eS,button=gD,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;jA.obj,gD.obj=dr,dr;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function jJ(...)local eH,dJ="Heading",20;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs=pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local eO={["OnAcquire"]=function(self)self:SetText()self:SetFullWidth()self:SetHeight(18)end,["SetText"]=function(self,ff)self.label:SetText(ff or"")if ff and ff~=""then self.left:SetPoint("RIGHT",self.label,"LEFT",-5,0)self.right:Show()else self.left:SetPoint("RIGHT",-3,0)self.right:Hide()end end}local function dI()local bv=CreateFrame("Frame",nil,UIParent)bv:Hide()local eS=bv:CreateFontString(nil,"BACKGROUND","GameFontNormal")eS:SetPoint("TOP")eS:SetPoint("BOTTOM")eS:SetJustifyH("CENTER")local fX=bv:CreateTexture(nil,"BACKGROUND")fX:SetHeight(8)fX:SetPoint("LEFT",3,0)fX:SetPoint("RIGHT",eS,"LEFT",-5,0)fX:SetTexture(137057)fX:SetTexCoord(0.81,0.94,0.5,1)local g4=bv:CreateTexture(nil,"BACKGROUND")g4:SetHeight(8)g4:SetPoint("RIGHT",-3,0)g4:SetPoint("LEFT",eS,"RIGHT",5,0)g4:SetTexture(137057)g4:SetTexCoord(0.81,0.94,0.5,1)local dr={label=eS,left=fX,right=g4,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function jK(...)local eH,dJ="Icon",21;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local select,pairs,print=select,pairs,print;local CreateFrame,UIParent=CreateFrame,UIParent;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local function f3(bv,gD)bv.obj:Fire("OnClick",gD)dd:ClearFocus()end;local eO={["OnAcquire"]=function(self)self:SetHeight(110)self:SetWidth(110)self:SetLabel()self:SetImage(nil)self:SetImageSize(64,64)self:SetDisabled(false)end,["SetLabel"]=function(self,ff)if ff and ff~=""then self.label:Show()self.label:SetText(ff)self:SetHeight(self.image:GetHeight()+25)else self.label:Hide()self:SetHeight(self.image:GetHeight()+10)end end,["SetImage"]=function(self,hj,...)local i7=self.image;i7:SetTexture(hj)if i7:GetTexture()then local cZ=select("#",...)if cZ==4 or cZ==8 then i7:SetTexCoord(...)else i7:SetTexCoord(0,1,0,1)end end end,["SetImageSize"]=function(self,dv,dw)self.image:SetWidth(dv)self.image:SetHeight(dw)if self.label:IsShown()then self:SetHeight(dw+25)else self:SetHeight(dw+10)end end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.frame:Disable()self.label:SetTextColor(0.5,0.5,0.5)self.image:SetVertexColor(0.5,0.5,0.5,0.5)else self.frame:Enable()self.label:SetTextColor(1,1,1)self.image:SetVertexColor(1,1,1,1)end end}local function dI()local bv=CreateFrame("Button",nil,UIParent)bv:Hide()bv:EnableMouse(true)bv:SetScript("OnEnter",hU)bv:SetScript("OnLeave",hV)bv:SetScript("OnClick",f3)local eS=bv:CreateFontString(nil,"BACKGROUND","GameFontHighlight")eS:SetPoint("BOTTOMLEFT")eS:SetPoint("BOTTOMRIGHT")eS:SetJustifyH("CENTER")eS:SetJustifyV("TOP")eS:SetHeight(18)local i7=bv:CreateTexture(nil,"BACKGROUND")i7:SetWidth(64)i7:SetHeight(64)i7:SetPoint("TOP",0,-5)local i4=bv:CreateTexture(nil,"HIGHLIGHT")i4:SetAllPoints(i7)i4:SetTexture(136580)i4:SetTexCoord(0,1,0.23,0.77)i4:SetBlendMode("ADD")local dr={label=eS,image=i7,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;dr.SetText=function(self,...)print("AceGUI-3.0-Icon: SetText is deprecated! Use SetLabel instead!")self:SetLabel(...)end;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function jL(...)local eH,dJ="InteractiveLabel",21;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local select,pairs=select,pairs;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local function jM(bv,gD)bv.obj:Fire("OnClick",gD)dd:ClearFocus()end;local eO={["OnAcquire"]=function(self)self:LabelOnAcquire()self:SetHighlight()self:SetHighlightTexCoord()self:SetDisabled(false)end,["SetHighlight"]=function(self,...)self.highlight:SetTexture(...)end,["SetHighlightTexCoord"]=function(self,...)local jN=select("#",...)if jN==4 or jN==8 then self.highlight:SetTexCoord(...)else self.highlight:SetTexCoord(0,1,0,1)end end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.frame:EnableMouse(false)self.label:SetTextColor(0.5,0.5,0.5)else self.frame:EnableMouse(true)self.label:SetTextColor(1,1,1)end end}local function dI()local eS=dd:Create("Label")local bv=eS.frame;bv:EnableMouse(true)bv:SetScript("OnEnter",hU)bv:SetScript("OnLeave",hV)bv:SetScript("OnMouseDown",jM)local i4=bv:CreateTexture(nil,"HIGHLIGHT")i4:SetTexture(nil)i4:SetAllPoints()i4:SetBlendMode("ADD")eS.highlight=i4;eS.type=eH;eS.LabelOnAcquire=eS.OnAcquire;for s,G in pairs(eO)do eS[s]=G end;return eS end;dd:RegisterWidgetType(eH,dI,dJ)end;local function jO(...)local eH,dJ="Keybinding",26;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs=pairs;local IsShiftKeyDown,IsControlKeyDown,IsAltKeyDown=IsShiftKeyDown,IsControlKeyDown,IsAltKeyDown;local CreateFrame,UIParent=CreateFrame,UIParent;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local function jP(bv,gD)if gD=="LeftButton"or gD=="RightButton"then local self=bv.obj;if self.waitingForKey then bv:EnableKeyboard(false)bv:EnableMouseWheel(false)self.msgframe:Hide()bv:UnlockHighlight()self.waitingForKey=nil else bv:EnableKeyboard(true)bv:EnableMouseWheel(true)self.msgframe:Show()bv:LockHighlight()self.waitingForKey=true end end;dd:ClearFocus()end;local jQ={["BUTTON1"]=true,["BUTTON2"]=true,["UNKNOWN"]=true,["LSHIFT"]=true,["LCTRL"]=true,["LALT"]=true,["RSHIFT"]=true,["RCTRL"]=true,["RALT"]=true}local function jR(bv,o)local self=bv.obj;if self.waitingForKey then local jS=o;if jS=="ESCAPE"then jS=""else if jQ[jS]then return end;if IsShiftKeyDown()then jS="SHIFT-"..jS end;if IsControlKeyDown()then jS="CTRL-"..jS end;if IsAltKeyDown()then jS="ALT-"..jS end end;bv:EnableKeyboard(false)bv:EnableMouseWheel(false)self.msgframe:Hide()bv:UnlockHighlight()self.waitingForKey=nil;if not self.disabled then self:SetKey(jS)self:Fire("OnKeyChanged",jS)end end end;local function jT(bv,gD)if gD=="LeftButton"or gD=="RightButton"then return elseif gD=="MiddleButton"then gD="BUTTON3"elseif gD=="Button4"then gD="BUTTON4"elseif gD=="Button5"then gD="BUTTON5"end;jR(bv,gD)end;local function jU(bv,jV)local gD;if jV>=0 then gD="MOUSEWHEELUP"else gD="MOUSEWHEELDOWN"end;jR(bv,gD)end;local eO={["OnAcquire"]=function(self)self:SetWidth(200)self:SetLabel("")self:SetKey("")self.waitingForKey=nil;self.msgframe:Hide()self:SetDisabled(false)self.button:EnableKeyboard(false)self.button:EnableMouseWheel(false)end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.button:Disable()self.label:SetTextColor(0.5,0.5,0.5)else self.button:Enable()self.label:SetTextColor(1,1,1)end end,["SetKey"]=function(self,o)if(o or"")==""then self.button:SetText(NOT_BOUND)self.button:SetNormalFontObject("GameFontNormal")else self.button:SetText(o)self.button:SetNormalFontObject("GameFontHighlight")end end,["GetKey"]=function(self)local o=self.button:GetText()if o==NOT_BOUND then o=nil end;return o end,["SetLabel"]=function(self,eS)self.label:SetText(eS or"")if(eS or"")==""then self.alignoffset=nil;self:SetHeight(24)else self.alignoffset=30;self:SetHeight(44)end end}local jW={bgFile="Interface\\Tooltips\\UI-Tooltip-Background",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=3,bottom=3}}local function jX(bv)bv:SetWidth(bv.msg:GetWidth()+10)bv:SetScript("OnUpdate",nil)end;local function dI()local a8="AceGUI30KeybindingButton"..dd:GetNextWidgetNum(eH)local bv=CreateFrame("Frame",nil,UIParent)local gD=CreateFrame("Button",a8,bv,"UIPanelButtonTemplate")gD:EnableMouse(true)gD:EnableMouseWheel(false)gD:RegisterForClicks("AnyDown")gD:SetScript("OnEnter",hU)gD:SetScript("OnLeave",hV)gD:SetScript("OnClick",jP)gD:SetScript("OnKeyDown",jR)gD:SetScript("OnMouseDown",jT)gD:SetScript("OnMouseWheel",jU)gD:SetPoint("BOTTOMLEFT")gD:SetPoint("BOTTOMRIGHT")gD:SetHeight(24)gD:EnableKeyboard(false)local ff=gD:GetFontString()ff:SetPoint("LEFT",7,0)ff:SetPoint("RIGHT",-7,0)local eS=bv:CreateFontString(nil,"OVERLAY","GameFontHighlight")eS:SetPoint("TOPLEFT")eS:SetPoint("TOPRIGHT")eS:SetJustifyH("CENTER")eS:SetHeight(18)local jY=CreateFrame("Frame",nil,UIParent,"BackdropTemplate")jY:SetHeight(30)jY:SetBackdrop(jW)jY:SetBackdropColor(0,0,0)jY:SetFrameStrata("FULLSCREEN_DIALOG")jY:SetFrameLevel(1000)jY:SetToplevel(true)local jZ=jY:CreateFontString(nil,"OVERLAY","GameFontNormal")jZ:SetText("Press a key to bind, ESC to clear the binding or click the button again to cancel.")jY.msg=jZ;jZ:SetPoint("TOPLEFT",5,-5)jY:SetScript("OnUpdate",jX)jY:SetPoint("BOTTOM",gD,"TOP")jY:Hide()local dr={button=gD,label=eS,msgframe=jY,frame=bv,alignoffset=30,type=eH}for s,G in pairs(eO)do dr[s]=G end;gD.obj=dr;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function j_(...)local eH,dJ="Label",28;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local cW,select,pairs=math.max,select,pairs;local CreateFrame,UIParent=CreateFrame,UIParent;local function k0(self)if self.resizing then return end;local bv=self.frame;local dv=bv.width or bv:GetWidth()or 0;local i7=self.image;local eS=self.label;local dw;eS:ClearAllPoints()i7:ClearAllPoints()if self.imageshown then local k1=i7:GetWidth()if dv-k1<200 or(eS:GetText()or"")==""then i7:SetPoint("TOP")eS:SetPoint("TOP",i7,"BOTTOM")eS:SetPoint("LEFT")eS:SetWidth(dv)dw=i7:GetHeight()+eS:GetStringHeight()else i7:SetPoint("TOPLEFT")if i7:GetHeight()>eS:GetStringHeight()then eS:SetPoint("LEFT",i7,"RIGHT",4,0)else eS:SetPoint("TOPLEFT",i7,"TOPRIGHT",4,0)end;eS:SetWidth(dv-k1-4)dw=cW(i7:GetHeight(),eS:GetStringHeight())end else eS:SetPoint("TOPLEFT")eS:SetWidth(dv)dw=eS:GetStringHeight()end;if not dw or dw==0 then dw=1 end;self.resizing=true;bv:SetHeight(dw)bv.height=dw;self.resizing=nil end;local eO={["OnAcquire"]=function(self)self.resizing=true;self:SetWidth(200)self:SetText()self:SetImage(nil)self:SetImageSize(16,16)self:SetColor()self:SetFontObject()self:SetJustifyH("LEFT")self:SetJustifyV("TOP")self.resizing=nil;k0(self)end,["OnWidthSet"]=function(self,dv)k0(self)end,["SetText"]=function(self,ff)self.label:SetText(ff)k0(self)end,["SetColor"]=function(self,ia,ib,ic)if not(ia and ib and ic)then ia,ib,ic=1,1,1 end;self.label:SetVertexColor(ia,ib,ic)end,["SetImage"]=function(self,hj,...)local i7=self.image;i7:SetTexture(hj)if i7:GetTexture()then self.imageshown=true;local cZ=select("#",...)if cZ==4 or cZ==8 then i7:SetTexCoord(...)else i7:SetTexCoord(0,1,0,1)end else self.imageshown=nil end;k0(self)end,["SetFont"]=function(self,k2,dw,k3)if not self.fontObject then self.fontObject=CreateFont("AceGUI30LabelFont"..dd:GetNextWidgetNum(eH))end;self.fontObject:SetFont(k2,dw,k3)self:SetFontObject(self.fontObject)end,["SetFontObject"]=function(self,k2)self.label:SetFontObject(k2 or GameFontHighlightSmall)k0(self)end,["SetImageSize"]=function(self,dv,dw)self.image:SetWidth(dv)self.image:SetHeight(dw)k0(self)end,["SetJustifyH"]=function(self,k4)self.label:SetJustifyH(k4)end,["SetJustifyV"]=function(self,k5)self.label:SetJustifyV(k5)end}local function dI()local bv=CreateFrame("Frame",nil,UIParent)bv:Hide()local eS=bv:CreateFontString(nil,"BACKGROUND","GameFontHighlightSmall")local i7=bv:CreateTexture(nil,"BACKGROUND")local dr={label=eS,image=i7,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function k6(...)local eH,dJ="MultiLineEditBox",32;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local pairs=pairs;local GetCursorInfo,GetSpellInfo,ClearCursor=GetCursorInfo,GetSpellInfo,ClearCursor;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIMultiLineEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIMultiLineEditBoxInsertLink(...)end)end;function _G.AceGUIMultiLineEditBoxInsertLink(ff)for J=1,dd:GetWidgetCount(eH)do local jA=_G[("MultiLineEditBox%uEdit"):format(J)]if jA and jA:IsVisible()and jA:HasFocus()then jA:Insert(ff)return true end end end;local function dD(self)self:SetHeight(self.numlines*14+(self.disablebutton and 19 or 41)+self.labelHeight)if self.labelHeight==0 then self.scrollBar:SetPoint("TOP",self.frame,"TOP",0,-23)else self.scrollBar:SetPoint("TOP",self.label,"BOTTOM",0,-19)end;if self.disablebutton then self.scrollBar:SetPoint("BOTTOM",self.frame,"BOTTOM",0,21)self.scrollBG:SetPoint("BOTTOMLEFT",0,4)else self.scrollBar:SetPoint("BOTTOM",self.button,"TOP",0,18)self.scrollBG:SetPoint("BOTTOMLEFT",self.button,"TOPLEFT")end end;local function k7(self)self=self.obj;self.editBox:ClearFocus()if not self:Fire("OnEnterPressed",self.editBox:GetText())then self.button:Disable()end end;local function k8(self,aT,iJ,aT,k9)self,iJ=self.obj.scrollFrame,-iJ;local ae=self:GetVerticalScroll()if iJ<ae then self:SetVerticalScroll(iJ)else iJ=iJ+k9-self:GetHeight()if iJ>ae then self:SetVerticalScroll(iJ)end end end;local function ka(self)self:HighlightText(0,0)self.obj:Fire("OnEditFocusLost")end;local function iw(self)self=self.obj;if not self.entered then self.entered=true;self:Fire("OnEnter")end end;local function jt(self)self=self.obj;if self.entered then self.entered=nil;self:Fire("OnLeave")end end;local function kb(self)self=self.obj.editBox;self:SetFocus()self:SetCursorPosition(self:GetNumLetters())end;local function kc(self)local type,aL,cz=GetCursorInfo()if type=="spell"then cz=GetSpellInfo(aL,cz)elseif type~="item"then return end;ClearCursor()self=self.obj;local d2=self.editBox;if not d2:HasFocus()then d2:SetFocus()d2:SetCursorPosition(d2:GetNumLetters())end;d2:Insert(cz)self.button:Enable()end;local function iz(self,dv,dw)self.obj.editBox:SetWidth(dv)end;local function kd(self,ke)if ke then self=self.obj;self:Fire("OnTextChanged",self.editBox:GetText())self.button:Enable()end end;local function kf(self)self:HighlightText(0,0)self:SetCursorPosition(self:GetNumLetters())self:SetCursorPosition(0)self.obj.button:Disable()end;local function kg(self,ae)local d2=self.obj.editBox;d2:SetHitRectInsets(0,0,ae,d2:GetHeight()-ae-self:GetHeight())end;local function kh(self,ki,kj)if kj==0 then self.obj.editBox:SetHitRectInsets(0,0,0,0)else kg(self,self:GetVerticalScroll())end end;local function kk(bv)bv.obj.editBox:SetFocus()bv:SetScript("OnShow",nil)end;local function kl(bv)dd:SetFocus(bv.obj)bv.obj:Fire("OnEditFocusGained")end;local eO={["OnAcquire"]=function(self)self.editBox:SetText("")self:SetDisabled(false)self:SetWidth(200)self:DisableButton(false)self:SetNumLines()self.entered=nil;self:SetMaxLetters(0)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gf)local d2=self.editBox;if gf then d2:ClearFocus()d2:EnableMouse(false)d2:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)self.scrollFrame:EnableMouse(false)self.button:Disable()else d2:EnableMouse(true)d2:SetTextColor(1,1,1)self.label:SetTextColor(1,0.82,0)self.scrollFrame:EnableMouse(true)end end,["SetLabel"]=function(self,ff)if ff and ff~=""then self.label:SetText(ff)if self.labelHeight~=10 then self.labelHeight=10;self.label:Show()end elseif self.labelHeight~=0 then self.labelHeight=0;self.label:Hide()end;dD(self)end,["SetNumLines"]=function(self,bw)if not bw or bw<4 then bw=4 end;self.numlines=bw;dD(self)end,["SetText"]=function(self,ff)self.editBox:SetText(ff)end,["GetText"]=function(self)return self.editBox:GetText()end,["SetMaxLetters"]=function(self,fE)self.editBox:SetMaxLetters(fE or 0)end,["DisableButton"]=function(self,gf)self.disablebutton=gf;if gf then self.button:Hide()else self.button:Show()end;dD(self)end,["ClearFocus"]=function(self)self.editBox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editBox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",kk)end end,["HighlightText"]=function(self,e9,ea)self.editBox:HighlightText(e9,ea)end,["GetCursorPosition"]=function(self)return self.editBox:GetCursorPosition()end,["SetCursorPosition"]=function(self,...)return self.editBox:SetCursorPosition(...)end}local is={bgFile=[[Interface\Tooltips\UI-Tooltip-Background]],edgeFile=[[Interface\Tooltips\UI-Tooltip-Border]],edgeSize=16,insets={left=4,right=3,top=4,bottom=3}}local function dI()local bv=CreateFrame("Frame",nil,UIParent)bv:Hide()local km=dd:GetNextWidgetNum(eH)local eS=bv:CreateFontString(nil,"OVERLAY","GameFontNormalSmall")eS:SetPoint("TOPLEFT",bv,"TOPLEFT",0,-4)eS:SetPoint("TOPRIGHT",bv,"TOPRIGHT",0,-4)eS:SetJustifyH("LEFT")eS:SetText(ACCEPT)eS:SetHeight(10)local gD=CreateFrame("Button",("%s%dButton"):format(eH,km),bv,"UIPanelButtonTemplate")gD:SetPoint("BOTTOMLEFT",0,4)gD:SetHeight(22)gD:SetWidth(eS:GetStringWidth()+24)gD:SetText(ACCEPT)gD:SetScript("OnClick",k7)gD:Disable()local ff=gD:GetFontString()ff:ClearAllPoints()ff:SetPoint("TOPLEFT",gD,"TOPLEFT",5,-5)ff:SetPoint("BOTTOMRIGHT",gD,"BOTTOMRIGHT",-5,1)ff:SetJustifyV("MIDDLE")local kn=CreateFrame("Frame",nil,bv,"BackdropTemplate")kn:SetBackdrop(is)kn:SetBackdropColor(0,0,0)kn:SetBackdropBorderColor(0.4,0.4,0.4)local iU=CreateFrame("ScrollFrame",("%s%dScrollFrame"):format(eH,km),bv,"UIPanelScrollFrameTemplate")local ko=_G[iU:GetName().."ScrollBar"]ko:ClearAllPoints()ko:SetPoint("TOP",eS,"BOTTOM",0,-19)ko:SetPoint("BOTTOM",gD,"TOP",0,18)ko:SetPoint("RIGHT",bv,"RIGHT")kn:SetPoint("TOPRIGHT",ko,"TOPLEFT",0,19)kn:SetPoint("BOTTOMLEFT",gD,"TOPLEFT")iU:SetPoint("TOPLEFT",kn,"TOPLEFT",5,-6)iU:SetPoint("BOTTOMRIGHT",kn,"BOTTOMRIGHT",-4,4)iU:SetScript("OnEnter",iw)iU:SetScript("OnLeave",jt)iU:SetScript("OnMouseUp",kb)iU:SetScript("OnReceiveDrag",kc)iU:SetScript("OnSizeChanged",iz)iU:HookScript("OnVerticalScroll",kg)iU:HookScript("OnScrollRangeChanged",kh)local d2=CreateFrame("EditBox",("%s%dEdit"):format(eH,km),iU)d2:SetAllPoints()d2:SetFontObject(ChatFontNormal)d2:SetMultiLine(true)d2:EnableMouse(true)d2:SetAutoFocus(false)d2:SetCountInvisibleLetters(false)d2:SetScript("OnCursorChanged",k8)d2:SetScript("OnEditFocusLost",ka)d2:SetScript("OnEnter",iw)d2:SetScript("OnEscapePressed",d2.ClearFocus)d2:SetScript("OnLeave",jt)d2:SetScript("OnMouseDown",kc)d2:SetScript("OnReceiveDrag",kc)d2:SetScript("OnTextChanged",kd)d2:SetScript("OnTextSet",kf)d2:SetScript("OnEditFocusGained",kl)iU:SetScrollChild(d2)local dr={button=gD,editBox=d2,frame=bv,label=eS,labelHeight=10,numlines=4,scrollBar=ko,scrollBG=kn,scrollFrame=iU,type=eH}for s,G in pairs(eO)do dr[s]=G end;gD.obj,d2.obj,iU.obj=dr,dr,dr;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function kp(...)local eH,dJ="Slider",23;local dd=LibStub and LibStub("AceGUI-3.0",true)if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local fv,cW,fw=math.min,math.max,math.floor;local tonumber,pairs=tonumber,pairs;local PlaySound=PlaySound;local CreateFrame,UIParent=CreateFrame,UIParent;local function kq(self)local bw=self.value or 0;if self.ispercent then self.editbox:SetText(("%s%%"):format(fw(bw*1000+0.5)/10))else self.editbox:SetText(fw(bw*100+0.5)/100)end end;local function kr(self)local ks,kt=self.min or 0,self.max or 100;if self.ispercent then self.lowtext:SetFormattedText("%s%%",ks*100)self.hightext:SetFormattedText("%s%%",kt*100)else self.lowtext:SetText(ks)self.hightext:SetText(kt)end end;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local function f6(bv)bv.obj.slider:EnableMouseWheel(true)dd:ClearFocus()end;local function ku(bv,g_)local self=bv.obj;if not bv.setup then if self.step and self.step>0 then local ks=self.min or 0;g_=fw((g_-ks)/self.step+0.5)*self.step+ks end;if g_~=self.value and not self.disabled then self.value=g_;self:Fire("OnValueChanged",g_)end;if self.value then kq(self)end end end;local function kv(bv)local self=bv.obj;self:Fire("OnMouseUp",self.value)end;local function kw(bv,ac)local self=bv.obj;if not self.disabled then local bw=self.value;if ac>0 then bw=fv(bw+(self.step or 1),self.max)else bw=cW(bw-(self.step or 1),self.min)end;self.slider:SetValue(bw)end end;local function jE(bv)bv:ClearFocus()end;local function jF(bv)local self=bv.obj;local bw=bv:GetText()if self.ispercent then bw=bw:gsub('%%','')bw=tonumber(bw)/100 else bw=tonumber(bw)end;if bw then PlaySound(856)self.slider:SetValue(bw)self:Fire("OnMouseUp",bw)end end;local function kx(bv)bv:SetBackdropBorderColor(0.5,0.5,0.5,1)end;local function ky(bv)bv:SetBackdropBorderColor(0.3,0.3,0.3,0.8)end;local eO={["OnAcquire"]=function(self)self:SetWidth(200)self:SetHeight(44)self:SetDisabled(false)self:SetIsPercent(nil)self:SetSliderValues(0,100,1)self:SetValue(0)self.slider:EnableMouseWheel(false)end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.slider:EnableMouse(false)self.label:SetTextColor(.5,.5,.5)self.hightext:SetTextColor(.5,.5,.5)self.lowtext:SetTextColor(.5,.5,.5)self.editbox:SetTextColor(.5,.5,.5)self.editbox:EnableMouse(false)self.editbox:ClearFocus()else self.slider:EnableMouse(true)self.label:SetTextColor(1,.82,0)self.hightext:SetTextColor(1,1,1)self.lowtext:SetTextColor(1,1,1)self.editbox:SetTextColor(1,1,1)self.editbox:EnableMouse(true)end end,["SetValue"]=function(self,bw)self.slider.setup=true;self.slider:SetValue(bw)self.value=bw;kq(self)self.slider.setup=nil end,["GetValue"]=function(self)return self.value end,["SetLabel"]=function(self,ff)self.label:SetText(ff)end,["SetSliderValues"]=function(self,ks,kt,kz)local bv=self.slider;bv.setup=true;self.min=ks;self.max=kt;self.step=kz;bv:SetMinMaxValues(ks or 0,kt or 100)kr(self)bv:SetValueStep(kz or 1)if self.value then bv:SetValue(self.value)end;bv.setup=nil end,["SetIsPercent"]=function(self,bw)self.ispercent=bw;kr(self)kq(self)end}local kA={bgFile="Interface\\Buttons\\UI-SliderBar-Background",edgeFile="Interface\\Buttons\\UI-SliderBar-Border",tile=true,tileSize=8,edgeSize=8,insets={left=3,right=3,top=6,bottom=6}}local kB={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\ChatFrame\\ChatFrameBackground",tile=true,edgeSize=1,tileSize=5}local function dI()local bv=CreateFrame("Frame",nil,UIParent)bv:EnableMouse(true)bv:SetScript("OnMouseDown",f6)local eS=bv:CreateFontString(nil,"OVERLAY","GameFontNormal")eS:SetPoint("TOPLEFT")eS:SetPoint("TOPRIGHT")eS:SetJustifyH("CENTER")eS:SetHeight(15)local iV=CreateFrame("Slider",nil,bv,"BackdropTemplate")iV:SetOrientation("HORIZONTAL")iV:SetHeight(15)iV:SetHitRectInsets(0,0,-10,0)iV:SetBackdrop(kA)iV:SetThumbTexture("Interface\\Buttons\\UI-SliderBar-Button-Horizontal")iV:SetPoint("TOP",eS,"BOTTOM")iV:SetPoint("LEFT",3,0)iV:SetPoint("RIGHT",-3,0)iV:SetValue(0)iV:SetScript("OnValueChanged",ku)iV:SetScript("OnEnter",hU)iV:SetScript("OnLeave",hV)iV:SetScript("OnMouseUp",kv)iV:SetScript("OnMouseWheel",kw)local kC=iV:CreateFontString(nil,"ARTWORK","GameFontHighlightSmall")kC:SetPoint("TOPLEFT",iV,"BOTTOMLEFT",2,3)local kD=iV:CreateFontString(nil,"ARTWORK","GameFontHighlightSmall")kD:SetPoint("TOPRIGHT",iV,"BOTTOMRIGHT",-2,3)local jA=CreateFrame("EditBox",nil,bv,"BackdropTemplate")jA:SetAutoFocus(false)jA:SetFontObject(GameFontHighlightSmall)jA:SetPoint("TOP",iV,"BOTTOM")jA:SetHeight(14)jA:SetWidth(70)jA:SetJustifyH("CENTER")jA:EnableMouse(true)jA:SetBackdrop(kB)jA:SetBackdropColor(0,0,0,0.5)jA:SetBackdropBorderColor(0.3,0.3,0.30,0.80)jA:SetScript("OnEnter",kx)jA:SetScript("OnLeave",ky)jA:SetScript("OnEnterPressed",jF)jA:SetScript("OnEscapePressed",jE)local dr={label=eS,slider=iV,lowtext=kC,hightext=kD,editbox=jA,alignoffset=25,frame=bv,type=eH}for s,G in pairs(eO)do dr[s]=G end;iV.obj,jA.obj=dr,dr;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;local function kE(...)local l=LibStub("CallbackHandler-1.0")local i,k="AceConfigRegistry-3.0",21;local kF=LibStub:NewLibrary(i,k)if not kF then return end;kF.tables=kF.tables or{}if not kF.callbacks then kF.callbacks=l:New(kF)end;local M,N=table.insert,table.concat;local cU,kG=string.find,string.match;local type,tostring,select,pairs=type,tostring,select,pairs;local error,assert=error,assert;kF.validated={cmd={},dropdown={},dialog={}}local function R(jZ,kH,...)local aS={}for J=select("#",...),1,-1 do M(aS,(select(J,...)))end;error(i..":ValidateOptionsTable(): "..N(aS,".")..jZ,kH+2)end;local kI={["string"]=true,_="string"}local kJ={["string"]=true,["function"]=true,_="string or funcref"}local kK={["table"]=true,_="table"}local kL={["table"]=true,["string"]=true,["function"]=true,_="methodname, funcref or table"}local kM={["nil"]=true,["string"]=true,_="string"}local kN={["nil"]=true,["string"]=true,["function"]=true,_="string or funcref"}local kO={["nil"]=true,["string"]=true,["number"]=true,["function"]=true,_="string, number or funcref"}local kP={["nil"]=true,["number"]=true,_="number"}local kQ={["nil"]=true,["string"]=true,["function"]=true,["boolean"]={[false]=true},_="methodname, funcref or false"}local kR={["nil"]=true,["string"]=true,["function"]=true,["number"]=true,_="methodname, funcref or number"}local kS={["nil"]=true,["string"]=true,["function"]=true,["table"]=true,_="methodname, funcref or table"}local kT={["nil"]=true,["string"]=true,["function"]=true,["boolean"]=true,_="methodname, funcref or boolean"}local kU={["nil"]=true,["table"]=true,_="table"}local kV={["nil"]=true,["boolean"]=true,_="boolean"}local kW={["nil"]=true,["boolean"]=true,["number"]=true,_="boolean or number"}local kX={["nil"]=true,["string"]=true,["number"]=true,_="string or number"}local kY={type=kI,name=kJ,desc=kN,descStyle=kM,order=kR,validate=kQ,confirm=kT,confirmText=kM,disabled=kT,hidden=kT,guiHidden=kT,dialogHidden=kT,dropdownHidden=kT,cmdHidden=kT,tooltipHyperlink=kN,icon=kO,iconCoords=kS,handler=kU,get=kQ,set=kQ,func=kQ,arg={["*"]=true},width=kX}local kZ={header={control=kM,dialogControl=kM,dropdownControl=kM},description={image=kO,imageCoords=kS,imageHeight=kP,imageWidth=kP,fontSize=kN,control=kM,dialogControl=kM,dropdownControl=kM},group={args=kK,plugins=kU,inline=kV,cmdInline=kV,guiInline=kV,dropdownInline=kV,dialogInline=kV,childGroups=kM},execute={image=kO,imageCoords=kS,imageHeight=kP,imageWidth=kP,control=kM,dialogControl=kM,dropdownControl=kM},input={pattern=kM,usage=kM,control=kM,dialogControl=kM,dropdownControl=kM,multiline=kW},toggle={tristate=kV,image=kO,imageCoords=kS,control=kM,dialogControl=kM,dropdownControl=kM},tristate={},range={min=kP,softMin=kP,max=kP,softMax=kP,step=kP,bigStep=kP,isPercent=kV,control=kM,dialogControl=kM,dropdownControl=kM},select={values=kL,sorting=kS,style={["nil"]=true,["string"]={dropdown=true,radio=true},_="string: 'dropdown' or 'radio'"},control=kM,dialogControl=kM,dropdownControl=kM,itemControl=kM},multiselect={values=kL,style=kM,tristate=kV,control=kM,dialogControl=kM,dropdownControl=kM},color={hasAlpha=kT,control=kM,dialogControl=kM,dropdownControl=kM},keybinding={control=kM,dialogControl=kM,dropdownControl=kM}}local function k_(ab,kH,...)kH=(kH or 0)+1;if type(ab)~="string"then R("["..tostring(ab).."] - key is not a string",kH,...)end;if cU(ab,"[%c\127]")then R("["..tostring(ab).."] - key name contained control characters",kH,...)end end;local function l0(ac,l1,kH,...)kH=(kH or 0)+1;local l2=l1[type(ac)]or l1["*"]if not l2 then R(": expected a "..l1._..", got '"..tostring(ac).."'",kH,...)end;if type(l2)=="table"then if not l2[ac]then R(": did not expect "..type(ac).." value '"..tostring(ac).."'",kH,...)end end end;local function l3(l4,kH,...)kH=(kH or 0)+1;if type(l4)~="table"then R(": expected a table, got a "..type(l4),kH,...)end;if type(l4.type)~="string"then R(".type: expected a string, got a "..type(l4.type),kH,...)end;local l5=kZ[l4.type]if not l5 then R(".type: unknown type '"..l4.type.."'",kH,...)end;for ab,ac in pairs(l4)do if not(l5[ab]or kY[ab])then R(": unknown parameter",kH,tostring(ab),...)end end;for ab,l1 in pairs(kY)do l0(l4[ab],l1,kH,ab,...)end;for ab,l1 in pairs(l5)do l0(l4[ab],l1,kH,ab,...)end;if l4.type=="group"then for ab,ac in pairs(l4.args)do k_(ab,kH,"args",...)l3(ac,kH,ab,"args",...)end;if l4.plugins then for l6,l7 in pairs(l4.plugins)do if type(l7)~="table"then R(": expected a table, got '"..tostring(l7).."'",kH,tostring(l6),"plugins",...)end;for ab,ac in pairs(l7)do k_(ab,kH,tostring(l6),"plugins",...)l3(ac,kH,ab,tostring(l6),"plugins",...)end end end end end;function kF:ValidateOptionsTable(l4,a8,kH)kH=(kH or 0)+1;a8=a8 or"Optionstable"if not l4.name then l4.name=a8 end;l3(l4,kH,a8)end;function kF:NotifyChange(l8)if not kF.tables[l8]then return end;kF.callbacks:Fire("ConfigTableChange",l8)end;local function l9(la,lb,kH)kH=(kH or 0)+2;if la~="cmd"and la~="dropdown"and la~="dialog"then error(i..": Requesting options table: 'uiType' - invalid configuration UI type, expected 'cmd', 'dropdown' or 'dialog'",kH)end;if not kG(lb,"[A-Za-z]%-[0-9]")then error(i..": Requesting options table: 'uiName' - badly formatted or missing version number. Expected e.g. 'MyLib-1.2'",kH)end end;function kF:RegisterOptionsTable(l8,l4,lc)if type(l4)=="table"then if l4.type~="group"then error(i..": RegisterOptionsTable(appName, options): 'options' - missing type='group' member in root group",2)end;kF.tables[l8]=function(la,lb,kH)kH=(kH or 0)+1;l9(la,lb,kH)if not kF.validated[la][l8]and not lc then kF:ValidateOptionsTable(l4,l8,kH)kF.validated[la][l8]=true end;return l4 end elseif type(l4)=="function"then kF.tables[l8]=function(la,lb,kH)kH=(kH or 0)+1;l9(la,lb,kH)local fO=assert(l4(la,lb,l8))if not kF.validated[la][l8]and not lc then kF:ValidateOptionsTable(fO,l8,kH)kF.validated[la][l8]=true end;return fO end else error(i..": RegisterOptionsTable(appName, options): 'options' - expected table or function reference",2)end end;function kF:IterateOptionsTables()return pairs(kF.tables)end;function kF:GetOptionsTable(l8,la,lb)local eu=kF.tables[l8]if not eu then return nil end;if la then return eu(la,lb,1)else return eu end end end;local function ld(...)local le=LibStub("AceConfigRegistry-3.0")local i,k="AceConfigCmd-3.0",14;local lf=LibStub:NewLibrary(i,k)if not lf then return end;lf.commands=lf.commands or{}local lg=lf.commands;local cT;local lh="AceConsole-3.0"local cV,li,lj,kG,lk=string.sub,string.split,string.lower,string.match,string.trim;local be,tonumber,tostring=string.format,tonumber,tostring;local im,M=table.sort,table.insert;local select,pairs,next,type=select,pairs,next,type;local error,assert=error,assert;local _G=_G;local cp=setmetatable({},{__index=function(self,ab)return ab end})local function print(jZ)(SELECTED_CHAT_FRAME or DEFAULT_CHAT_FRAME):AddMessage(jZ)end;local ll={["table"]=true}local lm="expected a table"local ln={["function"]=true,["string"]=true}local lo="expected function or member name"local function lp(...)for J=1,select("#",...)do if select(J,...)~=nil then return select(J,...)end end end;local function R(cz,lq,jZ)local lr=" "..cV(cz.input,1,lq-1)error(i..": /"..cz[0]..lr..": "..(jZ or"malformed options table"),2)end;local function ls(cz,lq,jZ)local lr=cV(cz.input,1,lq-1)print("/"..cz[0].." "..lr..": "..(jZ or"malformed options table"))end;local function lt(cz,lq,fO,lu,...)local s=cz[lu]if not s then R(cz,lq,"'"..lu.."': not set")end;cz.arg=fO.arg;cz.option=fO;cz.type=fO.type;if type(s)=="function"then return s(cz,...)elseif type(s)=="string"then if type(cz.handler[s])~="function"then R(cz,lq,"'"..lu.."': '"..s.."' is not a member function of "..tostring(cz.handler))end;return cz.handler[s](cz.handler,cz,...)else assert(false)end end;local function lv(cz,fO,lu,...)local s=fO[lu]cz.arg=fO.arg;cz.option=fO;cz.type=fO.type;if type(s)=="function"then return s(cz,...)else assert(false)end end;local function lw(cz,lq,fO,lu,...)if cz.validate then local lx=lt(cz,lq,fO,"validate",...)if type(lx)=="string"then ls(cz,lq,"'"..cV(cz.input,lq).."' - "..lx)return end end;lt(cz,lq,fO,lu,...)end;local function ly(cz,lq,fO,lz,lA,lB,lC)local lD,lE=cz[lA],cz[lA.."_at"]local e6=fO[lA]if e6~=nil then if e6==false then e6=nil elseif not lB[type(e6)]then R(cz,lq,"'"..lA.."' - "..lC)end;cz[lA]=e6;cz[lA.."_at"]=lz end;return lD,lE end;local lF={}local function lG(fO)if not fO.plugins then return pairs(fO.args)end;local lH,lI=next(fO.plugins)local ac;return function(aT,ab)while lI do ab,ac=next(lI,ab)if ab then return ab,ac end;if lI==fO.args then lI=nil else lH,lI=next(fO.plugins,lH)if not lH then lI=fO.args end end end end end;local function lJ(cz,lq,fO)if fO.cmdHidden~=nil then return fO.cmdHidden end;local lK=fO.hidden;if type(lK)=="function"or type(lK)=="string"then cz.hidden=lK;lK=lt(cz,lq,fO,'hidden')cz.hidden=nil end;return lK end;local function lL(cz,lq,fO,lz,lM)if not lM then print("|cff33ff99"..cz.appName.."|r: Arguments to |cffffff78/"..cz[0].."|r "..cV(cz.input,1,lq-1)..":")end;local jg={}local lN={}for ab,ac in lG(fO)do if not lN[ab]then M(jg,ab)lN[ab]=ac end end;im(jg,function(lO,lP)local lQ=lN[lO].order or 100;local lR=lN[lP].order or 100;if type(lQ)=="function"or type(lQ)=="string"then cz.order=lQ;cz[#cz+1]=lO;lQ=lt(cz,lq,lN[lO],"order")cz[#cz]=nil;cz.order=nil end;if type(lR)=="function"or type(lQ)=="string"then cz.order=lR;cz[#cz+1]=lP;lR=lt(cz,lq,lN[lP],"order")cz[#cz]=nil;cz.order=nil end;if lQ<0 and lR<0 then return lQ<lR end;if lR<0 then return true end;if lQ<0 then return false end;if lQ==lR then return tostring(lO)<tostring(lP)end;return lQ<lR end)for J=1,#jg do local ab=jg[J]local ac=lN[ab]if not lJ(cz,lq,ac)then if ac.type~="description"and ac.type~="header"then local a8,i6=ac.name,ac.desc;if type(a8)=="function"then a8=lv(cz,ac,'name')end;if type(i6)=="function"then i6=lv(cz,ac,'desc')end;if ac.type=="group"and lp(ac.cmdInline,ac.inline,false)then print("  "..(i6 or a8)..":")local lS,lT=ly(cz,lq,ac,lz,"handler",ll,lm)lL(cz,lq,ac,lz,true)cz.handler,cz.handler_at=lS,lT else local o=ab:gsub(" ","_")print("  |cffffff78"..o.."|r - "..(i6 or a8 or""))end end end end end;local function lU(ff)if ff==nil or ff=="NONE"then return nil end;ff=ff:upper()local lV,lW,lX;local lY;while true do if ff=="-"then break end;lY,ff=li('-',ff,2)if ff then if lY~="SHIFT"and lY~="CTRL"and lY~="ALT"then return false end;if lY=="SHIFT"then if lV then return false end;lV=true end;if lY=="CTRL"then if lW then return false end;lW=true end;if lY=="ALT"then if lX then return false end;lX=true end else ff=lY;break end end;if ff==""then return false end;if not ff:find("^F%d+$")and ff~="CAPSLOCK"and ff:len()~=1 and(ff:byte()<128 or ff:len()>4)and not _G["KEY_"..ff]then return false end;local lZ=ff;if lV then lZ="SHIFT-"..lZ end;if lW then lZ="CTRL-"..lZ end;if lX then lZ="ALT-"..lZ end;return lZ end;local function aN(cz,lq,fO,lz,l_)if not(type(fO)=="table"and type(fO.type)=="string")then R(cz,lq)end;local lS,lT=ly(cz,lq,fO,lz,"handler",ll,lm)local m0,m1=ly(cz,lq,fO,lz,"set",ln,lo)local m2,m3=ly(cz,lq,fO,lz,"get",ln,lo)local m4,m5=ly(cz,lq,fO,lz,"func",ln,lo)local m6,m7=ly(cz,lq,fO,lz,"validate",ln,lo)if fO.type=="group"then if type(fO.args)~="table"then R(cz,lq)end;if fO.plugins and type(fO.plugins)~="table"then R(cz,lq)end;local aT,m8,I=cz.input:find(" *([^ ]+) *",lq)if not I then lL(cz,lq,fO,lz)return end;m8=m8+1;for ab,ac in lG(fO)do if not(type(ab)=="string"and type(ac)=="table"and type(ac.type)=="string")then R(cz,lq,"options table child '"..tostring(ab).."' is malformed")end;if ac.type=="group"and lp(ac.cmdInline,ac.inline,false)then cz[lz+1]=ab;if aN(cz,lq,ac,lz+1,true)==false then cz[lz+1]=nil else return end elseif lj(I)==lj(ab:gsub(" ","_"))then cz[lz+1]=ab;return aN(cz,m8,ac,lz+1)end end;if l_ then cz.handler,cz.handler_at=lS,lT;cz.set,cz.set_at=m0,m1;cz.get,cz.get_at=m2,m3;cz.func,cz.func_at=m4,m5;cz.validate,cz.validate_at=m6,m7;return false end;ls(cz,lq,"'"..I.."' - "..cp["unknown argument"])return end;local m9=cV(cz.input,lq)if fO.type=="execute"then lw(cz,lq,fO,"func")elseif fO.type=="input"then local lx=true;if fO.pattern then if type(fO.pattern)~="string"then R(cz,lq,"'pattern' - expected a string")end;if not kG(m9,fO.pattern)then ls(cz,lq,"'"..m9 .."' - "..cp["invalid input"])return end end;lw(cz,lq,fO,"set",m9)elseif fO.type=="toggle"then local ic;local d4=lk(lj(m9))if d4==""then ic=lt(cz,lq,fO,"get")if fO.tristate then if ic then ic=nil elseif ic==nil then ic=false else ic=true end else ic=not ic end elseif d4==cp["on"]then ic=true elseif d4==cp["off"]then ic=false elseif fO.tristate and d4==cp["default"]then ic=nil else if fO.tristate then ls(cz,lq,be(cp["'%s' - expected 'on', 'off' or 'default', or no argument to toggle."],d4))else ls(cz,lq,be(cp["'%s' - expected 'on' or 'off', or no argument to toggle."],d4))end;return end;lw(cz,lq,fO,"set",ic)elseif fO.type=="range"then local e6=tonumber(m9)if not e6 then ls(cz,lq,"'"..m9 .."' - "..cp["expected number"])return end;if type(cz.step)=="number"then e6=e6-e6%cz.step end;if type(cz.min)=="number"and e6<cz.min then ls(cz,lq,e6 .." - "..be(cp["must be equal to or higher than %s"],tostring(cz.min)))return end;if type(cz.max)=="number"and e6>cz.max then ls(cz,lq,e6 .." - "..be(cp["must be equal to or lower than %s"],tostring(cz.max)))return end;lw(cz,lq,fO,"set",e6)elseif fO.type=="select"then local d4=lk(lj(m9))local ma=fO.values;if type(ma)=="function"or type(ma)=="string"then cz.values=ma;ma=lt(cz,lq,fO,"values")cz.values=nil end;if d4==""then local ic=lt(cz,lq,fO,"get")local P="|cffffff78- [%s]|r %s"local mb="|cffffff78- [%s]|r %s |cffff0000*|r"print(cp["Options for |cffffff78"..cz[#cz].."|r:"])for ab,ac in pairs(ma)do if ic==ab then print(mb:format(ab,ac))else print(P:format(ab,ac))end end;return end;local mc;for ab,ac in pairs(ma)do if lj(ab)==d4 then d4=ab;mc=true;break end end;if not mc then ls(cz,lq,"'"..d4 .."' - "..cp["unknown selection"])return end;lw(cz,lq,fO,"set",d4)elseif fO.type=="multiselect"then local d4=lk(lj(m9))local ma=fO.values;if type(ma)=="function"or type(ma)=="string"then cz.values=ma;ma=lt(cz,lq,fO,"values")cz.values=nil end;if d4==""then local P="|cffffff78- [%s]|r %s"local mb="|cffffff78- [%s]|r %s |cffff0000*|r"print(cp["Options for |cffffff78"..cz[#cz].."|r (multiple possible):"])for ab,ac in pairs(ma)do if lt(cz,lq,fO,"get",ab)then print(mb:format(ab,ac))else print(P:format(ab,ac))end end;return end;local md={}for ac in d4:gmatch("[^ ]+")do local me,e6=ac:match('(.+)=(.+)')if not me then me=ac end;local mc;for ab in pairs(ma)do if lj(ab)==me then me=ab;mc=true;break end end;if not mc then ls(cz,lq,"'"..me.."' - "..cp["unknown selection"])return end;if e6 then if e6==cp["on"]or e6==cp["off"]or fO.tristate and e6==cp["default"]then md[me]=e6 else if fO.tristate then ls(cz,lq,be(cp["'%s' '%s' - expected 'on', 'off' or 'default', or no argument to toggle."],ac,e6))else ls(cz,lq,be(cp["'%s' '%s' - expected 'on' or 'off', or no argument to toggle."],ac,e6))end;return end else md[me]=true end end;for me,e6 in pairs(md)do local mf;if e6==true then local ic=lt(cz,lq,fO,"get",me)if fO.tristate then if ic then ic=nil elseif ic==nil then ic=false else ic=true end else ic=not ic end;mf=ic else if e6==cp["on"]then mf=true elseif e6==cp["off"]then mf=false elseif e6==cp["default"]then mf=nil end end;lw(cz,lq,fO,"set",me,mf)end elseif fO.type=="color"then local d4=lk(lj(m9))if d4==""then return end;local ia,ib,ic,id;local mg=fO.hasAlpha;if type(mg)=="function"or type(mg)=="string"then cz.hasAlpha=mg;mg=lt(cz,lq,fO,'hasAlpha')cz.hasAlpha=nil end;if mg then if d4:len()==8 and d4:find("^%x*$")then ia,ib,ic,id=tonumber(d4:sub(1,2),16)/255,tonumber(d4:sub(3,4),16)/255,tonumber(d4:sub(5,6),16)/255,tonumber(d4:sub(7,8),16)/255 else ia,ib,ic,id=d4:match("^([%d%.]+) ([%d%.]+) ([%d%.]+) ([%d%.]+)$")ia,ib,ic,id=tonumber(ia),tonumber(ib),tonumber(ic),tonumber(id)end;if not(ia and ib and ic and id)then ls(cz,lq,be(cp["'%s' - expected 'RRGGBBAA' or 'r g b a'."],d4))return end;if ia>=0.0 and ia<=1.0 and ib>=0.0 and ib<=1.0 and ic>=0.0 and ic<=1.0 and id>=0.0 and id<=1.0 then elseif ia>=0 and ia<=255 and ib>=0 and ib<=255 and ic>=0 and ic<=255 and id>=0 and id<=255 then ia=ia/255;ib=ib/255;ic=ic/255;id=id/255 else ls(cz,lq,be(cp["'%s' - values must all be either in the range 0..1 or 0..255."],d4))end else id=1.0;if d4:len()==6 and d4:find("^%x*$")then ia,ib,ic=tonumber(d4:sub(1,2),16)/255,tonumber(d4:sub(3,4),16)/255,tonumber(d4:sub(5,6),16)/255 else ia,ib,ic=d4:match("^([%d%.]+) ([%d%.]+) ([%d%.]+)$")ia,ib,ic=tonumber(ia),tonumber(ib),tonumber(ic)end;if not(ia and ib and ic)then ls(cz,lq,be(cp["'%s' - expected 'RRGGBB' or 'r g b'."],d4))return end;if ia>=0.0 and ia<=1.0 and ib>=0.0 and ib<=1.0 and ic>=0.0 and ic<=1.0 then elseif ia>=0 and ia<=255 and ib>=0 and ib<=255 and ic>=0 and ic<=255 then ia=ia/255;ib=ib/255;ic=ic/255 else ls(cz,lq,be(cp["'%s' - values must all be either in the range 0-1 or 0-255."],d4))end end;lw(cz,lq,fO,"set",ia,ib,ic,id)elseif fO.type=="keybinding"then local d4=lk(lj(m9))if d4==""then return end;local bw=lU(d4:upper())if bw==false then ls(cz,lq,be(cp["'%s' - Invalid Keybinding."],d4))return end;lw(cz,lq,fO,"set",bw)elseif fO.type=="description"then else R(cz,lq,"unknown options table item type '"..tostring(fO.type).."'")end end;function lf:HandleCommand(mh,l8,d1)local mi=le:GetOptionsTable(l8)if not mi then error([[Usage: HandleCommand("slashcmd", "appName", "input"): 'appName' - no options table "]]..tostring(l8)..[[" has been registered]],2)end;local l4=assert(mi("cmd",i))local cz={[0]=mh,appName=l8,options=l4,input=d1,self=self,handler=self,uiType="cmd",uiName=i}aN(cz,1,l4,0)end;function lf:CreateChatCommand(mh,l8)if not cT then cT=LibStub(lh)end;if cT.RegisterChatCommand(self,mh,function(d1)lf.HandleCommand(self,mh,l8,d1)end,true)then lg[mh]=l8 end end;function lf:GetChatCommandOptions(mh)return lg[mh]end end;local function mj(...)local LibStub=LibStub;local mk=LibStub("AceGUI-3.0")local ml=LibStub("AceConfigRegistry-3.0")local i,k="AceConfigDialog-3.0",86;local mm,f=LibStub:NewLibrary(i,k)if not mm then return end;mm.OpenFrames=mm.OpenFrames or{}mm.Status=mm.Status or{}mm.frame=mm.frame or CreateFrame("Frame")mm.tooltip=mm.tooltip or CreateFrame("GameTooltip","AceConfigDialogTooltip",UIParent,"GameTooltipTemplate")mm.frame.apps=mm.frame.apps or{}mm.frame.closing=mm.frame.closing or{}mm.frame.closeAllOverride=mm.frame.closeAllOverride or{}local M,im,O,de=table.insert,table.sort,table.remove,table.wipe;local kG,be=string.match,string.format;local error=error;local pairs,next,select,type,unpack,ipairs=pairs,next,select,type,unpack,ipairs;local tostring,tonumber=tostring,tonumber;local dg,df,mn=math.min,math.max,math.floor;local mo={}local xpcall=xpcall;local function Q(R)return geterrorhandler()(R)end;local function S(G,...)if G then return xpcall(G,Q,...)end end;local mp=170;local aF,gw,mq;do local gx=setmetatable({},{__mode="k"})function aF()local aS=next(gx)if aS then gx[aS]=nil;return aS else return{}end end;function mq(aS)local jN=aF()for ab,ac in pairs(aS)do jN[ab]=ac end;return jN end;function gw(aS)de(aS)gx[aS]=true end end;local function lp(...)for J=1,select("#",...)do if select(J,...)~=nil then return select(J,...)end end end;local function mr(eV,o)if eV.plugins then for l7,aS in pairs(eV.plugins)do if aS[o]then return aS[o]end end end;return eV.args[o]end;local ms={set=true,get=true,func=true,confirm=true,validate=true,disabled=true,hidden=true}local mt={name=true,desc=true,icon=true,usage=true,width=true,image=true,fontSize=true,tooltipHyperlink=true}local mu={type=true,descStyle=true,imageWidth=true,imageHeight=true}local function mv(mw,mx,l4,hj,l8,...)local my=ms[mw]local mz;if my then local eV=l4;if eV[mw]~=nil then mz=eV[mw]end;for J=1,#hj do eV=mr(eV,hj[J])if eV[mw]~=nil then mz=eV[mw]end end else mz=mx[mw]end;if not mu[mw]and(type(mz)=="function"or not mt[mw]and type(mz)=="string")then local cz=aF()local eV=l4;local bj=eV.handler;for J=1,#hj do eV=mr(eV,hj[J])cz[J]=hj[J]bj=eV.handler or bj end;cz.options=l4;cz.appName=l8;cz[0]=l8;cz.arg=mx.arg;cz.handler=bj;cz.option=mx;cz.type=mx.type;cz.uiType="dialog"cz.uiName=i;local id,ic,jN,mA;if type(mz)=="function"then id,ic,jN,mA=mz(cz,...)else if bj and bj[mz]then id,ic,jN,mA=bj[mz](bj,cz,...)else error(be("Method %s doesn't exist in handler for type %s",mz,mw))end end;gw(cz)return id,ic,jN,mA else return mz end end;local mB;local mC;local function mD(id,ic)if not id then return true end;if not ic then return false end;local mE,mF=mB[id]or 100,mB[ic]or 100;if mE==mF then local mG=type(mC[id])=="string"and mC[id]or""local mH=type(mC[ic])=="string"and mC[ic]or""return mG:upper()<mH:upper()end;if mE<0 then if mF>=0 then return false end else if mF<0 then return true end end;return mE<mF end;local function mI(eV,mJ,mK,l4,hj,l8)mB=aF()mC=aF()if eV.plugins then for l7,aS in pairs(eV.plugins)do for ab,ac in pairs(aS)do if not mK[ab]then M(mJ,ab)mK[ab]=ac;hj[#hj+1]=ab;mB[ab]=mv("order",ac,l4,hj,l8)mC[ab]=mv("name",ac,l4,hj,l8)hj[#hj]=nil end end end end;for ab,ac in pairs(eV.args)do if not mK[ab]then M(mJ,ab)mK[ab]=ac;hj[#hj+1]=ab;mB[ab]=mv("order",ac,l4,hj,l8)mC[ab]=mv("name",ac,l4,hj,l8)hj[#hj]=nil end end;im(mJ,mD)gw(mB)gw(mC)end;local function mL(gN)if gN.children then local mM=gN.children;for J=1,#mM do mL(mM[J])gw(mM[J])end;gw(mM)end end;local function mN(dr,C)local mO=dr:GetUserDataTable()if mO.path then gw(mO.path)end;if dr.type=="TreeGroup"then local gN=mO.tree;dr:SetTree(nil)if gN then for J=1,#gN do mL(gN[J])gw(gN[J])end;gw(gN)end end;if dr.type=="TabGroup"then dr:SetTabs(nil)if mO.tablist then gw(mO.tablist)end end;if dr.type=="DropdownGroup"then dr:SetGroupList(nil)if mO.grouplist then gw(mO.grouplist)end;if mO.orderlist then gw(mO.orderlist)end end end;function mm:GetStatusTable(l8,hj)local eW=self.Status;if not eW[l8]then eW[l8]={}eW[l8].status={}eW[l8].children={}end;eW=eW[l8]if hj then for J=1,#hj do local ac=hj[J]if not eW.children[ac]then eW.children[ac]={}eW.children[ac].status={}eW.children[ac].children={}end;eW=eW.children[ac]end end;return eW.status end;function mm:SelectGroup(l8,...)local hj=aF()local cR=ml:GetOptionsTable(l8)if not cR then error(("%s isn't registed with AceConfigRegistry, unable to open config"):format(l8),2)end;local l4=cR("dialog",i)local eV=l4;local eW=self:GetStatusTable(l8,hj)if not eW.groups then eW.groups={}end;eW=eW.groups;local mP;local mQ;for cZ=1,select("#",...)do local o=select(cZ,...)if eV.childGroups=="tab"or eV.childGroups=="select"then eW.selected=o;mP=nil else if mP then mP=mP.."\001"..o else mP=o;if not eW.groups then eW.groups={}end;mQ=eW end;mQ.selected=mP;mQ.groups[mP]=true end;eV=mr(eV,o)if not eV then break end;M(hj,o)eW=self:GetStatusTable(l8,hj)if not eW.groups then eW.groups={}end;eW=eW.groups end;gw(hj)ml:NotifyChange(l8)end;local function mR(dr,C)local mO=dr:GetUserDataTable()local me=mO.option;local l4=mO.options;local hj=mO.path;local l8=mO.appName;local gV=mm.tooltip;gV:SetOwner(dr.frame,"ANCHOR_TOPRIGHT")local mS=mv("tooltipHyperlink",me,l4,hj,l8)if mS then gV:SetHyperlink(mS)gV:Show()return end;local a8=mv("name",me,l4,hj,l8)local i6=mv("desc",me,l4,hj,l8)local bs=mv("usage",me,l4,hj,l8)local mT=me.descStyle;if mT and mT~="tooltip"then return end;gV:SetText(a8,1,.82,0,true)if me.type=="multiselect"then gV:AddLine(mO.text,0.5,0.5,0.8,true)end;if type(i6)=="string"then gV:AddLine(i6,1,1,1,true)end;if type(bs)=="string"then gV:AddLine("Usage: "..bs,NORMAL_FONT_COLOR.r,NORMAL_FONT_COLOR.g,NORMAL_FONT_COLOR.b,true)end;gV:Show()end;local function mU(dr,C)mm.tooltip:Hide()end;local function mV(mx)if mx.type=="execute"then return"func"else return"set"end end;do local bv=mm.popup;if not bv or f<81 then bv=CreateFrame("Frame",nil,UIParent)mm.popup=bv;bv:Hide()bv:SetPoint("CENTER",UIParent,"CENTER")bv:SetSize(320,72)bv:EnableMouse(true)bv:SetFrameStrata("TOOLTIP")bv:SetFrameLevel(100)bv:SetScript("OnKeyDown",function(self,o)if o=="ESCAPE"then self:SetPropagateKeyboardInput(false)if self.cancel:IsShown()then self.cancel:Click()else self:Hide()end else self:SetPropagateKeyboardInput(true)end end)local f1=CreateFrame("Frame",nil,bv,"DialogBorderOpaqueTemplate")f1:SetAllPoints(bv)bv:SetFixedFrameStrata(true)bv:SetFixedFrameLevel(true)local ff=bv:CreateFontString(nil,"ARTWORK","GameFontHighlight")ff:SetSize(290,0)ff:SetPoint("TOP",0,-16)bv.text=ff;local function mW(mX)local gD=CreateFrame("Button",nil,bv)gD:SetSize(128,21)gD:SetNormalFontObject(GameFontNormal)gD:SetHighlightFontObject(GameFontHighlight)gD:SetNormalTexture(130763)gD:GetNormalTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gD:SetPushedTexture(130761)gD:GetPushedTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gD:SetHighlightTexture(130762)gD:GetHighlightTexture():SetTexCoord(0.0,1.0,0.0,0.71875)gD:SetText(mX)return gD end;local mY=mW(ACCEPT)mY:SetPoint("BOTTOMRIGHT",bv,"BOTTOM",-6,16)bv.accept=mY;local eL=mW(CANCEL)eL:SetPoint("LEFT",mY,"RIGHT",13,0)bv.cancel=eL end end;local function mZ(l8,m_,n0,cz,b6,G,...)local bv=mm.popup;bv:Show()bv.text:SetText(b6)local dw=61+bv.text:GetHeight()bv:SetHeight(dw)bv.accept:ClearAllPoints()bv.accept:SetPoint("BOTTOMRIGHT",bv,"BOTTOM",-6,16)bv.cancel:Show()local aS={...}local n1=select("#",...)bv.accept:SetScript("OnClick",function(self)S(G,unpack(aS,1,n1))mm:Open(l8,m_,unpack(n0 or mo))bv:Hide()self:SetScript("OnClick",nil)bv.cancel:SetScript("OnClick",nil)gw(cz)end)bv.cancel:SetScript("OnClick",function(self)mm:Open(l8,m_,unpack(n0 or mo))bv:Hide()self:SetScript("OnClick",nil)bv.accept:SetScript("OnClick",nil)gw(cz)end)end;local function n2(b6)local bv=mm.popup;bv:Show()bv.text:SetText(b6)local dw=61+bv.text:GetHeight()bv:SetHeight(dw)bv.accept:ClearAllPoints()bv.accept:SetPoint("BOTTOM",bv,"BOTTOM",0,16)bv.cancel:Hide()bv.accept:SetScript("OnClick",function()bv:Hide()end)end;local function n3(dr,C,...)local mO=dr:GetUserDataTable()local mx=mO.option;local l4=mO.options;local hj=mO.path;local cz=aF()local G;local eV=l4;local n4=mV(mx)local bj;local n5;local l3;if eV[n4]~=nil then G=eV[n4]end;bj=eV.handler;n5=eV.confirm;l3=eV.validate;for J=1,#hj do local ac=hj[J]eV=mr(eV,ac)cz[J]=ac;if eV[n4]~=nil then G=eV[n4]end;bj=eV.handler or bj;if eV.confirm~=nil then n5=eV.confirm end;if eV.validate~=nil then l3=eV.validate end end;cz.options=l4;cz.appName=mO.appName;cz.arg=mx.arg;cz.handler=bj;cz.option=mx;cz.type=mx.type;cz.uiType="dialog"cz.uiName=i;local a8;if type(mx.name)=="function"then a8=mx.name(cz)elseif type(mx.name)=="string"then a8=mx.name else a8=""end;local bs=mx.usage;local n6=mx.pattern;local n7=true;if mx.type=="input"then if type(n6)=="string"then if not kG(...,n6)then n7=false end end end;local dt;if n7 and mx.type~="execute"then if type(l3)=="string"then if bj and bj[l3]then dt,n7=S(bj[l3],bj,cz,...)if not dt then n7=false end else error(be("Method %s doesn't exist in handler for type execute",l3))end elseif type(l3)=="function"then dt,n7=S(l3,cz,...)if not dt then n7=false end end end;if not n7 or type(n7)=="string"then if not n7 then if bs then n7=a8 ..": "..bs else if n6 then n7=a8 ..": Expected "..n6 else n7=a8 ..": Invalid Value"end end end;if mO.rootframe.SetStatusText then mO.rootframe:SetStatusText(n7)else n2(n7)end;PlaySound(882)gw(cz)return true else local n8=mx.confirmText;if type(n5)=="string"then if bj and bj[n5]then dt,n5=S(bj[n5],bj,cz,...)if dt and type(n5)=="string"then n8=n5;n5=true elseif not dt then n5=false end else error(be("Method %s doesn't exist in handler for type confirm",n5))end elseif type(n5)=="function"then dt,n5=S(n5,cz,...)if dt and type(n5)=="string"then n8=n5;n5=true elseif not dt then n5=false end end;if type(n5)=="boolean"then if n5 then if not n8 then local n9,i6=mx.name,mx.desc;if type(n9)=="function"then n9=n9(cz)end;if type(i6)=="function"then i6=i6(cz)end;n8=n9;if i6 then n8=n8 .." - "..i6 end end;local na=mO.rootframe:GetUserData("iscustom")local m_;if na then m_=mO.rootframe end;local n0=mO.rootframe:GetUserData("basepath")if type(G)=="string"then if bj and bj[G]then mZ(mO.appName,m_,n0,cz,n8,bj[G],bj,cz,...)else error(be("Method %s doesn't exist in handler for type func",G))end elseif type(G)=="function"then mZ(mO.appName,m_,n0,cz,n8,G,cz,...)end;return end end;if type(G)=="string"then if bj and bj[G]then S(bj[G],bj,cz,...)else error(be("Method %s doesn't exist in handler for type func",G))end elseif type(G)=="function"then S(G,cz,...)end;local na=mO.rootframe:GetUserData("iscustom")local n0=mO.rootframe:GetUserData("basepath")or mo;if mx.type=="color"then if C=="OnValueConfirmed"then if na then mm:Open(mO.appName,mO.rootframe,unpack(n0))else mm:Open(mO.appName,unpack(n0))end end elseif mx.type=="range"then if C=="OnMouseUp"then if na then mm:Open(mO.appName,mO.rootframe,unpack(n0))else mm:Open(mO.appName,unpack(n0))end end elseif mx.type=="multiselect"then mO.valuechanged=true else if na then mm:Open(mO.appName,mO.rootframe,unpack(n0))else mm:Open(mO.appName,unpack(n0))end end end;gw(cz)end;local function nb(dr,C,bw)local mx=dr:GetUserData("option")local fv,cW,kz=mx.min or(not mx.softMin and 0 or nil),mx.max or(not mx.softMax and 100 or nil),mx.step;if fv then if kz then bw=mn((bw-fv)/kz+0.5)*kz+fv end;bw=df(bw,fv)end;if cW then bw=dg(bw,cW)end;n3(dr,C,bw)end;local function nc(dr,C,...)n3(dr,C,dr:GetUserData("value"),...)local mO=dr:GetUserDataTable()local na=mO.rootframe:GetUserData("iscustom")local n0=mO.rootframe:GetUserData("basepath")or mo;if na then mm:Open(mO.appName,mO.rootframe,unpack(n0))else mm:Open(mO.appName,unpack(n0))end end;local function nd(dr,C,...)local mO=dr:GetUserDataTable()if mO.valuechanged and not dr:IsReleasing()then local na=mO.rootframe:GetUserData("iscustom")local n0=mO.rootframe:GetUserData("basepath")or mo;if na then mm:Open(mO.appName,mO.rootframe,unpack(n0))else mm:Open(mO.appName,unpack(n0))end end end;local function ne(dr,C)local l8=dr:GetUserData("appName")mm.OpenFrames[l8]=nil;mk:Release(dr)end;local function nf(mx,l4,hj,l8)local lK=lp(mx.dialogHidden,mx.guiHidden)if lK~=nil then return lK end;return mv("hidden",mx,l4,hj,l8)end;local function ng(mx,l4,hj,l8)local gf=lp(mx.dialogDisabled,mx.guiDisabled)if gf~=nil then return gf end;return mv("disabled",mx,l4,hj,l8)end;local function nh(eV,l4,hj,l8)local h8=aF()local eY=aF()local mJ=aF()local mK=aF()mI(eV,mJ,mK,l4,hj,l8)for J=1,#mJ do local ab=mJ[J]local ac=mK[ab]if ac.type=="group"then hj[#hj+1]=ab;local ni=lp(ac.dialogInline,ac.guiInline,ac.inline,false)local lK=nf(ac,l4,hj,l8)if not ni and not lK then h8[ab]=mv("name",ac,l4,hj,l8)M(eY,ab)end;hj[#hj]=nil end end;gw(mK)gw(mJ)return h8,eY end;local function nj(eV,gN,l4,hj,l8)local mJ=aF()local mK=aF()mI(eV,mJ,mK,l4,hj,l8)for J=1,#mJ do local ab=mJ[J]local ac=mK[ab]if ac.type=="group"then hj[#hj+1]=ab;local ni=lp(ac.dialogInline,ac.guiInline,ac.inline,false)local lK=nf(ac,l4,hj,l8)if not ni and not lK then local nk=aF()nk.value=ab;nk.text=mv("name",ac,l4,hj,l8)nk.icon=mv("icon",ac,l4,hj,l8)nk.iconCoords=mv("iconCoords",ac,l4,hj,l8)nk.disabled=ng(ac,l4,hj,l8)if not gN.children then gN.children=aF()end;M(gN.children,nk)if(ac.childGroups or"tree")=="tree"then nj(ac,nk,l4,hj,l8)end end;hj[#hj]=nil end end;gw(mJ)gw(mK)end;local function nl(eV,l4,hj,l8,nm)local gN=aF()local mJ=aF()local mK=aF()mI(eV,mJ,mK,l4,hj,l8)for J=1,#mJ do local ab=mJ[J]local ac=mK[ab]if ac.type=="group"then hj[#hj+1]=ab;local ni=lp(ac.dialogInline,ac.guiInline,ac.inline,false)local lK=nf(ac,l4,hj,l8)if not ni and not lK then local nk=aF()nk.value=ab;nk.text=mv("name",ac,l4,hj,l8)nk.icon=mv("icon",ac,l4,hj,l8)nk.iconCoords=mv("iconCoords",ac,l4,hj,l8)nk.disabled=ng(ac,l4,hj,l8)M(gN,nk)if nm and(ac.childGroups or"tree")=="tree"then nj(ac,nk,l4,hj,l8)end end;hj[#hj]=nil end end;gw(mJ)gw(mK)return gN end;local function nn(no,l4,mx,hj,m_,l8)local mO=no:GetUserDataTable()for J=1,#hj do mO[J]=hj[J]end;mO.rootframe=m_;mO.option=mx;mO.options=l4;mO.path=mq(hj)mO.appName=l8;no:SetCallback("OnRelease",mN)no:SetCallback("OnLeave",mU)no:SetCallback("OnEnter",mR)end;local function np(nq,nr)local no;if nq then no=mk:Create(nq)if not no then geterrorhandler()(("Invalid Custom Control Type - %s"):format(tostring(nq)))end end;if not no then no=mk:Create(nr)end;return no end;local function ns(fp,iJ)return tostring(fp)<tostring(iJ)end;local function nt(l8,l4,nu,m_,hj,eV,ni)local mJ=aF()local mK=aF()mI(eV,mJ,mK,l4,hj,l8)for J=1,#mJ do local ab=mJ[J]local ac=mK[ab]M(hj,ab)local lK=nf(ac,l4,hj,l8)local a8=mv("name",ac,l4,hj,l8)if not lK then if ac.type=="group"then if ni or lp(ac.dialogInline,ac.guiInline,ac.inline,false)then local nv;if a8 and a8~=""then nv=mk:Create("InlineGroup")nv:SetTitle(a8 or"")else nv=mk:Create("SimpleGroup")end;nv.width="fill"nv:SetLayout("flow")nu:AddChild(nv)nt(l8,l4,nv,m_,hj,ac,true)end else local no;if ac.type=="execute"then local nw=mv("imageCoords",ac,l4,hj,l8)local i7,dv,dw=mv("image",ac,l4,hj,l8)local nx=type(i7)=="string"or type(i7)=="number"no=np(ac.dialogControl or ac.control,nx and"Icon"or"Button")if nx then if not dv then dv=mv("imageWidth",ac,l4,hj,l8)end;if not dw then dw=mv("imageHeight",ac,l4,hj,l8)end;if type(nw)=="table"then no:SetImage(i7,unpack(nw))else no:SetImage(i7)end;if type(dv)~="number"then dv=32 end;if type(dw)~="number"then dw=32 end;no:SetImageSize(dv,dw)no:SetLabel(a8)else no:SetText(a8)end;no:SetCallback("OnClick",n3)elseif ac.type=="input"then no=np(ac.dialogControl or ac.control,ac.multiline and"MultiLineEditBox"or"EditBox")if ac.multiline and no.SetNumLines then no:SetNumLines(tonumber(ac.multiline)or 4)end;no:SetLabel(a8)no:SetCallback("OnEnterPressed",n3)local ff=mv("get",ac,l4,hj,l8)if type(ff)~="string"then ff=""end;no:SetText(ff)elseif ac.type=="toggle"then no=np(ac.dialogControl or ac.control,"CheckBox")no:SetLabel(a8)no:SetTriState(ac.tristate)local bw=mv("get",ac,l4,hj,l8)no:SetValue(bw)no:SetCallback("OnValueChanged",n3)if ac.descStyle=="inline"then local i6=mv("desc",ac,l4,hj,l8)no:SetDescription(i6)end;local i7=mv("image",ac,l4,hj,l8)local nw=mv("imageCoords",ac,l4,hj,l8)if type(i7)=="string"or type(i7)=="number"then if type(nw)=="table"then no:SetImage(i7,unpack(nw))else no:SetImage(i7)end end elseif ac.type=="range"then no=np(ac.dialogControl or ac.control,"Slider")no:SetLabel(a8)no:SetSliderValues(ac.softMin or ac.min or 0,ac.softMax or ac.max or 100,ac.bigStep or ac.step or 0)no:SetIsPercent(ac.isPercent)local bw=mv("get",ac,l4,hj,l8)if type(bw)~="number"then bw=0 end;no:SetValue(bw)no:SetCallback("OnValueChanged",nb)no:SetCallback("OnMouseUp",nb)elseif ac.type=="select"then local ma=mv("values",ac,l4,hj,l8)local ny=mv("sorting",ac,l4,hj,l8)if ac.style=="radio"then local gf=ng(ac,l4,hj,l8)local dv=mv("width",ac,l4,hj,l8)no=mk:Create("InlineGroup")no:SetLayout("Flow")no:SetTitle(a8)no.width="fill"no:PauseLayout()local nz=mv("get",ac,l4,hj,l8)if not ny then ny={}for bw,ff in pairs(ma)do ny[#ny+1]=bw end;im(ny,ns)end;for aT,bw in ipairs(ny)do local ff=ma[bw]local nA=mk:Create("CheckBox")nA:SetLabel(ff)nA:SetUserData("value",bw)nA:SetUserData("text",ff)nA:SetDisabled(gf)nA:SetType("radio")nA:SetValue(nz==bw)nA:SetCallback("OnValueChanged",nc)nn(nA,l4,ac,hj,m_,l8)no:AddChild(nA)if dv=="double"then nA:SetWidth(mp*2)elseif dv=="half"then nA:SetWidth(mp/2)elseif type(dv)=="number"then nA:SetWidth(mp*dv)elseif dv=="full"then nA.width="fill"else nA:SetWidth(mp)end end;no:ResumeLayout()no:DoLayout()else no=np(ac.dialogControl or ac.control,"Dropdown")local jc=ac.itemControl;if jc and not mk:GetWidgetVersion(jc)then geterrorhandler()(("Invalid Custom Item Type - %s"):format(tostring(jc)))jc=nil end;no:SetLabel(a8)no:SetList(ma,ny,jc)local bw=mv("get",ac,l4,hj,l8)if not ma[bw]then bw=nil end;no:SetValue(bw)no:SetCallback("OnValueChanged",n3)end elseif ac.type=="multiselect"then local ma=mv("values",ac,l4,hj,l8)local gf=ng(ac,l4,hj,l8)local nB=aF()if ma then for bw,ff in pairs(ma)do M(nB,bw)end end;im(nB)local nC=ac.dialogControl or ac.control;if nC then no=mk:Create(nC)if not no then geterrorhandler()(("Invalid Custom Control Type - %s"):format(tostring(nC)))end end;if no then no:SetMultiselect(true)no:SetLabel(a8)no:SetList(ma)no:SetDisabled(gf)no:SetCallback("OnValueChanged",n3)no:SetCallback("OnClosed",nd)local dv=mv("width",ac,l4,hj,l8)if dv=="double"then no:SetWidth(mp*2)elseif dv=="half"then no:SetWidth(mp/2)elseif type(dv)=="number"then no:SetWidth(mp*dv)elseif dv=="full"then no.width="fill"else no:SetWidth(mp)end;for lZ=1,#nB do local o=nB[lZ]local bw=mv("get",ac,l4,hj,l8,o)no:SetItemValue(o,bw)end else no=mk:Create("InlineGroup")no:SetLayout("Flow")no:SetTitle(a8)no.width="fill"no:PauseLayout()local dv=mv("width",ac,l4,hj,l8)for lZ=1,#nB do local bw=nB[lZ]local ff=ma[bw]local i1=mk:Create("CheckBox")i1:SetLabel(ff)i1:SetUserData("value",bw)i1:SetUserData("text",ff)i1:SetDisabled(gf)i1:SetTriState(ac.tristate)i1:SetValue(mv("get",ac,l4,hj,l8,bw))i1:SetCallback("OnValueChanged",nc)nn(i1,l4,ac,hj,m_,l8)no:AddChild(i1)if dv=="double"then i1:SetWidth(mp*2)elseif dv=="half"then i1:SetWidth(mp/2)elseif type(dv)=="number"then i1:SetWidth(mp*dv)elseif dv=="full"then i1.width="fill"else i1:SetWidth(mp)end end;no:ResumeLayout()no:DoLayout()end;gw(nB)elseif ac.type=="color"then no=np(ac.dialogControl or ac.control,"ColorPicker")no:SetLabel(a8)no:SetHasAlpha(mv("hasAlpha",ac,l4,hj,l8))no:SetColor(mv("get",ac,l4,hj,l8))no:SetCallback("OnValueChanged",n3)no:SetCallback("OnValueConfirmed",n3)elseif ac.type=="keybinding"then no=np(ac.dialogControl or ac.control,"Keybinding")no:SetLabel(a8)no:SetKey(mv("get",ac,l4,hj,l8))no:SetCallback("OnKeyChanged",n3)elseif ac.type=="header"then no=np(ac.dialogControl or ac.control,"Heading")no:SetText(a8)no.width="fill"elseif ac.type=="description"then no=np(ac.dialogControl or ac.control,"Label")no:SetText(a8)local nD=mv("fontSize",ac,l4,hj,l8)if nD=="medium"then no:SetFontObject(GameFontHighlight)elseif nD=="large"then no:SetFontObject(GameFontHighlightLarge)else no:SetFontObject(GameFontHighlightSmall)end;local nw=mv("imageCoords",ac,l4,hj,l8)local i7,dv,dw=mv("image",ac,l4,hj,l8)if type(i7)=="string"or type(i7)=="number"then if not dv then dv=mv("imageWidth",ac,l4,hj,l8)end;if not dw then dw=mv("imageHeight",ac,l4,hj,l8)end;if type(nw)=="table"then no:SetImage(i7,unpack(nw))else no:SetImage(i7)end;if type(dv)~="number"then dv=32 end;if type(dw)~="number"then dw=32 end;no:SetImageSize(dv,dw)end;local nE=mv("width",ac,l4,hj,l8)no.width=not nE and"fill"end;if no then if no.width~="fill"then local dv=mv("width",ac,l4,hj,l8)if dv=="double"then no:SetWidth(mp*2)elseif dv=="half"then no:SetWidth(mp/2)elseif type(dv)=="number"then no:SetWidth(mp*dv)elseif dv=="full"then no.width="fill"else no:SetWidth(mp)end end;if no.SetDisabled then local gf=ng(ac,l4,hj,l8)no:SetDisabled(gf)end;nn(no,l4,ac,hj,m_,l8)nu:AddChild(no)end end end;O(hj)end;nu:ResumeLayout()nu:DoLayout()gw(mJ)gw(mK)end;local function nF(hj,...)for J=1,select("#",...)do M(hj,(select(J,...)))end end;local function nG(dr,C,gL,gD)local mO=dr:GetUserDataTable()if not mO then return end;local l4=mO.options;local mx=mO.option;local hj=mO.path;local l8=mO.appName;local gV=mm.tooltip;local nH=aF()for J=1,#hj do nH[J]=hj[J]end;nF(nH,("\001"):split(gL))local eV=l4;for J=1,#nH do if not eV then return end;eV=mr(eV,nH[J])end;local a8=mv("name",eV,l4,nH,l8)local i6=mv("desc",eV,l4,nH,l8)gV:SetOwner(gD,"ANCHOR_NONE")gV:ClearAllPoints()if dr.type=="TabGroup"then gV:SetPoint("BOTTOM",gD,"TOP")else gV:SetPoint("LEFT",gD,"RIGHT")end;gV:SetText(a8,1,.82,0,true)if type(i6)=="string"then gV:AddLine(i6,1,1,1,true)end;gV:Show()end;local function nI(dr,C,bw,gD)mm.tooltip:Hide()end;local function nJ(l8,l4,hj,gL)if not gL then return false end;local nH=aF()local nK=aF()for J=1,#hj do nH[J]=hj[J]end;nF(nH,("\001"):split(gL))local eV=l4;for J=1,#nH do local ac=nH[J]nK[J]=ac;eV=mr(eV,ac)if not eV or eV.type~="group"or nf(eV,l4,nK,l8)then gw(nH)gw(nK)return false end end;gw(nH)gw(nK)return true end;local function nL(dr,C,gL)local mO=dr:GetUserDataTable()local l4=mO.options;local mx=mO.option;local hj=mO.path;local m_=mO.rootframe;local nH=aF()for J=1,#hj do nH[J]=hj[J]end;nF(nH,("\001"):split(gL))dr:ReleaseChildren()mm:FeedGroup(mO.appName,l4,dr,m_,nH)gw(nH)end;function mm:FeedGroup(l8,l4,nu,m_,hj,nM)local eV=l4;local ni;local nN,nO=l4.childGroups,"none"for J=1,#hj do local ac=hj[J]eV=mr(eV,ac)ni=ni or lp(ac.dialogInline,ac.guiInline,ac.inline,false)nO=nN;nN=eV.childGroups end;if not nO then nO="tree"end;local nP;for ab,ac in pairs(eV.args)do if ac.type=="group"and not lp(ac.dialogInline,ac.guiInline,ac.inline,false)and not nf(ac,l4,hj,l8)then nP=true end end;if eV.plugins then for l7,aS in pairs(eV.plugins)do for ab,ac in pairs(aS)do if ac.type=="group"and not lp(ac.dialogInline,ac.guiInline,ac.inline,false)and not nf(ac,l4,hj,l8)then nP=true end end end end;nu:SetLayout("flow")local nQ;if not(nP and not ni)or nN~="tab"and nN~="select"and(nO=="tree"and not nM)then if nu.type~="InlineGroup"and nu.type~="SimpleGroup"then nQ=mk:Create("ScrollFrame")nQ:SetLayout("flow")nQ.width="fill"nQ.height="fill"nu:SetLayout("fill")nu:AddChild(nQ)nu=nQ end end;nt(l8,l4,nu,m_,hj,eV,nil)if nQ then nu:PerformLayout()local eW=self:GetStatusTable(l8,hj)if not eW.scroll then eW.scroll={}end;nQ:SetStatusTable(eW.scroll)end;if nP and not ni then local a8=mv("name",eV,l4,hj,l8)if nN=="tab"then local fO=mk:Create("TabGroup")nn(fO,l4,eV,hj,m_,l8)fO:SetCallback("OnGroupSelected",nL)fO:SetCallback("OnTabEnter",nG)fO:SetCallback("OnTabLeave",nI)local eW=mm:GetStatusTable(l8,hj)if not eW.groups then eW.groups={}end;fO:SetStatusTable(eW.groups)fO.width="fill"fO.height="fill"local gn=nl(eV,l4,hj,l8)fO:SetTabs(gn)fO:SetUserData("tablist",gn)for J=1,#gn do local nk=gn[J]if not nk.disabled then fO:SelectTab(nJ(l8,l4,hj,eW.groups.selected)and eW.groups.selected or nk.value)break end end;nu:AddChild(fO)elseif nN=="select"then local nR=mk:Create("DropdownGroup")nR:SetTitle(a8)nn(nR,l4,eV,hj,m_,l8)nR:SetCallback("OnGroupSelected",nL)local eW=mm:GetStatusTable(l8,hj)if not eW.groups then eW.groups={}end;nR:SetStatusTable(eW.groups)local nS,nT=nh(eV,l4,hj,l8)nR:SetGroupList(nS,nT)nR:SetUserData("grouplist",nS)nR:SetUserData("orderlist",nT)local nU=nT[1]if nU then nR:SetGroup(nJ(l8,l4,hj,eW.groups.selected)and eW.groups.selected or nU)end;nR.width="fill"nR.height="fill"nu:AddChild(nR)elseif nO~="tree"or nM then local gN=mk:Create("TreeGroup")nn(gN,l4,eV,hj,m_,l8)gN:EnableButtonTooltips(false)gN.width="fill"gN.height="fill"gN:SetCallback("OnGroupSelected",nL)gN:SetCallback("OnButtonEnter",nG)gN:SetCallback("OnButtonLeave",nI)local eW=mm:GetStatusTable(l8,hj)if not eW.groups then eW.groups={}end;local nV=nl(eV,l4,hj,l8,true)gN:SetStatusTable(eW.groups)gN:SetTree(nV)gN:SetUserData("tree",nV)for J=1,#nV do local nk=nV[J]if not nk.disabled then gN:SelectByValue(nJ(l8,l4,hj,eW.groups.selected)and eW.groups.selected or nk.value)break end end;nu:AddChild(gN)end end end;local nW;local function nX(aw)for l8 in pairs(aw.closing)do if mm.OpenFrames[l8]then mm.OpenFrames[l8]:Hide()end;if mm.BlizOptions and mm.BlizOptions[l8]then for o,dr in pairs(mm.BlizOptions[l8])do if not dr:IsVisible()then dr:ReleaseChildren()end end end;aw.closing[l8]=nil end;if aw.closeAll then for ab,ac in pairs(mm.OpenFrames)do if not aw.closeAllOverride[ab]then ac:Hide()end end;aw.closeAll=nil;de(aw.closeAllOverride)end;for l8 in pairs(aw.apps)do if mm.OpenFrames[l8]then local mO=mm.OpenFrames[l8]:GetUserDataTable()mm:Open(l8,unpack(mO.basepath or mo))end;if mm.BlizOptions and mm.BlizOptions[l8]then for o,dr in pairs(mm.BlizOptions[l8])do local mO=dr:GetUserDataTable()if dr:IsVisible()then mm:Open(dr:GetUserData("appName"),dr,unpack(mO.basepath or mo))end end end;aw.apps[l8]=nil end;aw:SetScript("OnUpdate",nil)end;if mm.frame:GetScript("OnUpdate")then mm.frame:SetScript("OnUpdate",nX)end;function mm:CloseAll()mm.frame.closeAll=true;mm.frame:SetScript("OnUpdate",nX)if next(self.OpenFrames)then return true end end;function mm:Close(l8)if self.OpenFrames[l8]then mm.frame.closing[l8]=true;mm.frame:SetScript("OnUpdate",nX)return true end end;function mm:ConfigTableChanged(C,l8)mm.frame.apps[l8]=true;mm.frame:SetScript("OnUpdate",nX)end;ml.RegisterCallback(mm,"ConfigTableChange","ConfigTableChanged")function mm:SetDefaultSize(l8,dv,dw)local eW=mm:GetStatusTable(l8)if type(dv)=="number"and type(dw)=="number"then eW.width=dv;eW.height=dw end end;function mm:Open(l8,nu,...)if not nW then nW=CloseSpecialWindows;CloseSpecialWindows=function()local gm=nW()return self:CloseAll()or gm end end;local cR=ml:GetOptionsTable(l8)if not cR then error(("%s isn't registed with AceConfigRegistry, unable to open config"):format(l8),2)end;local l4=cR("dialog",i)local eu;local hj=aF()local a8=mv("name",l4,l4,hj,l8)if type(nu)=="string"then M(hj,nu)nu=nil end;for cZ=1,select("#",...)do M(hj,(select(cZ,...)))end;local mx=l4;if type(nu)=="table"and nu.type=="BlizOptionsGroup"and#hj>0 then for J=1,#hj do mx=l4.args[hj[J]]end;a8=be("%s - %s",a8,mv("name",mx,l4,hj,l8))end;if nu then eu=nu;eu:ReleaseChildren()eu:SetUserData("appName",l8)eu:SetUserData("iscustom",true)if#hj>0 then eu:SetUserData("basepath",mq(hj))end;local eW=mm:GetStatusTable(l8)if not eW.width then eW.width=700 end;if not eW.height then eW.height=500 end;if eu.SetStatusTable then eu:SetStatusTable(eW)end;if eu.SetTitle then eu:SetTitle(a8 or"")end else if not self.OpenFrames[l8]then eu=mk:Create("Frame")self.OpenFrames[l8]=eu else eu=self.OpenFrames[l8]end;eu:ReleaseChildren()eu:SetCallback("OnClose",ne)eu:SetUserData("appName",l8)if#hj>0 then eu:SetUserData("basepath",mq(hj))end;eu:SetTitle(a8 or"")local eW=mm:GetStatusTable(l8)eu:SetStatusTable(eW)end;self:FeedGroup(l8,l4,eu,eu,hj,true)if eu.Show then eu:Show()end;gw(hj)if mm.frame.closeAll then mm.frame.closeAllOverride[l8]=true end end;if f and f<39 and mm.BlizOptions then local lD=mm.BlizOptions;local nY={}for o,dr in pairs(lD)do local l8=dr:GetUserData("appName")if not nY[l8]then nY[l8]={}end;nY[l8][o]=dr end;mm.BlizOptions=nY else mm.BlizOptions=mm.BlizOptions or{}end;local function nZ(dr,C)local hj=dr:GetUserData("path")mm:Open(dr:GetUserData("appName"),dr,unpack(hj or mo))end;local function n_(dr,C)local l8=dr:GetUserData("appName")mm.frame.closing[l8]=true;mm.frame:SetScript("OnUpdate",nX)end;function mm:AddToBlizOptions(l8,a8,cb,...)local o0=mm.BlizOptions;local o=l8;for cZ=1,select("#",...)do o=o.."\001"..select(cZ,...)end;if not o0[l8]then o0[l8]={}end;if not o0[l8][o]then local eV=mk:Create("BlizOptionsGroup")o0[l8][o]=eV;eV:SetTitle(a8 or l8)eV:SetUserData("appName",l8)if select("#",...)>0 then local hj={}for cZ=1,select("#",...)do M(hj,(select(cZ,...)))end;eV:SetUserData("path",hj)end;eV:SetCallback("OnShow",nZ)eV:SetCallback("OnHide",n_)if Settings and Settings.RegisterCanvasLayoutCategory then local o1=a8 or l8;if cb then local o2=Settings.GetCategory(cb)if not o2 then error(("The parent category '%s' was not found"):format(cb),2)end;local o3=Settings.RegisterCanvasLayoutSubcategory(o2,eV.frame,o1)eV:SetName(o3.ID,cb)else local o2=Settings.RegisterCanvasLayoutCategory(eV.frame,o1)o2.ID=o1;eV:SetName(o1,cb)Settings.RegisterAddOnCategory(o2)end else eV:SetName(a8 or l8,cb)InterfaceOptions_AddCategory(eV.frame)end;return eV.frame,eV.frame.name else error(("%s has already been added to the Blizzard Options Window with the given path"):format(l8),2)end end end;local function o4(...)local le=LibStub("AceConfigRegistry-3.0")local o5=LibStub("AceConfigCmd-3.0")local i,k="AceConfig-3.0",3;local o6=LibStub:NewLibrary(i,k)if not o6 then return end;local pcall,error,type,pairs=pcall,error,type,pairs;function o6:RegisterOptionsTable(l8,l4,mh)local mc,jZ=pcall(le.RegisterOptionsTable,self,l8,l4)if not mc then error(jZ,2)end;if mh then if type(mh)=="table"then for aT,o7 in pairs(mh)do o5:CreateChatCommand(o7,l8)end else o5:CreateChatCommand(mh,l8)end end end end;local function o8(...)local o9=24;local _G=_G;if _G.ChatThrottleLib then if _G.ChatThrottleLib.version>=o9 then return elseif not _G.ChatThrottleLib.securelyHooked then print("ChatThrottleLib: Warning: There's an ANCIENT ChatThrottleLib.lua (pre-wow 2.0, <v16) in an addon somewhere. Get the addon updated or copy in a newer ChatThrottleLib.lua (>=v16) in it!")_G.SendChatMessage=_G.ChatThrottleLib.ORIG_SendChatMessage;if _G.ChatThrottleLib.ORIG_SendAddonMessage then _G.SendAddonMessage=_G.ChatThrottleLib.ORIG_SendAddonMessage end end;_G.ChatThrottleLib.ORIG_SendChatMessage=nil;_G.ChatThrottleLib.ORIG_SendAddonMessage=nil end;if not _G.ChatThrottleLib then _G.ChatThrottleLib={}end;ChatThrottleLib=_G.ChatThrottleLib;local ChatThrottleLib=_G.ChatThrottleLib;ChatThrottleLib.version=o9;ChatThrottleLib.MAX_CPS=800;ChatThrottleLib.MSG_OVERHEAD=40;ChatThrottleLib.BURST=4000;ChatThrottleLib.MIN_FPS=20;local setmetatable=setmetatable;local oa=table.remove;local tostring=tostring;local GetTime=GetTime;local dg=math.min;local df=math.max;local next=next;local ob=string.len;local GetFramerate=GetFramerate;local lj=string.lower;local unpack,type,pairs,de=unpack,type,pairs,table.wipe;local UnitInRaid,UnitInParty=UnitInRaid,UnitInParty;local oc={}local od={__index=oc}function oc:New()local du={}setmetatable(du,od)return du end;function oc:Add(bo)if self.pos then bo.prev=self.pos.prev;bo.prev.next=bo;bo.next=self.pos;bo.next.prev=bo else bo.next=bo;bo.prev=bo;self.pos=bo end end;function oc:Remove(bo)bo.next.prev=bo.prev;bo.prev.next=bo.next;if self.pos==bo then self.pos=bo.next;if self.pos==bo then self.pos=nil end end end;ChatThrottleLib.PipeBin=nil;local oe=setmetatable({},{__mode="k"})local function of(og)oe[og]=true end;local function oh()local og=next(oe)if og then de(og)oe[og]=nil;return og end;return{}end;ChatThrottleLib.MsgBin=nil;local oi=setmetatable({},{__mode="k"})local function oj(jZ)jZ[1]=nil;oi[jZ]=true end;local function ok()local jZ=next(oi)if jZ then oi[jZ]=nil;return jZ end;return{}end;function ChatThrottleLib:Init()if not self.Prio then self.Prio={}self.Prio["ALERT"]={ByName={},Ring=oc:New(),avail=0}self.Prio["NORMAL"]={ByName={},Ring=oc:New(),avail=0}self.Prio["BULK"]={ByName={},Ring=oc:New(),avail=0}end;for aT,ol in pairs(self.Prio)do ol.nTotalSent=ol.nTotalSent or 0 end;if not self.avail then self.avail=0 end;if not self.nTotalSent then self.nTotalSent=0 end;if not self.Frame then self.Frame=CreateFrame("Frame")self.Frame:Hide()end;self.Frame:SetScript("OnUpdate",self.OnUpdate)self.Frame:SetScript("OnEvent",self.OnEvent)self.Frame:RegisterEvent("PLAYER_ENTERING_WORLD")self.OnUpdateDelay=0;self.LastAvailUpdate=GetTime()self.HardThrottlingBeginTime=GetTime()if not self.securelyHooked then self.securelyHooked=true;hooksecurefunc("SendChatMessage",function(...)return ChatThrottleLib.Hook_SendChatMessage(...)end)if _G.C_ChatInfo then hooksecurefunc(_G.C_ChatInfo,"SendAddonMessage",function(...)return ChatThrottleLib.Hook_SendAddonMessage(...)end)else hooksecurefunc("SendAddonMessage",function(...)return ChatThrottleLib.Hook_SendAddonMessage(...)end)end end;self.nBypass=0 end;local om=false;function ChatThrottleLib.Hook_SendChatMessage(ff,on,oo,op,...)if om then return end;local self=ChatThrottleLib;local i5=ob(tostring(ff or""))+ob(tostring(op or""))+self.MSG_OVERHEAD;self.avail=self.avail-i5;self.nBypass=self.nBypass+i5 end;function ChatThrottleLib.Hook_SendAddonMessage(oq,ff,on,op,...)if om then return end;local self=ChatThrottleLib;local i5=tostring(ff or""):len()+tostring(oq or""):len()i5=i5+tostring(op or""):len()+self.MSG_OVERHEAD;self.avail=self.avail-i5;self.nBypass=self.nBypass+i5 end;function ChatThrottleLib:UpdateAvail()local os=GetTime()local ot=self.MAX_CPS;local ou=ot*(os-self.LastAvailUpdate)local ov=self.avail;if os-self.HardThrottlingBeginTime<5 then ov=dg(ov+ou*0.1,ot*0.5)self.bChoking=true elseif GetFramerate()<self.MIN_FPS then ov=dg(ot,ov+ou*0.5)self.bChoking=true else ov=dg(self.BURST,ov+ou)self.bChoking=false end;ov=df(ov,0-ot*2)self.avail=ov;self.LastAvailUpdate=os;return ov end;function ChatThrottleLib:Despool(ol)local ow=ol.Ring;while ow.pos and ol.avail>ow.pos[1].nSize do local jZ=oa(ow.pos,1)if not ow.pos[1]then local og=ol.Ring.pos;ol.Ring:Remove(og)ol.ByName[og.name]=nil;of(og)else ol.Ring.pos=ol.Ring.pos.next end;local ox=false;local oy=lj(jZ[3]or"")if oy=="raid"and not UnitInRaid("player")then elseif oy=="party"and not UnitInParty("player")then else ol.avail=ol.avail-jZ.nSize;om=true;jZ.f(unpack(jZ,1,jZ.n))om=false;ol.nTotalSent=ol.nTotalSent+jZ.nSize;oj(jZ)ox=true end;if jZ.callbackFn then jZ.callbackFn(jZ.callbackArg,ox)end end end;function ChatThrottleLib.OnEvent(aw,C)local self=ChatThrottleLib;if C=="PLAYER_ENTERING_WORLD"then self.HardThrottlingBeginTime=GetTime()self.avail=0 end end;function ChatThrottleLib.OnUpdate(aw,aH)local self=ChatThrottleLib;self.OnUpdateDelay=self.OnUpdateDelay+aH;if self.OnUpdateDelay<0.08 then return end;self.OnUpdateDelay=0;self:UpdateAvail()if self.avail<0 then return end;local cZ=0;for oz,ol in pairs(self.Prio)do if ol.Ring.pos or ol.avail<0 then cZ=cZ+1 end end;if cZ<1 then for oz,ol in pairs(self.Prio)do self.avail=self.avail+ol.avail;ol.avail=0 end;self.bQueueing=false;self.Frame:Hide()return end;local ov=self.avail/cZ;self.avail=0;for oz,ol in pairs(self.Prio)do if ol.Ring.pos or ol.avail<0 then ol.avail=ol.avail+ov;if ol.Ring.pos and ol.avail>ol.Ring.pos[1].nSize then self:Despool(ol)end end end end;function ChatThrottleLib:Enqueue(oz,oA,jZ)local ol=self.Prio[oz]local og=ol.ByName[oA]if not og then self.Frame:Show()og=oh()og.name=oA;ol.ByName[oA]=og;ol.Ring:Add(og)end;og[#og+1]=jZ;self.bQueueing=true end;function ChatThrottleLib:SendChatMessage(oB,oq,ff,on,oo,op,oC,oD,oE)if not self or not oB or not oq or not ff or not self.Prio[oB]then error('Usage: ChatThrottleLib:SendChatMessage("{BULK||NORMAL||ALERT}", "prefix", "text"[, "chattype"[, "language"[, "destination"]]]',2)end;if oD and type(oD)~="function"then error('ChatThrottleLib:ChatMessage(): callbackFn: expected function, got '..type(oD),2)end;local oF=ff:len()if oF>255 then error("ChatThrottleLib:SendChatMessage(): message length cannot exceed 255 bytes",2)end;oF=oF+self.MSG_OVERHEAD;if not self.bQueueing and oF<self:UpdateAvail()then self.avail=self.avail-oF;om=true;_G.SendChatMessage(ff,on,oo,op)om=false;self.Prio[oB].nTotalSent=self.Prio[oB].nTotalSent+oF;if oD then oD(oE,true)end;return end;local jZ=ok()jZ.f=_G.SendChatMessage;jZ[1]=ff;jZ[2]=on or"SAY"jZ[3]=oo;jZ[4]=op;jZ.n=4;jZ.nSize=oF;jZ.callbackFn=oD;jZ.callbackArg=oE;self:Enqueue(oB,oC or oq..(on or"SAY")..(op or""),jZ)end;function ChatThrottleLib:SendAddonMessage(oB,oq,ff,on,u,oC,oD,oE)if not self or not oB or not oq or not ff or not on or not self.Prio[oB]then error('Usage: ChatThrottleLib:SendAddonMessage("{BULK||NORMAL||ALERT}", "prefix", "text", "chattype"[, "target"])',2)end;if oD and type(oD)~="function"then error('ChatThrottleLib:SendAddonMessage(): callbackFn: expected function, got '..type(oD),2)end;local oF=ff:len()if C_ChatInfo or RegisterAddonMessagePrefix then if oF>255 then error("ChatThrottleLib:SendAddonMessage(): message length cannot exceed 255 bytes",2)end else oF=oF+oq:len()+1;if oF>255 then error("ChatThrottleLib:SendAddonMessage(): prefix + message length cannot exceed 254 bytes",2)end end;oF=oF+self.MSG_OVERHEAD;if not self.bQueueing and oF<self:UpdateAvail()then self.avail=self.avail-oF;om=true;if _G.C_ChatInfo then _G.C_ChatInfo.SendAddonMessage(oq,ff,on,u)else _G.SendAddonMessage(oq,ff,on,u)end;om=false;self.Prio[oB].nTotalSent=self.Prio[oB].nTotalSent+oF;if oD then oD(oE,true)end;return end;local jZ=ok()jZ.f=_G.C_ChatInfo and _G.C_ChatInfo.SendAddonMessage or _G.SendAddonMessage;jZ[1]=oq;jZ[2]=ff;jZ[3]=on;jZ[4]=u;jZ.n=u~=nil and 4 or 3;jZ.nSize=oF;jZ.callbackFn=oD;jZ.callbackArg=oE;self:Enqueue(oB,oC or oq..on..(u or""),jZ)end;ChatThrottleLib:Init()end;local function oG(...)local l=LibStub("CallbackHandler-1.0")local oH=assert(ChatThrottleLib,"AceComm-3.0 requires ChatThrottleLib")local i,k="AceComm-3.0",12;local oI,f=LibStub:NewLibrary(i,k)if not oI then return end;local type,next,pairs,tostring=type,next,pairs,tostring;local cV,cU=string.sub,string.find;local oJ=string.match;local M,N=table.insert,table.concat;local error,assert=error,assert;local Ambiguate=Ambiguate;oI.embeds=oI.embeds or{}local oK="\001"local oL="\002"local oM="\003"local oN="\004"oI.multipart_origprefixes=nil;oI.multipart_reassemblers=nil;oI.multipart_spool=oI.multipart_spool or{}function oI:RegisterComm(oq,s)if s==nil then s="OnCommReceived"end;if#oq>16 then error("AceComm:RegisterComm(prefix,method): prefix length is limited to 16 characters")end;if C_ChatInfo then C_ChatInfo.RegisterAddonMessagePrefix(oq)else RegisterAddonMessagePrefix(oq)end;return oI._RegisterComm(self,oq,s)end;local oO=false;function oI:SendCommMessage(oq,ff,oP,u,oB,oD,oE)oB=oB or"NORMAL"if not(type(oq)=="string"and type(ff)=="string"and type(oP)=="string"and(u==nil or type(u)=="string"or type(u)=="number")and(oB=="BULK"or oB=="NORMAL"or oB=="ALERT"))then error('Usage: SendCommMessage(addon, "prefix", "text", "distribution"[, "target"[, "prio"[, callbackFn, callbackarg]]])',2)end;local oQ=#ff;local oR=255;local oC=oq..oP..(u or"")local oS=nil;if oD then oS=function(oT)return oD(oE,oT,oQ)end end;local oU;if oJ(ff,"^[\001-\009]")then if oQ+1>oR then oU=true else ff="\004"..ff end end;if not oU and oQ<=oR then oH:SendAddonMessage(oB,oq,ff,oP,u,oC,oS,oQ)else oR=oR-1;local oV=cV(ff,1,oR)oH:SendAddonMessage(oB,oq,oK..oV,oP,u,oC,oS,oR)local d7=1+oR;while d7+oR<=oQ do oV=cV(ff,d7,d7+oR-1)oH:SendAddonMessage(oB,oq,oL..oV,oP,u,oC,oS,d7+oR-1)d7=d7+oR end;oV=cV(ff,d7)oH:SendAddonMessage(oB,oq,oM..oV,oP,u,oC,oS,oQ)end end;do local oW=setmetatable({},{__mode="k"})local function aF()local aS=next(oW)if aS then oW[aS]=nil;for J=#aS,3,-1 do aS[J]=nil end;return aS end;return{}end;local function oX(oq,oY,oZ)DEFAULT_CHAT_FRAME:AddMessage(i..": Warning: lost network data regarding '"..tostring(oq).."' from '"..tostring(oY).."' (in "..oZ..")")end;function oI:OnReceiveMultipartFirst(oq,b6,oP,oY)local o=oq.."\t"..oP.."\t"..oY;local o_=oI.multipart_spool;o_[o]=b6 end;function oI:OnReceiveMultipartNext(oq,b6,oP,oY)local o=oq.."\t"..oP.."\t"..oY;local o_=oI.multipart_spool;local p0=o_[o]if not p0 then return end;if type(p0)~="table"then local aS=aF()aS[1]=p0;aS[2]=b6;o_[o]=aS else M(p0,b6)end end;function oI:OnReceiveMultipartLast(oq,b6,oP,oY)local o=oq.."\t"..oP.."\t"..oY;local o_=oI.multipart_spool;local p0=o_[o]if not p0 then return end;o_[o]=nil;if type(p0)=="table"then M(p0,b6)oI.callbacks:Fire(oq,N(p0,""),oP,oY)oW[p0]=true else oI.callbacks:Fire(oq,p0 ..b6,oP,oY)end end end;if not oI.callbacks then oI.callbacks=l:New(oI,"_RegisterComm","UnregisterComm","UnregisterAllComm")end;oI.callbacks.OnUsed=nil;oI.callbacks.OnUnused=nil;local function p1(self,C,oq,b6,oP,oY)if C=="CHAT_MSG_ADDON"then oY=Ambiguate(oY,"none")local no,p2=oJ(b6,"^([\001-\009])(.*)")if no then if no==oK then oI:OnReceiveMultipartFirst(oq,p2,oP,oY)elseif no==oL then oI:OnReceiveMultipartNext(oq,p2,oP,oY)elseif no==oM then oI:OnReceiveMultipartLast(oq,p2,oP,oY)elseif no==oN then oI.callbacks:Fire(oq,p2,oP,oY)else end else oI.callbacks:Fire(oq,b6,oP,oY)end else assert(false,"Received "..tostring(C).." event?!")end end;oI.frame=oI.frame or CreateFrame("Frame","AceComm30Frame")oI.frame:SetScript("OnEvent",p1)oI.frame:UnregisterAllEvents()oI.frame:RegisterEvent("CHAT_MSG_ADDON")local ao={"RegisterComm","UnregisterComm","UnregisterAllComm","SendCommMessage"}function oI:Embed(u)for ab,ac in pairs(ao)do u[ac]=self[ac]end;self.embeds[u]=true;return u end;function oI:OnEmbedDisable(u)u:UnregisterAllComm()end;for u,ac in pairs(oI.embeds)do oI:Embed(u)end end;local function p3(...)local p4,p5='AceTab-3.0',9;local p6,f=LibStub:NewLibrary(p4,p5)if not p6 then return end;p6.registry=p6.registry or{}local _G=_G;local pairs=pairs;local ipairs=ipairs;local type=type;local z=p6.registry;local cU=string.find;local cV=string.sub;local lj=string.lower;local p7=string.format;local kG=string.match;local function p8(...)DEFAULT_CHAT_FRAME:AddMessage(p7(...))end;local function p9(aw,pa)return cV(aw:GetText(),pa or 1,aw:GetCursorPosition())end;local function pb(eu)if eu.hookedByAceTab3 then return end;eu.hookedByAceTab3=true;if eu==ChatEdit_GetActiveWindow()then local pc=ChatEdit_CustomTabPressed;function ChatEdit_CustomTabPressed(...)if p6:OnTabPressed(eu)then return pc(...)else return true end end else local pd=eu:GetScript('OnTabPressed')if type(pd)~='function'then pd=function()end end;eu:SetScript('OnTabPressed',function(...)if p6:OnTabPressed(eu)then return pd(...)end end)end;eu.at3curMatch=0;eu.at3matches={}end;local pe,pf={},{}local pg={}function p6:RegisterTabCompletion(ph,pi,pj,pk,pl,pm,pn)if type(ph)~='string'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'descriptor' - string expected.",3)end;if pi and type(pi)~='string'and type(pi)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'prematches' - string, table, or nil expected.",3)end;if type(pj)~='function'and type(pj)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'wordlist' - function or table expected.",3)end;if pk and type(pk)~='function'and type(pk)~='boolean'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'usagefunc' - function or boolean expected.",3)end;if pl and type(pl)~='string'and type(pl)~='table'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'listenframes' - string or table expected.",3)end;if pm and type(pm)~='function'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'postfunc' - function expected.",3)end;if pn and type(pn)~='boolean'and type(pn)~='number'then error("Usage: RegisterTabCompletion(descriptor, prematches, wordlist, usagefunc, listenframes, postfunc, pmoverwrite): 'pmoverwrite' - boolean or number expected.",3)end;local po;if type(pi)=='table'then po=pi;pf[ph]=true else po={}if not pi then po[1]=""pe[ph]=true elseif type(pi)=='string'then po[1]=pi;if pi==""then pe[ph]=true else pf[ph]=true end end end;if not pl then pl={}for J=1,NUM_CHAT_WINDOWS do pl[J]=_G["ChatFrame"..J.."EditBox"]end elseif type(pl)~='table'or type(pl[0])=='userdata'and type(pl.IsObjectType)=='function'then pl={pl}end;for aT,eu in pairs(pl)do if type(eu)=='string'then eu=_G[eu]end;if type(eu)~='table'or type(eu[0])~='userdata'or type(eu.IsObjectType)~='function'then error(p7(p4 ..": Cannot register frame %q; it does not exist",eu:GetName()))end;if eu then if eu:GetObjectType()~='EditBox'then error(p7(p4 ..": Cannot register frame %q; it is not an EditBox",eu:GetName()))else pb(eu)end end end;if not z[ph]then z[ph]={prematches=po,wordlist=pj,usagefunc=pk,listenframes=pl,postfunc=pm,pmoverwrite=pn}end end;function p6:IsTabCompletionRegistered(ph)return z and z[ph]end;function p6:UnregisterTabCompletion(ph)z[ph]=nil;pg[ph]=nil;pe[ph]=nil;pf[ph]=nil end;local function pp(pq,pr)if not pq and not pr then return end;if not pq then pq=pr end;if not pr then pr=pq end;if#pr<#pq then pq,pr=pr,pq end;if cU(lj(pr),"^"..lj(pq))then return pq else return pp(cV(pq,1,-2),pr)end end;local ps;local pt,pu,pv,pw;local function px(aw)pu=0;pv=false;for i6,py in pairs(aw.at3matches)do for pz,pA in pairs(py)do pu=pu+1;if pu==aw.at3curMatch then aw.at3lastMatch=pz;aw.at3lastWord=pA;aw.at3curMatch=pu+1;pv=true;break end end;if pv then break end end;if not pv then aw.at3lastMatch=aw.at3origMatch;aw.at3lastWord=aw.at3origWord;aw.at3curMatch=1 end;aw:HighlightText(aw.at3matchStart-1,ps)aw:Insert(aw.at3lastWord or'')aw.at3_last_precursor=p9(aw)or''end;local IsSecureCmd=IsSecureCmd;local pB={}local pC=0;local pD,pE,pF,pG,bs;local pH,pI,pJ;local pK,pL,pM,pN,pO,pP,nk;local function pQ(aw,i6,pR)nk=z[i6]for aT,eu in ipairs(nk.listenframes)do if eu==aw then for aT,pS in ipairs(nk.prematches)do if pR then pS="%s"end;pK,pL,pM=nil,1,''pP,pO,pN=nil,nil,nil;while true do pK,pL,pM=cU(pH,"("..pS..")",pL)if pK then pN,pO,pP=pK,pL,pM;pL=pL+1 else break end end;if not pN and pR then pN,pO,pP=0,0,''end;if pN then pJ=cV(pH,pO+1)pg[i6]=nk.pmoverwrite==true and#pP or nk.pmoverwrite or 0;aw.at3matchStart=pO+1-(pg[i6]or 0)local pj=nk.wordlist;local pT=type(pj)=='table'and pj or{}if type(pj)=='function'then pj(pT,pI,pO+1,pJ)end;if pT~=false then local pU=aw.at3matches[i6]or{}for J in pairs(pU)do pU[J]=nil end;for aT,pz in ipairs(pT)do if cU(lj(pz),lj(pJ),1,1)==1 then pE=pE or not pR;pU[pz]=nk.postfunc and nk.postfunc(pz,pO+1,pI)or pz;pC=pC+1;if pC==1 then pD=pU[pz]end end end;aw.at3matches[i6]=pC>0 and pU or nil end end end end end end;function p6:OnTabPressed(aw)if aw:GetText()==''then return true end;if aw==ChatEdit_GetActiveWindow()then local c_=aw:GetText()if cU(c_,"^/[%a%d_]+$")then return true end;local o7=kG(c_,"^/[%a%d_]+")if o7 and IsSecureCmd(o7)then return true end end;ps=aw:GetCursorPosition()pI=aw:GetText()pH=p9(aw)or''aw.at3lastMatch=aw.at3curMatch>0 and(aw.at3lastMatch or aw.at3origWord)if pH==aw.at3_last_precursor then return px(aw)else for J in pairs(aw.at3matches)do aw.at3matches[J]=nil end;aw.at3curMatch=0;aw.at3origWord=nil;aw.at3origMatch=nil;aw.at3lastWord=nil;aw.at3lastMatch=nil;aw.at3_last_precursor=pH end;pC=0;pD=nil;pE=false;for J in pairs(pg)do pg[J]=nil end;for i6 in pairs(pf)do pQ(aw,i6)end;if not pE then for i6 in pairs(pe)do pQ(aw,i6,true)end end;if not pD then aw.at3_last_precursor="\0"return true end;if pC==1 then aw:HighlightText(aw.at3matchStart-1,ps)aw:Insert(pD)aw:Insert(" ")else pF=nil;for i6,pU in pairs(aw.at3matches)do if pE and pe[i6]then break end;DEFAULT_CHAT_FRAME:AddMessage(i6 ..":")local pk=z[i6].usagefunc;if not pk then for pz,pV in pairs(pU)do DEFAULT_CHAT_FRAME:AddMessage(pV)pF=pp(pF,pz)end else if type(pk)=='function'then for J in pairs(pB)do pB[J]=nil end;pG=nil;for pz in pairs(pU)do pG=pp(pG,pz)end;pF=pp(pF,pG)bs=pk(pB,pU,pG,cV(pH,1,pO))if type(bs)=='string'then DEFAULT_CHAT_FRAME:AddMessage(bs)elseif next(pB)and pC>0 then for pz,pV in pairs(pU)do if pB[pz]then DEFAULT_CHAT_FRAME:AddMessage(p7("%s - %s",pV,pB[pz]))end end end end end;if next(pU)then aw.at3curMatch=1;aw.at3origWord=cV(pH,aw.at3matchStart,aw.at3matchStart+pg[i6]-1)..pF or""aw.at3origMatch=pF or""aw.at3lastWord=aw.at3origWord;aw.at3lastMatch=aw.at3origMatch;aw:HighlightText(aw.at3matchStart-1,ps)aw:Insert(aw.at3origWord)aw.at3_last_precursor=p9(aw)or''end end end end end;local function pW(...)local i,k="AceSerializer-3.0",5;local pX,f=LibStub:NewLibrary(i,k)if not pX then return end;local pY,pZ,p_,q0,be=string.byte,string.char,string.gsub,string.gmatch,string.format;local assert,error,pcall=assert,error,pcall;local type,tostring,tonumber=type,tostring,tonumber;local pairs,select,q1=pairs,select,math.frexp;local N=table.concat;local q2=math.huge;local q3;local q4,q5="1.#INF","inf"local q6,q7="-1.#INF","-inf"local function q8(d9)local cZ=pY(d9)if cZ==30 then return"\126\122"elseif cZ<=32 then return"\126"..pZ(cZ+64)elseif cZ==94 then return"\126\125"elseif cZ==126 then return"\126\124"elseif cZ==127 then return"\126\123"else assert(false)end end;local function q9(ac,lx,qa)local aS=type(ac)if aS=="string"then lx[qa+1]="^S"lx[qa+2]=p_(ac,"[%c \94\126\127]",q8)qa=qa+2 elseif aS=="number"then local d4=tostring(ac)if tonumber(d4)==ac then lx[qa+1]="^N"lx[qa+2]=d4;qa=qa+2 elseif ac==q2 or ac==-q2 then lx[qa+1]="^N"lx[qa+2]=ac==q2 and q4 or q6;qa=qa+2 else local pz,b5=q1(ac)lx[qa+1]="^F"lx[qa+2]=be("%.0f",pz*2^53)lx[qa+3]="^f"lx[qa+4]=tostring(b5-53)qa=qa+4 end elseif aS=="table"then qa=qa+1;lx[qa]="^T"for o,bw in pairs(ac)do qa=q9(o,lx,qa)qa=q9(bw,lx,qa)end;qa=qa+1;lx[qa]="^t"elseif aS=="boolean"then qa=qa+1;if ac then lx[qa]="^B"else lx[qa]="^b"end elseif aS=="nil"then qa=qa+1;lx[qa]="^Z"else error(i..": Cannot serialize a value of type '"..aS.."'")end;return qa end;local qb={"^1"}function pX:Serialize(...)local qa=1;for J=1,select("#",...)do local ac=select(J,...)qa=q9(ac,qb,qa)end;qb[qa+1]="^^"return N(qb,"",1,qa+1)end;local function qc(qd)if qd<"~\122"then return pZ(pY(qd,2,2)-64)elseif qd=="~\122"then return"\030"elseif qd=="~\123"then return"\127"elseif qd=="~\124"then return"\126"elseif qd=="~\125"then return"\94"end;error("DeserializeStringHelper got called for '"..qd.."'?!?")end;local function qe(qf)if qf==q6 or qf==q7 then return-q2 elseif qf==q4 or qf==q5 then return q2 else return tonumber(qf)end end;local function qg(qh,qi,qj,qk)if not qi then qj,qk=qh()end;if not qj then error("Supplied data misses AceSerializer terminator ('^^')")end;if qj=="^^"then return end;local lx;if qj=="^S"then lx=p_(qk,"~.",qc)elseif qj=="^N"then lx=qe(qk)if not lx then error("Invalid serialized number: '"..tostring(qk).."'")end elseif qj=="^F"then local ql,b5=qh()if ql~="^f"then error("Invalid serialized floating-point number, expected '^f', not '"..tostring(ql).."'")end;local pz=tonumber(qk)b5=tonumber(b5)if not(pz and b5)then error("Invalid serialized floating-point number, expected mantissa and exponent, got '"..tostring(pz).."' and '"..tostring(b5).."'")end;lx=pz*2^b5 elseif qj=="^B"then lx=true elseif qj=="^b"then lx=false elseif qj=="^Z"then lx=nil elseif qj=="^T"then lx={}local ab,ac;while true do qj,qk=qh()if qj=="^t"then break end;ab=qg(qh,true,qj,qk)if ab==nil then error("Invalid AceSerializer table format (no table end marker)")end;qj,qk=qh()ac=qg(qh,true,qj,qk)if ac==nil then error("Invalid AceSerializer table format (no table end marker)")end;lx[ab]=ac end else error("Invalid AceSerializer control code '"..qj.."'")end;if not qi then return lx,qg(qh)else return lx end end;function pX:Deserialize(d4)d4=p_(d4,"[%c ]","")local qh=q0(d4,"(^.)([^^]*)")local qj,qk=qh()if not qj or qj~="^1"then return false,"Supplied data is not AceSerializer data (rev 1)"end;return pcall(qg,qh)end;pX.internals={SerializeValue=q9,SerializeStringHelper=q8}local ao={"Serialize","Deserialize"}pX.embeds=pX.embeds or{}function pX:Embed(u)for ab,ac in pairs(ao)do u[ac]=self[ac]end;self.embeds[u]=true;return u end;for u,ac in pairs(pX.embeds)do pX:Embed(u)end end;local function qm(...)BINDING_HEADER_ACE3="Ace3"BINDING_NAME_RELOADUI="ReloadUI"local mk=LibStub("AceGUI-3.0")local ml=LibStub("AceConfigRegistry-3.0")local qn=LibStub("AceConfigDialog-3.0")Ace3=LibStub("AceAddon-3.0"):NewAddon("Ace3","AceConsole-3.0")local Ace3=Ace3;local qo;local bv;local select;local eW={}local qp={}local function hr()mk:Release(bv)bv=nil end;local function qq()for a8 in ml:IterateOptionsTables()do qp[a8]=a8 end end;local function qr(dr,C,bw)qo=bw;qn:Open(bw,dr)end;local nW;function Ace3:Open()if not nW then nW=CloseSpecialWindows;CloseSpecialWindows=function()local gm=nW()if bv then bv:Hide()return true end;return gm end end;qq()if next(qp)==nil then self:Print("No Configs are Registered")return end;if not bv then bv=mk:Create("Frame")bv:ReleaseChildren()bv:SetTitle("Ace3 Options")bv:SetLayout("FILL")bv:SetCallback("OnClose",hr)select=mk:Create("DropdownGroup")select:SetGroupList(qp)select:SetCallback("OnGroupSelected",qr)bv:AddChild(select)end;if not qo then qo=next(qp)end;select:SetGroup(qo)bv:Show()end;local function nX(aw)select:SetGroup(qo)aw:SetScript("OnUpdate",nil)end;function Ace3:ConfigTableChanged(C,l8)if qo==l8 and bv then bv.frame:SetScript("OnUpdate",nX)end end;ml.RegisterCallback(Ace3,"ConfigTableChange","ConfigTableChanged")function Ace3:PrintCmd(d1)d1=d1:trim():match("^(.-);*$")local G,R=loadstring("LibStub(\"AceConsole-3.0\"):Print("..d1 ..")")if not G then LibStub("AceConsole-3.0"):Print("Error: "..R)else G()end end;function Ace3:OnInitialize()self:RegisterChatCommand("ace3",function()self:Open()end)self:RegisterChatCommand("rl",function()ReloadUI()end)self:RegisterChatCommand("print","PrintCmd")end end;local function qs(...)function __DUMPMACRO(qt)end;local i,k="ScrollingTable",tonumber("@project-timestamp@")or 40300;local af,f=LibStub:NewLibrary(i,k)if not af then return end;do af.SORT_ASC=1;af.SORT_DSC=2;local qu={["r"]=1.0,["g"]=1.0,["b"]=1.0,["a"]=1.0}local qv={["r"]=1.0,["g"]=0.9,["b"]=0.0,["a"]=0.5}local qw={["r"]=0.0,["g"]=0.0,["b"]=0.0,["a"]=0.0}local qx=2.5;local qy={bgFile="Interface\\ChatFrame\\ChatFrameBackground",edgeFile="Interface\\Tooltips\\UI-Tooltip-Border",tile=true,tileSize=16,edgeSize=16,insets={left=3,right=3,top=5,bottom=3}}local qz=function(self)self.frame:SetHeight(self.displayRows*self.rowHeight+10)self:Refresh()end;local qA=function(self)local dv=13;for fE,col in pairs(self.cols)do dv=dv+(col.width and col.width or 10)end;self.frame:SetWidth(dv+20)self:Refresh()end;local function qB(self,bv,qC)if not bv.highlight then bv.highlight=bv:CreateTexture(nil,"OVERLAY")bv.highlight:SetAllPoints(bv)end;bv.highlight:SetColorTexture(qC.r,qC.g,qC.b,qC.a)end;local qD=function(self,bv,C,bj,...)if not bj(...)then if self.DefaultEvents[C]then self.DefaultEvents[C](...)end end end;local function qE(self,y,qF)local table=self;for J,eo in ipairs(self.rows)do for j,col in ipairs(eo.cols)do if qF and self.events then for C,bj in pairs(self.events)do col:SetScript(C,nil)end end;for C,bj in pairs(y)do col:SetScript(C,function(qG,...)local qH=table.filtered[J+table.offset]table:FireUserEvent(col,C,bj,eo,qG,table.data,table.cols,J,qH,j,table,...)end)end end end;for j,col in ipairs(self.head.cols)do if qF and self.events then for C,bj in pairs(self.events)do col:SetScript(C,nil)end end;for C,bj in pairs(y)do col:SetScript(C,function(qG,...)table:FireUserEvent(col,C,bj,self.head,qG,table.data,table.cols,nil,nil,j,table,...)end)end end;self.events=y end;local function qI(self,fE,qJ)local table=self;self.displayRows=fE;self.rowHeight=qJ;if not self.rows then self.rows={}end;for J=1,fE do local eo=self.rows[J]if not eo then eo=CreateFrame("Button",self.frame:GetName().."Row"..J,self.frame)self.rows[J]=eo;if J>1 then eo:SetPoint("TOPLEFT",self.rows[J-1],"BOTTOMLEFT",0,0)eo:SetPoint("TOPRIGHT",self.rows[J-1],"BOTTOMRIGHT",0,0)else eo:SetPoint("TOPLEFT",self.frame,"TOPLEFT",4,-5)eo:SetPoint("TOPRIGHT",self.frame,"TOPRIGHT",-4,-5)end;eo:SetHeight(qJ)end;if not eo.cols then eo.cols={}end;for j=1,#self.cols do local col=eo.cols[j]if not col then col=CreateFrame("Button",eo:GetName().."col"..j,eo)col.text=eo:CreateFontString(col:GetName().."text","OVERLAY","GameFontHighlightSmall")eo.cols[j]=col;local eB=self.cols[j].align or"LEFT"col.text:SetJustifyH(eB)col:EnableMouse(true)col:RegisterForClicks("AnyUp")if self.events then for C,bj in pairs(self.events)do col:SetScript(C,function(qG,...)if table.offset then local qH=table.filtered[J+table.offset]table:FireUserEvent(col,C,bj,eo,qG,table.data,table.cols,J,qH,j,table,...)end end)end end end;if j>1 then col:SetPoint("LEFT",eo.cols[j-1],"RIGHT",0,0)else col:SetPoint("LEFT",eo,"LEFT",2,0)end;col:SetHeight(qJ)col:SetWidth(self.cols[j].width)col.text:SetPoint("TOP",col,"TOP",0,0)col.text:SetPoint("BOTTOM",col,"BOTTOM",0,0)col.text:SetWidth(self.cols[j].width-2*qx)end;j=#self.cols+1;col=eo.cols[j]while col do col:Hide()j=j+1;col=eo.cols[j]end end;for J=fE+1,#self.rows do self.rows[J]:Hide()end;self:SetHeight()end;local function qK(self,ed)local table=self;self.cols=ed;local eo=self.head;if not eo then eo=CreateFrame("Frame",self.frame:GetName().."Head",self.frame)eo:SetPoint("BOTTOMLEFT",self.frame,"TOPLEFT",4,0)eo:SetPoint("BOTTOMRIGHT",self.frame,"TOPRIGHT",-4,0)eo:SetHeight(self.rowHeight)eo.cols={}self.head=eo end;for J=1,#ed do if type(ed[J].defaultsort)=="string"then if ed[J].defaultsort:lower()=="asc"then ed[J].defaultsort=af.SORT_DSC elseif ed[J].defaultsort:lower()=="dsc"then ed[J].defaultsort=af.SORT_ASC else ed[J].defaultsort=nil end end;if type(ed[J].sort)=="string"then if ed[J].sort:lower()=="asc"then ed[J].sort=af.SORT_DSC elseif ed[J].sort:lower()=="dsc"then ed[J].sort=af.SORT_ASC else ed[J].sort=nil end end;local qL=eo:GetName().."Col"..J;local col=getglobal(qL)if not col then col=CreateFrame("Button",qL,eo)col:RegisterForClicks("AnyUp")if self.events then for C,bj in pairs(self.events)do col:SetScript(C,function(qG,...)table:FireUserEvent(col,C,bj,eo,qG,table.data,table.cols,nil,nil,J,table,...)end)end end end;eo.cols[J]=col;local qM=col:GetFontString()or col:CreateFontString(col:GetName().."fs","OVERLAY","GameFontHighlightSmall")qM:SetAllPoints(col)qM:SetPoint("LEFT",col,"LEFT",qx,0)qM:SetPoint("RIGHT",col,"RIGHT",-qx,0)local eB=ed[J].align or"LEFT"qM:SetJustifyH(eB)col:SetFontString(qM)qM:SetText(ed[J].name)qM:SetTextColor(0,1.0,1.0,1.0)col:SetPushedTextOffset(0,0)if J>1 then col:SetPoint("LEFT",eo.cols[J-1],"RIGHT",0,0)else col:SetPoint("LEFT",eo,"LEFT",2,0)end;col:SetHeight(self.rowHeight)col:SetWidth(ed[J].width)local qC=ed[J].bgcolor;if qC then local qN="col"..J.."bg"local qO=self.frame[qN]if not qO then qO=self.frame:CreateTexture(nil,"OVERLAY")self.frame[qN]=qO end;qO:SetPoint("BOTTOM",self.frame,"BOTTOM",0,4)qO:SetPoint("TOPLEFT",col,"BOTTOMLEFT",0,-4)qO:SetPoint("TOPRIGHT",col,"BOTTOMRIGHT",0,-4)qO:SetColorTexture(qC.r,qC.g,qC.b,qC.a)end end;self:SetDisplayRows(self.displayRows,self.rowHeight)self:SetWidth()end;local function hD(self)self.frame:Show()self.scrollframe:Show()self.showing=true end;local function hC(self)self.frame:Hide()self.showing=false end;local function qP(self)if not self.sorttable or#self.sorttable~=#self.data then self.sorttable={}end;if#self.sorttable~=#self.data then for J=1,#self.data do self.sorttable[J]=J end end;local J,qQ=1,nil;while J<=#self.cols and not qQ do if self.cols[J].sort then qQ=J end;J=J+1 end;if qQ then table.sort(self.sorttable,function(qR,qS)local qT=self.cols[qQ]if qT.comparesort then return qT.comparesort(self,qR,qS,qQ)else return self:CompareSort(qR,qS,qQ)end end)end;self.filtered=self:DoFilter()self:Refresh()end;local qU=function(d4)if d4==""then return 0 else return tonumber(d4)end end;local function qV(self,qR,qS,qW)local qX,qY=self:GetCell(qR,qW),self:GetCell(qS,qW)local qZ,q_=qX,qY;if type(qZ)=='table'then qZ=qZ.value end;if type(q_)=='table'then q_=q_.value end;local qT=self.cols[qW]if type(qZ)=="function"then if qX.args then qZ=qZ(unpack(qX.args))else qZ=qZ(self.data,self.cols,qR,qW,self)end end;if type(q_)=="function"then if qY.args then q_=q_(unpack(qY.args))else q_=q_(self.data,self.cols,qS,qW,self)end end;if type(qZ)~=type(q_)then local r0,r1=type(qZ),type(q_)if r0=="number"and r1=="string"then if tonumber(q_)then q_=qU(q_)else qZ=tostring(qZ)end elseif r0=="string"and r1=="number"then if tonumber(qZ)then qZ=qU(qZ)else q_=tostring(q_)end end end;if qZ==q_ then if qT.sortnext then local r2=self.cols[qT.sortnext]if not r2.sort then if r2.comparesort then return r2.comparesort(self,qR,qS,qT.sortnext)else return self:CompareSort(qR,qS,qT.sortnext)end else return false end else return false end else local jV=qT.sort or qT.defaultsort or af.SORT_DSC;if jV==af.SORT_ASC then return qZ<q_ else return qZ>q_ end end end;local r3=function(self,r4)return true end;local function r5(self,r3)self.Filter=r3;self:SortData()end;local r6=function(self)local gO={}for eo=1,#self.data do local r7=self.sorttable[eo]local r8=self:GetRow(r7)if self:Filter(r8)then table.insert(gO,r7)end end;return gO end;function GetDefaultHighlightBlank(self)return self.defaulthighlightblank end;function SetDefaultHighlightBlank(self,r9,ra,rb,rc)if not self.defaulthighlightblank then self.defaulthighlightblank=qw end;if r9 then self.defaulthighlightblank["r"]=r9 end;if ra then self.defaulthighlightblank["g"]=ra end;if rb then self.defaulthighlightblank["b"]=rb end;if rc then self.defaulthighlightblank["a"]=rc end end;function GetDefaultHighlight(self)return self.defaulthighlight end;function SetDefaultHighlight(self,r9,ra,rb,rc)if not self.defaulthighlight then self.defaulthighlight=qv end;if r9 then self.defaulthighlight["r"]=r9 end;if ra then self.defaulthighlight["g"]=ra end;if rb then self.defaulthighlight["b"]=rb end;if rc then self.defaulthighlight["a"]=rc end end;local function rd(self,re)self.fSelect=re end;local function rf(self)self:SetSelection(nil)end;local function rg(self,r7)self.selected=r7;self:Refresh()end;local function rh(self)return self.selected end;local function ri(rj,qG,qk,ed,eo,r7,qT,rk,table,...)if rk then local r4=table:GetRow(r7)local rl=table:GetCell(r4,qT)local rm=rl;if type(rl)=="table"then rm=rl.value end;if type(rm)=="function"then if rl.args then qG.text:SetText(rm(unpack(rl.args)))else qG.text:SetText(rm(qk,ed,r7,qT,table))end else qG.text:SetText(rm)end;local qC=nil;if type(rl)=="table"then qC=rl.color end;local rn=nil;if not qC then qC=ed[qT].color;if not qC then qC=r4.color;if not qC then qC=qu else rn=r4.colorargs end else rn=ed[qT].colorargs end else rn=rl.colorargs end;if type(qC)=="function"then if rn then qC=qC(unpack(rn))else qC=qC(qk,ed,r7,qT,table)end end;qG.text:SetTextColor(qC.r,qC.g,qC.b,qC.a)local i4=nil;if type(rl)=="table"then i4=rl.highlight end;if table.fSelect then if table.selected==r7 then table:SetHighLightColor(rj,i4 or ed[qT].highlight or r4.highlight or table:GetDefaultHighlight())else table:SetHighLightColor(rj,table:GetDefaultHighlightBlank())end end else qG.text:SetText("")end end;local function ro(self,qk,rp)self.isMinimalDataformat=rp;self.data=qk;self:SortData()end;local function rq(self,r7)return self.data[r7]end;local function rr(self,eo,col)local r4=eo;if type(eo)=="number"then r4=self:GetRow(eo)end;if self.isMinimalDataformat then return r4[col]else return r4.cols[col]end end;local function rs(self,r7)local rt=1+(self.offset or 0)local ru=rt+self.displayRows-1;for J=rt,ru do if self.filtered[J]==r7 and r7~=nil then return true end end;return false end;function af:CreateST(ed,rv,qJ,i4,cb)local rw={}self.framecount=self.framecount or 1;local eu=CreateFrame("Frame","ScrollTable"..self.framecount,cb or UIParent,BackdropTemplateMixin and"BackdropTemplate")self.framecount=self.framecount+1;rw.showing=true;rw.frame=eu;rw.Show=hD;rw.Hide=hC;rw.SetDisplayRows=qI;rw.SetRowHeight=SetRowHeight;rw.SetHeight=qz;rw.SetWidth=qA;rw.SetDisplayCols=qK;rw.SetData=ro;rw.SortData=qP;rw.CompareSort=qV;rw.RegisterEvents=qE;rw.FireUserEvent=qD;rw.SetDefaultHighlightBlank=SetDefaultHighlightBlank;rw.SetDefaultHighlight=SetDefaultHighlight;rw.GetDefaultHighlightBlank=GetDefaultHighlightBlank;rw.GetDefaultHighlight=GetDefaultHighlight;rw.EnableSelection=rd;rw.SetHighLightColor=qB;rw.ClearSelection=rf;rw.SetSelection=rg;rw.GetSelection=rh;rw.GetCell=rr;rw.GetRow=rq;rw.DoCellUpdate=ri;rw.IsRowVisible=rs;rw.RowIsVisible=rs;rw.SetFilter=r5;rw.DoFilter=r6;i4=i4 or{}rw:SetDefaultHighlight(i4["r"],i4["g"],i4["b"],i4["a"])rw:SetDefaultHighlightBlank()rw.displayRows=rv or 12;rw.rowHeight=qJ or 15;rw.cols=ed;rw.DefaultEvents={["OnEnter"]=function(rj,qG,qk,ed,eo,r7,qT,table,...)if eo and r7 then local r4=table:GetRow(r7)local rl=table:GetCell(r4,qT)local i4=nil;if type(rl)=="table"then i4=rl.highlight end;table:SetHighLightColor(rj,i4 or ed[qT].highlight or r4.highlight or table:GetDefaultHighlight())end;return true end,["OnLeave"]=function(rj,qG,qk,ed,eo,r7,qT,table,...)if eo and r7 then local r4=table:GetRow(r7)local rl=table:GetCell(r4,qT)if r7~=table.selected or not table.fSelect then table:SetHighLightColor(rj,table:GetDefaultHighlightBlank())end end;return true end,["OnClick"]=function(rj,qG,qk,ed,eo,r7,qT,table,gD,...)if gD=="LeftButton"then if not(eo or r7)then for J,col in ipairs(rw.cols)do if J~=qT then ed[J].sort=nil end end;local rx=af.SORT_DSC;if not ed[qT].sort and ed[qT].defaultsort then rx=ed[qT].defaultsort elseif ed[qT].sort and ed[qT].sort==af.SORT_DSC then rx=af.SORT_ASC end;ed[qT].sort=rx;table:SortData()else if table:GetSelection()==r7 then table:ClearSelection()else table:SetSelection(r7)end end;return true end end}rw.data={}eu:SetBackdrop(qy)eu:SetBackdropColor(0.1,0.1,0.1)eu:SetPoint("CENTER",cb or UIParent,"CENTER",0,0)local fF=CreateFrame("ScrollFrame",eu:GetName().."ScrollFrame",eu,"FauxScrollFrameTemplate")rw.scrollframe=fF;fF:Show()fF:SetScript("OnHide",function(self,...)self:Show()end)fF:SetPoint("TOPLEFT",eu,"TOPLEFT",0,-4)fF:SetPoint("BOTTOMRIGHT",eu,"BOTTOMRIGHT",-26,3)local ry=CreateFrame("Frame",eu:GetName().."ScrollTrough",fF)ry:SetWidth(17)ry:SetPoint("TOPRIGHT",eu,"TOPRIGHT",-4,-3)ry:SetPoint("BOTTOMRIGHT",eu,"BOTTOMRIGHT",-4,4)ry.background=ry:CreateTexture(nil,"BACKGROUND")ry.background:SetAllPoints(ry)ry.background:SetColorTexture(0.05,0.05,0.05,1.0)local rz=CreateFrame("Frame",eu:GetName().."ScrollTroughBorder",fF)rz:SetWidth(1)rz:SetPoint("TOPRIGHT",ry,"TOPLEFT")rz:SetPoint("BOTTOMRIGHT",ry,"BOTTOMLEFT")rz.background=ry:CreateTexture(nil,"BACKGROUND")rz.background:SetAllPoints(rz)rz.background:SetColorTexture(0.5,0.5,0.5,1.0)rw.Refresh=function(self)FauxScrollFrame_Update(fF,#rw.filtered,rw.displayRows,rw.rowHeight)local rA=FauxScrollFrame_GetOffset(fF)rw.offset=rA;for J=1,rw.displayRows do local eo=J+rA;if rw.rows then local rj=rw.rows[J]local r7=rw.filtered[eo]local r8=rw:GetRow(r7)local rk=true;for col=1,#rw.cols do local qG=rj.cols[col]local rB=rw.DoCellUpdate;if r8 then rw.rows[J]:Show()local rC=rw:GetCell(r8,col)if type(rC)=="table"and rC.DoCellUpdate then rB=rC.DoCellUpdate elseif rw.cols[col].DoCellUpdate then rB=rw.cols[col].DoCellUpdate elseif r8.DoCellUpdate then rB=r8.DoCellUpdate end else rw.rows[J]:Hide()rk=false end;rB(rj,qG,rw.data,rw.cols,eo,rw.filtered[eo],col,rk,rw)end end end end;fF:SetScript("OnVerticalScroll",function(self,ae)FauxScrollFrame_OnVerticalScroll(self,ae,rw.rowHeight,function()rw:Refresh()end)end)rw:SetFilter(r3)rw:SetDisplayCols(rw.cols)rw:RegisterEvents(rw.DefaultEvents)return rw end end end;local function rD(...)function _iter_props(bo)for ab,ac in pairs(bo)do print("k: "..ab.." v: "..type(ac))end end;local eH,dJ="SearchTable",28;local dd=LibStub and LibStub("AceGUI-3.0",true)local rE=LibStub("ScrollingTable")if not dd or(dd:GetWidgetVersion(eH)or 0)>=dJ then return end;local tostring,pairs=tostring,pairs;local PlaySound=PlaySound;local GetCursorInfo,ClearCursor,GetSpellInfo=GetCursorInfo,ClearCursor,GetSpellInfo;local CreateFrame,UIParent=CreateFrame,UIParent;local _G=_G;if not AceGUIEditBoxInsertLink then hooksecurefunc("ChatEdit_InsertLink",function(...)return _G.AceGUIEditBoxInsertLink(...)end)end;function _G.AceGUIEditBoxInsertLink(ff)for J=1,dd:GetWidgetCount(eH)do local jA=_G["AceGUI-3.0EditBox"..J]if jA and jA:IsVisible()and jA:HasFocus()then jA:Insert(ff)return true end end end;local function jB(self)if not self.disablebutton then self.button:Show()self.editbox:SetTextInsets(0,20,3,3)end end;local function jC(self)self.button:Hide()self.editbox:SetTextInsets(0,0,3,3)end;local function hU(bv)bv.obj:Fire("OnEnter")end;local function hV(bv)bv.obj:Fire("OnLeave")end;local function jD(bv)bv.obj.editbox:SetFocus()bv:SetScript("OnShow",nil)end;local function jE(bv)dd:ClearFocus()end;local function jF(bv)local self=bv.obj;local bw=bv:GetText()local eL=self:Fire("OnEnterPressed",bw)if not eL then PlaySound(856)jC(self)end end;local function jG(bv)local self=bv.obj;local type,aL,cz=GetCursorInfo()local a8;if type=="item"then a8=cz elseif type=="spell"then a8=GetSpellInfo(aL,cz)elseif type=="macro"then a8=GetMacroInfo(aL)end;if a8 then self:SetText(a8)self:Fire("OnEnterPressed",a8)ClearCursor()jC(self)dd:ClearFocus()end end;local function jH(bv)local self=bv.obj;local bw=bv:GetText()if tostring(bw)~=tostring(self.lasttext)then self:Fire("OnTextChanged",bw)self.lasttext=bw;jB(self)end end;local function jI(bv)dd:SetFocus(bv.obj)end;local function f3(bv)local jA=bv.obj.editbox;jA:ClearFocus()jF(jA)end;local eO={["OnAcquire"]=function(self)end,["OnRelease"]=function(self)self:ClearFocus()end,["SetDisabled"]=function(self,gf)self.disabled=gf;if gf then self.editbox:EnableMouse(false)self.editbox:ClearFocus()self.editbox:SetTextColor(0.5,0.5,0.5)self.label:SetTextColor(0.5,0.5,0.5)else self.editbox:EnableMouse(true)self.editbox:SetTextColor(1,1,1)self.label:SetTextColor(1,.82,0)end end,["SetText"]=function(self,ff)self.lasttext=ff or""self.editbox:SetText(ff or"")self.editbox:SetCursorPosition(0)jC(self)end,["GetText"]=function(self,ff)return self.editbox:GetText()end,["SetLabel"]=function(self,ff)if ff and ff~=""then self.label:SetText(ff)self.label:Show()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,-18)self:SetHeight(44)self.alignoffset=30 else self.label:SetText("")self.label:Hide()self.editbox:SetPoint("TOPLEFT",self.frame,"TOPLEFT",7,0)self:SetHeight(26)self.alignoffset=12 end end,["DisableButton"]=function(self,gf)self.disablebutton=gf;if gf then jC(self)end end,["SetMaxLetters"]=function(self,fE)self.editbox:SetMaxLetters(fE or 0)end,["ClearFocus"]=function(self)self.editbox:ClearFocus()self.frame:SetScript("OnShow",nil)end,["SetFocus"]=function(self)self.editbox:SetFocus()if not self.frame:IsShown()then self.frame:SetScript("OnShow",jD)end end,["HighlightText"]=function(self,e9,ea)self.editbox:HighlightText(e9,ea)end,["SetColumns"]=function(self,ed)self.cols=ed;self:SortData()end}local function dI(rF)local fE=dd:GetNextWidgetNum(eH)local bv=CreateFrame("Frame",nil,UIParent)bv:Hide()local eu=CreateFrame("Frame","ScrollTableHolder"..fE,bv,BackdropTemplateMixin and"BackdropTemplate")ScrollTableInstance=rE:CreateST(rF,nil,nil,nil,bv)local dr={alignoffset=30,frame=ScrollTableInstance.frame,type=eH,scrollInstance=ScrollTableInstance}for s,G in pairs(eO)do dr[s]=G end;return dd:RegisterAsWidget(dr)end;dd:RegisterWidgetType(eH,dI,dJ)end;a(...)h(...)K(...)az(...)aB(...)aU(...)b7(...)bx(...)cl(...)cE(...)cS(...)da(...)eG(...)eT(...)f2(...)ft(...)fu(...)fI(...)fJ(...)gv(...)hp(...)hT(...)hX(...)i8(...)il(...)jp(...)jz(...)jJ(...)jK(...)jL(...)jO(...)j_(...)k6(...)kp(...)kE(...)ld(...)mj(...)o4(...)o8(...)oG(...)p3(...)pW(...)qm(...)qs(...)rD(...)
